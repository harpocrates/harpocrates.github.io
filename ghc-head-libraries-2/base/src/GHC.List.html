<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE Trustworthy #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE CPP, NoImplicitPrelude, ScopedTypeVariables, MagicHash #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-6"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-7"></a><span class="hs-comment">-- Module      :  GHC.List</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- Copyright   :  (c) The University of Glasgow 1994-2002</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- License     :  see libraries/base/LICENSE</span><span>
</span><a name="line-10"></a><span class="hs-comment">--</span><span>
</span><a name="line-11"></a><span class="hs-comment">-- Maintainer  :  cvs-ghc@haskell.org</span><span>
</span><a name="line-12"></a><span class="hs-comment">-- Stability   :  internal</span><span>
</span><a name="line-13"></a><span class="hs-comment">-- Portability :  non-portable (GHC Extensions)</span><span>
</span><a name="line-14"></a><span class="hs-comment">--</span><span>
</span><a name="line-15"></a><span class="hs-comment">-- The List data type and its operations</span><span>
</span><a name="line-16"></a><span class="hs-comment">--</span><span>
</span><a name="line-17"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GHC.List</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-20"></a><span>   </span><span class="hs-comment">-- [] (..),          -- built-in syntax; can't be used in export list</span><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span>   </span><a href="GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#concat"><span class="hs-identifier hs-var">concat</span></a><span class="hs-special">,</span><span>
</span><a name="line-23"></a><span>   </span><a href="GHC.List.html#head"><span class="hs-identifier hs-var">head</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#last"><span class="hs-identifier hs-var">last</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#tail"><span class="hs-identifier hs-var">tail</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#init"><span class="hs-identifier hs-var">init</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#uncons"><span class="hs-identifier hs-var">uncons</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#null"><span class="hs-identifier hs-var">null</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#length"><span class="hs-identifier hs-var">length</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="GHC.List.html#%21%21"><span class="hs-operator hs-var">!!</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-24"></a><span>   </span><a href="GHC.List.html#foldl"><span class="hs-identifier hs-var">foldl</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#foldl%27"><span class="hs-identifier hs-var">foldl'</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#foldl1"><span class="hs-identifier hs-var">foldl1</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#foldl1%27"><span class="hs-identifier hs-var">foldl1'</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#scanl"><span class="hs-identifier hs-var">scanl</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#scanl1"><span class="hs-identifier hs-var">scanl1</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#scanl%27"><span class="hs-identifier hs-var">scanl'</span></a><span class="hs-special">,</span><span> </span><a href="GHC.Base.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#foldr1"><span class="hs-identifier hs-var">foldr1</span></a><span class="hs-special">,</span><span>
</span><a name="line-25"></a><span>   </span><a href="GHC.List.html#scanr"><span class="hs-identifier hs-var">scanr</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#scanr1"><span class="hs-identifier hs-var">scanr1</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#iterate"><span class="hs-identifier hs-var">iterate</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#iterate%27"><span class="hs-identifier hs-var">iterate'</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#repeat"><span class="hs-identifier hs-var">repeat</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#cycle"><span class="hs-identifier hs-var">cycle</span></a><span class="hs-special">,</span><span>
</span><a name="line-26"></a><span>   </span><a href="GHC.List.html#take"><span class="hs-identifier hs-var">take</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#drop"><span class="hs-identifier hs-var">drop</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#sum"><span class="hs-identifier hs-var">sum</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#product"><span class="hs-identifier hs-var">product</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#maximum"><span class="hs-identifier hs-var">maximum</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#minimum"><span class="hs-identifier hs-var">minimum</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#splitAt"><span class="hs-identifier hs-var">splitAt</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#takeWhile"><span class="hs-identifier hs-var">takeWhile</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#dropWhile"><span class="hs-identifier hs-var">dropWhile</span></a><span class="hs-special">,</span><span>
</span><a name="line-27"></a><span>   </span><a href="GHC.List.html#span"><span class="hs-identifier hs-var">span</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#break"><span class="hs-identifier hs-var">break</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#and"><span class="hs-identifier hs-var">and</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#or"><span class="hs-identifier hs-var">or</span></a><span class="hs-special">,</span><span>
</span><a name="line-28"></a><span>   </span><a href="GHC.List.html#any"><span class="hs-identifier hs-var">any</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#all"><span class="hs-identifier hs-var">all</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#elem"><span class="hs-identifier hs-var">elem</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#notElem"><span class="hs-identifier hs-var">notElem</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#lookup"><span class="hs-identifier hs-var">lookup</span></a><span class="hs-special">,</span><span>
</span><a name="line-29"></a><span>   </span><a href="GHC.List.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a><span class="hs-special">,</span><span>
</span><a name="line-30"></a><span>   </span><a href="GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#zip3"><span class="hs-identifier hs-var">zip3</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#zipWith"><span class="hs-identifier hs-var">zipWith</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#zipWith3"><span class="hs-identifier hs-var">zipWith3</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#unzip3"><span class="hs-identifier hs-var">unzip3</span></a><span class="hs-special">,</span><span>
</span><a name="line-31"></a><span>   </span><a href="GHC.List.html#errorEmptyList"><span class="hs-identifier hs-var">errorEmptyList</span></a><span class="hs-special">,</span><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a><span>
</span><a name="line-36"></a><span class="hs-keyword">import</span><span> </span><a href="GHC.Base.html"><span class="hs-identifier">GHC.Base</span></a><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span> </span><a href="GHC.Num.html"><span class="hs-identifier">GHC.Num</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Num.html#Num"><span class="hs-identifier hs-type">Num</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-38"></a><span class="hs-keyword">import</span><span> </span><a href="../integer-gmp/src/%{MODULE}.html#%{NAME}/GHC.Integer.html"><span class="hs-identifier">GHC.Integer</span></a><span> </span><span class="hs-special">(</span><a href="../integer-gmp/src/%{MODULE}.html#%{NAME}/GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span class="hs-special">)</span><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">9</span><span>  </span><a href="GHC.List.html#%21%21"><span class="hs-operator hs-var">!!</span></a><span>
</span><a name="line-41"></a><span class="hs-keyword">infix</span><span>  </span><span class="hs-number">4</span><span> </span><span class="hs-special">`</span><a href="GHC.List.html#elem"><span class="hs-identifier hs-var">elem</span></a><span class="hs-special">`</span><span class="hs-special">,</span><span> </span><span class="hs-special">`</span><a href="GHC.List.html#notElem"><span class="hs-identifier hs-var">notElem</span></a><span class="hs-special">`</span><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span class="hs-comment">--------------------------------------------------------------</span><span>
</span><a name="line-44"></a><span class="hs-comment">-- List-manipulation functions</span><span>
</span><a name="line-45"></a><span class="hs-comment">--------------------------------------------------------------</span><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span class="hs-comment">-- | Extract the first element of a list, which must be non-empty.</span><span>
</span><a name="line-48"></a><span class="hs-identifier">head</span><span>                    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679030641"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679030641"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-49"></a><a name="head"><a href="GHC.List.html#head"><span class="hs-identifier">head</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679030642"><a href="#local-6989586621679030642"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span>  </span><a href="#local-6989586621679030642"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-50"></a><span class="hs-identifier">head</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>                 </span><span class="hs-glyph">=</span><span>  </span><a href="GHC.List.html#badHead"><span class="hs-identifier hs-var">badHead</span></a><span>
</span><a name="line-51"></a><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">head</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span class="hs-identifier">badHead</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679030640"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-54"></a><a name="badHead"><a href="GHC.List.html#badHead"><span class="hs-identifier">badHead</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.List.html#errorEmptyList"><span class="hs-identifier hs-var">errorEmptyList</span></a><span> </span><span class="hs-string">&quot;head&quot;</span><span>
</span><a name="line-55"></a><span>
</span><a name="line-56"></a><span class="hs-comment">-- This rule is useful in cases like</span><span>
</span><a name="line-57"></a><span class="hs-comment">--      head [y | (x,y) &lt;- ps, x==t]</span><span>
</span><a name="line-58"></a><span class="hs-pragma">{-# RULES</span><span>
</span><a name="line-59"></a><span class="hs-pragma">&quot;head/build&quot;</span><span>    </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">g</span><span class="hs-pragma">::</span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">.</span><span class="hs-pragma">(</span><span class="hs-pragma">a</span><span class="hs-pragma">-&gt;</span><span class="hs-pragma">b</span><span class="hs-pragma">-&gt;</span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span class="hs-pragma">-&gt;</span><span class="hs-pragma">b</span><span class="hs-pragma">-&gt;</span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">.</span><span>
</span><a name="line-60"></a><span>                </span><span class="hs-pragma">head</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">build</span><span> </span><span class="hs-pragma">g</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span class="hs-pragma">x</span><span> </span><span class="hs-pragma">_</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">x</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">badHead</span><span>
</span><a name="line-61"></a><span class="hs-pragma">&quot;head/augment&quot;</span><span>  </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">g</span><span class="hs-pragma">::</span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">a</span><span class="hs-pragma">-&gt;</span><span class="hs-pragma">b</span><span class="hs-pragma">-&gt;</span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">b</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">.</span><span>
</span><a name="line-62"></a><span>                </span><span class="hs-pragma">head</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">augment</span><span> </span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">xs</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span class="hs-pragma">x</span><span> </span><span class="hs-pragma">_</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">x</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">head</span><span> </span><span class="hs-pragma">xs</span><span class="hs-pragma">)</span><span>
</span><a name="line-63"></a><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-64"></a><span>
</span><a name="line-65"></a><span class="hs-comment">-- | Decompose a list into its head and tail. If the list is empty,</span><span>
</span><a name="line-66"></a><span class="hs-comment">-- returns 'Nothing'. If the list is non-empty, returns @'Just' (x, xs)@,</span><span>
</span><a name="line-67"></a><span class="hs-comment">-- where @x@ is the head of the list and @xs@ its tail.</span><span>
</span><a name="line-68"></a><span class="hs-comment">--</span><span>
</span><a name="line-69"></a><span class="hs-comment">-- @since 4.8.0.0</span><span>
</span><a name="line-70"></a><span class="hs-identifier">uncons</span><span>                  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-71"></a><span class="hs-identifier">uncons</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><a name="line-72"></a><a name="uncons"><a href="GHC.List.html#uncons"><span class="hs-identifier">uncons</span></a></a><span> </span><span class="hs-special">(</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#%5B%5D"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span class="hs-comment">-- | Extract the elements after the head of a list, which must be non-empty.</span><span>
</span><a name="line-75"></a><span class="hs-identifier">tail</span><span>                    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span>
</span><a name="line-76"></a><span class="hs-identifier">tail</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">xs</span><span>
</span><a name="line-77"></a><a name="tail"><a href="GHC.List.html#tail"><span class="hs-identifier">tail</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>                 </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">errorEmptyList</span><span> </span><span class="hs-string">&quot;tail&quot;</span><span>
</span><a name="line-78"></a><span>
</span><a name="line-79"></a><span class="hs-comment">-- | Extract the last element of a list, which must be finite and non-empty.</span><span>
</span><a name="line-80"></a><span class="hs-identifier">last</span><span>                    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-81"></a><span class="hs-cpp">#if defined(USE_REPORT_PRELUDE)
</span><span class="hs-identifier">last</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">x</span><span class="hs-special">]</span><span>                </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">x</span><span>
</span><a name="line-83"></a><span class="hs-identifier">last</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">last</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-84"></a><span class="hs-identifier">last</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>                 </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">errorEmptyList</span><span> </span><span class="hs-string">&quot;last&quot;</span><span>
</span><a name="line-85"></a><span class="hs-cpp">#else
</span><span class="hs-comment">-- Use foldl to make last a good consumer.</span><span>
</span><a name="line-87"></a><span class="hs-comment">-- This will compile to good code for the actual GHC.List.last.</span><span>
</span><a name="line-88"></a><span class="hs-comment">-- (At least as long it is eta-expaned, otherwise it does not, #10260.)</span><span>
</span><a name="line-89"></a><span class="hs-identifier">last</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldl</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">lastError</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-90"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">last</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-91"></a><span class="hs-comment">-- The inline pragma is required to make GHC remember the implementation via</span><span>
</span><a name="line-92"></a><span class="hs-comment">-- foldl.</span><span>
</span><a name="line-93"></a><span class="hs-identifier">lastError</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-94"></a><span class="hs-identifier">lastError</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">errorEmptyList</span><span> </span><span class="hs-string">&quot;last&quot;</span><span>
</span><a name="line-95"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-97"></a><span class="hs-comment">-- | Return all the elements of a list except the last one.</span><span>
</span><a name="line-98"></a><span class="hs-comment">-- The list must be non-empty.</span><span>
</span><a name="line-99"></a><span class="hs-identifier">init</span><span>                    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span>
</span><a name="line-100"></a><span class="hs-cpp">#if defined(USE_REPORT_PRELUDE)
</span><span class="hs-identifier">init</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">x</span><span class="hs-special">]</span><span>                </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-102"></a><span class="hs-identifier">init</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">init</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-103"></a><span class="hs-identifier">init</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>                 </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">errorEmptyList</span><span> </span><span class="hs-string">&quot;init&quot;</span><span>
</span><a name="line-104"></a><span class="hs-cpp">#else
</span><span class="hs-comment">-- eliminate repeated cases</span><span>
</span><a name="line-106"></a><span class="hs-identifier">init</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>                 </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">errorEmptyList</span><span> </span><span class="hs-string">&quot;init&quot;</span><span>
</span><a name="line-107"></a><a name="init"><a href="GHC.List.html#init"><span class="hs-identifier">init</span></a></a><span> </span><span class="hs-special">(</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#%5B%5D"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span>  </span><a href="GHC.List.html#errorEmptyList"><span class="hs-identifier hs-var">init'</span></a><span> </span><a href="GHC.List.html#errorEmptyList"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="GHC.List.html#errorEmptyList"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-108"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">init'</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-109"></a><span>        </span><a name="local-6989586621679030650"><a href="#local-6989586621679030650"><span class="hs-identifier">init'</span></a></a><span> </span><span class="hs-identifier">y</span><span> </span><span class="hs-special">(</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#%5B%5D"><span class="hs-identifier hs-var">z</span></a><span class="hs-glyph">:</span><span class="hs-identifier">zs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">y</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">init'</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">zs</span><span>
</span><a name="line-110"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-112"></a><span class="hs-comment">-- | Test whether a list is empty.</span><span>
</span><a name="line-113"></a><span class="hs-identifier">null</span><span>                    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><a name="line-114"></a><span class="hs-identifier">null</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>                 </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">True</span><span>
</span><a name="line-115"></a><a name="null"><a href="GHC.List.html#null"><span class="hs-identifier">null</span></a></a><span> </span><span class="hs-special">(</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#%5B%5D"><span class="hs-identifier hs-var">_</span></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">False</span><span>
</span><a name="line-116"></a><span>
</span><a name="line-117"></a><span class="hs-comment">-- | /O(n)/. 'length' returns the length of a finite list as an 'Int'.</span><span>
</span><a name="line-118"></a><span class="hs-comment">-- It is an instance of the more general 'Data.List.genericLength',</span><span>
</span><a name="line-119"></a><span class="hs-comment">-- the result type of which may be any kind of number.</span><span>
</span><a name="line-120"></a><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">length</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-121"></a><span class="hs-identifier">length</span><span>                  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span>
</span><a name="line-122"></a><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">xs</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lenAcc</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-123"></a><span>
</span><a name="line-124"></a><span class="hs-identifier">lenAcc</span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span>
</span><a name="line-125"></a><span class="hs-identifier">lenAcc</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">n</span><span>
</span><a name="line-126"></a><a name="lenAcc"><a href="GHC.List.html#lenAcc"><span class="hs-identifier">lenAcc</span></a></a><span> </span><span class="hs-special">(</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#%5B%5D"><span class="hs-identifier hs-var">_</span></a><span class="hs-glyph">:</span><span class="hs-identifier">ys</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679030655"><a href="#local-6989586621679030655"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lenAcc</span><span> </span><span class="hs-identifier">ys</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n</span><span class="hs-operator">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-127"></a><span>
</span><a name="line-128"></a><span class="hs-pragma">{-# RULES</span><span>
</span><a name="line-129"></a><span class="hs-pragma">&quot;length&quot;</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">~</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">length</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">foldr</span><span> </span><span class="hs-pragma">lengthFB</span><span> </span><span class="hs-pragma">idLength</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">0</span><span>
</span><a name="line-130"></a><span class="hs-pragma">&quot;lengthList&quot;</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">foldr</span><span> </span><span class="hs-pragma">lengthFB</span><span> </span><span class="hs-pragma">idLength</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">lenAcc</span><span>
</span><a name="line-131"></a><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-132"></a><span>
</span><a name="line-133"></a><span class="hs-comment">-- The lambda form turns out to be necessary to make this inline</span><span>
</span><a name="line-134"></a><span class="hs-comment">-- when we need it to and give good performance.</span><span>
</span><a name="line-135"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">0</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">lengthFB</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-136"></a><span class="hs-identifier">lengthFB</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span>
</span><a name="line-137"></a><span class="hs-identifier">lengthFB</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-138"></a><span>
</span><a name="line-139"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">0</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">idLength</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-140"></a><span class="hs-identifier">idLength</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span>
</span><a name="line-141"></a><span class="hs-identifier">idLength</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">id</span><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><span class="hs-comment">-- | 'filter', applied to a predicate and a list, returns the list of</span><span>
</span><a name="line-144"></a><span class="hs-comment">-- those elements that satisfy the predicate; i.e.,</span><span>
</span><a name="line-145"></a><span class="hs-comment">--</span><span>
</span><a name="line-146"></a><span class="hs-comment">-- &gt; filter p xs = [ x | x &lt;- xs, p x]</span><span>
</span><a name="line-147"></a><span>
</span><a name="line-148"></a><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">filter</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-149"></a><span class="hs-identifier">filter</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span>
</span><a name="line-150"></a><span class="hs-identifier">filter</span><span> </span><span class="hs-identifier">_pred</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-151"></a><span class="hs-identifier">filter</span><span> </span><span class="hs-identifier">pred</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>
</span><a name="line-152"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">pred</span><span> </span><a name="local-6989586621679030660"><a href="#local-6989586621679030660"><span class="hs-identifier">x</span></a></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">filter</span><span> </span><span class="hs-identifier">pred</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-153"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">filter</span><span> </span><span class="hs-identifier">pred</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-154"></a><span>
</span><a name="line-155"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">0</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">filterFB</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-comment">-- See Note [Inline FB functions]</span><span>
</span><a name="line-156"></a><span class="hs-identifier">filterFB</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-157"></a><span class="hs-identifier">filterFB</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">x</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">c</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">r</span><span>
</span><a name="line-158"></a><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">r</span><span>
</span><a name="line-159"></a><span>
</span><a name="line-160"></a><span class="hs-pragma">{-# RULES</span><span>
</span><a name="line-161"></a><span class="hs-pragma">&quot;filter&quot;</span><span>     </span><span class="hs-pragma">[</span><span class="hs-pragma">~</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">p</span><span> </span><span class="hs-pragma">xs</span><span class="hs-pragma">.</span><span>  </span><span class="hs-pragma">filter</span><span> </span><span class="hs-pragma">p</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">build</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span class="hs-pragma">c</span><span> </span><span class="hs-pragma">n</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">foldr</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">filterFB</span><span> </span><span class="hs-pragma">c</span><span> </span><span class="hs-pragma">p</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">n</span><span> </span><span class="hs-pragma">xs</span><span class="hs-pragma">)</span><span>
</span><a name="line-162"></a><span class="hs-pragma">&quot;filterList&quot;</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span>  </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">p</span><span class="hs-pragma">.</span><span>     </span><span class="hs-pragma">foldr</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">filterFB</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">:</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">p</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">filter</span><span> </span><span class="hs-pragma">p</span><span>
</span><a name="line-163"></a><span class="hs-pragma">&quot;filterFB&quot;</span><span>        </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">c</span><span> </span><span class="hs-pragma">p</span><span> </span><span class="hs-pragma">q</span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">filterFB</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">filterFB</span><span> </span><span class="hs-pragma">c</span><span> </span><span class="hs-pragma">p</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">q</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">filterFB</span><span> </span><span class="hs-pragma">c</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span class="hs-pragma">x</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">q</span><span> </span><span class="hs-pragma">x</span><span> </span><span class="hs-pragma">&amp;&amp;</span><span> </span><span class="hs-pragma">p</span><span> </span><span class="hs-pragma">x</span><span class="hs-pragma">)</span><span>
</span><a name="line-164"></a><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-165"></a><span>
</span><a name="line-166"></a><span class="hs-comment">-- Note the filterFB rule, which has p and q the &quot;wrong way round&quot; in the RHS.</span><span>
</span><a name="line-167"></a><span class="hs-comment">--     filterFB (filterFB c p) q a b</span><span>
</span><a name="line-168"></a><span class="hs-comment">--   = if q a then filterFB c p a b else b</span><span>
</span><a name="line-169"></a><span class="hs-comment">--   = if q a then (if p a then c a b else b) else b</span><span>
</span><a name="line-170"></a><span class="hs-comment">--   = if q a &amp;&amp; p a then c a b else b</span><span>
</span><a name="line-171"></a><span class="hs-comment">--   = filterFB c (\x -&gt; q x &amp;&amp; p x) a b</span><span>
</span><a name="line-172"></a><span class="hs-comment">-- I originally wrote (\x -&gt; p x &amp;&amp; q x), which is wrong, and actually</span><span>
</span><a name="line-173"></a><span class="hs-comment">-- gave rise to a live bug report.  SLPJ.</span><span>
</span><a name="line-174"></a><span>
</span><a name="line-175"></a><span>
</span><a name="line-176"></a><span class="hs-comment">-- | 'foldl', applied to a binary operator, a starting value (typically</span><span>
</span><a name="line-177"></a><span class="hs-comment">-- the left-identity of the operator), and a list, reduces the list</span><span>
</span><a name="line-178"></a><span class="hs-comment">-- using the binary operator, from left to right:</span><span>
</span><a name="line-179"></a><span class="hs-comment">--</span><span>
</span><a name="line-180"></a><span class="hs-comment">-- &gt; foldl f z [x1, x2, ..., xn] == (...((z `f` x1) `f` x2) `f`...) `f` xn</span><span>
</span><a name="line-181"></a><span class="hs-comment">--</span><span>
</span><a name="line-182"></a><span class="hs-comment">-- The list must be finite.</span><span>
</span><a name="line-183"></a><span>
</span><a name="line-184"></a><span class="hs-identifier">foldl</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-185"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">foldl</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-186"></a><span class="hs-identifier">foldl</span><span> </span><span class="hs-identifier">k</span><span> </span><span class="hs-identifier">z0</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-187"></a><span>  </span><span class="hs-identifier">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier">v</span><span class="hs-glyph">::</span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fn</span><span class="hs-glyph">::</span><a href="#local-6989586621679030627"><span class="hs-identifier hs-type">b</span></a><span class="hs-glyph">-&gt;</span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">oneShot</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier">z</span><span class="hs-glyph">::</span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">fn</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">k</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">v</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">id</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-identifier">z0</span><span>
</span><a name="line-188"></a><span>  </span><span class="hs-comment">-- See Note [Left folds via right fold]</span><span>
</span><a name="line-189"></a><span>
</span><a name="line-190"></a><span class="hs-comment">{-
Note [Left folds via right fold]

Implementing foldl et. al. via foldr is only a good idea if the compiler can
optimize the resulting code (eta-expand the recursive &quot;go&quot;). See #7994.
We hope that one of the two measure kick in:

   * Call Arity (-fcall-arity, enabled by default) eta-expands it if it can see
     all calls and determine that the arity is large.
   * The oneShot annotation gives a hint to the regular arity analysis that
     it may assume that the lambda is called at most once.
     See [One-shot lambdas] in CoreArity and especially [Eta expanding thunks]
     in CoreArity.

The oneShot annotations used in this module are correct, as we only use them in
arguments to foldr, where we know how the arguments are called.

Note [Inline FB functions]
~~~~~~~~~~~~~~~~~~~~~~~~~~
After fusion rules successfully fire, we are usually left with one or more calls
to list-producing functions abstracted over cons and nil. Here we call them
FB functions because their names usually end with 'FB'. It's a good idea to
inline FB functions because:

* They are higher-order functions and therefore benefits from inlining.

* When the final consumer is a left fold, inlining the FB functions is the only
  way to make arity expansion to happen. See Note [Left fold via right fold].

For this reason we mark all FB functions INLINE [0]. The [0] phase-specifier
ensures that calls to FB functions can be written back to the original form
when no fusion happens.

Without these inline pragmas, the loop in perf/should_run/T13001 won't be
allocation-free. Also see Trac #13001.
-}</span><span>
</span><a name="line-226"></a><span>
</span><a name="line-227"></a><span class="hs-comment">-- ----------------------------------------------------------------------------</span><span>
</span><a name="line-228"></a><span>
</span><a name="line-229"></a><span class="hs-comment">-- | A strict version of 'foldl'.</span><span>
</span><a name="line-230"></a><span class="hs-identifier">foldl'</span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-231"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">foldl'</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-232"></a><span class="hs-identifier">foldl'</span><span> </span><span class="hs-identifier">k</span><span> </span><span class="hs-identifier">z0</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-233"></a><span>  </span><span class="hs-identifier">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier">v</span><span class="hs-glyph">::</span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fn</span><span class="hs-glyph">::</span><span class="hs-identifier">b</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">oneShot</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier">z</span><span class="hs-glyph">::</span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">seq</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">fn</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">k</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">v</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">id</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-identifier">z0</span><span>
</span><a name="line-234"></a><span>  </span><span class="hs-comment">-- See Note [Left folds via right fold]</span><span>
</span><a name="line-235"></a><span>
</span><a name="line-236"></a><span class="hs-comment">-- | 'foldl1' is a variant of 'foldl' that has no starting value argument,</span><span>
</span><a name="line-237"></a><span class="hs-comment">-- and thus must be applied to non-empty lists.</span><span>
</span><a name="line-238"></a><span class="hs-identifier">foldl1</span><span>                  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-239"></a><span class="hs-identifier">foldl1</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">foldl</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-240"></a><span class="hs-identifier">foldl1</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>             </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">errorEmptyList</span><span> </span><span class="hs-string">&quot;foldl1&quot;</span><span>
</span><a name="line-241"></a><span>
</span><a name="line-242"></a><span class="hs-comment">-- | A strict version of 'foldl1'</span><span>
</span><a name="line-243"></a><span class="hs-identifier">foldl1'</span><span>                  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="GHC.List.html#errorEmptyList"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.List.html#errorEmptyList"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.List.html#errorEmptyList"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-244"></a><span class="hs-identifier">foldl1'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">foldl'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-245"></a><span class="hs-identifier">foldl1'</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>             </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">errorEmptyList</span><span> </span><span class="hs-string">&quot;foldl1'&quot;</span><span>
</span><a name="line-246"></a><span>
</span><a name="line-247"></a><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><a name="line-248"></a><span class="hs-comment">-- List sum and product</span><span>
</span><a name="line-249"></a><span>
</span><a name="line-250"></a><span class="hs-comment">-- | The 'sum' function computes the sum of a finite list of numbers.</span><span>
</span><a name="line-251"></a><span class="hs-identifier">sum</span><span>                     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Num</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-252"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">sum</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-253"></a><span class="hs-identifier">sum</span><span>                     </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">foldl</span><span> </span><span class="hs-special">(</span><span class="hs-operator">+</span><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-254"></a><span>
</span><a name="line-255"></a><span class="hs-comment">-- | The 'product' function computes the product of a finite list of numbers.</span><span>
</span><a name="line-256"></a><span class="hs-identifier">product</span><span>                 </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="GHC.List.html#foldl"><span class="hs-identifier hs-var">Num</span></a><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-257"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">product</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-258"></a><span class="hs-identifier">product</span><span>                 </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">foldl</span><span> </span><span class="hs-special">(</span><span class="hs-operator">*</span><span class="hs-special">)</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-259"></a><span>
</span><a name="line-260"></a><span class="hs-comment">-- | 'scanl' is similar to 'foldl', but returns a list of successive</span><span>
</span><a name="line-261"></a><span class="hs-comment">-- reduced values from the left:</span><span>
</span><a name="line-262"></a><span class="hs-comment">--</span><span>
</span><a name="line-263"></a><span class="hs-comment">-- &gt; scanl f z [x1, x2, ...] == [z, z `f` x1, (z `f` x1) `f` x2, ...]</span><span>
</span><a name="line-264"></a><span class="hs-comment">--</span><span>
</span><a name="line-265"></a><span class="hs-comment">-- Note that</span><span>
</span><a name="line-266"></a><span class="hs-comment">--</span><span>
</span><a name="line-267"></a><span class="hs-comment">-- &gt; last (scanl f z xs) == foldl f z xs.</span><span>
</span><a name="line-268"></a><span>
</span><a name="line-269"></a><span class="hs-comment">-- This peculiar arrangement is necessary to prevent scanl being rewritten in</span><span>
</span><a name="line-270"></a><span class="hs-comment">-- its own right-hand side.</span><span>
</span><a name="line-271"></a><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">scanl</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-272"></a><span class="hs-identifier">scanl</span><span>                   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">b</span><span class="hs-special">]</span><span>
</span><a name="line-273"></a><span class="hs-identifier">scanl</span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">scanlGo</span><span>
</span><a name="line-274"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-275"></a><span>    </span><span class="hs-identifier">scanlGo</span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">b</span><span class="hs-special">]</span><span>
</span><a name="line-276"></a><span>    </span><span class="hs-identifier">scanlGo</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-identifier">ls</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">ls</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-277"></a><span>                               </span><span class="hs-special">[</span><span class="hs-special">]</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-278"></a><span>                               </span><a href="#local-6989586621679030688"><span class="hs-identifier hs-type">x</span></a><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">scanlGo</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>
</span><a name="line-279"></a><span>
</span><a name="line-280"></a><span class="hs-comment">-- Note [scanl rewrite rules]</span><span>
</span><a name="line-281"></a><span class="hs-pragma">{-# RULES</span><span>
</span><a name="line-282"></a><span class="hs-pragma">&quot;scanl&quot;</span><span>  </span><span class="hs-pragma">[</span><span class="hs-pragma">~</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">bs</span><span> </span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">scanl</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">bs</span><span> </span><span class="hs-pragma">=</span><span>
</span><a name="line-283"></a><span>  </span><span class="hs-pragma">build</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span class="hs-pragma">c</span><span> </span><span class="hs-pragma">n</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">`</span><span class="hs-pragma">c</span><span class="hs-pragma">`</span><span> </span><span class="hs-pragma">foldr</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">scanlFB</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">c</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">constScanl</span><span> </span><span class="hs-pragma">n</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">bs</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span>
</span><a name="line-284"></a><span class="hs-pragma">&quot;scanlList&quot;</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">a</span><span class="hs-pragma">::</span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">bs</span><span> </span><span class="hs-pragma">.</span><span>
</span><a name="line-285"></a><span>    </span><span class="hs-pragma">foldr</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">scanlFB</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">:</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">constScanl</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">]</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">bs</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">tail</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">scanl</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">bs</span><span class="hs-pragma">)</span><span>
</span><a name="line-286"></a><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-287"></a><span>
</span><a name="line-288"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">0</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">scanlFB</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-comment">-- See Note [Inline FB functions]</span><span>
</span><a name="line-289"></a><span class="hs-identifier">scanlFB</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-290"></a><span class="hs-identifier">scanlFB</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">oneShot</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">b'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">b'</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">c</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">b'</span><span class="hs-special">)</span><span>
</span><a name="line-291"></a><span>  </span><span class="hs-comment">-- See Note [Left folds via right fold]</span><span>
</span><a name="line-292"></a><span>
</span><a name="line-293"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">0</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">constScanl</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-294"></a><span class="hs-identifier">constScanl</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Magic.html#oneShot"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-295"></a><span class="hs-identifier">constScanl</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">const</span><span>
</span><a name="line-296"></a><span>
</span><a name="line-297"></a><span>
</span><a name="line-298"></a><span class="hs-comment">-- | 'scanl1' is a variant of 'scanl' that has no starting value argument:</span><span>
</span><a name="line-299"></a><span class="hs-comment">--</span><span>
</span><a name="line-300"></a><span class="hs-comment">-- &gt; scanl1 f [x1, x2, ...] == [x1, x1 `f` x2, ...]</span><span>
</span><a name="line-301"></a><span>
</span><a name="line-302"></a><span class="hs-identifier">scanl1</span><span>                  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span>
</span><a name="line-303"></a><span class="hs-identifier">scanl1</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">scanl</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-304"></a><span class="hs-identifier">scanl1</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>             </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-305"></a><span>
</span><a name="line-306"></a><span class="hs-comment">-- | A strictly accumulating version of 'scanl'</span><span>
</span><a name="line-307"></a><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">scanl'</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-308"></a><span class="hs-identifier">scanl'</span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">b</span><span class="hs-special">]</span><span>
</span><a name="line-309"></a><span class="hs-comment">-- This peculiar form is needed to prevent scanl' from being rewritten</span><span>
</span><a name="line-310"></a><span class="hs-comment">-- in its own right hand side.</span><span>
</span><a name="line-311"></a><span class="hs-identifier">scanl'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">scanlGo'</span><span>
</span><a name="line-312"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-313"></a><span>    </span><span class="hs-identifier">scanlGo'</span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">b</span><span class="hs-special">]</span><span>
</span><a name="line-314"></a><span>    </span><span class="hs-identifier">scanlGo'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">q</span><span> </span><span class="hs-identifier">ls</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">ls</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-315"></a><span>                            </span><span class="hs-special">[</span><span class="hs-special">]</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-316"></a><span>                            </span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">scanlGo'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>
</span><a name="line-317"></a><span>
</span><a name="line-318"></a><span class="hs-comment">-- Note [scanl rewrite rules]</span><span>
</span><a name="line-319"></a><span class="hs-pragma">{-# RULES</span><span>
</span><a name="line-320"></a><span class="hs-pragma">&quot;scanl'&quot;</span><span>  </span><span class="hs-pragma">[</span><span class="hs-pragma">~</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">bs</span><span> </span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">scanl'</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">bs</span><span> </span><span class="hs-pragma">=</span><span>
</span><a name="line-321"></a><span>  </span><span class="hs-pragma">build</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span class="hs-pragma">c</span><span> </span><span class="hs-pragma">n</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">`</span><span class="hs-pragma">c</span><span class="hs-pragma">`</span><span> </span><span class="hs-pragma">foldr</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">scanlFB'</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">c</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">flipSeqScanl'</span><span> </span><span class="hs-pragma">n</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">bs</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span>
</span><a name="line-322"></a><span class="hs-pragma">&quot;scanlList'&quot;</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">bs</span><span> </span><span class="hs-pragma">.</span><span>
</span><a name="line-323"></a><span>    </span><span class="hs-pragma">foldr</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">scanlFB'</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">:</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">flipSeqScanl'</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">]</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">bs</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">tail</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">scanl'</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">bs</span><span class="hs-pragma">)</span><span>
</span><a name="line-324"></a><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-325"></a><span>
</span><a name="line-326"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">0</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">scanlFB'</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-comment">-- See Note [Inline FB functions]</span><span>
</span><a name="line-327"></a><span class="hs-identifier">scanlFB'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="GHC.List.html#scanlFB%27"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.List.html#scanlFB%27"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#%3A"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="GHC.List.html#flipSeqScanl%27"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.List.html#flipSeqScanl%27"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.List.html#flipSeqScanl%27"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679031021"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.List.html#scanl%27"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679031020"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-328"></a><span class="hs-identifier">scanlFB'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">oneShot</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">b'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">b'</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">c</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">b'</span><span class="hs-special">)</span><span>
</span><a name="line-329"></a><span>  </span><span class="hs-comment">-- See Note [Left folds via right fold]</span><span>
</span><a name="line-330"></a><span>
</span><a name="line-331"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">0</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">flipSeqScanl'</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-332"></a><span class="hs-identifier">flipSeqScanl'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-333"></a><span class="hs-identifier">flipSeqScanl'</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_b</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-334"></a><span>
</span><a name="line-335"></a><span class="hs-comment">{-
Note [scanl rewrite rules]
~~~~~~~~~~~~~~~~~~~~~~~~~~

In most cases, when we rewrite a form to one that can fuse, we try to rewrite it
back to the original form if it does not fuse. For scanl, we do something a
little different. In particular, we rewrite

scanl f a bs

to

build (\c n -&gt; a `c` foldr (scanlFB f c) (constScanl n) bs a)

When build is inlined, this becomes

a : foldr (scanlFB f (:)) (constScanl []) bs a

To rewrite this form back to scanl, we would need a rule that looked like

forall f a bs. a : foldr (scanlFB f (:)) (constScanl []) bs a = scanl f a bs

The problem with this rule is that it has (:) at its head. This would have the
effect of changing the way the inliner looks at (:), not only here but
everywhere.  In most cases, this makes no difference, but in some cases it
causes it to come to a different decision about whether to inline something.
Based on nofib benchmarks, this is bad for performance. Therefore, we instead
match on everything past the :, which is just the tail of scanl.
-}</span><span>
</span><a name="line-364"></a><span>
</span><a name="line-365"></a><span class="hs-comment">-- foldr, foldr1, scanr, and scanr1 are the right-to-left duals of the</span><span>
</span><a name="line-366"></a><span class="hs-comment">-- above functions.</span><span>
</span><a name="line-367"></a><span>
</span><a name="line-368"></a><span class="hs-comment">-- | 'foldr1' is a variant of 'foldr' that has no starting value argument,</span><span>
</span><a name="line-369"></a><span class="hs-comment">-- and thus must be applied to non-empty lists.</span><span>
</span><a name="line-370"></a><span>
</span><a name="line-371"></a><span class="hs-identifier">foldr1</span><span>                  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-372"></a><span class="hs-identifier">foldr1</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">go</span><span>
</span><a name="line-373"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">x</span><span class="hs-special">]</span><span>            </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">x</span><span>
</span><a name="line-374"></a><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>
</span><a name="line-375"></a><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>             </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">errorEmptyList</span><span> </span><span class="hs-string">&quot;foldr1&quot;</span><span>
</span><a name="line-376"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">0</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">foldr1</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-377"></a><span>
</span><a name="line-378"></a><span class="hs-comment">-- | 'scanr' is the right-to-left dual of 'scanl'.</span><span>
</span><a name="line-379"></a><span class="hs-comment">-- Note that</span><span>
</span><a name="line-380"></a><span class="hs-comment">--</span><span>
</span><a name="line-381"></a><span class="hs-comment">-- &gt; head (scanr f z xs) == foldr f z xs.</span><span>
</span><a name="line-382"></a><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">scanr</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-383"></a><span class="hs-identifier">scanr</span><span>                   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">b</span><span class="hs-special">]</span><span>
</span><a name="line-384"></a><span class="hs-identifier">scanr</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">q0</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>           </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">[</span><span class="hs-identifier">q0</span><span class="hs-special">]</span><span>
</span><a name="line-385"></a><span class="hs-identifier">scanr</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">q0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">qs</span><span>
</span><a name="line-386"></a><span>                           </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">qs</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">q</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">scanr</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">q0</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-387"></a><span>
</span><a name="line-388"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">0</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">strictUncurryScanr</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-389"></a><span class="hs-identifier">strictUncurryScanr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679030724"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-390"></a><span class="hs-identifier">strictUncurryScanr</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">pair</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">pair</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-391"></a><span>                              </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679030729"><a href="#local-6989586621679030729"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span> </span><a href="GHC.List.html#scanr"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-392"></a><span>
</span><a name="line-393"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">0</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">scanrFB</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-comment">-- See Note [Inline FB functions]</span><span>
</span><a name="line-394"></a><span class="hs-identifier">scanrFB</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-395"></a><a name="strictUncurryScanr"><a href="GHC.List.html#strictUncurryScanr"><span class="hs-identifier">scanrFB</span></a></a><span> </span><a name="strictUncurryScanr"><a href="GHC.List.html#strictUncurryScanr"><span class="hs-identifier">f</span></a></a><span> </span><a name="strictUncurryScanr"><a href="GHC.List.html#strictUncurryScanr"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="strictUncurryScanr"><a href="GHC.List.html#strictUncurryScanr"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">r</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679030732"><a href="#local-6989586621679030732"><span class="hs-identifier">est</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span> </span><a href="#local-6989586621679030732"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">c</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">est</span><span class="hs-special">)</span><span>
</span><a name="line-396"></a><span>
</span><a name="line-397"></a><span class="hs-pragma">{-# RULES</span><span>
</span><a name="line-398"></a><span class="hs-pragma">&quot;scanr&quot;</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">~</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">q0</span><span> </span><span class="hs-pragma">ls</span><span> </span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">scanr</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">q0</span><span> </span><span class="hs-pragma">ls</span><span> </span><span class="hs-pragma">=</span><span>
</span><a name="line-399"></a><span>  </span><span class="hs-pragma">build</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span class="hs-pragma">c</span><span> </span><span class="hs-pragma">n</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">strictUncurryScanr</span><span> </span><span class="hs-pragma">c</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">foldr</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">scanrFB</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">c</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">q0</span><span class="hs-pragma">,</span><span class="hs-pragma">n</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">ls</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span>
</span><a name="line-400"></a><span class="hs-pragma">&quot;scanrList&quot;</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">q0</span><span> </span><span class="hs-pragma">ls</span><span> </span><span class="hs-pragma">.</span><span>
</span><a name="line-401"></a><span>               </span><span class="hs-pragma">strictUncurryScanr</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">:</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">foldr</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">scanrFB</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">:</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">q0</span><span class="hs-pragma">,</span><span class="hs-pragma">[</span><span class="hs-pragma">]</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">ls</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span>
</span><a name="line-402"></a><span>                 </span><span class="hs-pragma">scanr</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">q0</span><span> </span><span class="hs-pragma">ls</span><span>
</span><a name="line-403"></a><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-404"></a><span>
</span><a name="line-405"></a><span class="hs-comment">-- | 'scanr1' is a variant of 'scanr' that has no starting value argument.</span><span>
</span><a name="line-406"></a><span class="hs-identifier">scanr1</span><span>                  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="GHC.List.html#strictUncurryScanr"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="GHC.List.html#scanrFB"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-407"></a><span class="hs-identifier">scanr1</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>             </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-408"></a><span class="hs-identifier">scanr1</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">x</span><span class="hs-special">]</span><span>            </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">[</span><span class="hs-identifier">x</span><span class="hs-special">]</span><span>
</span><a name="line-409"></a><span class="hs-identifier">scanr1</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">qs</span><span>
</span><a name="line-410"></a><span>                           </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">qs</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">q</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">scanr1</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-411"></a><span>
</span><a name="line-412"></a><span class="hs-comment">-- | 'maximum' returns the maximum value from a list,</span><span>
</span><a name="line-413"></a><span class="hs-comment">-- which must be non-empty, finite, and of an ordered type.</span><span>
</span><a name="line-414"></a><span class="hs-comment">-- It is a special case of 'Data.List.maximumBy', which allows the</span><span>
</span><a name="line-415"></a><span class="hs-comment">-- programmer to supply their own comparison function.</span><span>
</span><a name="line-416"></a><span class="hs-identifier">maximum</span><span>                 </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Ord</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.List.html#scanr1"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-417"></a><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="hs-pragma">maximum</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-418"></a><span class="hs-identifier">maximum</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>              </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">errorEmptyList</span><span> </span><span class="hs-string">&quot;maximum&quot;</span><span>
</span><a name="line-419"></a><span class="hs-identifier">maximum</span><span> </span><span class="hs-identifier">xs</span><span>              </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">foldl1</span><span> </span><span class="hs-identifier">max</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-420"></a><span>
</span><a name="line-421"></a><span class="hs-comment">-- We want this to be specialized so that with a strict max function, GHC</span><span>
</span><a name="line-422"></a><span class="hs-comment">-- produces good code. Note that to see if this is happending, one has to</span><span>
</span><a name="line-423"></a><span class="hs-comment">-- look at -ddump-prep, not -ddump-core!</span><span>
</span><a name="line-424"></a><span class="hs-pragma">{-# SPECIALIZE</span><span>  </span><span class="hs-pragma">maximum</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">Int</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-425"></a><span class="hs-pragma">{-# SPECIALIZE</span><span>  </span><span class="hs-pragma">maximum</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">Integer</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Integer</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-426"></a><span>
</span><a name="line-427"></a><span class="hs-comment">-- | 'minimum' returns the minimum value from a list,</span><span>
</span><a name="line-428"></a><span class="hs-comment">-- which must be non-empty, finite, and of an ordered type.</span><span>
</span><a name="line-429"></a><span class="hs-comment">-- It is a special case of 'Data.List.minimumBy', which allows the</span><span>
</span><a name="line-430"></a><span class="hs-comment">-- programmer to supply their own comparison function.</span><span>
</span><a name="line-431"></a><span class="hs-identifier">minimum</span><span>                 </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="../integer-gmp/src/%{MODULE}.html#%{NAME}/GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Ord</span></a><span> </span><a href="../integer-gmp/src/%{MODULE}.html#%{NAME}/GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../integer-gmp/src/%{MODULE}.html#%{NAME}/GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-432"></a><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="hs-pragma">minimum</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-433"></a><span class="hs-identifier">minimum</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>              </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">errorEmptyList</span><span> </span><span class="hs-string">&quot;minimum&quot;</span><span>
</span><a name="line-434"></a><span class="hs-identifier">minimum</span><span> </span><span class="hs-identifier">xs</span><span>              </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">foldl1</span><span> </span><span class="hs-identifier">min</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-435"></a><span>
</span><a name="line-436"></a><span class="hs-pragma">{-# SPECIALIZE</span><span>  </span><span class="hs-pragma">minimum</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">Int</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-437"></a><span class="hs-pragma">{-# SPECIALIZE</span><span>  </span><span class="hs-pragma">minimum</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">Integer</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Integer</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-438"></a><span>
</span><a name="line-439"></a><span>
</span><a name="line-440"></a><span class="hs-comment">-- | 'iterate' @f x@ returns an infinite list of repeated applications</span><span>
</span><a name="line-441"></a><span class="hs-comment">-- of @f@ to @x@:</span><span>
</span><a name="line-442"></a><span class="hs-comment">--</span><span>
</span><a name="line-443"></a><span class="hs-comment">-- &gt; iterate f x == [x, f x, f (f x), ...]</span><span>
</span><a name="line-444"></a><span class="hs-comment">--</span><span>
</span><a name="line-445"></a><span class="hs-comment">-- Note that 'iterate' is lazy, potentially leading to thunk build-up if</span><span>
</span><a name="line-446"></a><span class="hs-comment">-- the consumer doesn't force each iterate. See 'iterate'' for a strict</span><span>
</span><a name="line-447"></a><span class="hs-comment">-- variant of this function.</span><span>
</span><a name="line-448"></a><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">iterate</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-449"></a><span class="hs-identifier">iterate</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span>
</span><a name="line-450"></a><span class="hs-identifier">iterate</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">iterate</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><a name="line-451"></a><span>
</span><a name="line-452"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">0</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">iterateFB</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-comment">-- See Note [Inline FB functions]</span><span>
</span><a name="line-453"></a><span class="hs-identifier">iterateFB</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-454"></a><span class="hs-identifier">iterateFB</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">x0</span><span>
</span><a name="line-455"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">c</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><a name="line-456"></a><span>
</span><a name="line-457"></a><span class="hs-pragma">{-# RULES</span><span>
</span><a name="line-458"></a><span class="hs-pragma">&quot;iterate&quot;</span><span>    </span><span class="hs-pragma">[</span><span class="hs-pragma">~</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">x</span><span class="hs-pragma">.</span><span>   </span><span class="hs-pragma">iterate</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">x</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">build</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span class="hs-pragma">c</span><span> </span><span class="hs-pragma">_n</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">iterateFB</span><span> </span><span class="hs-pragma">c</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">x</span><span class="hs-pragma">)</span><span>
</span><a name="line-459"></a><span class="hs-pragma">&quot;iterateFB&quot;</span><span>  </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span>                </span><span class="hs-pragma">iterateFB</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">:</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">iterate</span><span>
</span><a name="line-460"></a><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-461"></a><span>
</span><a name="line-462"></a><span>
</span><a name="line-463"></a><span class="hs-comment">-- | 'iterate'' is the strict version of 'iterate'.</span><span>
</span><a name="line-464"></a><span class="hs-comment">--</span><span>
</span><a name="line-465"></a><span class="hs-comment">-- It ensures that the result of each application of force to weak head normal</span><span>
</span><a name="line-466"></a><span class="hs-comment">-- form before proceeding.</span><span>
</span><a name="line-467"></a><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">iterate'</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-468"></a><span class="hs-identifier">iterate'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span>
</span><a name="line-469"></a><span class="hs-identifier">iterate'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-470"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">x'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span>
</span><a name="line-471"></a><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">x'</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">seq</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">iterate'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x'</span><span class="hs-special">)</span><span>
</span><a name="line-472"></a><span>
</span><a name="line-473"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">0</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">iterate'FB</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-comment">-- See Note [Inline FB functions]</span><span>
</span><a name="line-474"></a><span class="hs-identifier">iterate'FB</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-475"></a><span class="hs-identifier">iterate'FB</span><span> </span><span class="hs-identifier">c</span><span> </span><a href="#local-6989586621679030589"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-identifier">x0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">x0</span><span>
</span><a name="line-476"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679030756"><a href="#local-6989586621679030756"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-477"></a><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">x'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span>
</span><a name="line-478"></a><span>            </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">x'</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">seq</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="GHC.List.html#iterate%27"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="GHC.List.html#iterate%27"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">x'</span><span class="hs-special">)</span><span>
</span><a name="line-479"></a><span>
</span><a name="line-480"></a><span class="hs-pragma">{-# RULES</span><span>
</span><a name="line-481"></a><span class="hs-pragma">&quot;iterate'&quot;</span><span>    </span><span class="hs-pragma">[</span><span class="hs-pragma">~</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">x</span><span class="hs-pragma">.</span><span>   </span><span class="hs-pragma">iterate'</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">x</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">build</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span class="hs-pragma">c</span><span> </span><span class="hs-pragma">_n</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">iterate'FB</span><span> </span><span class="hs-pragma">c</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">x</span><span class="hs-pragma">)</span><span>
</span><a name="line-482"></a><span class="hs-pragma">&quot;iterate'FB&quot;</span><span>  </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span>                </span><span class="hs-pragma">iterate'FB</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">:</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">iterate'</span><span>
</span><a name="line-483"></a><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-484"></a><span>
</span><a name="line-485"></a><span>
</span><a name="line-486"></a><span class="hs-comment">-- | 'repeat' @x@ is an infinite list, with @x@ the value of every element.</span><span>
</span><a name="line-487"></a><span class="hs-identifier">repeat</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span>
</span><a name="line-488"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">0</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">repeat</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-489"></a><span class="hs-comment">-- The pragma just gives the rules more chance to fire</span><span>
</span><a name="line-490"></a><span class="hs-identifier">repeat</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-491"></a><span>
</span><a name="line-492"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">0</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">repeatFB</span><span> </span><span class="hs-pragma">#-}</span><span>     </span><span class="hs-comment">-- ditto -- See Note [Inline FB functions]</span><span>
</span><a name="line-493"></a><span class="hs-identifier">repeatFB</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-494"></a><span class="hs-identifier">repeatFB</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">c</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-495"></a><span>
</span><a name="line-496"></a><span>
</span><a name="line-497"></a><span class="hs-pragma">{-# RULES</span><span>
</span><a name="line-498"></a><span class="hs-pragma">&quot;repeat&quot;</span><span>    </span><span class="hs-pragma">[</span><span class="hs-pragma">~</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">x</span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">repeat</span><span> </span><span class="hs-pragma">x</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">build</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span class="hs-pragma">c</span><span> </span><span class="hs-pragma">_n</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">repeatFB</span><span> </span><span class="hs-pragma">c</span><span> </span><span class="hs-pragma">x</span><span class="hs-pragma">)</span><span>
</span><a name="line-499"></a><span class="hs-pragma">&quot;repeatFB&quot;</span><span>  </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span>  </span><span class="hs-pragma">repeatFB</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">:</span><span class="hs-pragma">)</span><span>       </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">repeat</span><span>
</span><a name="line-500"></a><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-501"></a><span>
</span><a name="line-502"></a><span class="hs-comment">-- | 'replicate' @n x@ is a list of length @n@ with @x@ the value of</span><span>
</span><a name="line-503"></a><span class="hs-comment">-- every element.</span><span>
</span><a name="line-504"></a><span class="hs-comment">-- It is an instance of the more general 'Data.List.genericReplicate',</span><span>
</span><a name="line-505"></a><span class="hs-comment">-- in which @n@ may be of any integral type.</span><span>
</span><a name="line-506"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">replicate</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-507"></a><span class="hs-identifier">replicate</span><span>               </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="GHC.List.html#repeat"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-508"></a><span class="hs-identifier">replicate</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">x</span><span>           </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">take</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">repeat</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><a name="line-509"></a><span>
</span><a name="line-510"></a><span class="hs-comment">-- | 'cycle' ties a finite list into a circular one, or equivalently,</span><span>
</span><a name="line-511"></a><span class="hs-comment">-- the infinite repetition of the original list.  It is the identity</span><span>
</span><a name="line-512"></a><span class="hs-comment">-- on infinite lists.</span><span>
</span><a name="line-513"></a><span>
</span><a name="line-514"></a><span class="hs-identifier">cycle</span><span>                   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span>
</span><a name="line-515"></a><span class="hs-identifier">cycle</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">errorEmptyList</span><span> </span><span class="hs-string">&quot;cycle&quot;</span><span>
</span><a name="line-516"></a><span class="hs-identifier">cycle</span><span> </span><span class="hs-identifier">xs</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">xs'</span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">xs'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-operator">++</span><span> </span><span class="hs-identifier">xs'</span><span>
</span><a name="line-517"></a><span>
</span><a name="line-518"></a><span class="hs-comment">-- | 'takeWhile', applied to a predicate @p@ and a list @xs@, returns the</span><span>
</span><a name="line-519"></a><span class="hs-comment">-- longest prefix (possibly empty) of @xs@ of elements that satisfy @p@:</span><span>
</span><a name="line-520"></a><span class="hs-comment">--</span><span>
</span><a name="line-521"></a><span class="hs-comment">-- &gt; takeWhile (&lt; 3) [1,2,3,4,1,2,3,4] == [1,2]</span><span>
</span><a name="line-522"></a><span class="hs-comment">-- &gt; takeWhile (&lt; 9) [1,2,3] == [1,2,3]</span><span>
</span><a name="line-523"></a><span class="hs-comment">-- &gt; takeWhile (&lt; 0) [1,2,3] == []</span><span>
</span><a name="line-524"></a><span class="hs-comment">--</span><span>
</span><a name="line-525"></a><span>
</span><a name="line-526"></a><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">takeWhile</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-527"></a><span class="hs-identifier">takeWhile</span><span>               </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span>
</span><a name="line-528"></a><span class="hs-identifier">takeWhile</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-529"></a><span class="hs-identifier">takeWhile</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>
</span><a name="line-530"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">x</span><span>       </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">takeWhile</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-531"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-532"></a><span>
</span><a name="line-533"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">0</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">takeWhileFB</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-comment">-- See Note [Inline FB functions]</span><span>
</span><a name="line-534"></a><span class="hs-identifier">takeWhileFB</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-535"></a><span class="hs-identifier">takeWhileFB</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">c</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">n</span><span>
</span><a name="line-536"></a><span>
</span><a name="line-537"></a><span class="hs-comment">-- The takeWhileFB rule is similar to the filterFB rule. It works like this:</span><span>
</span><a name="line-538"></a><span class="hs-comment">-- takeWhileFB q (takeWhileFB p c n) n =</span><span>
</span><a name="line-539"></a><span class="hs-comment">-- \x r -&gt; if q x then (takeWhileFB p c n) x r else n =</span><span>
</span><a name="line-540"></a><span class="hs-comment">-- \x r -&gt; if q x then (\x' r' -&gt; if p x' then x' `c` r' else n) x r else n =</span><span>
</span><a name="line-541"></a><span class="hs-comment">-- \x r -&gt; if q x then (if p x then x `c` r else n) else n =</span><span>
</span><a name="line-542"></a><span class="hs-comment">-- \x r -&gt; if q x &amp;&amp; p x then x `c` r else n =</span><span>
</span><a name="line-543"></a><span class="hs-comment">-- takeWhileFB (\x -&gt; q x &amp;&amp; p x) c n</span><span>
</span><a name="line-544"></a><span class="hs-pragma">{-# RULES</span><span>
</span><a name="line-545"></a><span class="hs-pragma">&quot;takeWhile&quot;</span><span>     </span><span class="hs-pragma">[</span><span class="hs-pragma">~</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">p</span><span> </span><span class="hs-pragma">xs</span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">takeWhile</span><span> </span><span class="hs-pragma">p</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">=</span><span>
</span><a name="line-546"></a><span>                                </span><span class="hs-pragma">build</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span class="hs-pragma">c</span><span> </span><span class="hs-pragma">n</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">foldr</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">takeWhileFB</span><span> </span><span class="hs-pragma">p</span><span> </span><span class="hs-pragma">c</span><span> </span><span class="hs-pragma">n</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">n</span><span> </span><span class="hs-pragma">xs</span><span class="hs-pragma">)</span><span>
</span><a name="line-547"></a><span class="hs-pragma">&quot;takeWhileList&quot;</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span>  </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">p</span><span class="hs-pragma">.</span><span>    </span><span class="hs-pragma">foldr</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">takeWhileFB</span><span> </span><span class="hs-pragma">p</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">:</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">]</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">takeWhile</span><span> </span><span class="hs-pragma">p</span><span>
</span><a name="line-548"></a><span class="hs-pragma">&quot;takeWhileFB&quot;</span><span>        </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">c</span><span> </span><span class="hs-pragma">n</span><span> </span><span class="hs-pragma">p</span><span> </span><span class="hs-pragma">q</span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">takeWhileFB</span><span> </span><span class="hs-pragma">q</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">takeWhileFB</span><span> </span><span class="hs-pragma">p</span><span> </span><span class="hs-pragma">c</span><span> </span><span class="hs-pragma">n</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">n</span><span> </span><span class="hs-pragma">=</span><span>
</span><a name="line-549"></a><span>                        </span><span class="hs-pragma">takeWhileFB</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span class="hs-pragma">x</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">q</span><span> </span><span class="hs-pragma">x</span><span> </span><span class="hs-pragma">&amp;&amp;</span><span> </span><span class="hs-pragma">p</span><span> </span><span class="hs-pragma">x</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">c</span><span> </span><span class="hs-pragma">n</span><span>
</span><a name="line-550"></a><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-551"></a><span>
</span><a name="line-552"></a><span class="hs-comment">-- | 'dropWhile' @p xs@ returns the suffix remaining after 'takeWhile' @p xs@:</span><span>
</span><a name="line-553"></a><span class="hs-comment">--</span><span>
</span><a name="line-554"></a><span class="hs-comment">-- &gt; dropWhile (&lt; 3) [1,2,3,4,5,1,2,3] == [3,4,5,1,2,3]</span><span>
</span><a name="line-555"></a><span class="hs-comment">-- &gt; dropWhile (&lt; 9) [1,2,3] == []</span><span>
</span><a name="line-556"></a><span class="hs-comment">-- &gt; dropWhile (&lt; 0) [1,2,3] == [1,2,3]</span><span>
</span><a name="line-557"></a><span class="hs-comment">--</span><span>
</span><a name="line-558"></a><span>
</span><a name="line-559"></a><span class="hs-identifier">dropWhile</span><span>               </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span>
</span><a name="line-560"></a><span class="hs-identifier">dropWhile</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-561"></a><span class="hs-identifier">dropWhile</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">xs</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">xs'</span><span class="hs-special">)</span><span>
</span><a name="line-562"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">x</span><span>       </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">dropWhile</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">xs'</span><span>
</span><a name="line-563"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">xs</span><span>
</span><a name="line-564"></a><span>
</span><a name="line-565"></a><span class="hs-comment">-- | 'take' @n@, applied to a list @xs@, returns the prefix of @xs@</span><span>
</span><a name="line-566"></a><span class="hs-comment">-- of length @n@, or @xs@ itself if @n &gt; 'length' xs@:</span><span>
</span><a name="line-567"></a><span class="hs-comment">--</span><span>
</span><a name="line-568"></a><span class="hs-comment">-- &gt; take 5 &quot;Hello World!&quot; == &quot;Hello&quot;</span><span>
</span><a name="line-569"></a><span class="hs-comment">-- &gt; take 3 [1,2,3,4,5] == [1,2,3]</span><span>
</span><a name="line-570"></a><span class="hs-comment">-- &gt; take 3 [1,2] == [1,2]</span><span>
</span><a name="line-571"></a><span class="hs-comment">-- &gt; take 3 [] == []</span><span>
</span><a name="line-572"></a><span class="hs-comment">-- &gt; take (-1) [1,2] == []</span><span>
</span><a name="line-573"></a><span class="hs-comment">-- &gt; take 0 [1,2] == []</span><span>
</span><a name="line-574"></a><span class="hs-comment">--</span><span>
</span><a name="line-575"></a><span class="hs-comment">-- It is an instance of the more general 'Data.List.genericTake',</span><span>
</span><a name="line-576"></a><span class="hs-comment">-- in which @n@ may be of any integral type.</span><span>
</span><a name="line-577"></a><span class="hs-identifier">take</span><span>                   </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span>
</span><a name="line-578"></a><span class="hs-cpp">#if defined(USE_REPORT_PRELUDE)
</span><span class="hs-identifier">take</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-operator">&lt;=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-580"></a><span class="hs-identifier">take</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>              </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-581"></a><span class="hs-identifier">take</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">take</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-582"></a><span class="hs-cpp">#else
</span><span>
</span><a name="line-584"></a><span class="hs-comment">{- We always want to inline this to take advantage of a known length argument
sign. Note, however, that it's important for the RULES to grab take, rather
than trying to INLINE take immediately and then letting the RULES grab
unsafeTake. Presumably the latter approach doesn't grab it early enough; it led
to an allocation regression in nofib/fft2. -}</span><span>
</span><a name="line-589"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">take</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-590"></a><span class="hs-identifier">take</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">n</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unsafeTake</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-591"></a><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-592"></a><span>
</span><a name="line-593"></a><span class="hs-comment">-- A version of take that takes the whole list if it's given an argument less</span><span>
</span><a name="line-594"></a><span class="hs-comment">-- than 1.</span><span>
</span><a name="line-595"></a><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">unsafeTake</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-596"></a><span class="hs-identifier">unsafeTake</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span>
</span><a name="line-597"></a><span class="hs-identifier">unsafeTake</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-598"></a><span class="hs-identifier">unsafeTake</span><span> </span><span class="hs-number">1</span><span>   </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">x</span><span class="hs-special">]</span><span>
</span><a name="line-599"></a><span class="hs-identifier">unsafeTake</span><span> </span><span class="hs-identifier">m</span><span>   </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">unsafeTake</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">m</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-600"></a><span>
</span><a name="line-601"></a><span class="hs-pragma">{-# RULES</span><span>
</span><a name="line-602"></a><span class="hs-pragma">&quot;take&quot;</span><span>     </span><span class="hs-pragma">[</span><span class="hs-pragma">~</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">n</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">take</span><span> </span><span class="hs-pragma">n</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">=</span><span>
</span><a name="line-603"></a><span>  </span><span class="hs-pragma">build</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span class="hs-pragma">c</span><span> </span><span class="hs-pragma">nil</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">if</span><span> </span><span class="hs-pragma">0</span><span> </span><span class="hs-pragma">&lt;</span><span> </span><span class="hs-pragma">n</span><span>
</span><a name="line-604"></a><span>                   </span><span class="hs-pragma">then</span><span> </span><span class="hs-pragma">foldr</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">takeFB</span><span> </span><span class="hs-pragma">c</span><span> </span><span class="hs-pragma">nil</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">flipSeqTake</span><span> </span><span class="hs-pragma">nil</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">n</span><span>
</span><a name="line-605"></a><span>                   </span><span class="hs-pragma">else</span><span> </span><span class="hs-pragma">nil</span><span class="hs-pragma">)</span><span>
</span><a name="line-606"></a><span class="hs-pragma">&quot;unsafeTakeList&quot;</span><span>  </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">n</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">foldr</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">takeFB</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">:</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">]</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">flipSeqTake</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">]</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">n</span><span>
</span><a name="line-607"></a><span>                                        </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">unsafeTake</span><span> </span><span class="hs-pragma">n</span><span> </span><span class="hs-pragma">xs</span><span>
</span><a name="line-608"></a><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-609"></a><span>
</span><a name="line-610"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">0</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">flipSeqTake</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-611"></a><span class="hs-comment">-- Just flip seq, specialized to Int, but not inlined too early.</span><span>
</span><a name="line-612"></a><span class="hs-comment">-- It's important to force the numeric argument here, even though</span><span>
</span><a name="line-613"></a><span class="hs-comment">-- it's not used. Otherwise, take n [] doesn't force n. This is</span><span>
</span><a name="line-614"></a><span class="hs-comment">-- bad for strictness analysis and unboxing, and leads to increased</span><span>
</span><a name="line-615"></a><span class="hs-comment">-- allocation in T7257.</span><span>
</span><a name="line-616"></a><span class="hs-identifier">flipSeqTake</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-617"></a><span class="hs-identifier">flipSeqTake</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_n</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">x</span><span>
</span><a name="line-618"></a><span>
</span><a name="line-619"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">0</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">takeFB</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-comment">-- See Note [Inline FB functions]</span><span>
</span><a name="line-620"></a><span class="hs-identifier">takeFB</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-621"></a><span class="hs-comment">-- The \m accounts for the fact that takeFB is used in a higher-order</span><span>
</span><a name="line-622"></a><span class="hs-comment">-- way by takeFoldr, so it's better to inline.  A good example is</span><span>
</span><a name="line-623"></a><span class="hs-comment">--     take n (repeat x)</span><span>
</span><a name="line-624"></a><span class="hs-comment">-- for which we get excellent code... but only if we inline takeFB</span><span>
</span><a name="line-625"></a><span class="hs-comment">-- when given four arguments</span><span>
</span><a name="line-626"></a><span class="hs-identifier">takeFB</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-627"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-628"></a><span>            </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-special">`</span><a href="#local-6989586621679030791"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier">n</span><span>
</span><a name="line-629"></a><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">c</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">m</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-630"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-632"></a><span class="hs-comment">-- | 'drop' @n xs@ returns the suffix of @xs@</span><span>
</span><a name="line-633"></a><span class="hs-comment">-- after the first @n@ elements, or @[]@ if @n &gt; 'length' xs@:</span><span>
</span><a name="line-634"></a><span class="hs-comment">--</span><span>
</span><a name="line-635"></a><span class="hs-comment">-- &gt; drop 6 &quot;Hello World!&quot; == &quot;World!&quot;</span><span>
</span><a name="line-636"></a><span class="hs-comment">-- &gt; drop 3 [1,2,3,4,5] == [4,5]</span><span>
</span><a name="line-637"></a><span class="hs-comment">-- &gt; drop 3 [1,2] == []</span><span>
</span><a name="line-638"></a><span class="hs-comment">-- &gt; drop 3 [] == []</span><span>
</span><a name="line-639"></a><span class="hs-comment">-- &gt; drop (-1) [1,2] == [1,2]</span><span>
</span><a name="line-640"></a><span class="hs-comment">-- &gt; drop 0 [1,2] == [1,2]</span><span>
</span><a name="line-641"></a><span class="hs-comment">--</span><span>
</span><a name="line-642"></a><span class="hs-comment">-- It is an instance of the more general 'Data.List.genericDrop',</span><span>
</span><a name="line-643"></a><span class="hs-comment">-- in which @n@ may be of any integral type.</span><span>
</span><a name="line-644"></a><span class="hs-identifier">drop</span><span>                   </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span>
</span><a name="line-645"></a><span class="hs-cpp">#if defined(USE_REPORT_PRELUDE)
</span><span class="hs-identifier">drop</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">xs</span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-operator">&lt;=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">xs</span><span>
</span><a name="line-647"></a><span class="hs-identifier">drop</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>              </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-648"></a><span class="hs-identifier">drop</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">drop</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-649"></a><span class="hs-cpp">#else /* hack away */
</span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">drop</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-651"></a><span class="hs-identifier">drop</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">ls</span><span>
</span><a name="line-652"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-operator">&lt;=</span><span> </span><span class="hs-number">0</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ls</span><span>
</span><a name="line-653"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unsafeDrop</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">ls</span><span>
</span><a name="line-654"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-655"></a><span>    </span><span class="hs-comment">-- A version of drop that drops the whole list if given an argument</span><span>
</span><a name="line-656"></a><span>    </span><span class="hs-comment">-- less than 1</span><span>
</span><a name="line-657"></a><span>    </span><span class="hs-identifier">unsafeDrop</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span>
</span><a name="line-658"></a><span>    </span><span class="hs-identifier">unsafeDrop</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-659"></a><span>    </span><span class="hs-identifier">unsafeDrop</span><span> </span><span class="hs-number">1</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-660"></a><span>    </span><span class="hs-identifier">unsafeDrop</span><span> </span><span class="hs-identifier">m</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unsafeDrop</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">m</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-661"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-663"></a><span class="hs-comment">-- | 'splitAt' @n xs@ returns a tuple where first element is @xs@ prefix of</span><span>
</span><a name="line-664"></a><span class="hs-comment">-- length @n@ and second element is the remainder of the list:</span><span>
</span><a name="line-665"></a><span class="hs-comment">--</span><span>
</span><a name="line-666"></a><span class="hs-comment">-- &gt; splitAt 6 &quot;Hello World!&quot; == (&quot;Hello &quot;,&quot;World!&quot;)</span><span>
</span><a name="line-667"></a><span class="hs-comment">-- &gt; splitAt 3 [1,2,3,4,5] == ([1,2,3],[4,5])</span><span>
</span><a name="line-668"></a><span class="hs-comment">-- &gt; splitAt 1 [1,2,3] == ([1],[2,3])</span><span>
</span><a name="line-669"></a><span class="hs-comment">-- &gt; splitAt 3 [1,2,3] == ([1,2,3],[])</span><span>
</span><a name="line-670"></a><span class="hs-comment">-- &gt; splitAt 4 [1,2,3] == ([1,2,3],[])</span><span>
</span><a name="line-671"></a><span class="hs-comment">-- &gt; splitAt 0 [1,2,3] == ([],[1,2,3])</span><span>
</span><a name="line-672"></a><span class="hs-comment">-- &gt; splitAt (-1) [1,2,3] == ([],[1,2,3])</span><span>
</span><a name="line-673"></a><span class="hs-comment">--</span><span>
</span><a name="line-674"></a><span class="hs-comment">-- It is equivalent to @('take' n xs, 'drop' n xs)@ when @n@ is not @_|_@</span><span>
</span><a name="line-675"></a><span class="hs-comment">-- (@splitAt _|_ xs = _|_@).</span><span>
</span><a name="line-676"></a><span class="hs-comment">-- 'splitAt' is an instance of the more general 'Data.List.genericSplitAt',</span><span>
</span><a name="line-677"></a><span class="hs-comment">-- in which @n@ may be of any integral type.</span><span>
</span><a name="line-678"></a><span class="hs-identifier">splitAt</span><span>                </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-679"></a><span>
</span><a name="line-680"></a><span class="hs-cpp">#if defined(USE_REPORT_PRELUDE)
</span><span class="hs-identifier">splitAt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">xs</span><span>           </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">take</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">drop</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>
</span><a name="line-682"></a><span class="hs-cpp">#else
</span><span class="hs-identifier">splitAt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">ls</span><span>
</span><a name="line-684"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-operator">&lt;=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ls</span><span class="hs-special">)</span><span>
</span><a name="line-685"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splitAt'</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">ls</span><span>
</span><a name="line-686"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-687"></a><span>        </span><span class="hs-identifier">splitAt'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-688"></a><span>        </span><span class="hs-identifier">splitAt'</span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-689"></a><span>        </span><span class="hs-identifier">splitAt'</span><span> </span><span class="hs-number">1</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-identifier">x</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>
</span><a name="line-690"></a><span>        </span><span class="hs-identifier">splitAt'</span><span> </span><span class="hs-identifier">m</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">xs'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">xs''</span><span class="hs-special">)</span><span>
</span><a name="line-691"></a><span>          </span><span class="hs-keyword">where</span><span>
</span><a name="line-692"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier">xs'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">xs''</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splitAt'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">m</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-693"></a><span class="hs-cpp">#endif /* USE_REPORT_PRELUDE */
</span><span>
</span><a name="line-695"></a><span class="hs-comment">-- | 'span', applied to a predicate @p@ and a list @xs@, returns a tuple where</span><span>
</span><a name="line-696"></a><span class="hs-comment">-- first element is longest prefix (possibly empty) of @xs@ of elements that</span><span>
</span><a name="line-697"></a><span class="hs-comment">-- satisfy @p@ and second element is the remainder of the list:</span><span>
</span><a name="line-698"></a><span class="hs-comment">--</span><span>
</span><a name="line-699"></a><span class="hs-comment">-- &gt; span (&lt; 3) [1,2,3,4,1,2,3,4] == ([1,2],[3,4,1,2,3,4])</span><span>
</span><a name="line-700"></a><span class="hs-comment">-- &gt; span (&lt; 9) [1,2,3] == ([1,2,3],[])</span><span>
</span><a name="line-701"></a><span class="hs-comment">-- &gt; span (&lt; 0) [1,2,3] == ([],[1,2,3])</span><span>
</span><a name="line-702"></a><span class="hs-comment">--</span><span>
</span><a name="line-703"></a><span class="hs-comment">-- 'span' @p xs@ is equivalent to @('takeWhile' p xs, 'dropWhile' p xs)@</span><span>
</span><a name="line-704"></a><span>
</span><a name="line-705"></a><span class="hs-identifier">span</span><span>                    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-706"></a><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">xs</span><span class="hs-glyph">@</span><span class="hs-special">[</span><span class="hs-special">]</span><span>            </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">xs</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>
</span><a name="line-707"></a><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">xs</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">xs'</span><span class="hs-special">)</span><span>
</span><a name="line-708"></a><span>         </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">x</span><span>          </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ys</span><span class="hs-special">,</span><span class="hs-identifier">zs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">span</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">xs'</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">ys</span><span class="hs-special">,</span><span class="hs-identifier">zs</span><span class="hs-special">)</span><span>
</span><a name="line-709"></a><span>         </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>
</span><a name="line-710"></a><span>
</span><a name="line-711"></a><span class="hs-comment">-- | 'break', applied to a predicate @p@ and a list @xs@, returns a tuple where</span><span>
</span><a name="line-712"></a><span class="hs-comment">-- first element is longest prefix (possibly empty) of @xs@ of elements that</span><span>
</span><a name="line-713"></a><span class="hs-comment">-- /do not satisfy/ @p@ and second element is the remainder of the list:</span><span>
</span><a name="line-714"></a><span class="hs-comment">--</span><span>
</span><a name="line-715"></a><span class="hs-comment">-- &gt; break (&gt; 3) [1,2,3,4,1,2,3,4] == ([1,2,3],[4,1,2,3,4])</span><span>
</span><a name="line-716"></a><span class="hs-comment">-- &gt; break (&lt; 9) [1,2,3] == ([],[1,2,3])</span><span>
</span><a name="line-717"></a><span class="hs-comment">-- &gt; break (&gt; 9) [1,2,3] == ([1,2,3],[])</span><span>
</span><a name="line-718"></a><span class="hs-comment">--</span><span>
</span><a name="line-719"></a><span class="hs-comment">-- 'break' @p@ is equivalent to @'span' ('not' . p)@.</span><span>
</span><a name="line-720"></a><span>
</span><a name="line-721"></a><span class="hs-identifier">break</span><span>                   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-722"></a><span class="hs-cpp">#if defined(USE_REPORT_PRELUDE)
</span><span class="hs-identifier">break</span><span> </span><span class="hs-identifier">p</span><span>                 </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">span</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">not</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">)</span><span>
</span><a name="line-724"></a><span class="hs-cpp">#else
</span><span class="hs-comment">-- HBC version (stolen)</span><span>
</span><a name="line-726"></a><span class="hs-identifier">break</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">xs</span><span class="hs-glyph">@</span><span class="hs-special">[</span><span class="hs-special">]</span><span>           </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">xs</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>
</span><a name="line-727"></a><span class="hs-identifier">break</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">xs</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">xs'</span><span class="hs-special">)</span><span>
</span><a name="line-728"></a><span>           </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">x</span><span>        </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>
</span><a name="line-729"></a><span>           </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ys</span><span class="hs-special">,</span><span class="hs-identifier">zs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">break</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">xs'</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">ys</span><span class="hs-special">,</span><span class="hs-identifier">zs</span><span class="hs-special">)</span><span>
</span><a name="line-730"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-732"></a><span class="hs-comment">-- | 'reverse' @xs@ returns the elements of @xs@ in reverse order.</span><span>
</span><a name="line-733"></a><span class="hs-comment">-- @xs@ must be finite.</span><span>
</span><a name="line-734"></a><span class="hs-identifier">reverse</span><span>                 </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span>
</span><a name="line-735"></a><span class="hs-cpp">#if defined(USE_REPORT_PRELUDE)
</span><span class="hs-identifier">reverse</span><span>                 </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">foldl</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">flip</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-737"></a><span class="hs-cpp">#else
</span><span class="hs-identifier">reverse</span><span> </span><a name="local-6989586621679030825"><a href="#local-6989586621679030825"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">rev</span><span> </span><span class="hs-identifier">l</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-739"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-740"></a><span>    </span><span class="hs-identifier">rev</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><a href="GHC.Base.html#otherwise"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Base.html#otherwise"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-741"></a><span>    </span><span class="hs-identifier">rev</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">rev</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-742"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-744"></a><span class="hs-comment">-- | 'and' returns the conjunction of a Boolean list.  For the result to be</span><span>
</span><a name="line-745"></a><span class="hs-comment">-- 'True', the list must be finite; 'False', however, results from a 'False'</span><span>
</span><a name="line-746"></a><span class="hs-comment">-- value at a finite index of a finite or infinite list.</span><span>
</span><a name="line-747"></a><span class="hs-identifier">and</span><span>                     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Bool</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><a name="line-748"></a><span class="hs-cpp">#if defined(USE_REPORT_PRELUDE)
</span><a name="reverse"><a href="GHC.List.html#reverse"><span class="hs-identifier">and</span></a></a><span>                     </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-operator">&amp;&amp;</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">True</span><span>
</span><a name="line-750"></a><span class="hs-cpp">#else
</span><span class="hs-identifier">and</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">True</span><span>
</span><a name="line-752"></a><span class="hs-identifier">and</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span>  </span><a href="#local-6989586621679030831"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">and</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-753"></a><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">and</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-754"></a><span>
</span><a name="line-755"></a><span class="hs-pragma">{-# RULES</span><span>
</span><a name="line-756"></a><span class="hs-pragma">&quot;and/build&quot;</span><span>     </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">g</span><span class="hs-pragma">::</span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">.</span><span class="hs-pragma">(</span><span class="hs-pragma">Bool</span><span class="hs-pragma">-&gt;</span><span class="hs-pragma">b</span><span class="hs-pragma">-&gt;</span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span class="hs-pragma">-&gt;</span><span class="hs-pragma">b</span><span class="hs-pragma">-&gt;</span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">.</span><span>
</span><a name="line-757"></a><span>                </span><span class="hs-pragma">and</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">build</span><span> </span><span class="hs-pragma">g</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">&amp;&amp;</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">True</span><span>
</span><a name="line-758"></a><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-759"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-761"></a><span class="hs-comment">-- | 'or' returns the disjunction of a Boolean list.  For the result to be</span><span>
</span><a name="line-762"></a><span class="hs-comment">-- 'False', the list must be finite; 'True', however, results from a 'True'</span><span>
</span><a name="line-763"></a><span class="hs-comment">-- value at a finite index of a finite or infinite list.</span><span>
</span><a name="line-764"></a><span class="hs-identifier">or</span><span>                      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Bool</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><a name="line-765"></a><span class="hs-cpp">#if defined(USE_REPORT_PRELUDE)
</span><span class="hs-identifier">or</span><span>                      </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-operator">||</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">False</span><span>
</span><a name="line-767"></a><span class="hs-cpp">#else
</span><span class="hs-identifier">or</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>           </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">False</span><span>
</span><a name="line-769"></a><span class="hs-identifier">or</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">x</span><span> </span><span class="hs-operator">||</span><span> </span><span class="hs-identifier">or</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-770"></a><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">or</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-771"></a><span>
</span><a name="line-772"></a><span class="hs-pragma">{-# RULES</span><span>
</span><a name="line-773"></a><span class="hs-pragma">&quot;or/build&quot;</span><span>      </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">g</span><span class="hs-pragma">::</span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">.</span><span class="hs-pragma">(</span><span class="hs-pragma">Bool</span><span class="hs-pragma">-&gt;</span><span class="hs-pragma">b</span><span class="hs-pragma">-&gt;</span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span class="hs-pragma">-&gt;</span><span class="hs-pragma">b</span><span class="hs-pragma">-&gt;</span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">.</span><span>
</span><a name="line-774"></a><span>                </span><span class="hs-pragma">or</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">build</span><span> </span><span class="hs-pragma">g</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">||</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">False</span><span>
</span><a name="line-775"></a><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-776"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-778"></a><span class="hs-comment">-- | Applied to a predicate and a list, 'any' determines if any element</span><span>
</span><a name="line-779"></a><span class="hs-comment">-- of the list satisfies the predicate.  For the result to be</span><span>
</span><a name="line-780"></a><span class="hs-comment">-- 'False', the list must be finite; 'True', however, results from a 'True'</span><span>
</span><a name="line-781"></a><span class="hs-comment">-- value for the predicate applied to an element at a finite index of a finite or infinite list.</span><span>
</span><a name="line-782"></a><span class="hs-identifier">any</span><span>                     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><a name="line-783"></a><span>
</span><a name="line-784"></a><span class="hs-cpp">#if defined(USE_REPORT_PRELUDE)
</span><span class="hs-identifier">any</span><span> </span><span class="hs-identifier">p</span><span>                   </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">or</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">p</span><span>
</span><a name="line-786"></a><span class="hs-cpp">#else
</span><span class="hs-identifier">any</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">False</span><span>
</span><a name="line-788"></a><span class="hs-identifier">any</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-operator">||</span><span> </span><span class="hs-identifier">any</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-789"></a><span>
</span><a name="line-790"></a><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">any</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-791"></a><span>
</span><a name="line-792"></a><span class="hs-pragma">{-# RULES</span><span>
</span><a name="line-793"></a><span class="hs-pragma">&quot;any/build&quot;</span><span>     </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">p</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">g</span><span class="hs-pragma">::</span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">.</span><span class="hs-pragma">(</span><span class="hs-pragma">a</span><span class="hs-pragma">-&gt;</span><span class="hs-pragma">b</span><span class="hs-pragma">-&gt;</span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span class="hs-pragma">-&gt;</span><span class="hs-pragma">b</span><span class="hs-pragma">-&gt;</span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">.</span><span>
</span><a name="line-794"></a><span>                </span><span class="hs-pragma">any</span><span> </span><span class="hs-pragma">p</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">build</span><span> </span><span class="hs-pragma">g</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">(</span><span class="hs-pragma">||</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">p</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">False</span><span>
</span><a name="line-795"></a><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-796"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-798"></a><span class="hs-comment">-- | Applied to a predicate and a list, 'all' determines if all elements</span><span>
</span><a name="line-799"></a><span class="hs-comment">-- of the list satisfy the predicate. For the result to be</span><span>
</span><a name="line-800"></a><span class="hs-comment">-- 'True', the list must be finite; 'False', however, results from a 'False'</span><span>
</span><a name="line-801"></a><span class="hs-comment">-- value for the predicate applied to an element at a finite index of a finite or infinite list.</span><span>
</span><a name="line-802"></a><span class="hs-identifier">all</span><span>                     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><a name="line-803"></a><span class="hs-cpp">#if defined(USE_REPORT_PRELUDE)
</span><span class="hs-identifier">all</span><span> </span><span class="hs-identifier">p</span><span>                   </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">and</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">p</span><span>
</span><a name="line-805"></a><span class="hs-cpp">#else
</span><span class="hs-identifier">all</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>        </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">True</span><span>
</span><a name="line-807"></a><span class="hs-identifier">all</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">x</span><span> </span><a href="GHC.Base.html#build"><span class="hs-operator hs-var">&amp;&amp;</span></a><span> </span><span class="hs-identifier">all</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-808"></a><span>
</span><a name="line-809"></a><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">all</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-810"></a><span>
</span><a name="line-811"></a><span class="hs-pragma">{-# RULES</span><span>
</span><a name="line-812"></a><span class="hs-pragma">&quot;all/build&quot;</span><span>     </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">p</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">g</span><span class="hs-pragma">::</span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">.</span><span class="hs-pragma">(</span><span class="hs-pragma">a</span><span class="hs-pragma">-&gt;</span><span class="hs-pragma">b</span><span class="hs-pragma">-&gt;</span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span class="hs-pragma">-&gt;</span><span class="hs-pragma">b</span><span class="hs-pragma">-&gt;</span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">.</span><span>
</span><a name="line-813"></a><span>                </span><span class="hs-pragma">all</span><span> </span><span class="hs-pragma">p</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">build</span><span> </span><span class="hs-pragma">g</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">(</span><span class="hs-pragma">&amp;&amp;</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">p</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">True</span><span>
</span><a name="line-814"></a><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-815"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-817"></a><span class="hs-comment">-- | 'elem' is the list membership predicate, usually written in infix form,</span><span>
</span><a name="line-818"></a><span class="hs-comment">-- e.g., @x \`elem\` xs@.  For the result to be</span><span>
</span><a name="line-819"></a><span class="hs-comment">-- 'False', the list must be finite; 'True', however, results from an element</span><span>
</span><a name="line-820"></a><span class="hs-comment">-- equal to @x@ found at a finite index of a finite or infinite list.</span><span>
</span><a name="line-821"></a><span class="hs-identifier">elem</span><span>                    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Eq</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><a name="line-822"></a><span class="hs-cpp">#if defined(USE_REPORT_PRELUDE)
</span><span class="hs-identifier">elem</span><span> </span><span class="hs-identifier">x</span><span>                  </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">any</span><span> </span><span class="hs-special">(</span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><a name="line-824"></a><span class="hs-cpp">#else
</span><span class="hs-identifier">elem</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">False</span><span>
</span><a name="line-826"></a><span class="hs-identifier">elem</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">y</span><span class="hs-glyph">:</span><span class="hs-identifier">ys</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">x</span><span class="hs-operator">==</span><span class="hs-identifier">y</span><span> </span><span class="hs-operator">||</span><span> </span><span class="hs-identifier">elem</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">ys</span><span>
</span><a name="line-827"></a><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">elem</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-828"></a><span class="hs-pragma">{-# RULES</span><span>
</span><a name="line-829"></a><span class="hs-pragma">&quot;elem/build&quot;</span><span>    </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">x</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">b</span><span> </span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">Eq</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">=&gt;</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">b</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">b</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span>
</span><a name="line-830"></a><span>   </span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">elem</span><span> </span><span class="hs-pragma">x</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">build</span><span> </span><span class="hs-pragma">g</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span> </span><span class="hs-pragma">y</span><span> </span><span class="hs-pragma">r</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">x</span><span> </span><span class="hs-pragma">==</span><span> </span><span class="hs-pragma">y</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">||</span><span> </span><span class="hs-pragma">r</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">False</span><span>
</span><a name="line-831"></a><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-832"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-834"></a><span class="hs-comment">-- | 'notElem' is the negation of 'elem'.</span><span>
</span><a name="line-835"></a><span class="hs-identifier">notElem</span><span>                 </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Eq</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><a name="line-836"></a><span class="hs-cpp">#if defined(USE_REPORT_PRELUDE)
</span><span class="hs-identifier">notElem</span><span> </span><span class="hs-identifier">x</span><span>               </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">all</span><span> </span><span class="hs-special">(</span><span class="hs-operator">/=</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><a name="line-838"></a><span class="hs-cpp">#else
</span><span class="hs-identifier">notElem</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">True</span><span>
</span><a name="line-840"></a><span class="hs-identifier">notElem</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#%5B%5D"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">y</span><span class="hs-glyph">:</span><span class="hs-identifier">ys</span><span class="hs-special">)</span><span class="hs-glyph">=</span><span>  </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#False"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#False"><span class="hs-operator hs-var">/=</span></a><span> </span><span class="hs-identifier">y</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">notElem</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">ys</span><span>
</span><a name="line-841"></a><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">notElem</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-842"></a><span class="hs-pragma">{-# RULES</span><span>
</span><a name="line-843"></a><span class="hs-pragma">&quot;notElem/build&quot;</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">x</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">b</span><span> </span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">Eq</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">=&gt;</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">b</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">b</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span>
</span><a name="line-844"></a><span>   </span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">notElem</span><span> </span><span class="hs-pragma">x</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">build</span><span> </span><span class="hs-pragma">g</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span> </span><span class="hs-pragma">y</span><span> </span><span class="hs-pragma">r</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">x</span><span> </span><span class="hs-pragma">/=</span><span> </span><span class="hs-pragma">y</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">&amp;&amp;</span><span> </span><span class="hs-pragma">r</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">True</span><span>
</span><a name="line-845"></a><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-846"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-848"></a><span class="hs-comment">-- | 'lookup' @key assocs@ looks up a key in an association list.</span><span>
</span><a name="line-849"></a><span class="hs-identifier">lookup</span><span>                  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Eq</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-850"></a><span class="hs-identifier">lookup</span><span> </span><span class="hs-identifier">_key</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">Nothing</span><span>
</span><a name="line-851"></a><span class="hs-identifier">lookup</span><span>  </span><span class="hs-identifier">key</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-special">,</span><span class="hs-identifier">y</span><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-identifier">xys</span><span class="hs-special">)</span><span>
</span><a name="line-852"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">key</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">x</span><span>          </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">y</span><span>
</span><a name="line-853"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>         </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">lookup</span><span> </span><span class="hs-identifier">key</span><span> </span><span class="hs-identifier">xys</span><span>
</span><a name="line-854"></a><span>
</span><a name="line-855"></a><span class="hs-comment">-- | Map a function over a list and concatenate the results.</span><span>
</span><a name="line-856"></a><span class="hs-identifier">concatMap</span><span>               </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="GHC.List.html#notElem"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">b</span><span class="hs-special">]</span><span>
</span><a name="line-857"></a><span class="hs-identifier">concatMap</span><span> </span><span class="hs-identifier">f</span><span>             </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator">++</span><span class="hs-special">)</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-858"></a><span>
</span><a name="line-859"></a><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">concatMap</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-860"></a><span>
</span><a name="line-861"></a><span class="hs-pragma">{-# RULES</span><span>
</span><a name="line-862"></a><span class="hs-pragma">&quot;concatMap&quot;</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">concatMap</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">=</span><span>
</span><a name="line-863"></a><span>    </span><span class="hs-pragma">build</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span class="hs-pragma">c</span><span> </span><span class="hs-pragma">n</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">foldr</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span class="hs-pragma">x</span><span> </span><span class="hs-pragma">b</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">foldr</span><span> </span><span class="hs-pragma">c</span><span> </span><span class="hs-pragma">b</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">x</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">n</span><span> </span><span class="hs-pragma">xs</span><span class="hs-pragma">)</span><span>
</span><a name="line-864"></a><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-865"></a><span>
</span><a name="line-866"></a><span>
</span><a name="line-867"></a><span class="hs-comment">-- | Concatenate a list of lists.</span><span>
</span><a name="line-868"></a><span class="hs-identifier">concat</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679030856"><a href="#local-6989586621679030856"><span class="hs-identifier">a</span></a></a><span class="hs-special">]</span><span>
</span><a name="line-869"></a><span class="hs-identifier">concat</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-operator">++</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-870"></a><span>
</span><a name="line-871"></a><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">concat</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-872"></a><span>
</span><a name="line-873"></a><span class="hs-pragma">{-# RULES</span><span>
</span><a name="line-874"></a><span>  </span><span class="hs-pragma">&quot;concat&quot;</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">xs</span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">concat</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">=</span><span>
</span><a name="line-875"></a><span>     </span><span class="hs-pragma">build</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span class="hs-pragma">c</span><span> </span><span class="hs-pragma">n</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">foldr</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span class="hs-pragma">x</span><span> </span><span class="hs-pragma">y</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">foldr</span><span> </span><span class="hs-pragma">c</span><span> </span><span class="hs-pragma">y</span><span> </span><span class="hs-pragma">x</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">n</span><span> </span><span class="hs-pragma">xs</span><span class="hs-pragma">)</span><span>
</span><a name="line-876"></a><span class="hs-pragma">-- We don't bother to turn non-fusible applications of concat back into concat</span><span>
</span><a name="line-877"></a><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-878"></a><span>
</span><a name="line-879"></a><span class="hs-comment">-- | List index (subscript) operator, starting from 0.</span><span>
</span><a name="line-880"></a><span class="hs-comment">-- It is an instance of the more general 'Data.List.genericIndex',</span><span>
</span><a name="line-881"></a><span class="hs-comment">-- which takes an index of any integral type.</span><span>
</span><a name="line-882"></a><span class="hs-special">(</span><span class="hs-operator">!!</span><span class="hs-special">)</span><span>                    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-883"></a><span class="hs-cpp">#if defined(USE_REPORT_PRELUDE)
</span><span class="hs-identifier">xs</span><span>     </span><span class="hs-operator">!!</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">errorWithoutStackTrace</span><span> </span><span class="hs-string">&quot;Prelude.!!: negative index&quot;</span><span>
</span><a name="line-885"></a><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-operator">!!</span><span> </span><span class="hs-identifier">_</span><span>         </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">errorWithoutStackTrace</span><span> </span><span class="hs-string">&quot;Prelude.!!: index too large&quot;</span><span>
</span><a name="line-886"></a><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-operator">!!</span><span> </span><span class="hs-number">0</span><span>         </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">x</span><span>
</span><a name="line-887"></a><span class="hs-special">(</span><a name="concat"><a href="GHC.List.html#concat"><span class="hs-identifier">_</span></a></a><span class="hs-glyph">:</span><a name="concat"><a href="GHC.List.html#concat"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-operator">!!</span><span> </span><a href="GHC.Base.html#foldr"><span class="hs-identifier hs-var">n</span></a><span>         </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">xs</span><span> </span><span class="hs-operator">!!</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-888"></a><span class="hs-cpp">#else
</span><span>
</span><a name="line-890"></a><span class="hs-comment">-- We don't really want the errors to inline with (!!).</span><span>
</span><a name="line-891"></a><span class="hs-comment">-- We may want to fuss around a bit with NOINLINE, and</span><span>
</span><a name="line-892"></a><span class="hs-comment">-- if so we should be careful not to trip up known-bottom</span><span>
</span><a name="line-893"></a><span class="hs-comment">-- optimizations.</span><span>
</span><a name="line-894"></a><span class="hs-identifier">tooLarge</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-895"></a><span class="hs-identifier">tooLarge</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">errorWithoutStackTrace</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">prel_list_str</span><span> </span><span class="hs-operator">++</span><span> </span><span class="hs-string">&quot;!!: index too large&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-896"></a><span>
</span><a name="line-897"></a><span class="hs-identifier">negIndex</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-898"></a><span class="hs-identifier">negIndex</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">errorWithoutStackTrace</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">prel_list_str</span><span> </span><span class="hs-operator">++</span><span> </span><span class="hs-string">&quot;!!: negative index&quot;</span><span>
</span><a name="line-899"></a><span>
</span><a name="line-900"></a><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">!!</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-901"></a><span class="hs-identifier">xs</span><span> </span><span class="hs-operator">!!</span><span> </span><span class="hs-identifier">n</span><span>
</span><a name="line-902"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-number">0</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">negIndex</span><span>
</span><a name="line-903"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-identifier">k</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">k</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-904"></a><span>                                   </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">x</span><span>
</span><a name="line-905"></a><span>                                   </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">k</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">tooLarge</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-identifier">n</span><span>
</span><a name="line-906"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-908"></a><span class="hs-comment">--------------------------------------------------------------</span><span>
</span><a name="line-909"></a><span class="hs-comment">-- The zip family</span><span>
</span><a name="line-910"></a><span class="hs-comment">--------------------------------------------------------------</span><span>
</span><a name="line-911"></a><span>
</span><a name="line-912"></a><span class="hs-identifier">foldr2</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">b</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-913"></a><span class="hs-identifier">foldr2</span><span> </span><span class="hs-identifier">k</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">go</span></a><span>
</span><a name="line-914"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-915"></a><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>    </span><span class="hs-identifier">_ys</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">z</span><span>
</span><a name="line-916"></a><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_xs</span><span>   </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">z</span><span>
</span><a name="line-917"></a><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="GHC.Err.html#errorWithoutStackTrace"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="GHC.Err.html#errorWithoutStackTrace"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="GHC.Err.html#errorWithoutStackTrace"><span class="hs-identifier hs-var">y</span></a><span class="hs-glyph">:</span><a href="GHC.Err.html#errorWithoutStackTrace"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Err.html#errorWithoutStackTrace"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="GHC.Err.html#errorWithoutStackTrace"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="GHC.Err.html#errorWithoutStackTrace"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">go</span><span> </span><a href="GHC.List.html#prel_list_str"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="GHC.List.html#prel_list_str"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span>
</span><a name="line-918"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">0</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">foldr2</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-919"></a><span>
</span><a name="line-920"></a><span class="hs-identifier">foldr2_left</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">d</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-identifier">b</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">b</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">d</span><span>
</span><a name="line-921"></a><span class="hs-identifier">foldr2_left</span><span> </span><span class="hs-identifier">_k</span><span>  </span><a href="GHC.List.html#negIndex"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="GHC.List.html#negIndex"><span class="hs-identifier hs-var">_x</span></a><span> </span><a href="GHC.List.html#negIndex"><span class="hs-identifier hs-var">_r</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">z</span><span>
</span><a name="line-922"></a><span class="hs-identifier">foldr2_left</span><span>  </span><span class="hs-identifier">k</span><span> </span><span class="hs-identifier">_z</span><span>  </span><a href="GHC.Base.html#foldr"><span class="hs-identifier hs-var">x</span></a><span>  </span><span class="hs-identifier">r</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">y</span><span class="hs-glyph">:</span><span class="hs-identifier">ys</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">k</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">r</span><span> </span><span class="hs-identifier">ys</span><span class="hs-special">)</span><span>
</span><a name="line-923"></a><span>
</span><a name="line-924"></a><span class="hs-comment">-- foldr2 k z xs ys = foldr (foldr2_left k z)  (\_ -&gt; z) xs ys</span><span>
</span><a name="line-925"></a><span class="hs-pragma">{-# RULES</span><span>
</span><a name="line-926"></a><span class="hs-pragma">&quot;foldr2/left&quot;</span><span>   </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">k</span><span> </span><span class="hs-pragma">z</span><span> </span><span class="hs-pragma">ys</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">g</span><span class="hs-pragma">::</span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">.</span><span class="hs-pragma">(</span><span class="hs-pragma">a</span><span class="hs-pragma">-&gt;</span><span class="hs-pragma">b</span><span class="hs-pragma">-&gt;</span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span class="hs-pragma">-&gt;</span><span class="hs-pragma">b</span><span class="hs-pragma">-&gt;</span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">.</span><span>
</span><a name="line-927"></a><span>                  </span><span class="hs-pragma">foldr2</span><span> </span><span class="hs-pragma">k</span><span> </span><span class="hs-pragma">z</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">build</span><span> </span><span class="hs-pragma">g</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">ys</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">foldr2_left</span><span>  </span><span class="hs-pragma">k</span><span> </span><span class="hs-pragma">z</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span class="hs-pragma">_</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">z</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">ys</span><span>
</span><a name="line-928"></a><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-929"></a><span class="hs-comment">-- There used to be a foldr2/right rule, allowing foldr2 to fuse with a build</span><span>
</span><a name="line-930"></a><span class="hs-comment">-- form on the right. However, this causes trouble if the right list ends in</span><span>
</span><a name="line-931"></a><span class="hs-comment">-- a bottom that is only avoided by the left list ending at that spot. That is,</span><span>
</span><a name="line-932"></a><span class="hs-comment">-- foldr2 f z [a,b,c] (d:e:f:_|_), where the right list is produced by a build</span><span>
</span><a name="line-933"></a><span class="hs-comment">-- form, would cause the foldr2/right rule to introduce bottom. Example:</span><span>
</span><a name="line-934"></a><span class="hs-comment">--</span><span>
</span><a name="line-935"></a><span class="hs-comment">-- zip [1,2,3,4] (unfoldr (\s -&gt; if s &gt; 4 then undefined else Just (s,s+1)) 1)</span><span>
</span><a name="line-936"></a><span class="hs-comment">--</span><span>
</span><a name="line-937"></a><span class="hs-comment">-- should produce</span><span>
</span><a name="line-938"></a><span class="hs-comment">--</span><span>
</span><a name="line-939"></a><span class="hs-comment">-- [(1,1),(2,2),(3,3),(4,4)]</span><span>
</span><a name="line-940"></a><span class="hs-comment">--</span><span>
</span><a name="line-941"></a><span class="hs-comment">-- but with the foldr2/right rule it would instead produce</span><span>
</span><a name="line-942"></a><span class="hs-comment">--</span><span>
</span><a name="line-943"></a><span class="hs-comment">-- (1,1):(2,2):(3,3):(4,4):_|_</span><span>
</span><a name="line-944"></a><span>
</span><a name="line-945"></a><span class="hs-comment">-- Zips for larger tuples are in the List module.</span><span>
</span><a name="line-946"></a><span>
</span><a name="line-947"></a><span class="hs-comment">----------------------------------------------</span><span>
</span><a name="line-948"></a><span class="hs-comment">-- | 'zip' takes two lists and returns a list of corresponding pairs.</span><span>
</span><a name="line-949"></a><span class="hs-comment">--</span><span>
</span><a name="line-950"></a><span class="hs-comment">-- &gt; zip [1, 2] ['a', 'b'] = [(1, 'a'), (2, 'b')]</span><span>
</span><a name="line-951"></a><span class="hs-comment">--</span><span>
</span><a name="line-952"></a><span class="hs-comment">-- If one input list is short, excess elements of the longer list are</span><span>
</span><a name="line-953"></a><span class="hs-comment">-- discarded:</span><span>
</span><a name="line-954"></a><span class="hs-comment">--</span><span>
</span><a name="line-955"></a><span class="hs-comment">-- &gt; zip [1] ['a', 'b'] = [(1, 'a')]</span><span>
</span><a name="line-956"></a><span class="hs-comment">-- &gt; zip [1, 2] ['a'] = [(1, 'a')]</span><span>
</span><a name="line-957"></a><span class="hs-comment">--</span><span>
</span><a name="line-958"></a><span class="hs-comment">-- 'zip' is right-lazy:</span><span>
</span><a name="line-959"></a><span class="hs-comment">--</span><span>
</span><a name="line-960"></a><span class="hs-comment">-- &gt; zip [] _|_ = []</span><span>
</span><a name="line-961"></a><span class="hs-comment">-- &gt; zip _|_ [] = _|_</span><span>
</span><a name="line-962"></a><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">zip</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-963"></a><span class="hs-identifier">zip</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">b</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-964"></a><span class="hs-identifier">zip</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-identifier">_bs</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-965"></a><span class="hs-identifier">zip</span><span> </span><span class="hs-identifier">_as</span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-966"></a><span class="hs-identifier">zip</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-glyph">:</span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span class="hs-glyph">:</span><span class="hs-identifier">bs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">zip</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">bs</span><span>
</span><a name="line-967"></a><span>
</span><a name="line-968"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">0</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">zipFB</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-comment">-- See Note [Inline FB functions]</span><span>
</span><a name="line-969"></a><span class="hs-identifier">zipFB</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">d</span><span>
</span><a name="line-970"></a><span class="hs-identifier">zipFB</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-special">,</span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">c</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">r</span><span>
</span><a name="line-971"></a><span>
</span><a name="line-972"></a><span class="hs-pragma">{-# RULES</span><span>
</span><a name="line-973"></a><span class="hs-pragma">&quot;zip&quot;</span><span>      </span><span class="hs-pragma">[</span><span class="hs-pragma">~</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">ys</span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">zip</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">ys</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">build</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span class="hs-pragma">c</span><span> </span><span class="hs-pragma">n</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">foldr2</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">zipFB</span><span> </span><span class="hs-pragma">c</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">n</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">ys</span><span class="hs-pragma">)</span><span>
</span><a name="line-974"></a><span class="hs-pragma">&quot;zipList&quot;</span><span>  </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span>  </span><span class="hs-pragma">foldr2</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">zipFB</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">:</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">]</span><span>   </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">zip</span><span>
</span><a name="line-975"></a><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-976"></a><span>
</span><a name="line-977"></a><span class="hs-comment">----------------------------------------------</span><span>
</span><a name="line-978"></a><span class="hs-comment">-- | 'zip3' takes three lists and returns a list of triples, analogous to</span><span>
</span><a name="line-979"></a><span class="hs-comment">-- 'zip'.</span><span>
</span><a name="line-980"></a><span class="hs-identifier">zip3</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">b</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">c</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span class="hs-identifier">c</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-981"></a><span class="hs-comment">-- Specification</span><span>
</span><a name="line-982"></a><span class="hs-comment">-- zip3 =  zipWith3 (,,)</span><span>
</span><a name="line-983"></a><span class="hs-identifier">zip3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-glyph">:</span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span class="hs-glyph">:</span><span class="hs-identifier">bs</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-glyph">:</span><span class="hs-identifier">cs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">zip3</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">bs</span><span> </span><span class="hs-identifier">cs</span><span>
</span><a name="line-984"></a><span class="hs-identifier">zip3</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#%5B%5D"><span class="hs-identifier hs-var">_</span></a><span>      </span><a name="local-6989586621679030882"><a href="#local-6989586621679030882"><span class="hs-identifier">_</span></a></a><span>      </span><span class="hs-identifier">_</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-985"></a><span>
</span><a name="line-986"></a><span>
</span><a name="line-987"></a><span class="hs-comment">-- The zipWith family generalises the zip family by zipping with the</span><span>
</span><a name="line-988"></a><span class="hs-comment">-- function given as the first argument, instead of a tupling function.</span><span>
</span><a name="line-989"></a><span>
</span><a name="line-990"></a><span class="hs-comment">----------------------------------------------</span><span>
</span><a name="line-991"></a><span class="hs-comment">-- | 'zipWith' generalises 'zip' by zipping with the function given</span><span>
</span><a name="line-992"></a><span class="hs-comment">-- as the first argument, instead of a tupling function.</span><span>
</span><a name="line-993"></a><span class="hs-comment">-- For example, @'zipWith' (+)@ is applied to two lists to produce the</span><span>
</span><a name="line-994"></a><span class="hs-comment">-- list of corresponding sums.</span><span>
</span><a name="line-995"></a><span class="hs-comment">--</span><span>
</span><a name="line-996"></a><span class="hs-comment">-- 'zipWith' is right-lazy:</span><span>
</span><a name="line-997"></a><span class="hs-comment">--</span><span>
</span><a name="line-998"></a><span class="hs-comment">-- &gt; zipWith f [] _|_ = []</span><span>
</span><a name="line-999"></a><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">zipWith</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1000"></a><span class="hs-identifier">zipWith</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier">b</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><span class="hs-identifier">b</span><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><span class="hs-identifier">c</span><span class="hs-special">]</span><span>
</span><a name="line-1001"></a><span class="hs-identifier">zipWith</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">go</span><span>
</span><a name="line-1002"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1003"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1004"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#%3A"><span class="hs-identifier hs-var">_</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1005"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">y</span><span class="hs-glyph">:</span><span class="hs-identifier">ys</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-identifier">ys</span><span>
</span><a name="line-1006"></a><span>
</span><a name="line-1007"></a><span class="hs-comment">-- zipWithFB must have arity 2 since it gets two arguments in the &quot;zipWith&quot;</span><span>
</span><a name="line-1008"></a><span class="hs-comment">-- rule; it might not get inlined otherwise</span><span>
</span><a name="line-1009"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">0</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">zipWithFB</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-comment">-- See Note [Inline FB functions]</span><span>
</span><a name="line-1010"></a><span class="hs-identifier">zipWithFB</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">d</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">d</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-1011"></a><span class="hs-identifier">zipWithFB</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">c</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">r</span><span>
</span><a name="line-1012"></a><span>
</span><a name="line-1013"></a><span class="hs-pragma">{-# RULES</span><span>
</span><a name="line-1014"></a><span class="hs-pragma">&quot;zipWith&quot;</span><span>       </span><span class="hs-pragma">[</span><span class="hs-pragma">~</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">ys</span><span class="hs-pragma">.</span><span>    </span><span class="hs-pragma">zipWith</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">ys</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">build</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span class="hs-pragma">c</span><span> </span><span class="hs-pragma">n</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">foldr2</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">zipWithFB</span><span> </span><span class="hs-pragma">c</span><span> </span><span class="hs-pragma">f</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">n</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">ys</span><span class="hs-pragma">)</span><span>
</span><a name="line-1015"></a><span class="hs-pragma">&quot;zipWithList&quot;</span><span>   </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span>  </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">f</span><span class="hs-pragma">.</span><span>  </span><span class="hs-pragma">foldr2</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">zipWithFB</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">:</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">f</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">zipWith</span><span> </span><span class="hs-pragma">f</span><span>
</span><a name="line-1016"></a><span>  </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1017"></a><span>
</span><a name="line-1018"></a><span class="hs-comment">-- | The 'zipWith3' function takes a function which combines three</span><span>
</span><a name="line-1019"></a><span class="hs-comment">-- elements, as well as three lists and returns a list of their point-wise</span><span>
</span><a name="line-1020"></a><span class="hs-comment">-- combination, analogous to 'zipWith'.</span><span>
</span><a name="line-1021"></a><span class="hs-identifier">zipWith3</span><span>                </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier">b</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier">c</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier">d</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><span class="hs-identifier">b</span><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><span class="hs-identifier">c</span><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><span class="hs-identifier">d</span><span class="hs-special">]</span><span>
</span><a name="line-1022"></a><span class="hs-identifier">zipWith3</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">go</span><span>
</span><a name="line-1023"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1024"></a><span>    </span><a name="local-6989586621679030899"><a href="#local-6989586621679030899"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#%5B%5D"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">:</span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span class="hs-glyph">:</span><span class="hs-identifier">bs</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-glyph">:</span><span class="hs-identifier">cs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">bs</span><span> </span><span class="hs-identifier">cs</span><span>
</span><a name="line-1025"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#%5B%5D"><span class="hs-identifier hs-var">_</span></a><span> </span><span class="hs-identifier">_</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1026"></a><span>
</span><a name="line-1027"></a><span class="hs-comment">-- | 'unzip' transforms a list of pairs into a list of first components</span><span>
</span><a name="line-1028"></a><span class="hs-comment">-- and a list of second components.</span><span>
</span><a name="line-1029"></a><span class="hs-identifier">unzip</span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-identifier">b</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1030"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">unzip</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1031"></a><span class="hs-identifier">unzip</span><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="hs-keyword">as</span><span class="hs-special">,</span><span class="hs-identifier">bs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-glyph">:</span><span class="hs-keyword">as</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-glyph">:</span><span class="hs-identifier">bs</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1032"></a><span>
</span><a name="line-1033"></a><span class="hs-comment">-- | The 'unzip3' function takes a list of triples and returns three</span><span>
</span><a name="line-1034"></a><span class="hs-comment">-- lists, analogous to 'unzip'.</span><span>
</span><a name="line-1035"></a><span class="hs-identifier">unzip3</span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span class="hs-identifier">c</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-identifier">b</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-identifier">c</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1036"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">unzip3</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1037"></a><span class="hs-identifier">unzip3</span><span>   </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="hs-keyword">as</span><span class="hs-special">,</span><span class="hs-identifier">bs</span><span class="hs-special">,</span><span class="hs-identifier">cs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-glyph">:</span><span class="hs-keyword">as</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-glyph">:</span><span class="hs-identifier">bs</span><span class="hs-special">,</span><span class="hs-identifier">c</span><span class="hs-glyph">:</span><span class="hs-identifier">cs</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1038"></a><span>                  </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1039"></a><span>
</span><a name="line-1040"></a><span class="hs-comment">--------------------------------------------------------------</span><span>
</span><a name="line-1041"></a><span class="hs-comment">-- Error code</span><span>
</span><a name="line-1042"></a><span class="hs-comment">--------------------------------------------------------------</span><span>
</span><a name="line-1043"></a><span>
</span><a name="line-1044"></a><span class="hs-comment">-- Common up near identical calls to `error' to reduce the number</span><span>
</span><a name="line-1045"></a><span class="hs-comment">-- constant strings created when compiled:</span><span>
</span><a name="line-1046"></a><span>
</span><a name="line-1047"></a><span class="hs-identifier">errorEmptyList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-1048"></a><span class="hs-identifier">errorEmptyList</span><span> </span><span class="hs-identifier">fun</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1049"></a><span>  </span><span class="hs-identifier">errorWithoutStackTrace</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">prel_list_str</span><span> </span><span class="hs-operator">++</span><span> </span><span class="hs-identifier">fun</span><span> </span><span class="hs-operator">++</span><span> </span><span class="hs-string">&quot;: empty list&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1050"></a><span>
</span><a name="line-1051"></a><span class="hs-identifier">prel_list_str</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">String</span><span>
</span><a name="line-1052"></a><span class="hs-identifier">prel_list_str</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Prelude.&quot;</span><span>
</span><a name="line-1053"></a></pre></body></html>