<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><a name="line-2"></a><span class="hs-cpp">#include &quot;containers.h&quot;
</span><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><a name="line-4"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__
</span><span class="hs-pragma">{-# LANGUAGE DeriveDataTypeable #-}</span><span>
</span><a name="line-6"></a><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><a name="line-7"></a><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><a name="line-8"></a><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><a name="line-9"></a><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><a name="line-10"></a><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><a name="line-11"></a><span class="hs-pragma">{-# LANGUAGE Trustworthy #-}</span><span>
</span><a name="line-12"></a><span class="hs-cpp">#endif
#ifdef DEFINE_PATTERN_SYNONYMS
</span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms #-}</span><span>
</span><a name="line-15"></a><span class="hs-pragma">{-# LANGUAGE ViewPatterns #-}</span><span>
</span><a name="line-16"></a><span class="hs-cpp">#endif
</span><span class="hs-pragma">{-# LANGUAGE PatternGuards #-}</span><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span class="hs-pragma">{-# OPTIONS_HADDOCK not-home #-}</span><span>
</span><a name="line-20"></a><span>
</span><a name="line-21"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-22"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-23"></a><span class="hs-comment">-- Module      :  Data.Sequence.Internal</span><span>
</span><a name="line-24"></a><span class="hs-comment">-- Copyright   :  (c) Ross Paterson 2005</span><span>
</span><a name="line-25"></a><span class="hs-comment">--                (c) Louis Wasserman 2009</span><span>
</span><a name="line-26"></a><span class="hs-comment">--                (c) Bertram Felgenhauer, David Feuer, Ross Paterson, and</span><span>
</span><a name="line-27"></a><span class="hs-comment">--                    Milan Straka 2014</span><span>
</span><a name="line-28"></a><span class="hs-comment">-- License     :  BSD-style</span><span>
</span><a name="line-29"></a><span class="hs-comment">-- Maintainer  :  libraries@haskell.org</span><span>
</span><a name="line-30"></a><span class="hs-comment">-- Portability :  portable</span><span>
</span><a name="line-31"></a><span class="hs-comment">--</span><span>
</span><a name="line-32"></a><span class="hs-comment">--</span><span>
</span><a name="line-33"></a><span class="hs-comment">-- = WARNING</span><span>
</span><a name="line-34"></a><span class="hs-comment">--</span><span>
</span><a name="line-35"></a><span class="hs-comment">-- This module is considered __internal__.</span><span>
</span><a name="line-36"></a><span class="hs-comment">--</span><span>
</span><a name="line-37"></a><span class="hs-comment">-- The Package Versioning Policy __does not apply__.</span><span>
</span><a name="line-38"></a><span class="hs-comment">--</span><span>
</span><a name="line-39"></a><span class="hs-comment">-- This contents of this module may change __in any way whatsoever__</span><span>
</span><a name="line-40"></a><span class="hs-comment">-- and __without any warning__ between minor versions of this package.</span><span>
</span><a name="line-41"></a><span class="hs-comment">--</span><span>
</span><a name="line-42"></a><span class="hs-comment">-- Authors importing this module are expected to track development</span><span>
</span><a name="line-43"></a><span class="hs-comment">-- closely.</span><span>
</span><a name="line-44"></a><span class="hs-comment">--</span><span>
</span><a name="line-45"></a><span class="hs-comment">-- = Description</span><span>
</span><a name="line-46"></a><span class="hs-comment">--</span><span>
</span><a name="line-47"></a><span class="hs-comment">-- General purpose finite sequences.</span><span>
</span><a name="line-48"></a><span class="hs-comment">-- Apart from being finite and having strict operations, sequences</span><span>
</span><a name="line-49"></a><span class="hs-comment">-- also differ from lists in supporting a wider variety of operations</span><span>
</span><a name="line-50"></a><span class="hs-comment">-- efficiently.</span><span>
</span><a name="line-51"></a><span class="hs-comment">--</span><span>
</span><a name="line-52"></a><span class="hs-comment">-- An amortized running time is given for each operation, with \( n \) referring</span><span>
</span><a name="line-53"></a><span class="hs-comment">-- to the length of the sequence and \( i \) being the integral index used by</span><span>
</span><a name="line-54"></a><span class="hs-comment">-- some operations. These bounds hold even in a persistent (shared) setting.</span><span>
</span><a name="line-55"></a><span class="hs-comment">--</span><span>
</span><a name="line-56"></a><span class="hs-comment">-- The implementation uses 2-3 finger trees annotated with sizes,</span><span>
</span><a name="line-57"></a><span class="hs-comment">-- as described in section 4.2 of</span><span>
</span><a name="line-58"></a><span class="hs-comment">--</span><span>
</span><a name="line-59"></a><span class="hs-comment">--    * Ralf Hinze and Ross Paterson,</span><span>
</span><a name="line-60"></a><span class="hs-comment">--      \&quot;Finger trees: a simple general-purpose data structure\&quot;,</span><span>
</span><a name="line-61"></a><span class="hs-comment">--      /Journal of Functional Programming/ 16:2 (2006) pp 197-217.</span><span>
</span><a name="line-62"></a><span class="hs-comment">--      &lt;http://staff.city.ac.uk/~ross/papers/FingerTree.html&gt;</span><span>
</span><a name="line-63"></a><span class="hs-comment">--</span><span>
</span><a name="line-64"></a><span class="hs-comment">-- /Note/: Many of these operations have the same names as similar</span><span>
</span><a name="line-65"></a><span class="hs-comment">-- operations on lists in the &quot;Prelude&quot;. The ambiguity may be resolved</span><span>
</span><a name="line-66"></a><span class="hs-comment">-- using either qualification or the @hiding@ clause.</span><span>
</span><a name="line-67"></a><span class="hs-comment">--</span><span>
</span><a name="line-68"></a><span class="hs-comment">-- /Warning/: The size of a 'Seq' must not exceed @maxBound::Int@.  Violation</span><span>
</span><a name="line-69"></a><span class="hs-comment">-- of this condition is not detected and if the size limit is exceeded, the</span><span>
</span><a name="line-70"></a><span class="hs-comment">-- behaviour of the sequence is undefined.  This is unlikely to occur in most</span><span>
</span><a name="line-71"></a><span class="hs-comment">-- applications, but some care may be required when using '&gt;&lt;', '&lt;*&gt;', '*&gt;', or</span><span>
</span><a name="line-72"></a><span class="hs-comment">-- '&gt;&gt;', particularly repeatedly and particularly in combination with</span><span>
</span><a name="line-73"></a><span class="hs-comment">-- 'replicate' or 'fromFunction'.</span><span>
</span><a name="line-74"></a><span class="hs-comment">--</span><span>
</span><a name="line-75"></a><span class="hs-comment">-- @since 0.5.9</span><span>
</span><a name="line-76"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-77"></a><span>
</span><a name="line-78"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.Sequence.Internal</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-79"></a><span>    </span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#MaybeForce"><span class="hs-identifier hs-type">MaybeForce</span></a><span class="hs-special">,</span><span>
</span><a name="line-80"></a><span class="hs-cpp">#if defined(DEFINE_PATTERN_SYNONYMS)
</span><span>    </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#%3A%3C%7C"><span class="hs-operator hs-var">:&lt;|</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#%3A%7C%3E"><span class="hs-operator hs-var">:|&gt;</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-82"></a><span class="hs-cpp">#else
</span><span>    </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-84"></a><span class="hs-cpp">#endif
</span><span>    </span><a href="Utils.Containers.Internal.State.html#State"><span class="hs-identifier hs-type">State</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-86"></a><span>    </span><a href="Utils.Containers.Internal.State.html#execState"><span class="hs-identifier hs-var">execState</span></a><span class="hs-special">,</span><span>
</span><a name="line-87"></a><span>    </span><a href="Data.Sequence.Internal.html#foldDigit"><span class="hs-identifier hs-var">foldDigit</span></a><span class="hs-special">,</span><span>
</span><a name="line-88"></a><span>    </span><a href="Data.Sequence.Internal.html#foldNode"><span class="hs-identifier hs-var">foldNode</span></a><span class="hs-special">,</span><span>
</span><a name="line-89"></a><span>    </span><a href="Data.Sequence.Internal.html#foldWithIndexDigit"><span class="hs-identifier hs-var">foldWithIndexDigit</span></a><span class="hs-special">,</span><span>
</span><a name="line-90"></a><span>    </span><a href="Data.Sequence.Internal.html#foldWithIndexNode"><span class="hs-identifier hs-var">foldWithIndexNode</span></a><span class="hs-special">,</span><span>
</span><a name="line-91"></a><span>
</span><a name="line-92"></a><span>    </span><span class="hs-comment">-- * Construction</span><span>
</span><a name="line-93"></a><span>    </span><a href="Data.Sequence.Internal.html#empty"><span class="hs-identifier hs-var">empty</span></a><span class="hs-special">,</span><span>          </span><span class="hs-comment">-- :: Seq a</span><span>
</span><a name="line-94"></a><span>    </span><a href="Data.Sequence.Internal.html#singleton"><span class="hs-identifier hs-var">singleton</span></a><span class="hs-special">,</span><span>      </span><span class="hs-comment">-- :: a -&gt; Seq a</span><span>
</span><a name="line-95"></a><span>    </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#%3C%7C"><span class="hs-operator hs-var">&lt;|</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>           </span><span class="hs-comment">-- :: a -&gt; Seq a -&gt; Seq a</span><span>
</span><a name="line-96"></a><span>    </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>           </span><span class="hs-comment">-- :: Seq a -&gt; a -&gt; Seq a</span><span>
</span><a name="line-97"></a><span>    </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#%3E%3C"><span class="hs-operator hs-var">&gt;&lt;</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>           </span><span class="hs-comment">-- :: Seq a -&gt; Seq a -&gt; Seq a</span><span>
</span><a name="line-98"></a><span>    </span><a href="Data.Sequence.Internal.html#fromList"><span class="hs-identifier hs-var">fromList</span></a><span class="hs-special">,</span><span>       </span><span class="hs-comment">-- :: [a] -&gt; Seq a</span><span>
</span><a name="line-99"></a><span>    </span><a href="Data.Sequence.Internal.html#fromFunction"><span class="hs-identifier hs-var">fromFunction</span></a><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- :: Int -&gt; (Int -&gt; a) -&gt; Seq a</span><span>
</span><a name="line-100"></a><span>    </span><a href="Data.Sequence.Internal.html#fromArray"><span class="hs-identifier hs-var">fromArray</span></a><span class="hs-special">,</span><span>      </span><span class="hs-comment">-- :: Ix i =&gt; Array i a -&gt; Seq a</span><span>
</span><a name="line-101"></a><span>    </span><span class="hs-comment">-- ** Repetition</span><span>
</span><a name="line-102"></a><span>    </span><a href="Data.Sequence.Internal.html#replicate"><span class="hs-identifier hs-var">replicate</span></a><span class="hs-special">,</span><span>      </span><span class="hs-comment">-- :: Int -&gt; a -&gt; Seq a</span><span>
</span><a name="line-103"></a><span>    </span><a href="Data.Sequence.Internal.html#replicateA"><span class="hs-identifier hs-var">replicateA</span></a><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- :: Applicative f =&gt; Int -&gt; f a -&gt; f (Seq a)</span><span>
</span><a name="line-104"></a><span>    </span><a href="Data.Sequence.Internal.html#replicateM"><span class="hs-identifier hs-var">replicateM</span></a><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- :: Applicative m =&gt; Int -&gt; m a -&gt; m (Seq a)</span><span>
</span><a name="line-105"></a><span>    </span><a href="Data.Sequence.Internal.html#cycleTaking"><span class="hs-identifier hs-var">cycleTaking</span></a><span class="hs-special">,</span><span>    </span><span class="hs-comment">-- :: Int -&gt; Seq a -&gt; Seq a</span><span>
</span><a name="line-106"></a><span>    </span><span class="hs-comment">-- ** Iterative construction</span><span>
</span><a name="line-107"></a><span>    </span><a href="Data.Sequence.Internal.html#iterateN"><span class="hs-identifier hs-var">iterateN</span></a><span class="hs-special">,</span><span>       </span><span class="hs-comment">-- :: Int -&gt; (a -&gt; a) -&gt; a -&gt; Seq a</span><span>
</span><a name="line-108"></a><span>    </span><a href="Data.Sequence.Internal.html#unfoldr"><span class="hs-identifier hs-var">unfoldr</span></a><span class="hs-special">,</span><span>        </span><span class="hs-comment">-- :: (b -&gt; Maybe (a, b)) -&gt; b -&gt; Seq a</span><span>
</span><a name="line-109"></a><span>    </span><a href="Data.Sequence.Internal.html#unfoldl"><span class="hs-identifier hs-var">unfoldl</span></a><span class="hs-special">,</span><span>        </span><span class="hs-comment">-- :: (b -&gt; Maybe (b, a)) -&gt; b -&gt; Seq a</span><span>
</span><a name="line-110"></a><span>    </span><span class="hs-comment">-- * Deconstruction</span><span>
</span><a name="line-111"></a><span>    </span><span class="hs-comment">-- | Additional functions for deconstructing sequences are available</span><span>
</span><a name="line-112"></a><span>    </span><span class="hs-comment">-- via the 'Foldable' instance of 'Seq'.</span><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><span>    </span><span class="hs-comment">-- ** Queries</span><span>
</span><a name="line-115"></a><span>    </span><a href="Data.Sequence.Internal.html#null"><span class="hs-identifier hs-var">null</span></a><span class="hs-special">,</span><span>           </span><span class="hs-comment">-- :: Seq a -&gt; Bool</span><span>
</span><a name="line-116"></a><span>    </span><a href="Data.Sequence.Internal.html#length"><span class="hs-identifier hs-var">length</span></a><span class="hs-special">,</span><span>         </span><span class="hs-comment">-- :: Seq a -&gt; Int</span><span>
</span><a name="line-117"></a><span>    </span><span class="hs-comment">-- ** Views</span><span>
</span><a name="line-118"></a><span>    </span><a href="Data.Sequence.Internal.html#ViewL"><span class="hs-identifier hs-type">ViewL</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-119"></a><span>    </span><a href="Data.Sequence.Internal.html#viewl"><span class="hs-identifier hs-var">viewl</span></a><span class="hs-special">,</span><span>          </span><span class="hs-comment">-- :: Seq a -&gt; ViewL a</span><span>
</span><a name="line-120"></a><span>    </span><a href="Data.Sequence.Internal.html#ViewR"><span class="hs-identifier hs-type">ViewR</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-121"></a><span>    </span><a href="Data.Sequence.Internal.html#viewr"><span class="hs-identifier hs-var">viewr</span></a><span class="hs-special">,</span><span>          </span><span class="hs-comment">-- :: Seq a -&gt; ViewR a</span><span>
</span><a name="line-122"></a><span>    </span><span class="hs-comment">-- * Scans</span><span>
</span><a name="line-123"></a><span>    </span><a href="Data.Sequence.Internal.html#scanl"><span class="hs-identifier hs-var">scanl</span></a><span class="hs-special">,</span><span>          </span><span class="hs-comment">-- :: (a -&gt; b -&gt; a) -&gt; a -&gt; Seq b -&gt; Seq a</span><span>
</span><a name="line-124"></a><span>    </span><a href="Data.Sequence.Internal.html#scanl1"><span class="hs-identifier hs-var">scanl1</span></a><span class="hs-special">,</span><span>         </span><span class="hs-comment">-- :: (a -&gt; a -&gt; a) -&gt; Seq a -&gt; Seq a</span><span>
</span><a name="line-125"></a><span>    </span><a href="Data.Sequence.Internal.html#scanr"><span class="hs-identifier hs-var">scanr</span></a><span class="hs-special">,</span><span>          </span><span class="hs-comment">-- :: (a -&gt; b -&gt; b) -&gt; b -&gt; Seq a -&gt; Seq b</span><span>
</span><a name="line-126"></a><span>    </span><a href="Data.Sequence.Internal.html#scanr1"><span class="hs-identifier hs-var">scanr1</span></a><span class="hs-special">,</span><span>         </span><span class="hs-comment">-- :: (a -&gt; a -&gt; a) -&gt; Seq a -&gt; Seq a</span><span>
</span><a name="line-127"></a><span>    </span><span class="hs-comment">-- * Sublists</span><span>
</span><a name="line-128"></a><span>    </span><a href="Data.Sequence.Internal.html#tails"><span class="hs-identifier hs-var">tails</span></a><span class="hs-special">,</span><span>          </span><span class="hs-comment">-- :: Seq a -&gt; Seq (Seq a)</span><span>
</span><a name="line-129"></a><span>    </span><a href="Data.Sequence.Internal.html#inits"><span class="hs-identifier hs-var">inits</span></a><span class="hs-special">,</span><span>          </span><span class="hs-comment">-- :: Seq a -&gt; Seq (Seq a)</span><span>
</span><a name="line-130"></a><span>    </span><a href="Data.Sequence.Internal.html#chunksOf"><span class="hs-identifier hs-var">chunksOf</span></a><span class="hs-special">,</span><span>       </span><span class="hs-comment">-- :: Int -&gt; Seq a -&gt; Seq (Seq a)</span><span>
</span><a name="line-131"></a><span>    </span><span class="hs-comment">-- ** Sequential searches</span><span>
</span><a name="line-132"></a><span>    </span><a href="Data.Sequence.Internal.html#takeWhileL"><span class="hs-identifier hs-var">takeWhileL</span></a><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- :: (a -&gt; Bool) -&gt; Seq a -&gt; Seq a</span><span>
</span><a name="line-133"></a><span>    </span><a href="Data.Sequence.Internal.html#takeWhileR"><span class="hs-identifier hs-var">takeWhileR</span></a><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- :: (a -&gt; Bool) -&gt; Seq a -&gt; Seq a</span><span>
</span><a name="line-134"></a><span>    </span><a href="Data.Sequence.Internal.html#dropWhileL"><span class="hs-identifier hs-var">dropWhileL</span></a><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- :: (a -&gt; Bool) -&gt; Seq a -&gt; Seq a</span><span>
</span><a name="line-135"></a><span>    </span><a href="Data.Sequence.Internal.html#dropWhileR"><span class="hs-identifier hs-var">dropWhileR</span></a><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- :: (a -&gt; Bool) -&gt; Seq a -&gt; Seq a</span><span>
</span><a name="line-136"></a><span>    </span><a href="Data.Sequence.Internal.html#spanl"><span class="hs-identifier hs-var">spanl</span></a><span class="hs-special">,</span><span>          </span><span class="hs-comment">-- :: (a -&gt; Bool) -&gt; Seq a -&gt; (Seq a, Seq a)</span><span>
</span><a name="line-137"></a><span>    </span><a href="Data.Sequence.Internal.html#spanr"><span class="hs-identifier hs-var">spanr</span></a><span class="hs-special">,</span><span>          </span><span class="hs-comment">-- :: (a -&gt; Bool) -&gt; Seq a -&gt; (Seq a, Seq a)</span><span>
</span><a name="line-138"></a><span>    </span><a href="Data.Sequence.Internal.html#breakl"><span class="hs-identifier hs-var">breakl</span></a><span class="hs-special">,</span><span>         </span><span class="hs-comment">-- :: (a -&gt; Bool) -&gt; Seq a -&gt; (Seq a, Seq a)</span><span>
</span><a name="line-139"></a><span>    </span><a href="Data.Sequence.Internal.html#breakr"><span class="hs-identifier hs-var">breakr</span></a><span class="hs-special">,</span><span>         </span><span class="hs-comment">-- :: (a -&gt; Bool) -&gt; Seq a -&gt; (Seq a, Seq a)</span><span>
</span><a name="line-140"></a><span>    </span><a href="Data.Sequence.Internal.html#partition"><span class="hs-identifier hs-var">partition</span></a><span class="hs-special">,</span><span>      </span><span class="hs-comment">-- :: (a -&gt; Bool) -&gt; Seq a -&gt; (Seq a, Seq a)</span><span>
</span><a name="line-141"></a><span>    </span><a href="Data.Sequence.Internal.html#filter"><span class="hs-identifier hs-var">filter</span></a><span class="hs-special">,</span><span>         </span><span class="hs-comment">-- :: (a -&gt; Bool) -&gt; Seq a -&gt; Seq a</span><span>
</span><a name="line-142"></a><span>    </span><span class="hs-comment">-- * Indexing</span><span>
</span><a name="line-143"></a><span>    </span><a href="Data.Sequence.Internal.html#lookup"><span class="hs-identifier hs-var">lookup</span></a><span class="hs-special">,</span><span>         </span><span class="hs-comment">-- :: Int -&gt; Seq a -&gt; Maybe a</span><span>
</span><a name="line-144"></a><span>    </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#%21%3F"><span class="hs-operator hs-var">!?</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>           </span><span class="hs-comment">-- :: Seq a -&gt; Int -&gt; Maybe a</span><span>
</span><a name="line-145"></a><span>    </span><a href="Data.Sequence.Internal.html#index"><span class="hs-identifier hs-var">index</span></a><span class="hs-special">,</span><span>          </span><span class="hs-comment">-- :: Seq a -&gt; Int -&gt; a</span><span>
</span><a name="line-146"></a><span>    </span><a href="Data.Sequence.Internal.html#adjust"><span class="hs-identifier hs-var">adjust</span></a><span class="hs-special">,</span><span>         </span><span class="hs-comment">-- :: (a -&gt; a) -&gt; Int -&gt; Seq a -&gt; Seq a</span><span>
</span><a name="line-147"></a><span>    </span><a href="Data.Sequence.Internal.html#adjust%27"><span class="hs-identifier hs-var">adjust'</span></a><span class="hs-special">,</span><span>        </span><span class="hs-comment">-- :: (a -&gt; a) -&gt; Int -&gt; Seq a -&gt; Seq a</span><span>
</span><a name="line-148"></a><span>    </span><a href="Data.Sequence.Internal.html#update"><span class="hs-identifier hs-var">update</span></a><span class="hs-special">,</span><span>         </span><span class="hs-comment">-- :: Int -&gt; a -&gt; Seq a -&gt; Seq a</span><span>
</span><a name="line-149"></a><span>    </span><a href="Data.Sequence.Internal.html#take"><span class="hs-identifier hs-var">take</span></a><span class="hs-special">,</span><span>           </span><span class="hs-comment">-- :: Int -&gt; Seq a -&gt; Seq a</span><span>
</span><a name="line-150"></a><span>    </span><a href="Data.Sequence.Internal.html#drop"><span class="hs-identifier hs-var">drop</span></a><span class="hs-special">,</span><span>           </span><span class="hs-comment">-- :: Int -&gt; Seq a -&gt; Seq a</span><span>
</span><a name="line-151"></a><span>    </span><a href="Data.Sequence.Internal.html#insertAt"><span class="hs-identifier hs-var">insertAt</span></a><span class="hs-special">,</span><span>       </span><span class="hs-comment">-- :: Int -&gt; a -&gt; Seq a -&gt; Seq a</span><span>
</span><a name="line-152"></a><span>    </span><a href="Data.Sequence.Internal.html#deleteAt"><span class="hs-identifier hs-var">deleteAt</span></a><span class="hs-special">,</span><span>       </span><span class="hs-comment">-- :: Int -&gt; Seq a -&gt; Seq a</span><span>
</span><a name="line-153"></a><span>    </span><a href="Data.Sequence.Internal.html#splitAt"><span class="hs-identifier hs-var">splitAt</span></a><span class="hs-special">,</span><span>        </span><span class="hs-comment">-- :: Int -&gt; Seq a -&gt; (Seq a, Seq a)</span><span>
</span><a name="line-154"></a><span>    </span><span class="hs-comment">-- ** Indexing with predicates</span><span>
</span><a name="line-155"></a><span>    </span><span class="hs-comment">-- | These functions perform sequential searches from the left</span><span>
</span><a name="line-156"></a><span>    </span><span class="hs-comment">-- or right ends of the sequence, returning indices of matching</span><span>
</span><a name="line-157"></a><span>    </span><span class="hs-comment">-- elements.</span><span>
</span><a name="line-158"></a><span>    </span><a href="Data.Sequence.Internal.html#elemIndexL"><span class="hs-identifier hs-var">elemIndexL</span></a><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- :: Eq a =&gt; a -&gt; Seq a -&gt; Maybe Int</span><span>
</span><a name="line-159"></a><span>    </span><a href="Data.Sequence.Internal.html#elemIndicesL"><span class="hs-identifier hs-var">elemIndicesL</span></a><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- :: Eq a =&gt; a -&gt; Seq a -&gt; [Int]</span><span>
</span><a name="line-160"></a><span>    </span><a href="Data.Sequence.Internal.html#elemIndexR"><span class="hs-identifier hs-var">elemIndexR</span></a><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- :: Eq a =&gt; a -&gt; Seq a -&gt; Maybe Int</span><span>
</span><a name="line-161"></a><span>    </span><a href="Data.Sequence.Internal.html#elemIndicesR"><span class="hs-identifier hs-var">elemIndicesR</span></a><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- :: Eq a =&gt; a -&gt; Seq a -&gt; [Int]</span><span>
</span><a name="line-162"></a><span>    </span><a href="Data.Sequence.Internal.html#findIndexL"><span class="hs-identifier hs-var">findIndexL</span></a><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- :: (a -&gt; Bool) -&gt; Seq a -&gt; Maybe Int</span><span>
</span><a name="line-163"></a><span>    </span><a href="Data.Sequence.Internal.html#findIndicesL"><span class="hs-identifier hs-var">findIndicesL</span></a><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- :: (a -&gt; Bool) -&gt; Seq a -&gt; [Int]</span><span>
</span><a name="line-164"></a><span>    </span><a href="Data.Sequence.Internal.html#findIndexR"><span class="hs-identifier hs-var">findIndexR</span></a><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- :: (a -&gt; Bool) -&gt; Seq a -&gt; Maybe Int</span><span>
</span><a name="line-165"></a><span>    </span><a href="Data.Sequence.Internal.html#findIndicesR"><span class="hs-identifier hs-var">findIndicesR</span></a><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- :: (a -&gt; Bool) -&gt; Seq a -&gt; [Int]</span><span>
</span><a name="line-166"></a><span>    </span><span class="hs-comment">-- * Folds</span><span>
</span><a name="line-167"></a><span>    </span><span class="hs-comment">-- | General folds are available via the 'Foldable' instance of 'Seq'.</span><span>
</span><a name="line-168"></a><span>    </span><a href="Data.Sequence.Internal.html#foldMapWithIndex"><span class="hs-identifier hs-var">foldMapWithIndex</span></a><span class="hs-special">,</span><span> </span><span class="hs-comment">-- :: Monoid m =&gt; (Int -&gt; a -&gt; m) -&gt; Seq a -&gt; m</span><span>
</span><a name="line-169"></a><span>    </span><a href="Data.Sequence.Internal.html#foldlWithIndex"><span class="hs-identifier hs-var">foldlWithIndex</span></a><span class="hs-special">,</span><span> </span><span class="hs-comment">-- :: (b -&gt; Int -&gt; a -&gt; b) -&gt; b -&gt; Seq a -&gt; b</span><span>
</span><a name="line-170"></a><span>    </span><a href="Data.Sequence.Internal.html#foldrWithIndex"><span class="hs-identifier hs-var">foldrWithIndex</span></a><span class="hs-special">,</span><span> </span><span class="hs-comment">-- :: (Int -&gt; a -&gt; b -&gt; b) -&gt; b -&gt; Seq a -&gt; b</span><span>
</span><a name="line-171"></a><span>    </span><span class="hs-comment">-- * Transformations</span><span>
</span><a name="line-172"></a><span>    </span><a href="Data.Sequence.Internal.html#mapWithIndex"><span class="hs-identifier hs-var">mapWithIndex</span></a><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- :: (Int -&gt; a -&gt; b) -&gt; Seq a -&gt; Seq b</span><span>
</span><a name="line-173"></a><span>    </span><a href="Data.Sequence.Internal.html#traverseWithIndex"><span class="hs-identifier hs-var">traverseWithIndex</span></a><span class="hs-special">,</span><span> </span><span class="hs-comment">-- :: Applicative f =&gt; (Int -&gt; a -&gt; f b) -&gt; Seq a -&gt; f (Seq b)</span><span>
</span><a name="line-174"></a><span>    </span><a href="Data.Sequence.Internal.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span class="hs-special">,</span><span>        </span><span class="hs-comment">-- :: Seq a -&gt; Seq a</span><span>
</span><a name="line-175"></a><span>    </span><a href="Data.Sequence.Internal.html#intersperse"><span class="hs-identifier hs-var">intersperse</span></a><span class="hs-special">,</span><span>    </span><span class="hs-comment">-- :: a -&gt; Seq a -&gt; Seq a</span><span>
</span><a name="line-176"></a><span>    </span><a href="Data.Sequence.Internal.html#liftA2Seq"><span class="hs-identifier hs-var">liftA2Seq</span></a><span class="hs-special">,</span><span>      </span><span class="hs-comment">-- :: (a -&gt; b -&gt; c) -&gt; Seq a -&gt; Seq b -&gt; Seq c</span><span>
</span><a name="line-177"></a><span>    </span><span class="hs-comment">-- ** Zips and unzips</span><span>
</span><a name="line-178"></a><span>    </span><a href="Data.Sequence.Internal.html#zip"><span class="hs-identifier hs-var">zip</span></a><span class="hs-special">,</span><span>            </span><span class="hs-comment">-- :: Seq a -&gt; Seq b -&gt; Seq (a, b)</span><span>
</span><a name="line-179"></a><span>    </span><a href="Data.Sequence.Internal.html#zipWith"><span class="hs-identifier hs-var">zipWith</span></a><span class="hs-special">,</span><span>        </span><span class="hs-comment">-- :: (a -&gt; b -&gt; c) -&gt; Seq a -&gt; Seq b -&gt; Seq c</span><span>
</span><a name="line-180"></a><span>    </span><a href="Data.Sequence.Internal.html#zip3"><span class="hs-identifier hs-var">zip3</span></a><span class="hs-special">,</span><span>           </span><span class="hs-comment">-- :: Seq a -&gt; Seq b -&gt; Seq c -&gt; Seq (a, b, c)</span><span>
</span><a name="line-181"></a><span>    </span><a href="Data.Sequence.Internal.html#zipWith3"><span class="hs-identifier hs-var">zipWith3</span></a><span class="hs-special">,</span><span>       </span><span class="hs-comment">-- :: (a -&gt; b -&gt; c -&gt; d) -&gt; Seq a -&gt; Seq b -&gt; Seq c -&gt; Seq d</span><span>
</span><a name="line-182"></a><span>    </span><a href="Data.Sequence.Internal.html#zip4"><span class="hs-identifier hs-var">zip4</span></a><span class="hs-special">,</span><span>           </span><span class="hs-comment">-- :: Seq a -&gt; Seq b -&gt; Seq c -&gt; Seq d -&gt; Seq (a, b, c, d)</span><span>
</span><a name="line-183"></a><span>    </span><a href="Data.Sequence.Internal.html#zipWith4"><span class="hs-identifier hs-var">zipWith4</span></a><span class="hs-special">,</span><span>       </span><span class="hs-comment">-- :: (a -&gt; b -&gt; c -&gt; d -&gt; e) -&gt; Seq a -&gt; Seq b -&gt; Seq c -&gt; Seq d -&gt; Seq e</span><span>
</span><a name="line-184"></a><span>    </span><a href="Data.Sequence.Internal.html#unzip"><span class="hs-identifier hs-var">unzip</span></a><span class="hs-special">,</span><span>          </span><span class="hs-comment">-- :: Seq (a, b) -&gt; (Seq a, Seq b)</span><span>
</span><a name="line-185"></a><span>    </span><a href="Data.Sequence.Internal.html#unzipWith"><span class="hs-identifier hs-var">unzipWith</span></a><span class="hs-special">,</span><span>      </span><span class="hs-comment">-- :: (a -&gt; (b, c)) -&gt; Seq a -&gt; (Seq b, Seq c)</span><span>
</span><a name="line-186"></a><span class="hs-cpp">#ifdef TESTING
</span><span>    </span><span class="hs-identifier">deep</span><span class="hs-special">,</span><span>
</span><a name="line-188"></a><span>    </span><span class="hs-identifier">node2</span><span class="hs-special">,</span><span>
</span><a name="line-189"></a><span>    </span><span class="hs-identifier">node3</span><span class="hs-special">,</span><span>
</span><a name="line-190"></a><span class="hs-cpp">#endif
</span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-192"></a><span>
</span><a name="line-193"></a><span class="hs-keyword">import</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Prelude.html"><span class="hs-identifier">Prelude</span></a><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-194"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Functor"><span class="hs-identifier hs-type">Functor</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-195"></a><span class="hs-cpp">#if MIN_VERSION_base(4,11,0)
</span><span>    </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-197"></a><span class="hs-cpp">#endif
#if MIN_VERSION_base(4,8,0)
</span><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">Applicative</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldMap"><span class="hs-identifier hs-var">foldMap</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Monoid"><span class="hs-identifier hs-type">Monoid</span></a><span class="hs-special">,</span><span>
</span><a name="line-200"></a><span class="hs-cpp">#endif
</span><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.List.html#lookup"><span class="hs-identifier hs-var">lookup</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.List.html#take"><span class="hs-identifier hs-var">take</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.List.html#drop"><span class="hs-identifier hs-var">drop</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.List.html#splitAt"><span class="hs-identifier hs-var">splitAt</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldl"><span class="hs-identifier hs-var">foldl</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldl1"><span class="hs-identifier hs-var">foldl1</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldr1"><span class="hs-identifier hs-var">foldr1</span></a><span class="hs-special">,</span><span>
</span><a name="line-202"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.List.html#scanl"><span class="hs-identifier hs-var">scanl</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.List.html#scanl1"><span class="hs-identifier hs-var">scanl1</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.List.html#scanr"><span class="hs-identifier hs-var">scanr</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.List.html#scanr1"><span class="hs-identifier hs-var">scanr1</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.List.html#zipWith"><span class="hs-identifier hs-var">zipWith</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.List.html#zip3"><span class="hs-identifier hs-var">zip3</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.List.html#zipWith3"><span class="hs-identifier hs-var">zipWith3</span></a><span class="hs-special">,</span><span>
</span><a name="line-203"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.List.html#takeWhile"><span class="hs-identifier hs-var">takeWhile</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.List.html#dropWhile"><span class="hs-identifier hs-var">dropWhile</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.List.html#iterate"><span class="hs-identifier hs-var">iterate</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#sum"><span class="hs-identifier hs-var">sum</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a><span class="hs-special">)</span><span>
</span><a name="line-204"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.List.html"><span class="hs-identifier">Data.List</span></a><span>
</span><a name="line-205"></a><span class="hs-keyword">import</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Control.Applicative.html"><span class="hs-identifier">Control.Applicative</span></a><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">Applicative</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%3C%2A%2A%3E"><span class="hs-operator hs-var">&lt;**&gt;</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>  </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Alternative"><span class="hs-identifier hs-type">Alternative</span></a><span class="hs-special">,</span><span>
</span><a name="line-206"></a><span>                            </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#liftA2"><span class="hs-identifier hs-var">liftA2</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#liftA3"><span class="hs-identifier hs-var">liftA3</span></a><span class="hs-special">)</span><span>
</span><a name="line-207"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Control.Applicative.html"><span class="hs-identifier">Control.Applicative</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Applicative</span><span>
</span><a name="line-208"></a><span class="hs-keyword">import</span><span> </span><a href="../deepseq/src/%{MODULE}.html#%{NAME}/Control.DeepSeq.html"><span class="hs-identifier">Control.DeepSeq</span></a><span> </span><span class="hs-special">(</span><a href="../deepseq/src/%{MODULE}.html#%{NAME}/Control.DeepSeq.html#NFData"><span class="hs-identifier hs-type">NFData</span></a><span class="hs-special">(</span><a href="../deepseq/src/%{MODULE}.html#%{NAME}/Control.DeepSeq.html#rnf"><span class="hs-identifier hs-var">rnf</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-209"></a><span class="hs-keyword">import</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#MonadPlus"><span class="hs-identifier hs-type">MonadPlus</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-210"></a><span class="hs-keyword">import</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Monoid.html"><span class="hs-identifier">Data.Monoid</span></a><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Monoid"><span class="hs-identifier hs-type">Monoid</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-211"></a><span class="hs-keyword">import</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Functor.html"><span class="hs-identifier">Data.Functor</span></a><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Functor"><span class="hs-identifier hs-type">Functor</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-212"></a><span class="hs-keyword">import</span><span> </span><a href="Utils.Containers.Internal.State.html"><span class="hs-identifier">Utils.Containers.Internal.State</span></a><span> </span><span class="hs-special">(</span><a href="Utils.Containers.Internal.State.html#State"><span class="hs-identifier hs-type">State</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Utils.Containers.Internal.State.html#execState"><span class="hs-identifier hs-var">execState</span></a><span class="hs-special">)</span><span>
</span><a name="line-213"></a><span class="hs-keyword">import</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html"><span class="hs-identifier">Data.Foldable</span></a><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#Foldable"><span class="hs-identifier hs-type">Foldable</span></a><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldl"><span class="hs-identifier hs-var">foldl</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldl1"><span class="hs-identifier hs-var">foldl1</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldr1"><span class="hs-identifier hs-var">foldr1</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldMap"><span class="hs-identifier hs-var">foldMap</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldl%27"><span class="hs-identifier hs-var">foldl'</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldr%27"><span class="hs-identifier hs-var">foldr'</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#toList"><span class="hs-identifier hs-var">toList</span></a><span class="hs-special">)</span><span>
</span><a name="line-214"></a><span>
</span><a name="line-215"></a><span class="hs-cpp">#if MIN_VERSION_base(4,9,0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Semigroup.html"><span class="hs-identifier">Data.Semigroup</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Semigroup</span><span>
</span><a name="line-217"></a><span class="hs-keyword">import</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Functor.Classes.html"><span class="hs-identifier">Data.Functor.Classes</span></a><span>
</span><a name="line-218"></a><span class="hs-cpp">#endif
</span><span class="hs-keyword">import</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Traversable.html"><span class="hs-identifier">Data.Traversable</span></a><span>
</span><a name="line-220"></a><span class="hs-keyword">import</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Typeable.html"><span class="hs-identifier">Data.Typeable</span></a><span>
</span><a name="line-221"></a><span>
</span><a name="line-222"></a><span class="hs-comment">-- GHC specific stuff</span><span>
</span><a name="line-223"></a><span class="hs-cpp">#ifdef __GLASGOW_HASKELL__
</span><span class="hs-keyword">import</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Exts.html"><span class="hs-identifier">GHC.Exts</span></a><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#build"><span class="hs-identifier hs-var">build</span></a><span class="hs-special">)</span><span>
</span><a name="line-225"></a><span class="hs-keyword">import</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Text.Read.html"><span class="hs-identifier">Text.Read</span></a><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/Text.Read.Lex.html#Lexeme"><span class="hs-identifier hs-type">Lexeme</span></a><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/Text.Read.Lex.html#Ident"><span class="hs-identifier hs-var">Ident</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Read.html#lexP"><span class="hs-identifier hs-var">lexP</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Read.html#parens"><span class="hs-identifier hs-var">parens</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Text.ParserCombinators.ReadPrec.html#prec"><span class="hs-identifier hs-var">prec</span></a><span class="hs-special">,</span><span>
</span><a name="line-226"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Read.html#readPrec"><span class="hs-identifier hs-var">readPrec</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Read.html#readListPrec"><span class="hs-identifier hs-var">readListPrec</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Read.html#readListPrecDefault"><span class="hs-identifier hs-var">readListPrecDefault</span></a><span class="hs-special">)</span><span>
</span><a name="line-227"></a><span class="hs-keyword">import</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Data.html"><span class="hs-identifier">Data.Data</span></a><span>
</span><a name="line-228"></a><span class="hs-keyword">import</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.String.html"><span class="hs-identifier">Data.String</span></a><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.String.html#IsString"><span class="hs-identifier hs-type">IsString</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-229"></a><span class="hs-cpp">#endif
#if __GLASGOW_HASKELL__
</span><span class="hs-keyword">import</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Generics.html"><span class="hs-identifier">GHC.Generics</span></a><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Generics.html#Generic"><span class="hs-identifier hs-type">Generic</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Generics.html#Generic1"><span class="hs-identifier hs-type">Generic1</span></a><span class="hs-special">)</span><span>
</span><a name="line-232"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-234"></a><span class="hs-comment">-- Array stuff, with GHC.Arr on GHC</span><span>
</span><a name="line-235"></a><span class="hs-keyword">import</span><span> </span><a href="../array/src/%{MODULE}.html#%{NAME}/Data.Array.html"><span class="hs-identifier">Data.Array</span></a><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Arr.html#Ix"><span class="hs-identifier hs-type">Ix</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Arr.html#Array"><span class="hs-identifier hs-type">Array</span></a><span class="hs-special">)</span><span>
</span><a name="line-236"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="../array/src/%{MODULE}.html#%{NAME}/Data.Array.html"><span class="hs-identifier">Data.Array</span></a><span>
</span><a name="line-237"></a><span class="hs-cpp">#ifdef __GLASGOW_HASKELL__
</span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Arr.html"><span class="hs-identifier">GHC.Arr</span></a><span>
</span><a name="line-239"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-241"></a><span class="hs-keyword">import</span><span> </span><a href="Utils.Containers.Internal.Coercions.html"><span class="hs-identifier">Utils.Containers.Internal.Coercions</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Utils.Containers.Internal.Coercions.html#.%23"><span class="hs-operator hs-var">.#</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Utils.Containers.Internal.Coercions.html#.%5E%23"><span class="hs-operator hs-var">.^#</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-242"></a><span class="hs-comment">-- Coercion on GHC 7.8+</span><span>
</span><a name="line-243"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 708
</span><span class="hs-keyword">import</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Coerce.html"><span class="hs-identifier">Data.Coerce</span></a><span>
</span><a name="line-245"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Exts.html"><span class="hs-identifier">GHC.Exts</span></a><span>
</span><a name="line-246"></a><span class="hs-cpp">#else
#endif
</span><span>
</span><a name="line-249"></a><span class="hs-comment">-- Identity functor on base 4.8 (GHC 7.10+)</span><span>
</span><a name="line-250"></a><span class="hs-cpp">#if MIN_VERSION_base(4,8,0)
</span><span class="hs-keyword">import</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Functor.Identity.html"><span class="hs-identifier">Data.Functor.Identity</span></a><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Functor.Identity.html#Identity"><span class="hs-identifier hs-type">Identity</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-252"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-254"></a><span class="hs-cpp">#if !MIN_VERSION_base(4,8,0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Word</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Word</span><span class="hs-special">)</span><span>
</span><a name="line-256"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-258"></a><span class="hs-keyword">import</span><span> </span><a href="Utils.Containers.Internal.StrictPair.html"><span class="hs-identifier">Utils.Containers.Internal.StrictPair</span></a><span> </span><span class="hs-special">(</span><a href="Utils.Containers.Internal.StrictPair.html#StrictPair"><span class="hs-identifier hs-type">StrictPair</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Utils.Containers.Internal.StrictPair.html#toPair"><span class="hs-identifier hs-var">toPair</span></a><span class="hs-special">)</span><span>
</span><a name="line-259"></a><span class="hs-keyword">import</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Control.Monad.Zip.html"><span class="hs-identifier">Control.Monad.Zip</span></a><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/Control.Monad.Zip.html#MonadZip"><span class="hs-identifier hs-type">MonadZip</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-260"></a><span class="hs-keyword">import</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Control.Monad.Fix.html"><span class="hs-identifier">Control.Monad.Fix</span></a><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/Control.Monad.Fix.html#MonadFix"><span class="hs-identifier hs-type">MonadFix</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Function.html#fix"><span class="hs-identifier hs-var">fix</span></a><span class="hs-special">)</span><span>
</span><a name="line-261"></a><span>
</span><a name="line-262"></a><span class="hs-keyword">default</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-263"></a><span>
</span><a name="line-264"></a><span class="hs-comment">-- We define our own copy here, for Monoid only, even though this</span><span>
</span><a name="line-265"></a><span class="hs-comment">-- is now a Semigroup operator in base. The essential reason is that</span><span>
</span><a name="line-266"></a><span class="hs-comment">-- we have absolutely no use for semigroups in this module. Everything</span><span>
</span><a name="line-267"></a><span class="hs-comment">-- that needs to sum things up requires a Monoid constraint to deal</span><span>
</span><a name="line-268"></a><span class="hs-comment">-- with empty sequences. I'm not sure if there's a risk of walking</span><span>
</span><a name="line-269"></a><span class="hs-comment">-- through dictionaries to reach &lt;&gt; from Monoid, but I see no reason</span><span>
</span><a name="line-270"></a><span class="hs-comment">-- to risk it.</span><span>
</span><a name="line-271"></a><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">6</span><span> </span><a href="Data.Sequence.Internal.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span>
</span><a name="line-272"></a><span class="hs-special">(</span><span class="hs-operator">&lt;&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Monoid"><span class="hs-identifier hs-type">Monoid</span></a><span> </span><a href="#local-6989586621679059112"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679059112"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059112"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059112"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-273"></a><span class="hs-special">(</span><a name="%3C%3E"><a href="Data.Sequence.Internal.html#%3C%3E"><span class="hs-operator">&lt;&gt;</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span>
</span><a name="line-274"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">&lt;&gt;</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-275"></a><span>
</span><a name="line-276"></a><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">5</span><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#consTree"><span class="hs-identifier hs-var">consTree</span></a><span class="hs-special">`</span><span>
</span><a name="line-277"></a><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">5</span><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#snocTree"><span class="hs-identifier hs-var">snocTree</span></a><span class="hs-special">`</span><span>
</span><a name="line-278"></a><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">5</span><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#appendTree0"><span class="hs-identifier hs-var">appendTree0</span></a><span class="hs-special">`</span><span>
</span><a name="line-279"></a><span>
</span><a name="line-280"></a><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">5</span><span> </span><a href="Data.Sequence.Internal.html#%3E%3C"><span class="hs-operator hs-var">&gt;&lt;</span></a><span>
</span><a name="line-281"></a><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">5</span><span> </span><a href="Data.Sequence.Internal.html#%3C%7C"><span class="hs-operator hs-var">&lt;|</span></a><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a><span>
</span><a name="line-282"></a><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">5</span><span> </span><a href="Data.Sequence.Internal.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a><span>
</span><a name="line-283"></a><span>
</span><a name="line-284"></a><span class="hs-cpp">#ifdef DEFINE_PATTERN_SYNONYMS
</span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">5</span><span> </span><a href="Data.Sequence.Internal.html#%3A%3C%7C"><span class="hs-operator hs-var">:&lt;|</span></a><span>
</span><a name="line-286"></a><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">5</span><span> </span><a href="Data.Sequence.Internal.html#%3A%7C%3E"><span class="hs-operator hs-var">:|&gt;</span></a><span>
</span><a name="line-287"></a><span>
</span><a name="line-288"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="hs-pragma">{-# COMPLETE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">:&lt;|</span><span class="hs-pragma">)</span><span class="hs-pragma">,</span><span> </span><span class="hs-pragma">Empty</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-290"></a><span class="hs-pragma">{-# COMPLETE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">:|&gt;</span><span class="hs-pragma">)</span><span class="hs-pragma">,</span><span> </span><span class="hs-pragma">Empty</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-291"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-293"></a><span class="hs-comment">-- | A bidirectional pattern synonym matching an empty sequence.</span><span>
</span><a name="line-294"></a><span class="hs-comment">--</span><span>
</span><a name="line-295"></a><span class="hs-comment">-- @since 0.5.8</span><span>
</span><a name="line-296"></a><span class="hs-keyword">pattern</span><span> </span><span class="hs-identifier">Empty</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679059111"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-297"></a><span class="hs-keyword">pattern</span><span> </span><a name="Empty"><a href="Data.Sequence.Internal.html#Empty"><span class="hs-identifier">Empty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span>
</span><a name="line-298"></a><span>
</span><a name="line-299"></a><span class="hs-comment">-- | A bidirectional pattern synonym viewing the front of a non-empty</span><span>
</span><a name="line-300"></a><span class="hs-comment">-- sequence.</span><span>
</span><a name="line-301"></a><span class="hs-comment">--</span><span>
</span><a name="line-302"></a><span class="hs-comment">-- @since 0.5.8</span><span>
</span><a name="line-303"></a><span class="hs-keyword">pattern</span><span> </span><span class="hs-special">(</span><span class="hs-operator">:&lt;|</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679059110"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679059110"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679059110"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-304"></a><span class="hs-keyword">pattern</span><span> </span><a href="#local-6989586621679059113"><span class="hs-identifier hs-var">x</span></a><span> </span><a name="%3A%3C%7C"><a href="Data.Sequence.Internal.html#%3A%3C%7C"><span class="hs-operator">:&lt;|</span></a></a><span> </span><a href="#local-6989586621679059114"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#viewl"><span class="hs-identifier hs-var">viewl</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a name="local-6989586621679059113"><a href="#local-6989586621679059113"><span class="hs-identifier">x</span></a></a><span> </span><a href="Data.Sequence.Internal.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a><span> </span><a name="local-6989586621679059114"><a href="#local-6989586621679059114"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-305"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-306"></a><span>    </span><a name="local-6989586621679059115"><a href="#local-6989586621679059115"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator">:&lt;|</span><span> </span><a name="local-6989586621679059116"><a href="#local-6989586621679059116"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679059115"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="Data.Sequence.Internal.html#%3C%7C"><span class="hs-operator hs-var">&lt;|</span></a><span> </span><a href="#local-6989586621679059116"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-307"></a><span>
</span><a name="line-308"></a><span class="hs-comment">-- | A bidirectional pattern synonym viewing the rear of a non-empty</span><span>
</span><a name="line-309"></a><span class="hs-comment">-- sequence.</span><span>
</span><a name="line-310"></a><span class="hs-comment">--</span><span>
</span><a name="line-311"></a><span class="hs-comment">-- @since 0.5.8</span><span>
</span><a name="line-312"></a><span class="hs-keyword">pattern</span><span> </span><span class="hs-special">(</span><span class="hs-operator">:|&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679059109"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059109"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679059109"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-313"></a><span class="hs-keyword">pattern</span><span> </span><a href="#local-6989586621679059117"><span class="hs-identifier hs-var">xs</span></a><span> </span><a name="%3A%7C%3E"><a href="Data.Sequence.Internal.html#%3A%7C%3E"><span class="hs-operator">:|&gt;</span></a></a><span> </span><a href="#local-6989586621679059118"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#viewr"><span class="hs-identifier hs-var">viewr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a name="local-6989586621679059117"><a href="#local-6989586621679059117"><span class="hs-identifier">xs</span></a></a><span> </span><a href="Data.Sequence.Internal.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a><span> </span><a name="local-6989586621679059118"><a href="#local-6989586621679059118"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-314"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-315"></a><span>    </span><a name="local-6989586621679059119"><a href="#local-6989586621679059119"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-operator">:|&gt;</span><span> </span><a name="local-6989586621679059120"><a href="#local-6989586621679059120"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679059119"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="Data.Sequence.Internal.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span> </span><a href="#local-6989586621679059120"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-316"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-318"></a><span class="hs-keyword">class</span><span> </span><a name="Sized"><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier">Sized</span></a></a><span> </span><a name="local-6989586621679058061"><a href="#local-6989586621679058061"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-319"></a><span>    </span><a name="size"><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier">size</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679058061"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span>
</span><a name="line-320"></a><span>
</span><a name="line-321"></a><span class="hs-comment">-- In much the same way that Sized lets us handle the</span><span>
</span><a name="line-322"></a><span class="hs-comment">-- sizes of elements and nodes uniformly, MaybeForce lets</span><span>
</span><a name="line-323"></a><span class="hs-comment">-- us handle their strictness (or lack thereof) uniformly.</span><span>
</span><a name="line-324"></a><span class="hs-comment">-- We can `mseq` something and not have to worry about</span><span>
</span><a name="line-325"></a><span class="hs-comment">-- whether it's an element or a node.</span><span>
</span><a name="line-326"></a><span class="hs-keyword">class</span><span> </span><a name="MaybeForce"><a href="Data.Sequence.Internal.html#MaybeForce"><span class="hs-identifier">MaybeForce</span></a></a><span> </span><a name="local-6989586621679058060"><a href="#local-6989586621679058060"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-327"></a><span>  </span><a name="maybeRwhnf"><a href="Data.Sequence.Internal.html#maybeRwhnf"><span class="hs-identifier">maybeRwhnf</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679058060"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-328"></a><span>
</span><a name="line-329"></a><span class="hs-identifier">mseq</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#MaybeForce"><span class="hs-identifier hs-type">MaybeForce</span></a><span> </span><a href="#local-6989586621679059107"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679059107"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059108"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059108"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-330"></a><a name="mseq"><a href="Data.Sequence.Internal.html#mseq"><span class="hs-identifier">mseq</span></a></a><span> </span><a name="local-6989586621679059121"><a href="#local-6989586621679059121"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059122"><a href="#local-6989586621679059122"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Data.Sequence.Internal.html#maybeRwhnf"><span class="hs-identifier hs-var">maybeRwhnf</span></a><span> </span><a href="#local-6989586621679059121"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059122"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-331"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">mseq</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-332"></a><span>
</span><a name="line-333"></a><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">0</span><span> </span><a href="Data.Sequence.Internal.html#%24%21%3F"><span class="hs-operator hs-var">$!?</span></a><span>
</span><a name="line-334"></a><span class="hs-special">(</span><span class="hs-operator">$!?</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#MaybeForce"><span class="hs-identifier hs-type">MaybeForce</span></a><span> </span><a href="#local-6989586621679059105"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059105"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059106"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059105"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059106"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-335"></a><a name="local-6989586621679059123"><a href="#local-6989586621679059123"><span class="hs-identifier">f</span></a></a><span> </span><a name="%24%21%3F"><a href="Data.Sequence.Internal.html#%24%21%3F"><span class="hs-operator">$!?</span></a></a><span> </span><a name="local-6989586621679059124"><a href="#local-6989586621679059124"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Data.Sequence.Internal.html#maybeRwhnf"><span class="hs-identifier hs-var">maybeRwhnf</span></a><span> </span><a href="#local-6989586621679059124"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059123"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679059124"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-336"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">$!?</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-337"></a><span>
</span><a name="line-338"></a><span class="hs-keyword">instance</span><span> </span><a href="Data.Sequence.Internal.html#MaybeForce"><span class="hs-identifier hs-type">MaybeForce</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679058791"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-339"></a><span>  </span><a name="local-8214565720323832741"><a href="Data.Sequence.Internal.html#maybeRwhnf"><span class="hs-identifier">maybeRwhnf</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-340"></a><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">maybeRwhnf</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-341"></a><span>
</span><a name="line-342"></a><span class="hs-keyword">instance</span><span> </span><a href="Data.Sequence.Internal.html#MaybeForce"><span class="hs-identifier hs-type">MaybeForce</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679058790"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-343"></a><span>  </span><a name="local-8214565720323832741"><a href="Data.Sequence.Internal.html#maybeRwhnf"><span class="hs-identifier">maybeRwhnf</span></a></a><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-344"></a><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">maybeRwhnf</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-345"></a><span>
</span><a name="line-346"></a><span class="hs-comment">-- A wrapper making mseq = seq</span><span>
</span><a name="line-347"></a><span class="hs-keyword">newtype</span><span> </span><a name="ForceBox"><a href="Data.Sequence.Internal.html#ForceBox"><span class="hs-identifier">ForceBox</span></a></a><span> </span><a name="local-6989586621679058059"><a href="#local-6989586621679058059"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="ForceBox"><a href="Data.Sequence.Internal.html#ForceBox"><span class="hs-identifier">ForceBox</span></a></a><span> </span><a href="#local-6989586621679058059"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-348"></a><span class="hs-keyword">instance</span><span> </span><a href="Data.Sequence.Internal.html#MaybeForce"><span class="hs-identifier hs-type">MaybeForce</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#ForceBox"><span class="hs-identifier hs-type">ForceBox</span></a><span> </span><a href="#local-6989586621679058789"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-349"></a><span>  </span><a name="local-8214565720323832741"><a href="Data.Sequence.Internal.html#maybeRwhnf"><span class="hs-identifier">maybeRwhnf</span></a></a><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-350"></a><span class="hs-keyword">instance</span><span> </span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#ForceBox"><span class="hs-identifier hs-type">ForceBox</span></a><span> </span><a href="#local-6989586621679058788"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-351"></a><span>  </span><a name="local-8214565720323832743"><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier">size</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-352"></a><span>
</span><a name="line-353"></a><span class="hs-comment">-- | General-purpose finite sequences.</span><span>
</span><a name="line-354"></a><span class="hs-keyword">newtype</span><span> </span><a name="Seq"><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier">Seq</span></a></a><span> </span><a name="local-6989586621679058058"><a href="#local-6989586621679058058"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Seq"><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier">Seq</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679058058"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-355"></a><span>
</span><a name="line-356"></a><span class="hs-keyword">instance</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Functor"><span class="hs-identifier hs-type">Functor</span></a><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-357"></a><span>    </span><a name="local-3458764513820541101"><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier">fmap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#fmapSeq"><span class="hs-identifier hs-var">fmapSeq</span></a><span>
</span><a name="line-358"></a><span class="hs-cpp">#ifdef __GLASGOW_HASKELL__
</span><span>    </span><a name="local-6989586621679058786"><a href="#local-6989586621679058786"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-8214565720323790448"><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%3C%24"><span class="hs-operator">&lt;$</span></a></a><span> </span><a name="local-6989586621679058787"><a href="#local-6989586621679058787"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#replicate"><span class="hs-identifier hs-var">replicate</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-6989586621679058787"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679058786"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-360"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-362"></a><span class="hs-identifier">fmapSeq</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059103"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059104"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679059103"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679059104"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-363"></a><a name="fmapSeq"><a href="Data.Sequence.Internal.html#fmapSeq"><span class="hs-identifier">fmapSeq</span></a></a><span> </span><a name="local-6989586621679059125"><a href="#local-6989586621679059125"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a name="local-6989586621679059126"><a href="#local-6989586621679059126"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><a href="#local-6989586621679059125"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059126"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-364"></a><span class="hs-cpp">#ifdef __GLASGOW_HASKELL__
</span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">fmapSeq</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-366"></a><span class="hs-pragma">{-# RULES</span><span>
</span><a name="line-367"></a><span class="hs-pragma">&quot;fmapSeq/fmapSeq&quot;</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">fmapSeq</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">fmapSeq</span><span> </span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">xs</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">fmapSeq</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">g</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">xs</span><span>
</span><a name="line-368"></a><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-369"></a><span class="hs-cpp">#endif
#if __GLASGOW_HASKELL__ &gt;= 709
</span><span class="hs-comment">-- Safe coercions were introduced in 7.8, but did not work well with RULES yet.</span><span>
</span><a name="line-372"></a><span class="hs-pragma">{-# RULES</span><span>
</span><a name="line-373"></a><span class="hs-pragma">&quot;fmapSeq/coerce&quot;</span><span> </span><span class="hs-pragma">fmapSeq</span><span> </span><span class="hs-pragma">coerce</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">coerce</span><span>
</span><a name="line-374"></a><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-375"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-377"></a><span class="hs-identifier">getSeq</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-378"></a><span class="hs-identifier">getSeq</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-379"></a><span>
</span><a name="line-380"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Foldable</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-381"></a><span>    </span><span class="hs-identifier">foldMap</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-operator">.#</span><span> </span><span class="hs-identifier">getElem</span><span class="hs-special">)</span><span> </span><span class="hs-operator">.#</span><span> </span><span class="hs-identifier">getSeq</span><span>
</span><a name="line-382"></a><span>    </span><span class="hs-identifier">foldr</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#Foldable"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#Foldable"><span class="hs-identifier hs-type">z</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-operator">.#</span><span> </span><span class="hs-identifier">getElem</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-operator">.#</span><span> </span><span class="hs-identifier">getSeq</span><span>
</span><a name="line-383"></a><span>    </span><a name="local-8214565720323789019"><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldMap"><span class="hs-identifier">foldl</span></a></a><span> </span><a name="local-8214565720323789019"><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldMap"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679058767"><a href="#local-6989586621679058767"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldMap"><span class="hs-identifier hs-var">foldl</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-operator">.^#</span><span> </span><span class="hs-identifier">getElem</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-operator">.#</span><span> </span><span class="hs-identifier">getSeq</span><span>
</span><a name="line-384"></a><span>
</span><a name="line-385"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__
</span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="hs-pragma">foldMap</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-387"></a><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="hs-pragma">foldr</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-388"></a><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="hs-pragma">foldl</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-389"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-391"></a><span>    </span><span class="hs-identifier">foldr'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldr'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-operator">.#</span><span> </span><span class="hs-identifier">getElem</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-operator">.#</span><span> </span><span class="hs-identifier">getSeq</span><span>
</span><a name="line-392"></a><span>    </span><span class="hs-identifier">foldl'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldl'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-operator">.^#</span><span> </span><span class="hs-identifier">getElem</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-operator">.#</span><span> </span><span class="hs-identifier">getSeq</span><span>
</span><a name="line-393"></a><span>
</span><a name="line-394"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__
</span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="hs-pragma">foldr'</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-396"></a><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="hs-pragma">foldl'</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-397"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-399"></a><span>    </span><span class="hs-identifier">foldr1</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">getElem</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldr1</span><span> </span><span class="hs-identifier">f'</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>
</span><a name="line-400"></a><span>      </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">f'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Elem</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span>
</span><a name="line-401"></a><span>
</span><a name="line-402"></a><span>    </span><span class="hs-identifier">foldl1</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">getElem</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldl1</span><span> </span><span class="hs-identifier">f'</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>
</span><a name="line-403"></a><span>      </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">f'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Elem</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span>
</span><a name="line-404"></a><span>
</span><a name="line-405"></a><span class="hs-cpp">#if MIN_VERSION_base(4,8,0)
</span><span>    </span><span class="hs-identifier">length</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">length</span><span>
</span><a name="line-407"></a><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">length</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-408"></a><span>    </span><a name="local-8214565720323789009"><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier">null</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#length"><span class="hs-identifier hs-var">null</span></a><span>
</span><a name="line-409"></a><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">null</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-410"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-412"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Traversable</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-413"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__
</span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="hs-pragma">traverse</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-415"></a><span class="hs-cpp">#endif
</span><span>    </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">EmptyT</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pure</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">EmptyT</span><span class="hs-special">)</span><span>
</span><a name="line-417"></a><span>    </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-identifier">f'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">x'</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-418"></a><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">x''</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#pure"><span class="hs-identifier hs-var">Elem</span></a><span> </span><span class="hs-identifier">x''</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><span class="hs-identifier">f'</span><span> </span><span class="hs-identifier">x'</span><span>
</span><a name="line-419"></a><span>    </span><span class="hs-identifier">traverse</span><span> </span><a name="local-6989586621679058687"><a href="#local-6989586621679058687"><span class="hs-identifier">f'</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-identifier">s'</span><span> </span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-var">pr'</span></a><span> </span><span class="hs-identifier">m'</span><span> </span><span class="hs-identifier">sf'</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-420"></a><span>        </span><span class="hs-identifier">liftA3</span><span>
</span><a name="line-421"></a><span>            </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">pr''</span><span> </span><span class="hs-identifier">m''</span><span> </span><span class="hs-identifier">sf''</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">s'</span><span> </span><span class="hs-identifier">pr''</span><span> </span><span class="hs-identifier">m''</span><span> </span><span class="hs-identifier">sf''</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-422"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier">traverseDigitE</span><span> </span><span class="hs-identifier">f'</span><span> </span><span class="hs-identifier">pr'</span><span class="hs-special">)</span><span>
</span><a name="line-423"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier">traverseTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">traverseNodeE</span><span> </span><a href="#local-6989586621679058691"><span class="hs-identifier hs-var">f'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679058764"><span class="hs-identifier hs-var">m'</span></a><span class="hs-special">)</span><span>
</span><a name="line-424"></a><span>            </span><span class="hs-special">(</span><a href="#local-6989586621679058696"><span class="hs-identifier hs-var">traverseDigitE</span></a><span> </span><a href="#local-6989586621679058690"><span class="hs-identifier hs-var">f'</span></a><span> </span><a href="#local-6989586621679058692"><span class="hs-identifier hs-var">sf'</span></a><span class="hs-special">)</span><span>
</span><a name="line-425"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-426"></a><span>        </span><span class="hs-identifier">traverseTree</span><span>
</span><a name="line-427"></a><span>            </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Applicative</span><span> </span><span class="hs-identifier">f</span><span>
</span><a name="line-428"></a><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-429"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-430"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-431"></a><span>        </span><span class="hs-identifier">traverseTree</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">_</span></a><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pure</span><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-432"></a><span>        </span><span class="hs-identifier">traverseTree</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Single</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span>
</span><a name="line-433"></a><span>        </span><a name="local-6989586621679058695"><a href="#local-6989586621679058695"><span class="hs-identifier">traverseTree</span></a></a><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#pure"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-434"></a><span>            </span><span class="hs-identifier">liftA3</span><span>
</span><a name="line-435"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span>
</span><a name="line-436"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier">traverseDigitN</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">pr</span><span class="hs-special">)</span><span>
</span><a name="line-437"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier">traverseTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">traverseNodeN</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span>
</span><a name="line-438"></a><span>                </span><span class="hs-special">(</span><a href="#local-6989586621679058697"><span class="hs-identifier hs-var">traverseDigitN</span></a><span> </span><a href="#local-6989586621679058717"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058719"><span class="hs-identifier hs-var">sf</span></a><span class="hs-special">)</span><span>
</span><a name="line-439"></a><span>        </span><span class="hs-identifier">traverseDigitE</span><span>
</span><a name="line-440"></a><span>            </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Applicative</span><span> </span><a href="#local-6989586621679058697"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-441"></a><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-442"></a><span>        </span><span class="hs-identifier">traverseDigitE</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-443"></a><span>            </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">a'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">One</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">a'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span>
</span><a name="line-444"></a><span>            </span><a name="local-6989586621679058696"><a href="#local-6989586621679058696"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679058696"><a href="#local-6989586621679058696"><span class="hs-identifier">a</span></a></a><span>
</span><a name="line-445"></a><span>        </span><span class="hs-identifier">traverseDigitE</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-var">Two</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-446"></a><span>            </span><span class="hs-identifier">liftA2</span><span>
</span><a name="line-447"></a><span>                </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">a'</span><span> </span><span class="hs-identifier">b'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Two</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a'</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">b'</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-448"></a><span>                </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#liftA2"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-449"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679058728"><a href="#local-6989586621679058728"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-450"></a><span>        </span><span class="hs-identifier">traverseDigitE</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-451"></a><span>            </span><span class="hs-identifier">liftA3</span><span>
</span><a name="line-452"></a><span>                </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">a'</span><span> </span><span class="hs-identifier">b'</span><span> </span><span class="hs-identifier">c'</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-453"></a><span>                      </span><span class="hs-identifier">Three</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a'</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">b'</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">c'</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-454"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679058734"><a href="#local-6989586621679058734"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-455"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-456"></a><span>                </span><span class="hs-special">(</span><a href="#local-6989586621679058730"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058731"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-457"></a><span>        </span><span class="hs-identifier">traverseDigitE</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-458"></a><span>            </span><span class="hs-identifier">liftA3</span><span>
</span><a name="line-459"></a><span>                </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">a'</span><span> </span><span class="hs-identifier">b'</span><span> </span><span class="hs-identifier">c'</span><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">d'</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Four</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a'</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">b'</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-var">Elem</span></a><span> </span><span class="hs-identifier">c'</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">d'</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-460"></a><span>                </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#liftA3"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-461"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679058742"><a href="#local-6989586621679058742"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-462"></a><span>                </span><span class="hs-special">(</span><a href="#local-6989586621679058737"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058738"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;*&gt;</span><span>
</span><a name="line-463"></a><span>                </span><span class="hs-special">(</span><a href="#local-6989586621679058737"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058739"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-464"></a><span>        </span><span class="hs-identifier">traverseDigitN</span><span>
</span><a name="line-465"></a><span>            </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Applicative</span><span> </span><span class="hs-identifier">f</span><span>
</span><a name="line-466"></a><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-467"></a><span>        </span><span class="hs-identifier">traverseDigitN</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">t</span><span>
</span><a name="line-468"></a><span>        </span><span class="hs-identifier">traverseNodeE</span><span>
</span><a name="line-469"></a><span>            </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Applicative</span><span> </span><span class="hs-identifier">f</span><span>
</span><a name="line-470"></a><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-471"></a><span>        </span><span class="hs-identifier">traverseNodeE</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node2</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-472"></a><span>            </span><span class="hs-identifier">liftA2</span><span>
</span><a name="line-473"></a><span>                </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679058698"><a href="#local-6989586621679058698"><span class="hs-identifier">a'</span></a></a><span> </span><span class="hs-identifier">b'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node2</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a'</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">b'</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-474"></a><span>                </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#liftA2"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-475"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679058752"><a href="#local-6989586621679058752"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-476"></a><span>        </span><span class="hs-identifier">traverseNodeE</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-477"></a><span>            </span><span class="hs-identifier">liftA3</span><span>
</span><a name="line-478"></a><span>                </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">a'</span><span> </span><span class="hs-identifier">b'</span><span> </span><span class="hs-identifier">c'</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-479"></a><span>                      </span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a'</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">b'</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">c'</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-480"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679058759"><a href="#local-6989586621679058759"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-481"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-482"></a><span>                </span><span class="hs-special">(</span><a href="#local-6989586621679058754"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058756"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-483"></a><span>        </span><span class="hs-identifier">traverseNodeN</span><span>
</span><a name="line-484"></a><span>            </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Applicative</span><span> </span><span class="hs-identifier">f</span><span>
</span><a name="line-485"></a><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-486"></a><span>        </span><span class="hs-identifier">traverseNodeN</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">t</span><span>
</span><a name="line-487"></a><span>
</span><a name="line-488"></a><span class="hs-keyword">instance</span><span> </span><a name="local-6989586621679058699"><a href="#local-6989586621679058699"><span class="hs-identifier">NFData</span></a></a><span> </span><a name="local-6989586621679058699"><a href="#local-6989586621679058699"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">NFData</span><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Traversable.html#traverse"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Traversable.html#traverse"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-489"></a><span>    </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-490"></a><span>
</span><a name="line-491"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Monad</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-492"></a><span>    </span><span class="hs-identifier">return</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pure</span><span>
</span><a name="line-493"></a><span>    </span><span class="hs-identifier">xs</span><span> </span><span class="hs-operator">&gt;&gt;=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Monad"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldl'</span><span> </span><span class="hs-identifier">add</span><span> </span><span class="hs-identifier">empty</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-494"></a><span>      </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">add</span><span> </span><span class="hs-identifier">ys</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ys</span><span> </span><span class="hs-operator">&gt;&lt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span>
</span><a name="line-495"></a><span>    </span><span class="hs-special">(</span><span class="hs-operator">&gt;&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator">*&gt;</span><span class="hs-special">)</span><span>
</span><a name="line-496"></a><span>
</span><a name="line-497"></a><span class="hs-comment">-- | @since 0.5.11</span><span>
</span><a name="line-498"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">MonadFix</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-499"></a><span>    </span><span class="hs-identifier">mfix</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mfixSeq</span><span>
</span><a name="line-500"></a><span>
</span><a name="line-501"></a><span class="hs-comment">-- This is just like the instance for lists, but we can take advantage of</span><span>
</span><a name="line-502"></a><span class="hs-comment">-- constant-time length and logarithmic-time indexing to speed things up.</span><span>
</span><a name="line-503"></a><span class="hs-comment">-- Using fromFunction, we make this about as lazy as we can.</span><span>
</span><a name="line-504"></a><span class="hs-identifier">mfixSeq</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-505"></a><span class="hs-identifier">mfixSeq</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fromFunction</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">length</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">err</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">k</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">fix</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">xk</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">xk</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">index</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">k</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-506"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-507"></a><span>    </span><a name="mfixSeq"><a href="Data.Sequence.Internal.html#mfixSeq"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;mfix for Data.Sequence.Seq applied to strict function&quot;</span><span>
</span><a name="line-508"></a><span>
</span><a name="line-509"></a><span class="hs-comment">-- | @since 0.5.4</span><span>
</span><a name="line-510"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Applicative</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-511"></a><span>    </span><span class="hs-identifier">pure</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">singleton</span><span>
</span><a name="line-512"></a><span>    </span><span class="hs-identifier">xs</span><span> </span><span class="hs-operator">*&gt;</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">ys</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cycleNTimes</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">ys</span><span>
</span><a name="line-513"></a><span>    </span><span class="hs-special">(</span><a name="local-3458764513820541680"><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#pure"><span class="hs-operator">&lt;*&gt;</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#singleton"><span class="hs-identifier hs-var">apSeq</span></a><span>
</span><a name="line-514"></a><span class="hs-cpp">#if MIN_VERSION_base(4,10,0)
</span><span>    </span><span class="hs-identifier">liftA2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">liftA2Seq</span><span>
</span><a name="line-516"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-518"></a><span class="hs-identifier">apSeq</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-519"></a><span class="hs-identifier">apSeq</span><span> </span><span class="hs-identifier">fs</span><span> </span><span class="hs-identifier">xs</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">xsFT</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">viewl</span><span> </span><span class="hs-identifier">fs</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-520"></a><span>  </span><span class="hs-identifier">EmptyL</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">empty</span><span>
</span><a name="line-521"></a><span>  </span><span class="hs-identifier">firstf</span><span> </span><a name="local-6989586621679059146"><a href="#local-6989586621679059146"><span class="hs-operator">:&lt;</span></a></a><span> </span><span class="hs-identifier">fs'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">viewr</span><span> </span><a href="Data.Sequence.Internal.html#viewl"><span class="hs-identifier hs-var">fs'</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-522"></a><span>    </span><span class="hs-identifier">EmptyR</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">firstf</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-523"></a><span>    </span><a name="local-6989586621679059148"><a href="#local-6989586621679059148"><span class="hs-identifier">Seq</span></a></a><span> </span><span class="hs-identifier">fs''FT</span><span> </span><span class="hs-operator">:&gt;</span><span> </span><span class="hs-identifier">lastf</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">rigidify</span><span> </span><span class="hs-identifier">xsFT</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-524"></a><span>         </span><span class="hs-identifier">RigidEmpty</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">empty</span><span>
</span><a name="line-525"></a><span>         </span><span class="hs-identifier">RigidOne</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679059151"><a href="#local-6989586621679059151"><span class="hs-identifier">Elem</span></a></a><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">fmap</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#rigidify"><span class="hs-operator hs-var">$</span></a><a href="Data.Sequence.Internal.html#rigidify"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">fs</span><span>
</span><a name="line-526"></a><span>         </span><a href="Data.Sequence.Internal.html#RigidEmpty"><span class="hs-identifier hs-var">RigidTwo</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><a href="Data.Sequence.Internal.html#empty"><span class="hs-identifier hs-var">x1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">x2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-527"></a><span>            </span><a href="Data.Sequence.Internal.html#RigidOne"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a href="Data.Sequence.Internal.html#RigidOne"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-identifier">ap2FT</span><span> </span><span class="hs-identifier">firstf</span><span> </span><span class="hs-identifier">fs''FT</span><span> </span><span class="hs-identifier">lastf</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">x2</span><span class="hs-special">)</span><span>
</span><a name="line-528"></a><span>         </span><span class="hs-identifier">RigidThree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">x1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">x2</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">x3</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-529"></a><span>            </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#ap2FT"><span class="hs-identifier hs-var">ap3FT</span></a><span> </span><a href="#local-6989586621679059148"><span class="hs-identifier hs-var">firstf</span></a><span> </span><a href="#local-6989586621679059150"><span class="hs-identifier hs-var">fs''FT</span></a><span> </span><a href="#local-6989586621679059151"><span class="hs-identifier hs-var">lastf</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059153"><span class="hs-identifier hs-var">x1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679059154"><span class="hs-identifier hs-var">x2</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">x3</span><span class="hs-special">)</span><span>
</span><a name="line-530"></a><span>         </span><a href="Data.Sequence.Internal.html#RigidThree"><span class="hs-identifier hs-var">RigidFull</span></a><span> </span><span class="hs-identifier">r</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">Rigid</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span> </span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-var">_m</span></a><span> </span><a name="local-6989586621679059156"><a href="#local-6989586621679059156"><span class="hs-identifier">sf</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><a name="local-6989586621679059157"><a href="#local-6989586621679059157"><span class="hs-operator">$</span></a></a><span>
</span><a name="line-531"></a><span>               </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#ap3FT"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator">*</span><span> </span><span class="hs-identifier">length</span><span> </span><a href="#local-6989586621679059150"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">)</span><span>
</span><a name="line-532"></a><span>                    </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">firstf</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">nodeToDigit</span><span> </span><span class="hs-identifier">pr</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-533"></a><span>                    </span><span class="hs-special">(</span><span class="hs-identifier">aptyMiddle</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">firstf</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">lastf</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">fs''FT</span><span> </span><span class="hs-identifier">r</span><span class="hs-special">)</span><span>
</span><a name="line-534"></a><span>                    </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><a href="#local-6989586621679059148"><span class="hs-identifier hs-var">lastf</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">nodeToDigit</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-535"></a><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">apSeq</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-536"></a><span>
</span><a name="line-537"></a><span class="hs-pragma">{-# RULES</span><span>
</span><a name="line-538"></a><span class="hs-pragma">&quot;ap/fmap1&quot;</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">ys</span><span> </span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">apSeq</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">fmapSeq</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">xs</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">ys</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">liftA2Seq</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">ys</span><span>
</span><a name="line-539"></a><span class="hs-pragma">&quot;ap/fmap2&quot;</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">gs</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">apSeq</span><span> </span><span class="hs-pragma">gs</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">fmapSeq</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">xs</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span>
</span><a name="line-540"></a><span>                              </span><span class="hs-pragma">liftA2Seq</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">x</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">x</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">gs</span><span> </span><span class="hs-pragma">xs</span><span>
</span><a name="line-541"></a><span class="hs-pragma">&quot;fmap/ap&quot;</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">gs</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">fmapSeq</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">gs</span><span> </span><span class="hs-pragma">`</span><span class="hs-pragma">apSeq</span><span class="hs-pragma">`</span><span> </span><span class="hs-pragma">xs</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span>
</span><a name="line-542"></a><span>                             </span><span class="hs-pragma">liftA2Seq</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">x</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">x</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">gs</span><span> </span><span class="hs-pragma">xs</span><span>
</span><a name="line-543"></a><span class="hs-pragma">&quot;fmap/liftA2&quot;</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">m</span><span> </span><span class="hs-pragma">n</span><span> </span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">fmapSeq</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">liftA2Seq</span><span> </span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">m</span><span> </span><span class="hs-pragma">n</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span>
</span><a name="line-544"></a><span>                       </span><span class="hs-pragma">liftA2Seq</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span class="hs-pragma">x</span><span> </span><span class="hs-pragma">y</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">x</span><span> </span><span class="hs-pragma">y</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">m</span><span> </span><span class="hs-pragma">n</span><span>
</span><a name="line-545"></a><span class="hs-pragma">&quot;liftA2/fmap1&quot;</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">m</span><span> </span><span class="hs-pragma">n</span><span> </span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">liftA2Seq</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">fmapSeq</span><span> </span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">m</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">n</span><span> </span><span class="hs-pragma">=</span><span>
</span><a name="line-546"></a><span>                       </span><span class="hs-pragma">liftA2Seq</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span class="hs-pragma">x</span><span> </span><span class="hs-pragma">y</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">x</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">y</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">m</span><span> </span><span class="hs-pragma">n</span><span>
</span><a name="line-547"></a><span class="hs-pragma">&quot;liftA2/fmap2&quot;</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">m</span><span> </span><span class="hs-pragma">n</span><span> </span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">liftA2Seq</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">m</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">fmapSeq</span><span> </span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">n</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span>
</span><a name="line-548"></a><span>                       </span><span class="hs-pragma">liftA2Seq</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span class="hs-pragma">x</span><span> </span><span class="hs-pragma">y</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">x</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">y</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">m</span><span> </span><span class="hs-pragma">n</span><span>
</span><a name="line-549"></a><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-550"></a><span>
</span><a name="line-551"></a><span class="hs-identifier">ap2FT</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-glyph">-&gt;</span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-552"></a><span class="hs-identifier">ap2FT</span><span> </span><span class="hs-identifier">firstf</span><span> </span><span class="hs-identifier">fs</span><span> </span><span class="hs-identifier">lastf</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-special">,</span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-553"></a><span>                 </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">fs</span><span> </span><span class="hs-operator">*</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-number">4</span><span class="hs-special">)</span><span>
</span><a name="line-554"></a><span>                      </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">Two</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-operator hs-type">$</span></a><span> </span><span class="hs-identifier">firstf</span><span> </span><a href="#local-6989586621679059098"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">firstf</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-555"></a><span>                      </span><span class="hs-special">(</span><span class="hs-identifier">mapMulFT</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node2</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">fs</span><span class="hs-special">)</span><span>
</span><a name="line-556"></a><span>                      </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">Two</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">lastf</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">lastf</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-557"></a><span>
</span><a name="line-558"></a><span class="hs-identifier">ap3FT</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-&gt;</span><a name="local-6989586621679059168"><a href="#local-6989586621679059168"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-559"></a><span class="hs-identifier">ap3FT</span><span> </span><span class="hs-identifier">firstf</span><span> </span><span class="hs-identifier">fs</span><span> </span><span class="hs-identifier">lastf</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><span class="hs-identifier">z</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">fs</span><span> </span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-operator hs-var">*</span></a><span> </span><span class="hs-number">3</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">6</span><span class="hs-special">)</span><span>
</span><a name="line-560"></a><span>                        </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">firstf</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">firstf</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">firstf</span><span> </span><span class="hs-identifier">z</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-561"></a><span>                        </span><span class="hs-special">(</span><span class="hs-identifier">mapMulFT</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node3</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">Elem</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">fs</span><span class="hs-special">)</span><span>
</span><a name="line-562"></a><span>                        </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Elem</span></a><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">lastf</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">lastf</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">lastf</span><span> </span><span class="hs-identifier">z</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-563"></a><span>
</span><a name="line-564"></a><span class="hs-identifier">lift2FT</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#mapMulFT"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-565"></a><span class="hs-identifier">lift2FT</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">firstx</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-identifier">lastx</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">y1</span></a><span class="hs-special">,</span><span class="hs-identifier">y2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-566"></a><span>                 </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-operator">*</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-number">4</span><span class="hs-special">)</span><span>
</span><a name="line-567"></a><span>                      </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-operator hs-type">$</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">firstx</span></a><span> </span><span class="hs-identifier">y1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-operator">$</span><span> </span><a href="#local-6989586621679059092"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-identifier">firstx</span><span> </span><span class="hs-identifier">y2</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-568"></a><span>                      </span><span class="hs-special">(</span><span class="hs-identifier">mapMulFT</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node2</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y2</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>
</span><a name="line-569"></a><span>                      </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">Two</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-operator">$</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-identifier">lastx</span><span> </span><span class="hs-identifier">y1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">lastx</span><span> </span><span class="hs-identifier">y2</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-570"></a><span>
</span><a name="line-571"></a><span class="hs-identifier">lift3FT</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#mapMulFT"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><a href="#local-6989586621679059178"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-572"></a><span class="hs-identifier">lift3FT</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">firstx</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-identifier">lastx</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">y1</span><span class="hs-special">,</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-var">y2</span></a><span class="hs-special">,</span><span class="hs-identifier">y3</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-573"></a><span>                 </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-operator">*</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-number">6</span><span class="hs-special">)</span><span>
</span><a name="line-574"></a><span>                      </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-operator hs-type">$</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-identifier">firstx</span><span> </span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">y1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><a href="#local-6989586621679059089"><span class="hs-operator hs-type">$</span></a><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">firstx</span><span> </span><span class="hs-identifier">y2</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-operator hs-type">$</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-identifier">firstx</span><span> </span><span class="hs-identifier">y3</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-575"></a><span>                      </span><span class="hs-special">(</span><span class="hs-identifier">mapMulFT</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node3</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y2</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y3</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>
</span><a name="line-576"></a><span>                      </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">lastx</span><span> </span><span class="hs-identifier">y1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">lastx</span><span> </span><span class="hs-identifier">y2</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">lastx</span><span> </span><span class="hs-identifier">y3</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-577"></a><span>
</span><a name="line-578"></a><span class="hs-identifier">liftA2Seq</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#mapMulFT"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-579"></a><span class="hs-identifier">liftA2Seq</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-identifier">ys</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">ysFT</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">viewl</span><span> </span><a href="#local-6989586621679059186"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-580"></a><span>  </span><span class="hs-identifier">EmptyL</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">empty</span><span>
</span><a name="line-581"></a><span>  </span><span class="hs-identifier">firstx</span><span> </span><span class="hs-operator">:&lt;</span><span> </span><span class="hs-identifier">xs'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">viewr</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">xs'</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-582"></a><span>    </span><span class="hs-identifier">EmptyR</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">firstx</span><span> </span><a name="local-6989586621679059194"><a href="#local-6989586621679059194"><span class="hs-operator">&lt;$&gt;</span></a></a><span> </span><span class="hs-identifier">ys</span><span>
</span><a name="line-583"></a><span>    </span><a href="Data.Sequence.Internal.html#EmptyL"><span class="hs-identifier hs-var">Seq</span></a><span> </span><span class="hs-identifier">xs''FT</span><span> </span><a href="Data.Sequence.Internal.html#empty"><span class="hs-operator hs-var">:&gt;</span></a><span> </span><span class="hs-identifier">lastx</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">rigidify</span><span> </span><span class="hs-identifier">ysFT</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-584"></a><span>      </span><span class="hs-identifier">RigidEmpty</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">empty</span><span>
</span><a name="line-585"></a><span>      </span><span class="hs-identifier">RigidOne</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059199"><span class="hs-identifier hs-var">Elem</span></a><span> </span><a href="#local-6989586621679059199"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-586"></a><span>      </span><span class="hs-identifier">RigidTwo</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><a name="local-6989586621679059202"><a href="#local-6989586621679059202"><span class="hs-identifier">y1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">y2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-587"></a><span>        </span><a href="Data.Sequence.Internal.html#RigidEmpty"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a href="Data.Sequence.Internal.html#RigidEmpty"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-identifier">lift2FT</span><span> </span><a href="Data.Sequence.Internal.html#empty"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-identifier">firstx</span><span> </span><span class="hs-identifier">xs''FT</span><span> </span><span class="hs-identifier">lastx</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">y1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">y2</span><span class="hs-special">)</span><span>
</span><a name="line-588"></a><span>      </span><span class="hs-identifier">RigidThree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">y1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">y2</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">y3</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-589"></a><span>        </span><a href="Data.Sequence.Internal.html#RigidTwo"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a href="Data.Sequence.Internal.html#RigidTwo"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-identifier">lift3FT</span><span> </span><a name="local-6989586621679059205"><a href="#local-6989586621679059205"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-identifier">firstx</span><span> </span><span class="hs-identifier">xs''FT</span><span> </span><span class="hs-identifier">lastx</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">y1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">y2</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">y3</span><span class="hs-special">)</span><span>
</span><a name="line-590"></a><span>      </span><span class="hs-identifier">RigidFull</span><span> </span><a href="Data.Sequence.Internal.html#lift2FT"><span class="hs-identifier hs-var">r</span></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">Rigid</span><span> </span><a href="#local-6989586621679059199"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679059199"><span class="hs-identifier hs-var">pr</span></a><span> </span><span class="hs-identifier">_m</span><span> </span><a href="#local-6989586621679059201"><span class="hs-identifier hs-var">sf</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059202"><span class="hs-identifier hs-var">Seq</span></a><span> </span><span class="hs-operator">$</span><span>
</span><a name="line-591"></a><span>        </span><a href="Data.Sequence.Internal.html#RigidThree"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#RigidThree"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator">*</span><span> </span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>
</span><a name="line-592"></a><span>             </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#lift3FT"><span class="hs-identifier hs-var">fmap</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059199"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-identifier">firstx</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">nodeToDigit</span><span> </span><span class="hs-identifier">pr</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-593"></a><span>             </span><span class="hs-special">(</span><span class="hs-identifier">aptyMiddle</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">firstx</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">lastx</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">lift_elem</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">xs''FT</span><span> </span><span class="hs-identifier">r</span><span class="hs-special">)</span><span>
</span><a name="line-594"></a><span>             </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#length"><span class="hs-identifier hs-var">fmap</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059192"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-identifier">lastx</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">nodeToDigit</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-595"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-596"></a><span>    </span><span class="hs-identifier">lift_elem</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#aptyMiddle"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#aptyMiddle"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059199"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Elem</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Elem</span><span> </span><a href="#local-6989586621679059202"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-597"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 708
</span><span>    </span><span class="hs-identifier">lift_elem</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">coerce</span><span>
</span><a name="line-599"></a><span class="hs-cpp">#else
</span><span>    </span><span class="hs-identifier">lift_elem</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Elem</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span>
</span><a name="line-601"></a><span class="hs-cpp">#endif
</span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">liftA2Seq</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-603"></a><span>
</span><a name="line-604"></a><span>
</span><a name="line-605"></a><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">Rigidified</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">RigidEmpty</span><span>
</span><a name="line-606"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">RigidOne</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-607"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">RigidTwo</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-608"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><a name="RigidEmpty"><a href="Data.Sequence.Internal.html#RigidEmpty"><span class="hs-identifier">RigidThree</span></a></a><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-609"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">RigidFull</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Rigid</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-610"></a><span class="hs-cpp">#ifdef TESTING
</span><span>                  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier">Show</span><span>
</span><a name="line-612"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-614"></a><span class="hs-comment">-- | A finger tree whose top level has only Two and/or Three digits, and whose</span><span>
</span><a name="line-615"></a><span class="hs-comment">-- other levels have only One and Two digits. A Rigid tree is precisely what one</span><span>
</span><a name="line-616"></a><span class="hs-comment">-- gets by unzipping/inverting a 2-3 tree, so it is precisely what we need to</span><span>
</span><a name="line-617"></a><span class="hs-comment">-- turn a finger tree into in order to transform it into a 2-3 tree.</span><span>
</span><a name="line-618"></a><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">Rigid</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Rigid</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="hs-identifier">Digit23</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Thin</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="hs-identifier">Digit23</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-619"></a><span class="hs-cpp">#ifdef TESTING
</span><span>             </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier">Show</span><span>
</span><a name="line-621"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-623"></a><span class="hs-comment">-- | A finger tree whose digits are all ones and twos</span><span>
</span><a name="line-624"></a><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">Thin</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EmptyTh</span><span>
</span><a name="line-625"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">SingleTh</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-626"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">DeepTh</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="hs-identifier">Digit12</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Thin</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="hs-identifier">Digit12</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-627"></a><span class="hs-cpp">#ifdef TESTING
</span><span>            </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier">Show</span><span>
</span><a name="line-629"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-631"></a><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">Digit12</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">One12</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">Two12</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-632"></a><span class="hs-cpp">#ifdef TESTING
</span><span>        </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier">Show</span><span>
</span><a name="line-634"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-636"></a><span class="hs-comment">-- | Sometimes, we want to emphasize that we are viewing a node as a top-level</span><span>
</span><a name="line-637"></a><span class="hs-comment">-- digit of a 'Rigid' tree.</span><span>
</span><a name="line-638"></a><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Digit23</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-639"></a><span>
</span><a name="line-640"></a><span class="hs-comment">-- | 'aptyMiddle' does most of the hard work of computing @fs&lt;*&gt;xs@.  It</span><span>
</span><a name="line-641"></a><span class="hs-comment">-- produces the center part of a finger tree, with a prefix corresponding to</span><span>
</span><a name="line-642"></a><span class="hs-comment">-- the prefix of @xs@ and a suffix corresponding to the suffix of @xs@ omitted;</span><span>
</span><a name="line-643"></a><span class="hs-comment">-- the missing suffix and prefix are added by the caller.  For the recursive</span><span>
</span><a name="line-644"></a><span class="hs-comment">-- call, it squashes the prefix and the suffix into the center tree. Once it</span><span>
</span><a name="line-645"></a><span class="hs-comment">-- gets to the bottom, it turns the tree into a 2-3 tree, applies 'mapMulFT' to</span><span>
</span><a name="line-646"></a><span class="hs-comment">-- produce the main body, and glues all the pieces together.</span><span>
</span><a name="line-647"></a><span class="hs-comment">--</span><span>
</span><a name="line-648"></a><span class="hs-comment">-- 'map23' itself is a bit horrifying because of the nested types involved. Its</span><span>
</span><a name="line-649"></a><span class="hs-comment">-- job is to map over the *elements* of a 2-3 tree, rather than the subtrees.</span><span>
</span><a name="line-650"></a><span class="hs-comment">-- If we used a higher-order nested type with MPTC, we could probably use a</span><span>
</span><a name="line-651"></a><span class="hs-comment">-- class, but as it is we have to build up 'map23' explicitly through the</span><span>
</span><a name="line-652"></a><span class="hs-comment">-- recursion.</span><span>
</span><a name="line-653"></a><span class="hs-identifier">aptyMiddle</span><span>
</span><a name="line-654"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-655"></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-656"></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-657"></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-658"></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Rigid</span><span> </span><a href="#local-6989586621679059084"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-659"></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-660"></a><span>
</span><a name="line-661"></a><span class="hs-comment">-- Not at the bottom yet</span><span>
</span><a name="line-662"></a><span>
</span><a name="line-663"></a><span class="hs-identifier">aptyMiddle</span><span> </span><span class="hs-identifier">firstf</span><span>
</span><a name="line-664"></a><span>           </span><span class="hs-identifier">lastf</span><span>
</span><a name="line-665"></a><span>           </span><span class="hs-identifier">map23</span><span>
</span><a name="line-666"></a><span>           </span><a name="local-6989586621679059215"><a href="#local-6989586621679059215"><span class="hs-identifier">fs</span></a></a><span>
</span><a name="line-667"></a><span>           </span><span class="hs-special">(</span><span class="hs-identifier">Rigid</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DeepTh</span><span> </span><span class="hs-identifier">sm</span><span> </span><span class="hs-identifier">prm</span><span> </span><span class="hs-identifier">mm</span><span> </span><span class="hs-identifier">sfm</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span>
</span><a name="line-668"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679059217"><a href="#local-6989586621679059217"><span class="hs-identifier">sm</span></a></a><span> </span><a name="local-6989586621679059217"><a href="#local-6989586621679059217"><span class="hs-operator">+</span></a></a><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-operator">*</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">fs</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- note: sm = s - size pr - size sf</span><span>
</span><a name="line-669"></a><span>           </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">firstf</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">digit12ToDigit</span><span> </span><span class="hs-identifier">prm</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-670"></a><span>           </span><span class="hs-special">(</span><span class="hs-identifier">aptyMiddle</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#DeepTh"><span class="hs-identifier hs-var">fmap</span></a><span> </span><span class="hs-identifier">firstf</span><span class="hs-special">)</span><span>
</span><a name="line-671"></a><span>                       </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">lastf</span><span class="hs-special">)</span><span>
</span><a name="line-672"></a><span>                       </span><span class="hs-special">(</span><a href="#local-6989586621679059215"><span class="hs-identifier hs-var">fmap</span></a><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">map23</span><span class="hs-special">)</span><span>
</span><a name="line-673"></a><span>                       </span><span class="hs-identifier">fs</span><span>
</span><a name="line-674"></a><span>                       </span><span class="hs-special">(</span><span class="hs-identifier">Rigid</span><span> </span><a href="#local-6989586621679059216"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">squashL</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">prm</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">mm</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">squashR</span><span> </span><span class="hs-identifier">sfm</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-675"></a><span>           </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">lastf</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">digit12ToDigit</span><span> </span><span class="hs-identifier">sfm</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-676"></a><span>
</span><a name="line-677"></a><span class="hs-comment">-- At the bottom</span><span>
</span><a name="line-678"></a><span>
</span><a name="line-679"></a><span class="hs-identifier">aptyMiddle</span><span> </span><span class="hs-identifier">firstf</span><span>
</span><a name="line-680"></a><span>           </span><span class="hs-identifier">lastf</span><span>
</span><a name="line-681"></a><span>           </span><span class="hs-identifier">map23</span><span>
</span><a name="line-682"></a><span>           </span><a name="local-6989586621679059226"><a href="#local-6989586621679059226"><span class="hs-identifier">fs</span></a></a><span>
</span><a name="line-683"></a><span>           </span><span class="hs-special">(</span><span class="hs-identifier">Rigid</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">EmptyTh</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span>
</span><a name="line-684"></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">deep</span><span>
</span><a name="line-685"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">firstf</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-686"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier">mapMulFT</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><a name="local-6989586621679059232"><a href="#local-6989586621679059232"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map23</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">converted</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">fs</span><span class="hs-special">)</span><span>
</span><a name="line-687"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">lastf</span><span> </span><span class="hs-identifier">pr</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-688"></a><span>   </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">converted</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">node2</span><span> </span><a href="#local-6989586621679059226"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679059232"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-689"></a><span>
</span><a name="line-690"></a><span class="hs-identifier">aptyMiddle</span><span> </span><span class="hs-identifier">firstf</span><span>
</span><a name="line-691"></a><span>           </span><a name="local-6989586621679059233"><a href="#local-6989586621679059233"><span class="hs-identifier">lastf</span></a></a><span>
</span><a name="line-692"></a><span>           </span><span class="hs-identifier">map23</span><span>
</span><a name="line-693"></a><span>           </span><a name="local-6989586621679059235"><a href="#local-6989586621679059235"><span class="hs-identifier">fs</span></a></a><span>
</span><a name="line-694"></a><span>           </span><span class="hs-special">(</span><span class="hs-identifier">Rigid</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SingleTh</span><span> </span><span class="hs-identifier">q</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span>
</span><a name="line-695"></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">deep</span><span>
</span><a name="line-696"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">firstf</span><span> </span><span class="hs-identifier">q</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">firstf</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-697"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier">mapMulFT</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#SingleTh"><span class="hs-identifier hs-var">Elem</span></a><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map23</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">converted</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">fs</span><span class="hs-special">)</span><span>
</span><a name="line-698"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">lastf</span><span> </span><span class="hs-identifier">pr</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">lastf</span><span> </span><span class="hs-identifier">q</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-699"></a><span>   </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">converted</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">node3</span><span> </span><a href="#local-6989586621679059235"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679059241"><span class="hs-identifier hs-var">q</span></a><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-700"></a><span>
</span><a name="line-701"></a><span class="hs-identifier">digit12ToDigit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Digit12</span><span> </span><a href="#local-6989586621679059236"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-702"></a><span class="hs-identifier">digit12ToDigit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One12</span><span> </span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-703"></a><span class="hs-identifier">digit12ToDigit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two12</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-704"></a><span>
</span><a name="line-705"></a><span class="hs-comment">-- Squash the first argument down onto the left side of the second.</span><span>
</span><a name="line-706"></a><span class="hs-identifier">squashL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Digit23</span><span> </span><a href="Data.Sequence.Internal.html#Two12"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit12</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit23</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-707"></a><span class="hs-identifier">squashL</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One12</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">node2</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">n</span><span>
</span><a name="line-708"></a><span class="hs-identifier">squashL</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two12</span><span> </span><span class="hs-identifier">n1</span><span> </span><span class="hs-identifier">n2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">node3</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">n1</span><span> </span><span class="hs-identifier">n2</span><span>
</span><a name="line-709"></a><span>
</span><a name="line-710"></a><span class="hs-comment">-- Squash the second argument down onto the right side of the first</span><span>
</span><a name="line-711"></a><span class="hs-identifier">squashR</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Digit12</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit23</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit23</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-712"></a><span class="hs-identifier">squashR</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One12</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">node2</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">m</span><span>
</span><a name="line-713"></a><span class="hs-identifier">squashR</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two12</span><span> </span><span class="hs-identifier">n1</span><span> </span><span class="hs-identifier">n2</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">node3</span><span> </span><span class="hs-identifier">n1</span><span> </span><span class="hs-identifier">n2</span><span> </span><span class="hs-identifier">m</span><span>
</span><a name="line-714"></a><span>
</span><a name="line-715"></a><span>
</span><a name="line-716"></a><span class="hs-comment">-- | /O(m*n)/ (incremental) Takes an /O(m)/ function and a finger tree of size</span><span>
</span><a name="line-717"></a><span class="hs-comment">-- /n/ and maps the function over the tree leaves. Unlike the usual 'fmap', the</span><span>
</span><a name="line-718"></a><span class="hs-comment">-- function is applied to the &quot;leaves&quot; of the 'FingerTree' (i.e., given a</span><span>
</span><a name="line-719"></a><span class="hs-comment">-- @FingerTree (Elem a)@, it applies the function to elements of type @Elem</span><span>
</span><a name="line-720"></a><span class="hs-comment">-- a@), replacing the leaves with subtrees of at least the same height, e.g.,</span><span>
</span><a name="line-721"></a><span class="hs-comment">-- @Node(Node(Elem y))@. The multiplier argument serves to make the annotations</span><span>
</span><a name="line-722"></a><span class="hs-comment">-- match up properly.</span><span>
</span><a name="line-723"></a><span class="hs-identifier">mapMulFT</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-724"></a><span class="hs-identifier">mapMulFT</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-725"></a><span class="hs-identifier">mapMulFT</span><span> </span><span class="hs-identifier">_mul</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Single</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-726"></a><span class="hs-identifier">mapMulFT</span><span> </span><span class="hs-identifier">mul</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">mul</span><span> </span><span class="hs-operator">*</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">fmap</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-identifier">pr</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mapMulFT</span><span> </span><span class="hs-identifier">mul</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mapMulNode</span><span> </span><span class="hs-identifier">mul</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span>
</span><a name="line-727"></a><span>
</span><a name="line-728"></a><span class="hs-identifier">mapMulNode</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-729"></a><span class="hs-identifier">mapMulNode</span><span> </span><span class="hs-identifier">mul</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node2</span><span> </span><a name="local-6989586621679059264"><a href="#local-6989586621679059264"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679059265"><a href="#local-6989586621679059265"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059266"><a href="#local-6989586621679059266"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Node2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mul</span><span> </span><a href="#local-6989586621679059263"><span class="hs-operator hs-var">*</span></a><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059264"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-730"></a><span class="hs-identifier">mapMulNode</span><span> </span><span class="hs-identifier">mul</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Node3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mul</span><span> </span><span class="hs-operator">*</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-731"></a><span>
</span><a name="line-732"></a><span class="hs-comment">-- | /O(log n)/ (incremental) Takes the extra flexibility out of a 'FingerTree'</span><span>
</span><a name="line-733"></a><span class="hs-comment">-- to make it a genuine 2-3 finger tree. The result of 'rigidify' will have</span><span>
</span><a name="line-734"></a><span class="hs-comment">-- only two and three digits at the top level and only one and two</span><span>
</span><a name="line-735"></a><span class="hs-comment">-- digits elsewhere. If the tree has fewer than four elements, 'rigidify'</span><span>
</span><a name="line-736"></a><span class="hs-comment">-- will simply extract them, and will not build a tree.</span><span>
</span><a name="line-737"></a><span class="hs-identifier">rigidify</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Rigidified</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-738"></a><span class="hs-comment">-- The patterns below just fix up the top level of the tree; 'rigidify'</span><span>
</span><a name="line-739"></a><span class="hs-comment">-- delegates the hard work to 'thin'.</span><span>
</span><a name="line-740"></a><span>
</span><a name="line-741"></a><span class="hs-identifier">rigidify</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">RigidEmpty</span><span>
</span><a name="line-742"></a><span>
</span><a name="line-743"></a><span class="hs-identifier">rigidify</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">q</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">RigidOne</span><span> </span><span class="hs-identifier">q</span><span>
</span><a name="line-744"></a><span>
</span><a name="line-745"></a><span class="hs-comment">-- The left digit is Two or Three</span><span>
</span><a name="line-746"></a><span class="hs-identifier">rigidify</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><a href="Data.Sequence.Internal.html#RigidOne"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="Data.Sequence.Internal.html#RigidOne"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#RigidOne"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">rigidifyRight</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">node2</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-747"></a><span class="hs-identifier">rigidify</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">rigidifyRight</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">node3</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-748"></a><span>
</span><a name="line-749"></a><span class="hs-comment">-- The left digit is Four</span><span>
</span><a name="line-750"></a><span class="hs-identifier">rigidify</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679059284"><a href="#local-6989586621679059284"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Four</span></a><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">rigidifyRight</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">node2</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">node2</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">d</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">consTree</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-751"></a><span>
</span><a name="line-752"></a><span class="hs-comment">-- The left digit is One</span><span>
</span><a name="line-753"></a><span class="hs-identifier">rigidify</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679059290"><a href="#local-6989586621679059290"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">One</span></a><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679059292"><a href="#local-6989586621679059292"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">viewLTree</span><span> </span><a href="Data.Sequence.Internal.html#rigidifyRight"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-754"></a><span>   </span><span class="hs-identifier">ConsLTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node2</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">rigidifyRight</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">node3</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m'</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-755"></a><span>   </span><span class="hs-identifier">ConsLTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">rigidifyRight</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">node2</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">node2</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">d</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">consTree</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">m'</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-756"></a><span>   </span><span class="hs-identifier">EmptyLTree</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">sf</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-757"></a><span>     </span><a href="Data.Sequence.Internal.html#ConsLTree"><span class="hs-identifier hs-var">One</span></a><span> </span><a href="Data.Sequence.Internal.html#ConsLTree"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">RigidTwo</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-758"></a><span>     </span><a href="Data.Sequence.Internal.html#ConsLTree"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="Data.Sequence.Internal.html#ConsLTree"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="Data.Sequence.Internal.html#ConsLTree"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">RigidThree</span><span> </span><span class="hs-identifier">a</span><span> </span><a name="local-6989586621679059307"><a href="#local-6989586621679059307"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-759"></a><span>     </span><a href="Data.Sequence.Internal.html#EmptyLTree"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="Data.Sequence.Internal.html#EmptyLTree"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">d</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">RigidFull</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">Rigid</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">node2</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyTh</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">node2</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span>
</span><a name="line-760"></a><span>     </span><span class="hs-identifier">Four</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span> </span><a href="Data.Sequence.Internal.html#RigidTwo"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="Data.Sequence.Internal.html#RigidTwo"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">RigidFull</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">Rigid</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">node3</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyTh</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">node2</span><span> </span><span class="hs-identifier">d</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span>
</span><a name="line-761"></a><span>
</span><a name="line-762"></a><span class="hs-comment">-- | /O(log n)/ (incremental) Takes a tree whose left side has been rigidified</span><span>
</span><a name="line-763"></a><span class="hs-comment">-- and finishes the job.</span><span>
</span><a name="line-764"></a><span class="hs-identifier">rigidifyRight</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit23</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Rigidified</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-765"></a><span>
</span><a name="line-766"></a><span class="hs-comment">-- The right digit is Two, Three, or Four</span><span>
</span><a name="line-767"></a><span class="hs-identifier">rigidifyRight</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><a href="Data.Sequence.Internal.html#Digit23"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="Data.Sequence.Internal.html#Digit23"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">RigidFull</span><span> </span><span class="hs-operator">$</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">Rigid</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">thin</span><span> </span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">node2</span><span> </span><span class="hs-identifier">a</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-768"></a><span class="hs-identifier">rigidifyRight</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">RigidFull</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">Rigid</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">thin</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">node3</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-769"></a><span class="hs-identifier">rigidifyRight</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">RigidFull</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">Rigid</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">thin</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">snocTree</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">node2</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">node2</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span>
</span><a name="line-770"></a><span>
</span><a name="line-771"></a><span class="hs-comment">-- The right digit is One</span><span>
</span><a name="line-772"></a><span class="hs-identifier">rigidifyRight</span><span> </span><a name="local-6989586621679059329"><a href="#local-6989586621679059329"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679059330"><a href="#local-6989586621679059330"><span class="hs-identifier">pr</span></a></a><span> </span><a name="local-6989586621679059331"><a href="#local-6989586621679059331"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">One</span></a><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">viewRTree</span><span> </span><a href="Data.Sequence.Internal.html#RigidFull"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-773"></a><span>    </span><span class="hs-identifier">SnocRTree</span><span> </span><span class="hs-identifier">m'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node2</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">RigidFull</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">Rigid</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">thin</span><span> </span><span class="hs-identifier">m'</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">node3</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span>
</span><a name="line-774"></a><span>    </span><span class="hs-identifier">SnocRTree</span><span> </span><span class="hs-identifier">m'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">RigidFull</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">Rigid</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">thin</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">m'</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">snocTree</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">node2</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">node2</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span>
</span><a name="line-775"></a><span>    </span><span class="hs-identifier">EmptyRTree</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">pr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-776"></a><span>      </span><a href="Data.Sequence.Internal.html#SnocRTree"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a href="Data.Sequence.Internal.html#SnocRTree"><span class="hs-identifier hs-var">_</span></a><span> </span><a name="local-6989586621679059340"><a href="#local-6989586621679059340"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">RigidThree</span><span> </span><span class="hs-identifier">a</span><span> </span><a href="Data.Sequence.Internal.html#RigidFull"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="Data.Sequence.Internal.html#RigidFull"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-777"></a><span>      </span><a href="Data.Sequence.Internal.html#SnocRTree"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a href="Data.Sequence.Internal.html#SnocRTree"><span class="hs-identifier hs-var">_</span></a><span> </span><a name="local-6989586621679059343"><a href="#local-6989586621679059343"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-identifier">b</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">RigidFull</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">Rigid</span><span> </span><a href="Data.Sequence.Internal.html#RigidFull"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">node2</span><span> </span><a href="Data.Sequence.Internal.html#Rigid"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="Data.Sequence.Internal.html#Rigid"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyTh</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">node2</span><span> </span><a href="Data.Sequence.Internal.html#snocTree"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="Data.Sequence.Internal.html#snocTree"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-778"></a><span>
</span><a name="line-779"></a><span class="hs-comment">-- | /O(log n)/ (incremental) Rejigger a finger tree so the digits are all ones</span><span>
</span><a name="line-780"></a><span class="hs-comment">-- and twos.</span><span>
</span><a name="line-781"></a><span class="hs-identifier">thin</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Sized</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Thin</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-782"></a><span class="hs-comment">-- Note that 'thin12' will produce a 'DeepTh' constructor immediately before</span><span>
</span><a name="line-783"></a><span class="hs-comment">-- recursively calling 'thin'.</span><span>
</span><a name="line-784"></a><span class="hs-identifier">thin</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EmptyTh</span><span>
</span><a name="line-785"></a><span class="hs-identifier">thin</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">SingleTh</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-786"></a><span class="hs-identifier">thin</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-787"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">pr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-788"></a><span>    </span><span class="hs-identifier">One</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">thin12</span><span> </span><a href="Data.Sequence.Internal.html#SingleTh"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">One12</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-789"></a><span>    </span><span class="hs-identifier">Two</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">thin12</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two12</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-790"></a><span>    </span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">thin12</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One12</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">node2</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">consTree</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-791"></a><span>    </span><span class="hs-identifier">Four</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><a href="Data.Sequence.Internal.html#thin12"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="Data.Sequence.Internal.html#thin12"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">thin12</span><span> </span><a href="Data.Sequence.Internal.html#One12"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two12</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">node2</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">d</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">consTree</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-792"></a><span>
</span><a name="line-793"></a><span class="hs-identifier">thin12</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Sized</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Sequence.Internal.html#thin12"><span class="hs-identifier hs-var">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit12</span><span> </span><a href="#local-6989586621679059360"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#consTree"><span class="hs-identifier hs-var">Node</span></a><span> </span><a href="Data.Sequence.Internal.html#consTree"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Thin</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-794"></a><span class="hs-identifier">thin12</span><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">DeepTh</span><span> </span><a href="Data.Sequence.Internal.html#Two12"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="Data.Sequence.Internal.html#Two12"><span class="hs-identifier hs-var">pr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">thin</span><span> </span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One12</span><span> </span><a href="Data.Sequence.Internal.html#consTree"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-795"></a><span class="hs-identifier">thin12</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">DeepTh</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">thin</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two12</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-796"></a><span class="hs-identifier">thin12</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span> </span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">DeepTh</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">thin</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-operator hs-type">$</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">snocTree</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">node2</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One12</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-797"></a><a name="thin12"><a href="Data.Sequence.Internal.html#thin12"><span class="hs-identifier">thin12</span></a></a><span> </span><a name="local-6989586621679059367"><a href="#local-6989586621679059367"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679059368"><a href="#local-6989586621679059368"><span class="hs-identifier">pr</span></a></a><span> </span><a name="local-6989586621679059369"><a href="#local-6989586621679059369"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><a href="Data.Sequence.Internal.html#DeepTh"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="Data.Sequence.Internal.html#DeepTh"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">DeepTh</span><span> </span><a href="Data.Sequence.Internal.html#thin"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">thin</span><span> </span><a href="Data.Sequence.Internal.html#One12"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">snocTree</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">node2</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two12</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span>
</span><a name="line-798"></a><span>
</span><a name="line-799"></a><span class="hs-comment">-- | \( O(n) \). Intersperse an element between the elements of a sequence.</span><span>
</span><a name="line-800"></a><span class="hs-comment">--</span><span>
</span><a name="line-801"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-802"></a><span class="hs-comment">-- intersperse a empty = empty</span><span>
</span><a name="line-803"></a><span class="hs-comment">-- intersperse a (singleton x) = singleton x</span><span>
</span><a name="line-804"></a><span class="hs-comment">-- intersperse a (fromList [x,y]) = fromList [x,a,y]</span><span>
</span><a name="line-805"></a><span class="hs-comment">-- intersperse a (fromList [x,y,z]) = fromList [x,a,y,a,z]</span><span>
</span><a name="line-806"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-807"></a><span class="hs-comment">--</span><span>
</span><a name="line-808"></a><span class="hs-comment">-- @since 0.5.8</span><span>
</span><a name="line-809"></a><span class="hs-identifier">intersperse</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-810"></a><span class="hs-identifier">intersperse</span><span> </span><span class="hs-identifier">y</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">viewl</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-811"></a><span>  </span><span class="hs-identifier">EmptyL</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">empty</span><span>
</span><a name="line-812"></a><span>  </span><span class="hs-identifier">p</span><span> </span><span class="hs-operator">:&lt;</span><span> </span><span class="hs-identifier">ps</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-operator">&lt;|</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ps</span><span> </span><span class="hs-operator">&lt;**&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">const</span><span> </span><span class="hs-identifier">y</span><span> </span><span class="hs-operator">&lt;|</span><span> </span><span class="hs-identifier">singleton</span><span> </span><span class="hs-identifier">id</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-813"></a><span class="hs-comment">-- We used to use</span><span>
</span><a name="line-814"></a><span class="hs-comment">--</span><span>
</span><a name="line-815"></a><span class="hs-comment">-- intersperse y xs = drop 1 $ xs &lt;**&gt; (const y &lt;| singleton id)</span><span>
</span><a name="line-816"></a><span class="hs-comment">--</span><span>
</span><a name="line-817"></a><span class="hs-comment">-- but if length xs = ((maxBound :: Int) `quot` 2) + 1 then</span><span>
</span><a name="line-818"></a><span class="hs-comment">--</span><span>
</span><a name="line-819"></a><span class="hs-comment">-- length (xs &lt;**&gt; (const y &lt;| singleton id)) will wrap around to negative</span><span>
</span><a name="line-820"></a><span class="hs-comment">-- and the drop won't work. The new implementation can produce a result</span><span>
</span><a name="line-821"></a><span class="hs-comment">-- right up to maxBound :: Int</span><span>
</span><a name="line-822"></a><span>
</span><a name="line-823"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">MonadPlus</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-824"></a><span>    </span><span class="hs-identifier">mzero</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">empty</span><span>
</span><a name="line-825"></a><span>    </span><span class="hs-identifier">mplus</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator">&gt;&lt;</span><span class="hs-special">)</span><span>
</span><a name="line-826"></a><span>
</span><a name="line-827"></a><span class="hs-comment">-- | @since 0.5.4</span><span>
</span><a name="line-828"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Alternative</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-829"></a><span>    </span><span class="hs-identifier">empty</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">empty</span><span>
</span><a name="line-830"></a><span>    </span><span class="hs-special">(</span><span class="hs-operator">&lt;|&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator">&gt;&lt;</span><span class="hs-special">)</span><span>
</span><a name="line-831"></a><span>
</span><a name="line-832"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Eq</span><span> </span><a href="Data.Sequence.Internal.html#empty"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Eq</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-833"></a><span>    </span><a name="local-8214565720323790453"><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%3C%7C%3E"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-8214565720323790453"><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%3C%7C%3E"><span class="hs-operator">==</span></a></a><span> </span><span class="hs-identifier">ys</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">ys</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">toList</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">toList</span><span> </span><span class="hs-identifier">ys</span><span>
</span><a name="line-834"></a><span>
</span><a name="line-835"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Ord</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Ord</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-836"></a><span>    </span><span class="hs-identifier">compare</span><span> </span><span class="hs-identifier">xs</span><span> </span><a href="Data.Sequence.Internal.html#length"><span class="hs-identifier hs-var">ys</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">compare</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">toList</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#toList"><span class="hs-identifier hs-var">toList</span></a><span> </span><a href="#local-6989586621679058676"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span>
</span><a name="line-837"></a><span>
</span><a name="line-838"></a><span class="hs-cpp">#ifdef TESTING
</span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Show</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Show</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#toList"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-840"></a><span>    </span><span class="hs-identifier">showsPrec</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">showsPrec</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">x</span><span>
</span><a name="line-841"></a><span class="hs-cpp">#else
</span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Show</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Show</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-843"></a><span>    </span><span class="hs-identifier">showsPrec</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">showParen</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">p</span><span> </span><span class="hs-operator">&gt;</span><span> </span><span class="hs-number">10</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span>
</span><a name="line-844"></a><span>        </span><span class="hs-identifier">showString</span><span> </span><span class="hs-string">&quot;fromList &quot;</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">shows</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">toList</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>
</span><a name="line-845"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-847"></a><span class="hs-cpp">#if MIN_VERSION_base(4,9,0)
</span><span class="hs-comment">-- | @since 0.5.9</span><span>
</span><a name="line-849"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Show1</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-850"></a><span>  </span><span class="hs-identifier">liftShowsPrec</span><span> </span><span class="hs-identifier">_shwsPrc</span><span> </span><span class="hs-identifier">shwList</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">showParen</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">p</span><span> </span><span class="hs-operator">&gt;</span><span> </span><span class="hs-number">10</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span>
</span><a name="line-851"></a><span>        </span><span class="hs-identifier">showString</span><span> </span><span class="hs-string">&quot;fromList &quot;</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">shwList</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">toList</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>
</span><a name="line-852"></a><span>
</span><a name="line-853"></a><span class="hs-comment">-- | @since 0.5.9</span><span>
</span><a name="line-854"></a><span class="hs-keyword">instance</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Show.html#showString"><span class="hs-identifier hs-var">Eq1</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Show.html#showString"><span class="hs-identifier hs-var">Seq</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-855"></a><span>    </span><span class="hs-identifier">liftEq</span><span> </span><span class="hs-identifier">eq</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-identifier">ys</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">ys</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">liftEq</span><span> </span><span class="hs-identifier">eq</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">toList</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">toList</span><span> </span><span class="hs-identifier">ys</span><span class="hs-special">)</span><span>
</span><a name="line-856"></a><span>
</span><a name="line-857"></a><span class="hs-comment">-- | @since 0.5.9</span><span>
</span><a name="line-858"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Ord1</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-859"></a><span>    </span><span class="hs-identifier">liftCompare</span><span> </span><span class="hs-identifier">cmp</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-identifier">ys</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">liftCompare</span><span> </span><span class="hs-identifier">cmp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">toList</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">toList</span><span> </span><span class="hs-identifier">ys</span><span class="hs-special">)</span><span>
</span><a name="line-860"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-862"></a><span class="hs-keyword">instance</span><span> </span><a name="local-8214565720323787014"><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Functor.Classes.html#liftCompare"><span class="hs-identifier">Read</span></a></a><span> </span><a name="local-8214565720323787014"><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Functor.Classes.html#liftCompare"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Read</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Functor.Classes.html#liftCompare"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-863"></a><span class="hs-cpp">#ifdef __GLASGOW_HASKELL__
</span><span>    </span><span class="hs-identifier">readPrec</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">parens</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">prec</span><span> </span><span class="hs-number">10</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-865"></a><span>        </span><span class="hs-identifier">Ident</span><span> </span><span class="hs-string">&quot;fromList&quot;</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">lexP</span><span>
</span><a name="line-866"></a><span>        </span><span class="hs-identifier">xs</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">readPrec</span><span>
</span><a name="line-867"></a><span>        </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fromList</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Text.ParserCombinators.ReadPrec.html#prec"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-868"></a><span>
</span><a name="line-869"></a><span>    </span><span class="hs-identifier">readListPrec</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">readListPrecDefault</span><span>
</span><a name="line-870"></a><span class="hs-cpp">#else
</span><span>    </span><span class="hs-identifier">readsPrec</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">readParen</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">p</span><span> </span><span class="hs-operator">&gt;</span><span> </span><span class="hs-number">10</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-872"></a><span>        </span><span class="hs-special">(</span><span class="hs-string">&quot;fromList&quot;</span><span class="hs-special">,</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Read.html#readListPrecDefault"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Read.html#readListPrecDefault"><span class="hs-identifier hs-var">lex</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Read.html#readListPrecDefault"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-873"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">xs</span><span class="hs-special">,</span><span class="hs-identifier">t</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">reads</span><span> </span><span class="hs-identifier">s</span><span>
</span><a name="line-874"></a><span>        </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fromList</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">,</span><span class="hs-identifier">t</span><span class="hs-special">)</span><span>
</span><a name="line-875"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-877"></a><span class="hs-cpp">#if MIN_VERSION_base(4,9,0)
</span><span class="hs-comment">-- | @since 0.5.9</span><span>
</span><a name="line-879"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Read1</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-880"></a><span>  </span><span class="hs-identifier">liftReadsPrec</span><span> </span><span class="hs-identifier">_rp</span><span> </span><span class="hs-identifier">readLst</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">readParen</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">p</span><span> </span><span class="hs-operator">&gt;</span><span> </span><span class="hs-number">10</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">r</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-881"></a><span>    </span><span class="hs-special">(</span><span class="hs-string">&quot;fromList&quot;</span><span class="hs-special">,</span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">lex</span><span> </span><span class="hs-identifier">r</span><span>
</span><a name="line-882"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">xs</span><span class="hs-special">,</span><span class="hs-identifier">t</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">readLst</span><span> </span><span class="hs-identifier">s</span><span>
</span><a name="line-883"></a><span>    </span><a name="local-8214565720323787019"><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Functor.Classes.html#liftReadsPrec"><span class="hs-identifier">pure</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">fromList</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679058651"><a href="#local-6989586621679058651"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-884"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-886"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Monoid</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-887"></a><span>    </span><span class="hs-identifier">mempty</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">empty</span><span>
</span><a name="line-888"></a><span>    </span><span class="hs-identifier">mappend</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator">&gt;&lt;</span><span class="hs-special">)</span><span>
</span><a name="line-889"></a><span>
</span><a name="line-890"></a><span class="hs-cpp">#if MIN_VERSION_base(4,9,0)
</span><span class="hs-comment">-- | @since 0.5.7</span><span>
</span><a name="line-892"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Semigroup.Semigroup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-893"></a><span>    </span><span class="hs-special">(</span><span class="hs-operator">&lt;&gt;</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator">&gt;&lt;</span><span class="hs-special">)</span><span>
</span><a name="line-894"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-896"></a><span class="hs-identifier">INSTANCE_TYPEABLE1</span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span class="hs-special">)</span><span>
</span><a name="line-897"></a><span>
</span><a name="line-898"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__
</span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Data</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Typeable.Internal.html#Typeable"><span class="hs-identifier hs-type">Data</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-900"></a><span>    </span><span class="hs-identifier">gfoldl</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">s</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">viewl</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-901"></a><span>        </span><span class="hs-identifier">EmptyL</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">empty</span><span>
</span><a name="line-902"></a><span>        </span><span class="hs-identifier">x</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Data.html#Data"><span class="hs-operator hs-type">:&lt;</span></a><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Data.html#Data"><span class="hs-identifier hs-type">z</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator">&lt;|</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-903"></a><span>
</span><a name="line-904"></a><span>    </span><span class="hs-identifier">gunfold</span><span> </span><a href="Data.Sequence.Internal.html#EmptyL"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">c</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">constrIndex</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-905"></a><span>        </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a name="local-6989586621679058642"><a href="#local-6989586621679058642"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-identifier">empty</span><span>
</span><a name="line-906"></a><span>        </span><span class="hs-number">2</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">k</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">k</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">z</span><span> </span><span class="hs-special">(</span><span class="hs-operator">&lt;|</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-907"></a><span>        </span><a name="local-8214565720323786807"><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Data.html#gunfold"><span class="hs-identifier">_</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;gunfold&quot;</span><span>
</span><a name="line-908"></a><span>
</span><a name="line-909"></a><span>    </span><span class="hs-identifier">toConstr</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-910"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">null</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Err.html#error"><span class="hs-identifier hs-var">xs</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">emptyConstr</span><span>
</span><a name="line-911"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">consConstr</span><span>
</span><a name="line-912"></a><span>
</span><a name="line-913"></a><span>    </span><span class="hs-identifier">dataTypeOf</span><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#emptyConstr"><span class="hs-identifier hs-var">seqDataType</span></a><span>
</span><a name="line-914"></a><span>
</span><a name="line-915"></a><span>    </span><span class="hs-identifier">dataCast1</span><span> </span><span class="hs-identifier">f</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">gcast1</span><span> </span><span class="hs-identifier">f</span><span>
</span><a name="line-916"></a><span>
</span><a name="line-917"></a><span class="hs-identifier">emptyConstr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">consConstr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Constr</span><span>
</span><a name="line-918"></a><span class="hs-identifier">emptyConstr</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkConstr</span><span> </span><span class="hs-identifier">seqDataType</span><span> </span><span class="hs-string">&quot;empty&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">Prefix</span><span>
</span><a name="line-919"></a><span class="hs-identifier">consConstr</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkConstr</span><span> </span><span class="hs-identifier">seqDataType</span><span> </span><span class="hs-string">&quot;&lt;|&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">Infix</span><span>
</span><a name="line-920"></a><span>
</span><a name="line-921"></a><a name="emptyConstr"><a href="Data.Sequence.Internal.html#emptyConstr"><span class="hs-identifier">seqDataType</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">DataType</span><span>
</span><a name="line-922"></a><span class="hs-identifier">seqDataType</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkDataType</span><span> </span><span class="hs-string">&quot;Data.Sequence.Seq&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">emptyConstr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">consConstr</span><span class="hs-special">]</span><span>
</span><a name="line-923"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-925"></a><span class="hs-comment">-- Finger trees</span><span>
</span><a name="line-926"></a><span>
</span><a name="line-927"></a><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-928"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-929"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-930"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="FingerTree"><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier">Deep</span></a></a><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="hs-identifier">Digit</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="hs-identifier">Digit</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-931"></a><span class="hs-cpp">#ifdef TESTING
</span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier">Show</span><span>
</span><a name="line-933"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-935"></a><span class="hs-cpp">#ifdef __GLASGOW_HASKELL__
</span><span class="hs-comment">-- | @since 0.6.1</span><span>
</span><a name="line-937"></a><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Generic1</span><span> </span><span class="hs-identifier">FingerTree</span><span>
</span><a name="line-938"></a><span>
</span><a name="line-939"></a><span class="hs-comment">-- | @since 0.6.1</span><span>
</span><a name="line-940"></a><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Generics.html#Generic1"><span class="hs-identifier hs-type">Generic</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-941"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-943"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Sized</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Generics.html#Generic"><span class="hs-identifier hs-type">Sized</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><a href="#local-6989586621679063184"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-944"></a><span>    </span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">instance</span><span> </span><span class="hs-pragma">Sized</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-945"></a><span>    </span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">instance</span><span> </span><span class="hs-pragma">Sized</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-946"></a><span>    </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">EmptyT</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-947"></a><span>    </span><span class="hs-identifier">size</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">x</span></a><span>
</span><a name="line-948"></a><span>    </span><span class="hs-identifier">size</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-949"></a><span>
</span><a name="line-950"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Foldable</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-951"></a><span>    </span><span class="hs-identifier">foldMap</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">_</span></a><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mempty</span><span>
</span><a name="line-952"></a><span>    </span><span class="hs-identifier">foldMap</span><span> </span><span class="hs-identifier">f'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">x'</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f'</span><span> </span><span class="hs-identifier">x'</span><span>
</span><a name="line-953"></a><span>    </span><span class="hs-identifier">foldMap</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#Foldable"><span class="hs-identifier hs-type">f'</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">_</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">pr'</span></a><span> </span><span class="hs-identifier">m'</span><span> </span><span class="hs-identifier">sf'</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-954"></a><span>        </span><span class="hs-identifier">foldMapDigit</span><span> </span><span class="hs-identifier">f'</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-identifier hs-var">pr'</span></a><span> </span><span class="hs-operator">&lt;&gt;</span><span>
</span><a name="line-955"></a><span>        </span><span class="hs-identifier">foldMapTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldMapNode</span><span> </span><span class="hs-identifier">f'</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m'</span><span> </span><span class="hs-operator">&lt;&gt;</span><span>
</span><a name="line-956"></a><span>        </span><span class="hs-identifier">foldMapDigit</span><span> </span><span class="hs-identifier">f'</span><span> </span><span class="hs-identifier">sf'</span><span>
</span><a name="line-957"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-958"></a><span>        </span><a href="#local-6989586621679058431"><span class="hs-identifier hs-var">foldMapTree</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679058434"><span class="hs-identifier hs-var">Monoid</span></a><span> </span><a href="#local-6989586621679058434"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><a href="Data.Sequence.Internal.html#%3C%3E"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span>
</span><a name="line-959"></a><span>        </span><a href="#local-6989586621679058432"><span class="hs-identifier hs-var">foldMapTree</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mempty</span><span>
</span><a name="line-960"></a><span>        </span><span class="hs-identifier">foldMapTree</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span>
</span><a name="line-961"></a><span>        </span><span class="hs-identifier">foldMapTree</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Monoid"><span class="hs-identifier hs-type">Deep</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Monoid"><span class="hs-identifier hs-type">_</span></a><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-962"></a><span>            </span><span class="hs-identifier">foldMapDigitN</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-identifier">pr</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-operator hs-var">&lt;&gt;</span></a><span>
</span><a name="line-963"></a><span>            </span><span class="hs-identifier">foldMapTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldMapNodeN</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-operator">&lt;&gt;</span><span>
</span><a name="line-964"></a><span>            </span><span class="hs-identifier">foldMapDigitN</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-965"></a><span>
</span><a name="line-966"></a><span>        </span><span class="hs-identifier">foldMapDigit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Monoid</span><span> </span><a href="#local-6989586621679058435"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span>
</span><a name="line-967"></a><span>        </span><span class="hs-identifier">foldMapDigit</span><span> </span><a href="#local-6989586621679058433"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058433"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldDigit</span><span> </span><span class="hs-special">(</span><span class="hs-operator">&lt;&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">t</span><span>
</span><a name="line-968"></a><span>
</span><a name="line-969"></a><span>        </span><span class="hs-identifier">foldMapDigitN</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Monoid</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span>
</span><a name="line-970"></a><span>        </span><span class="hs-identifier">foldMapDigitN</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldDigit</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">t</span><span>
</span><a name="line-971"></a><span>
</span><a name="line-972"></a><span>        </span><span class="hs-identifier">foldMapNode</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Monoid</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Monoid"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-973"></a><span>        </span><a name="local-6989586621679058433"><a href="#local-6989586621679058433"><span class="hs-identifier">foldMapNode</span></a></a><span> </span><a name="local-6989586621679058433"><a href="#local-6989586621679058433"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679058454"><a href="#local-6989586621679058454"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldNode</span><span> </span><span class="hs-special">(</span><span class="hs-operator">&lt;&gt;</span><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#%3C%3E"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-identifier">t</span><span>
</span><a name="line-974"></a><span>
</span><a name="line-975"></a><span>        </span><span class="hs-identifier">foldMapNodeN</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Monoid</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span>
</span><a name="line-976"></a><span>        </span><span class="hs-identifier">foldMapNodeN</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldNode</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">t</span><span>
</span><a name="line-977"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__
</span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="hs-pragma">foldMap</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-979"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-981"></a><span>    </span><span class="hs-identifier">foldr</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">z'</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">z'</span><span>
</span><a name="line-982"></a><span>    </span><span class="hs-identifier">foldr</span><span> </span><span class="hs-identifier">f'</span><span> </span><span class="hs-identifier">z'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">x'</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">x'</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f'</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">z'</span><span>
</span><a name="line-983"></a><span>    </span><span class="hs-identifier">foldr</span><span> </span><span class="hs-identifier">f'</span><span> </span><span class="hs-identifier">z'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">pr'</span><span> </span><span class="hs-identifier">m'</span><span> </span><span class="hs-identifier">sf'</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-984"></a><span>        </span><span class="hs-identifier">foldrDigit</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">f'</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldrTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldrNode</span><span> </span><span class="hs-identifier">f'</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldrDigit</span><span> </span><span class="hs-identifier">f'</span><span> </span><span class="hs-identifier">z'</span><span> </span><span class="hs-identifier">sf'</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m'</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr'</span><span>
</span><a name="line-985"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-986"></a><span>        </span><span class="hs-identifier">foldrTree</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a name="local-6989586621679058468"><a href="#local-6989586621679058468"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-987"></a><span>        </span><a href="#local-6989586621679058470"><span class="hs-identifier hs-var">foldrTree</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="#local-6989586621679058464"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679058469"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-988"></a><span>        </span><span class="hs-identifier">foldrTree</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">z</span><span>
</span><a name="line-989"></a><span>        </span><span class="hs-identifier">foldrTree</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-990"></a><span>            </span><span class="hs-identifier">foldrDigitN</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldrTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldrNodeN</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldrDigitN</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span>
</span><a name="line-991"></a><span>
</span><a name="line-992"></a><span>        </span><span class="hs-identifier">foldrDigit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a name="local-6989586621679058491"><a href="#local-6989586621679058491"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-993"></a><span>        </span><span class="hs-identifier">foldrDigit</span><span> </span><a href="#local-6989586621679058471"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058471"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679058469"><span class="hs-identifier hs-var">foldr</span></a><span> </span><a href="#local-6989586621679058469"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058469"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-identifier">t</span><span>
</span><a name="line-994"></a><span>
</span><a name="line-995"></a><span>        </span><span class="hs-identifier">foldrDigitN</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058477"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-996"></a><span>        </span><span class="hs-identifier">foldrDigitN</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldr</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">t</span><span>
</span><a name="line-997"></a><span>
</span><a name="line-998"></a><span>        </span><span class="hs-identifier">foldrNode</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-999"></a><span>        </span><a name="local-6989586621679058471"><a href="#local-6989586621679058471"><span class="hs-identifier">foldrNode</span></a></a><span> </span><a name="local-6989586621679058471"><a href="#local-6989586621679058471"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679058496"><a href="#local-6989586621679058496"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679058497"><a href="#local-6989586621679058497"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldr</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058496"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679058497"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-1000"></a><span>
</span><a name="line-1001"></a><span>        </span><span class="hs-identifier">foldrNodeN</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-1002"></a><span>        </span><span class="hs-identifier">foldrNodeN</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldr</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">t</span><span>
</span><a name="line-1003"></a><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">foldr</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1004"></a><span>
</span><a name="line-1005"></a><span>
</span><a name="line-1006"></a><span>    </span><span class="hs-identifier">foldl</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">z'</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">z'</span><span>
</span><a name="line-1007"></a><span>    </span><span class="hs-identifier">foldl</span><span> </span><span class="hs-identifier">f'</span><span> </span><span class="hs-identifier">z'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">x'</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">z'</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f'</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">x'</span><span>
</span><a name="line-1008"></a><span>    </span><span class="hs-identifier">foldl</span><span> </span><span class="hs-identifier">f'</span><span> </span><span class="hs-identifier">z'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">pr'</span><span> </span><span class="hs-identifier">m'</span><span> </span><span class="hs-identifier">sf'</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1009"></a><span>        </span><span class="hs-identifier">foldlDigit</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">f'</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldlTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldlNode</span><span> </span><span class="hs-identifier">f'</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldlDigit</span><span> </span><span class="hs-identifier">f'</span><span> </span><span class="hs-identifier">z'</span><span> </span><span class="hs-identifier">pr'</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m'</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">sf'</span><span>
</span><a name="line-1010"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-1011"></a><span>        </span><span class="hs-identifier">foldlTree</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><a name="local-6989586621679058513"><a href="#local-6989586621679058513"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-1012"></a><span>        </span><a href="#local-6989586621679058515"><span class="hs-identifier hs-var">foldlTree</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="#local-6989586621679058509"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679058514"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-1013"></a><span>        </span><span class="hs-identifier">foldlTree</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">x</span><span>
</span><a name="line-1014"></a><span>        </span><span class="hs-identifier">foldlTree</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">_</span></a><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1015"></a><span>            </span><span class="hs-identifier">foldlDigitN</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldlTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldlNodeN</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldlDigitN</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">pr</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-1016"></a><span>
</span><a name="line-1017"></a><span>        </span><span class="hs-identifier">foldlDigit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a name="local-6989586621679058536"><a href="#local-6989586621679058536"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-1018"></a><span>        </span><span class="hs-identifier">foldlDigit</span><span> </span><a href="#local-6989586621679058516"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058516"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679058514"><span class="hs-identifier hs-var">foldl</span></a><span> </span><a href="#local-6989586621679058514"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058514"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-identifier">t</span><span>
</span><a name="line-1019"></a><span>
</span><a name="line-1020"></a><span>        </span><span class="hs-identifier">foldlDigitN</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058521"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-1021"></a><span>        </span><span class="hs-identifier">foldlDigitN</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldl</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">t</span><span>
</span><a name="line-1022"></a><span>
</span><a name="line-1023"></a><span>        </span><span class="hs-identifier">foldlNode</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-1024"></a><span>        </span><a name="local-6989586621679058516"><a href="#local-6989586621679058516"><span class="hs-identifier">foldlNode</span></a></a><span> </span><a name="local-6989586621679058516"><a href="#local-6989586621679058516"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679058541"><a href="#local-6989586621679058541"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679058542"><a href="#local-6989586621679058542"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldl</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldl"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058541"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679058542"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-1025"></a><span>
</span><a name="line-1026"></a><span>        </span><span class="hs-identifier">foldlNodeN</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058525"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-1027"></a><span>        </span><span class="hs-identifier">foldlNodeN</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldl</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">t</span><span>
</span><a name="line-1028"></a><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">foldl</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1029"></a><span>
</span><a name="line-1030"></a><span>    </span><span class="hs-identifier">foldr'</span><span> </span><a name="local-6989586621679058518"><a href="#local-6989586621679058518"><span class="hs-identifier">_</span></a></a><span> </span><a name="local-6989586621679058518"><a href="#local-6989586621679058518"><span class="hs-identifier">z'</span></a></a><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">z'</span><span>
</span><a name="line-1031"></a><span>    </span><span class="hs-identifier">foldr'</span><span> </span><span class="hs-identifier">f'</span><span> </span><span class="hs-identifier">z'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">x'</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f'</span><span> </span><span class="hs-identifier">x'</span><span> </span><span class="hs-identifier">z'</span><span>
</span><a name="line-1032"></a><span>    </span><span class="hs-identifier">foldr'</span><span> </span><span class="hs-identifier">f'</span><span> </span><span class="hs-identifier">z'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">pr'</span><span> </span><span class="hs-identifier">m'</span><span> </span><span class="hs-identifier">sf'</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1033"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">foldrDigit'</span><span> </span><span class="hs-identifier">f'</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldrTree'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldrNode'</span><span> </span><span class="hs-identifier">f'</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldrDigit'</span><span> </span><span class="hs-identifier">f'</span><span> </span><span class="hs-identifier">z'</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">sf'</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m'</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr'</span><span>
</span><a name="line-1034"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-1035"></a><span>        </span><span class="hs-identifier">foldrTree'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a name="local-6989586621679058558"><a href="#local-6989586621679058558"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-1036"></a><span>        </span><span class="hs-identifier">foldrTree'</span><span> </span><a href="#local-6989586621679058560"><span class="hs-identifier hs-var">_</span></a><span> </span><a href="#local-6989586621679058554"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679058559"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-1037"></a><span>        </span><span class="hs-identifier">foldrTree'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">z</span><span>
</span><a name="line-1038"></a><span>        </span><span class="hs-identifier">foldrTree'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1039"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier">foldr'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldrTree'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldrNodeN'</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldr'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">z</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span>
</span><a name="line-1040"></a><span>
</span><a name="line-1041"></a><span>        </span><span class="hs-identifier">foldrDigit'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a name="local-6989586621679058578"><a href="#local-6989586621679058578"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-1042"></a><span>        </span><span class="hs-identifier">foldrDigit'</span><span> </span><a href="#local-6989586621679058575"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24%21"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679058559"><span class="hs-identifier hs-var">foldr'</span></a><span> </span><a href="#local-6989586621679058559"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-identifier">z</span><span> </span><a href="#local-6989586621679058562"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-1043"></a><span>
</span><a name="line-1044"></a><span>        </span><span class="hs-identifier">foldrNode'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-1045"></a><span>        </span><a name="local-6989586621679058560"><a href="#local-6989586621679058560"><span class="hs-identifier">foldrNode'</span></a></a><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldr'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">t</span><span>
</span><a name="line-1046"></a><span>
</span><a name="line-1047"></a><span>        </span><span class="hs-identifier">foldrNodeN'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-1048"></a><span>        </span><span class="hs-identifier">foldrNodeN'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldr'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">t</span><span>
</span><a name="line-1049"></a><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">foldr'</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1050"></a><span>
</span><a name="line-1051"></a><span>    </span><span class="hs-identifier">foldl'</span><span> </span><a name="local-6989586621679058562"><a href="#local-6989586621679058562"><span class="hs-identifier">_</span></a></a><span> </span><a name="local-6989586621679058562"><a href="#local-6989586621679058562"><span class="hs-identifier">z'</span></a></a><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">z'</span><span>
</span><a name="line-1052"></a><span>    </span><span class="hs-identifier">foldl'</span><span> </span><span class="hs-identifier">f'</span><span> </span><span class="hs-identifier">z'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">x'</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f'</span><span> </span><span class="hs-identifier">z'</span><span> </span><span class="hs-identifier">x'</span><span>
</span><a name="line-1053"></a><span>    </span><span class="hs-identifier">foldl'</span><span> </span><span class="hs-identifier">f'</span><span> </span><span class="hs-identifier">z'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">pr'</span><span> </span><span class="hs-identifier">m'</span><span> </span><span class="hs-identifier">sf'</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1054"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">foldlDigit'</span><span> </span><span class="hs-identifier">f'</span><span> </span><span class="hs-operator">$!</span><span>
</span><a name="line-1055"></a><span>         </span><span class="hs-special">(</span><span class="hs-identifier">foldlTree'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldlNode'</span><span> </span><span class="hs-identifier">f'</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679058592"><span class="hs-operator hs-var">$!</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldlDigit'</span><span> </span><span class="hs-identifier">f'</span><span> </span><span class="hs-identifier">z'</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr'</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m'</span><span class="hs-special">)</span><span>
</span><a name="line-1056"></a><span>            </span><span class="hs-identifier">sf'</span><span>
</span><a name="line-1057"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-1058"></a><span>        </span><span class="hs-identifier">foldlTree'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679058600"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058600"><span class="hs-identifier hs-var">Node</span></a><span> </span><a href="#local-6989586621679058593"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24%21"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058599"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><a href="#local-6989586621679058596"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-1059"></a><span>        </span><span class="hs-identifier">foldlTree'</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">z</span><span>
</span><a name="line-1060"></a><span>        </span><span class="hs-identifier">foldlTree'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-1061"></a><span>        </span><span class="hs-identifier">foldlTree'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">_</span></a><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1062"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier">foldl'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldlTree'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldl'</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">foldl'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">pr</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-1063"></a><span>
</span><a name="line-1064"></a><span>        </span><span class="hs-identifier">foldlDigit'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a name="local-6989586621679058614"><a href="#local-6989586621679058614"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-1065"></a><span>        </span><span class="hs-identifier">foldlDigit'</span><span> </span><a href="#local-6989586621679058611"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24%21"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679058598"><span class="hs-identifier hs-var">foldl'</span></a><span> </span><a href="#local-6989586621679058598"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-identifier">z</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldl%27"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-1066"></a><span>
</span><a name="line-1067"></a><span>        </span><span class="hs-identifier">foldlNode'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-1068"></a><span>        </span><a name="local-6989586621679058599"><a href="#local-6989586621679058599"><span class="hs-identifier">foldlNode'</span></a></a><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldl'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">t</span><span>
</span><a name="line-1069"></a><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">foldl'</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1070"></a><span>
</span><a name="line-1071"></a><span>    </span><span class="hs-identifier">foldr1</span><span> </span><a name="local-6989586621679058600"><a href="#local-6989586621679058600"><span class="hs-identifier">_</span></a></a><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;foldr1: empty sequence&quot;</span><span>
</span><a name="line-1072"></a><span>    </span><span class="hs-identifier">foldr1</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">x</span><span>
</span><a name="line-1073"></a><span>    </span><span class="hs-identifier">foldr1</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1074"></a><span>        </span><span class="hs-identifier">foldr</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">flip</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldr</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldr1</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span>
</span><a name="line-1075"></a><span>
</span><a name="line-1076"></a><span>    </span><span class="hs-identifier">foldl1</span><span> </span><a name="local-6989586621679058623"><a href="#local-6989586621679058623"><span class="hs-identifier">_</span></a></a><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;foldl1: empty sequence&quot;</span><span>
</span><a name="line-1077"></a><span>    </span><span class="hs-identifier">foldl1</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">_</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#flip"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1078"></a><span>    </span><span class="hs-identifier">foldl1</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1079"></a><span>        </span><span class="hs-identifier">foldl</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldl</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldl</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldl1</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">pr</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-1080"></a><span>
</span><a name="line-1081"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Functor</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1082"></a><span>    </span><span class="hs-identifier">fmap</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldl"><span class="hs-identifier hs-var">_</span></a><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-1083"></a><span>    </span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Single</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><a name="line-1084"></a><span>    </span><span class="hs-identifier">fmap</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Functor"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Functor"><span class="hs-identifier hs-type">Deep</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">pr</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">sf</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1085"></a><span>        </span><span class="hs-identifier">Deep</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">pr</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span>
</span><a name="line-1086"></a><span>
</span><a name="line-1087"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Traversable</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1088"></a><span>    </span><span class="hs-identifier">traverse</span><span> </span><a href="#local-6989586621679058421"><span class="hs-identifier hs-var">_</span></a><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pure</span><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-1089"></a><span>    </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Single</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span>
</span><a name="line-1090"></a><span>    </span><span class="hs-identifier">traverse</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Traversable.html#Traversable"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Traversable.html#Traversable"><span class="hs-identifier hs-type">Deep</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">pr</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">sf</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1091"></a><span>        </span><span class="hs-identifier">liftA3</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-identifier">v</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">traverse</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-identifier">pr</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">traverse</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">traverse</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span>
</span><a name="line-1092"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier">traverse</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span>
</span><a name="line-1093"></a><span>
</span><a name="line-1094"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">NFData</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">NFData</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1095"></a><span>    </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1096"></a><span>    </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-identifier">x</span><span>
</span><a name="line-1097"></a><span>    </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-special">(</span><a href="../deepseq/src/%{MODULE}.html#%{NAME}/Control.DeepSeq.html#NFData"><span class="hs-identifier hs-type">Deep</span></a><span> </span><a href="../deepseq/src/%{MODULE}.html#%{NAME}/Control.DeepSeq.html#NFData"><span class="hs-identifier hs-type">_</span></a><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><a href="../deepseq/src/%{MODULE}.html#%{NAME}/Control.DeepSeq.html#NFData"><span class="hs-identifier hs-type">sf</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">rnf</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">pr</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">seq</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-identifier">sf</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">seq</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-identifier">m</span><span>
</span><a name="line-1098"></a><span>
</span><a name="line-1099"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">deep</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1100"></a><span class="hs-identifier">deep</span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Sized</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-identifier hs-var">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-1101"></a><span class="hs-identifier">deep</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-1102"></a><span>
</span><a name="line-1103"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">pullL</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1104"></a><span class="hs-identifier">pullL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-1105"></a><span class="hs-identifier">pullL</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">viewLTree</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1106"></a><span>    </span><span class="hs-identifier">EmptyLTree</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">digitToTree'</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-1107"></a><span>    </span><span class="hs-identifier">ConsLTree</span><span> </span><span class="hs-identifier">pr</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">m'</span></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">nodeToDigit</span><span> </span><span class="hs-identifier">pr</span><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">m'</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">sf</span></a><span>
</span><a name="line-1108"></a><span>
</span><a name="line-1109"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">pullR</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1110"></a><span class="hs-identifier">pullR</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#ConsLTree"><span class="hs-identifier hs-var">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#nodeToDigit"><span class="hs-identifier hs-var">Node</span></a><span> </span><a href="Data.Sequence.Internal.html#nodeToDigit"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-1111"></a><span class="hs-identifier">pullR</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">viewRTree</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1112"></a><span>    </span><span class="hs-identifier">EmptyRTree</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">digitToTree'</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span>
</span><a name="line-1113"></a><span>    </span><span class="hs-identifier">SnocRTree</span><span> </span><span class="hs-identifier">m'</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">sf</span></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">Deep</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">pr</span></a><span> </span><span class="hs-identifier">m'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">nodeToDigit</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">sf</span></a><span class="hs-special">)</span><span>
</span><a name="line-1114"></a><span>
</span><a name="line-1115"></a><span class="hs-comment">-- Digits</span><span>
</span><a name="line-1116"></a><span>
</span><a name="line-1117"></a><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-1118"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-1119"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-1120"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-1121"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">Four</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-1122"></a><span class="hs-cpp">#ifdef TESTING
</span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier">Show</span><span>
</span><a name="line-1124"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-1126"></a><span class="hs-cpp">#ifdef __GLASGOW_HASKELL__
</span><span class="hs-comment">-- | @since 0.6.1</span><span>
</span><a name="line-1128"></a><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Generic1</span><span> </span><span class="hs-identifier">Digit</span><span>
</span><a name="line-1129"></a><span>
</span><a name="line-1130"></a><span class="hs-comment">-- | @since 0.6.1</span><span>
</span><a name="line-1131"></a><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Generics.html#Generic1"><span class="hs-identifier hs-type">Generic</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-1132"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-1134"></a><span class="hs-identifier">foldDigit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Generics.html#Generic"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Generics.html#Generic"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-1135"></a><span class="hs-identifier">foldDigit</span><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-1136"></a><span class="hs-identifier">foldDigit</span><span> </span><span class="hs-special">(</span><span class="hs-operator">&lt;+&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-1137"></a><span class="hs-identifier">foldDigit</span><span> </span><span class="hs-special">(</span><span class="hs-operator">&lt;+&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><a href="#local-6989586621679059066"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-1138"></a><a name="foldDigit"><a href="Data.Sequence.Internal.html#foldDigit"><span class="hs-identifier">foldDigit</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-operator">&lt;+&gt;</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679059406"><a href="#local-6989586621679059406"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><a href="#local-6989586621679059406"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679059407"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">d</span><span>
</span><a name="line-1139"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">foldDigit</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1140"></a><span>
</span><a name="line-1141"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Foldable</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1142"></a><span>    </span><span class="hs-identifier">foldMap</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldDigit</span><span> </span><span class="hs-identifier">mappend</span><span>
</span><a name="line-1143"></a><span>
</span><a name="line-1144"></a><span>    </span><span class="hs-identifier">foldr</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#Foldable"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#Foldable"><span class="hs-identifier hs-type">z</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">z</span><span>
</span><a name="line-1145"></a><span>    </span><a name="local-8214565720323789019"><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldMap"><span class="hs-identifier">foldr</span></a></a><span> </span><a name="local-8214565720323789019"><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldMap"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#foldDigit"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="Data.Sequence.Internal.html#foldDigit"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="Data.Sequence.Internal.html#foldDigit"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">z</span><span class="hs-special">)</span><span>
</span><a name="line-1146"></a><span>    </span><span class="hs-identifier">foldr</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">z</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1147"></a><span>    </span><a name="local-8214565720323789017"><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier">foldr</span></a></a><span> </span><a name="local-6989586621679058308"><a href="#local-6989586621679058308"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679058309"><a href="#local-6989586621679058309"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><a href="#local-6989586621679058310"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679058308"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">d</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">z</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1148"></a><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">foldr</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1149"></a><span>
</span><a name="line-1150"></a><span>    </span><span class="hs-identifier">foldl</span><span> </span><a name="local-6989586621679058320"><a href="#local-6989586621679058320"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679058321"><a href="#local-6989586621679058321"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">One</span></a><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679058324"><a href="#local-6989586621679058324"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-1151"></a><span>    </span><span class="hs-identifier">foldl</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">z</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-1152"></a><span>    </span><span class="hs-identifier">foldl</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">z</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-1153"></a><span>    </span><a name="local-8214565720323789015"><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldl"><span class="hs-identifier">foldl</span></a></a><span> </span><a name="local-6989586621679058326"><a href="#local-6989586621679058326"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679058327"><a href="#local-6989586621679058327"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><a href="#local-6989586621679058327"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679058326"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">z</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">d</span><span>
</span><a name="line-1154"></a><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">foldl</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1155"></a><span>
</span><a name="line-1156"></a><span>    </span><span class="hs-identifier">foldr'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679058340"><a href="#local-6989586621679058340"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">z</span><span>
</span><a name="line-1157"></a><span>    </span><span class="hs-identifier">foldr'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">z</span><span>
</span><a name="line-1158"></a><span>    </span><span class="hs-identifier">foldr'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">z</span><span>
</span><a name="line-1159"></a><span>    </span><a name="local-8214565720323789016"><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldr%27"><span class="hs-identifier">foldr'</span></a></a><span> </span><a name="local-6989586621679058344"><a href="#local-6989586621679058344"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679058345"><a href="#local-6989586621679058345"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><a href="#local-6989586621679058344"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679058346"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">d</span><span> </span><span class="hs-identifier">z</span><span>
</span><a name="line-1160"></a><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">foldr'</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1161"></a><span>
</span><a name="line-1162"></a><span>    </span><span class="hs-identifier">foldl'</span><span> </span><a name="local-6989586621679058356"><a href="#local-6989586621679058356"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679058357"><a href="#local-6989586621679058357"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">One</span></a><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679058360"><a href="#local-6989586621679058360"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679058361"><a href="#local-6989586621679058361"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-1163"></a><span>    </span><span class="hs-identifier">foldl'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-1164"></a><span>    </span><span class="hs-identifier">foldl'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-1165"></a><span>    </span><a name="local-8214565720323789014"><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldl%27"><span class="hs-identifier">foldl'</span></a></a><span> </span><a name="local-6989586621679058362"><a href="#local-6989586621679058362"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679058363"><a href="#local-6989586621679058363"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><a href="#local-6989586621679058362"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679058363"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">d</span><span>
</span><a name="line-1166"></a><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">foldl'</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1167"></a><span>
</span><a name="line-1168"></a><span>    </span><span class="hs-identifier">foldr1</span><span> </span><a name="local-6989586621679058374"><a href="#local-6989586621679058374"><span class="hs-identifier">_</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679058377"><a href="#local-6989586621679058377"><span class="hs-identifier">a</span></a></a><span>
</span><a name="line-1169"></a><span>    </span><span class="hs-identifier">foldr1</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-1170"></a><span>    </span><span class="hs-identifier">foldr1</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-1171"></a><span>    </span><a name="local-8214565720323789013"><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldr1"><span class="hs-identifier">foldr1</span></a></a><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><a href="#local-6989586621679058380"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1172"></a><span>
</span><a name="line-1173"></a><span>    </span><span class="hs-identifier">foldl1</span><span> </span><a name="local-6989586621679058384"><a href="#local-6989586621679058384"><span class="hs-identifier">_</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">One</span></a><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-1174"></a><span>    </span><span class="hs-identifier">foldl1</span><span> </span><a name="local-6989586621679058388"><a href="#local-6989586621679058388"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Two</span></a><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679058392"><a href="#local-6989586621679058392"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-1175"></a><span>    </span><span class="hs-identifier">foldl1</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-1176"></a><span>    </span><a name="local-8214565720323789012"><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldl1"><span class="hs-identifier">foldl1</span></a></a><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><a href="#local-6989586621679058393"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">d</span><span>
</span><a name="line-1177"></a><span>
</span><a name="line-1178"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Functor</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1179"></a><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">fmap</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1180"></a><span>    </span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">One</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-1181"></a><span>    </span><span class="hs-identifier">fmap</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Functor"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Functor"><span class="hs-identifier hs-type">Two</span></a><span> </span><span class="hs-identifier">a</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Two</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-1182"></a><span>    </span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Three</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-1183"></a><span>    </span><a name="local-3458764513820541101"><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier">fmap</span></a></a><span> </span><a name="local-6989586621679058294"><a href="#local-6989586621679058294"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Four</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span>
</span><a name="line-1184"></a><span>
</span><a name="line-1185"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Traversable</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1186"></a><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">traverse</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1187"></a><span>    </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">One</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-1188"></a><span>    </span><span class="hs-identifier">traverse</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Traversable.html#Traversable"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Traversable.html#Traversable"><span class="hs-identifier hs-type">Two</span></a><span> </span><span class="hs-identifier">a</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">liftA2</span><span> </span><span class="hs-identifier">Two</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-1189"></a><span>    </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">liftA3</span><span> </span><span class="hs-identifier">Three</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-1190"></a><span>    </span><a name="local-8214565720323787590"><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Traversable.html#traverse"><span class="hs-identifier">traverse</span></a></a><span> </span><a name="local-6989586621679058280"><a href="#local-6989586621679058280"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">liftA3</span><span> </span><span class="hs-identifier">Four</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">d</span><span>
</span><a name="line-1191"></a><span>
</span><a name="line-1192"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">NFData</span><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">NFData</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Digit</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#liftA3"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1193"></a><span>    </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><a name="local-6989586621679058289"><a href="#local-6989586621679058289"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-1194"></a><span>    </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">seq</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-1195"></a><span>    </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-special">(</span><a href="../deepseq/src/%{MODULE}.html#%{NAME}/Control.DeepSeq.html#NFData"><span class="hs-identifier hs-type">Three</span></a><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../deepseq/src/%{MODULE}.html#%{NAME}/Control.DeepSeq.html#NFData"><span class="hs-identifier hs-type">rnf</span></a><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">seq</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">seq</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-1196"></a><span>    </span><a name="local-8214565720323790701"><a href="../deepseq/src/%{MODULE}.html#%{NAME}/Control.DeepSeq.html#rnf"><span class="hs-identifier">rnf</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><a href="../deepseq/src/%{MODULE}.html#%{NAME}/Control.DeepSeq.html#rnf"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="../deepseq/src/%{MODULE}.html#%{NAME}/Control.DeepSeq.html#rnf"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">seq</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">seq</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">seq</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-identifier">d</span><span>
</span><a name="line-1197"></a><span>
</span><a name="line-1198"></a><span class="hs-keyword">instance</span><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Sized</span></a><span> </span><a name="local-6989586621679058273"><a href="#local-6989586621679058273"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Sized</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Digit</span><span> </span><span class="hs-identifier hs-var">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1199"></a><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">size</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1200"></a><span>    </span><span class="hs-identifier">size</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldl1</span><span> </span><span class="hs-special">(</span><span class="hs-operator">+</span><span class="hs-special">)</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">size</span><span>
</span><a name="line-1201"></a><span>
</span><a name="line-1202"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">digitToTree</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">Digit</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1203"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">digitToTree</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">Digit</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1204"></a><span class="hs-identifier">digitToTree</span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Sized</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-1205"></a><span class="hs-identifier">digitToTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-1206"></a><span class="hs-identifier">digitToTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">deep</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">One</span></a><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-1207"></a><span class="hs-identifier">digitToTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">deep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">EmptyT</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-1208"></a><a name="digitToTree"><a href="Data.Sequence.Internal.html#digitToTree"><span class="hs-identifier">digitToTree</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">deep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span>
</span><a name="line-1209"></a><span>
</span><a name="line-1210"></a><span class="hs-comment">-- | Given the size of a digit and the digit itself, efficiently converts</span><span>
</span><a name="line-1211"></a><span class="hs-comment">-- it to a FingerTree.</span><span>
</span><a name="line-1212"></a><span class="hs-identifier">digitToTree'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-1213"></a><span class="hs-identifier">digitToTree'</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span>
</span><a name="line-1214"></a><span class="hs-identifier">digitToTree'</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-1215"></a><span class="hs-identifier">digitToTree'</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Two</span></a><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">One</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-1216"></a><a name="digitToTree%27"><a href="Data.Sequence.Internal.html#digitToTree%27"><span class="hs-identifier">digitToTree'</span></a></a><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Single</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1217"></a><span>
</span><a name="line-1218"></a><span class="hs-comment">-- Nodes</span><span>
</span><a name="line-1219"></a><span>
</span><a name="line-1220"></a><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-1221"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Node2</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">Int</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-1222"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">Node3</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">Int</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-1223"></a><span class="hs-cpp">#ifdef TESTING
</span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier">Show</span><span>
</span><a name="line-1225"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-1227"></a><span class="hs-cpp">#ifdef __GLASGOW_HASKELL__
</span><span class="hs-comment">-- | @since 0.6.1</span><span>
</span><a name="line-1229"></a><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Generic1</span><span> </span><span class="hs-identifier">Node</span><span>
</span><a name="line-1230"></a><span>
</span><a name="line-1231"></a><span class="hs-comment">-- | @since 0.6.1</span><span>
</span><a name="line-1232"></a><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Generics.html#Generic1"><span class="hs-identifier hs-type">Generic</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-1233"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-1235"></a><span class="hs-identifier">foldNode</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Generics.html#Generic"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Generics.html#Generic"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-1236"></a><span class="hs-identifier">foldNode</span><span> </span><span class="hs-special">(</span><span class="hs-operator">&lt;+&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node2</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-1237"></a><span class="hs-identifier">foldNode</span><span> </span><span class="hs-special">(</span><span class="hs-operator">&lt;+&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-1238"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">foldNode</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1239"></a><span>
</span><a name="line-1240"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Foldable</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1241"></a><span>    </span><span class="hs-identifier">foldMap</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldNode</span><span> </span><span class="hs-identifier">mappend</span><span>
</span><a name="line-1242"></a><span>
</span><a name="line-1243"></a><span>    </span><span class="hs-identifier">foldr</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#Foldable"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#Foldable"><span class="hs-identifier hs-type">z</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node2</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">_</span></a><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">z</span><span class="hs-special">)</span><span>
</span><a name="line-1244"></a><span>    </span><a name="local-8214565720323789019"><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldMap"><span class="hs-identifier">foldr</span></a></a><span> </span><a name="local-8214565720323789019"><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldMap"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#foldNode"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a href="Data.Sequence.Internal.html#foldNode"><span class="hs-identifier hs-var">_</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">z</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1245"></a><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">foldr</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1246"></a><span>
</span><a name="line-1247"></a><span>    </span><span class="hs-identifier">foldl</span><span> </span><a name="local-6989586621679058236"><a href="#local-6989586621679058236"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679058237"><a href="#local-6989586621679058237"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679058238"><a href="#local-6989586621679058238"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679058239"><a href="#local-6989586621679058239"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">z</span><span> </span><span class="hs-special">`</span><a href="#local-6989586621679058236"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="#local-6989586621679058236"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-1248"></a><span>    </span><span class="hs-identifier">foldl</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">z</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">f</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-1249"></a><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">foldl</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1250"></a><span>
</span><a name="line-1251"></a><span>    </span><span class="hs-identifier">foldr'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node2</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-operator">$!</span><span> </span><a href="#local-6989586621679058245"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058247"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier">z</span><span>
</span><a name="line-1252"></a><span>    </span><span class="hs-identifier">foldr'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">z</span><span>
</span><a name="line-1253"></a><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">foldr'</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1254"></a><span>
</span><a name="line-1255"></a><span>    </span><span class="hs-identifier">foldl'</span><span> </span><a name="local-6989586621679058254"><a href="#local-6989586621679058254"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679058255"><a href="#local-6989586621679058255"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679058256"><a href="#local-6989586621679058256"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679058257"><a href="#local-6989586621679058257"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-operator">$!</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24%21"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24%21"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-1256"></a><span>    </span><span class="hs-identifier">foldl'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-operator">$!</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-1257"></a><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">foldl'</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1258"></a><span>
</span><a name="line-1259"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Functor</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1260"></a><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">fmap</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1261"></a><span>    </span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node2</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Node2</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-1262"></a><span>    </span><span class="hs-identifier">fmap</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Functor"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-1263"></a><span>
</span><a name="line-1264"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Traversable</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1265"></a><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">traverse</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1266"></a><span>    </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node2</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">liftA2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node2</span><span> </span><span class="hs-identifier">v</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-1267"></a><span>    </span><span class="hs-identifier">traverse</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Traversable.html#Traversable"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">liftA3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">v</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-1268"></a><span>
</span><a name="line-1269"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">NFData</span><span> </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">NFData</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#liftA2"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1270"></a><span>    </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node2</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">rnf</span><span> </span><a name="local-6989586621679058222"><a href="#local-6989586621679058222"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">seq</span><span class="hs-special">`</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#liftA3"><span class="hs-identifier hs-var">rnf</span></a><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-1271"></a><span>    </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">seq</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">seq</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-1272"></a><span>
</span><a name="line-1273"></a><span class="hs-keyword">instance</span><span> </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Sized</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1274"></a><span>    </span><span class="hs-identifier">size</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node2</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679058211"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1275"></a><span>    </span><span class="hs-identifier">size</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">v</span><span>
</span><a name="line-1276"></a><span>
</span><a name="line-1277"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">node2</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1278"></a><span class="hs-identifier">node2</span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Sized</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679058207"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-1279"></a><span class="hs-identifier">node2</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span>       </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">Node2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-1280"></a><span>
</span><a name="line-1281"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">node3</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1282"></a><a name="node2"><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier">node3</span></a></a><span>           </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Sized</span></a><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059457"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-1283"></a><span class="hs-identifier">node3</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span>     </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">Node3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-1284"></a><span>
</span><a name="line-1285"></a><span class="hs-identifier">nodeToDigit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Node</span><span> </span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-1286"></a><span class="hs-identifier">nodeToDigit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node2</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">_</span></a><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-1287"></a><span class="hs-identifier">nodeToDigit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-1288"></a><span>
</span><a name="line-1289"></a><span class="hs-comment">-- Elements</span><span>
</span><a name="line-1290"></a><span>
</span><a name="line-1291"></a><span class="hs-keyword">newtype</span><span> </span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">Elem</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">getElem</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1292"></a><span class="hs-cpp">#ifdef TESTING
</span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier">Show</span><span>
</span><a name="line-1294"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-1296"></a><span class="hs-cpp">#ifdef __GLASGOW_HASKELL__
</span><span class="hs-comment">-- | @since 0.6.1</span><span>
</span><a name="line-1298"></a><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Generic1</span><span> </span><span class="hs-identifier">Elem</span><span>
</span><a name="line-1299"></a><span>
</span><a name="line-1300"></a><span class="hs-comment">-- | @since 0.6.1</span><span>
</span><a name="line-1301"></a><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Generics.html#Generic1"><span class="hs-identifier hs-type">Generic</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-1302"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-1304"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Sized</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Generics.html#Generic"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1305"></a><span>    </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-1306"></a><span>
</span><a name="line-1307"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Functor</span><span> </span><span class="hs-identifier">Elem</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1308"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 708
</span><span class="hs-comment">-- This cuts the time for &lt;*&gt; by around a fifth.</span><span>
</span><a name="line-1310"></a><span>    </span><span class="hs-identifier">fmap</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">coerce</span><span>
</span><a name="line-1311"></a><span class="hs-cpp">#else
</span><span>    </span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Elem</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><a name="line-1313"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-1315"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Foldable</span><span> </span><span class="hs-identifier">Elem</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1316"></a><span>    </span><span class="hs-identifier">foldr</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">z</span><span>
</span><a name="line-1317"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 708
</span><span>    </span><span class="hs-identifier">foldMap</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">coerce</span><span>
</span><a name="line-1319"></a><span>    </span><a name="local-8214565720323789017"><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier">foldl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">coerce</span><span>
</span><a name="line-1320"></a><span>    </span><span class="hs-identifier">foldl'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">coerce</span><span>
</span><a name="line-1321"></a><span class="hs-cpp">#else
</span><span>    </span><span class="hs-identifier">foldMap</span><span> </span><span class="hs-identifier hs-var">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span>
</span><a name="line-1323"></a><span>    </span><a name="local-8214565720323789014"><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldl%27"><span class="hs-identifier">foldl</span></a></a><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Elem</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">x</span><span>
</span><a name="line-1324"></a><span>    </span><span class="hs-identifier">foldl'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">x</span><span>
</span><a name="line-1325"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-1327"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Traversable</span><span> </span><span class="hs-identifier">Elem</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1328"></a><span>    </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Elem</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span>
</span><a name="line-1329"></a><span>
</span><a name="line-1330"></a><span class="hs-keyword">instance</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Traversable.html#Traversable"><span class="hs-identifier hs-type">NFData</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Traversable.html#Traversable"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">NFData</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1331"></a><span>    </span><a name="local-8214565720323787590"><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Traversable.html#traverse"><span class="hs-identifier">rnf</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-identifier">x</span><span>
</span><a name="line-1332"></a><span>
</span><a name="line-1333"></a><span class="hs-comment">-------------------------------------------------------</span><span>
</span><a name="line-1334"></a><span class="hs-comment">-- Applicative construction</span><span>
</span><a name="line-1335"></a><span class="hs-comment">-------------------------------------------------------</span><span>
</span><a name="line-1336"></a><span class="hs-cpp">#if !MIN_VERSION_base(4,8,0)
</span><span class="hs-keyword">newtype</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">runIdentity</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">}</span><span>
</span><a name="line-1338"></a><span>
</span><a name="line-1339"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Functor</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1340"></a><span>    </span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><a name="line-1341"></a><span>
</span><a name="line-1342"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Applicative</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1343"></a><span>    </span><span class="hs-identifier">pure</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span>
</span><a name="line-1344"></a><span>    </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><a name="line-1345"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-1347"></a><span class="hs-comment">-- | 'applicativeTree' takes an Applicative-wrapped construction of a</span><span>
</span><a name="line-1348"></a><span class="hs-comment">-- piece of a FingerTree, assumed to always have the same size (which</span><span>
</span><a name="line-1349"></a><span class="hs-comment">-- is put in the second argument), and replicates it as many times as</span><span>
</span><a name="line-1350"></a><span class="hs-comment">-- specified.  This is a generalization of 'replicateA', which itself</span><span>
</span><a name="line-1351"></a><span class="hs-comment">-- is a generalization of many Data.Sequence methods.</span><span>
</span><a name="line-1352"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">applicativeTree</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">State</span><span> </span><span class="hs-pragma">s</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">State</span><span> </span><span class="hs-pragma">s</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1353"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">applicativeTree</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Identity</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Identity</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1354"></a><span class="hs-comment">-- Special note: the Identity specialization automatically does node sharing,</span><span>
</span><a name="line-1355"></a><span class="hs-comment">-- reducing memory usage of the resulting tree to /O(log n)/.</span><span>
</span><a name="line-1356"></a><span class="hs-identifier">applicativeTree</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">Applicative</span></a><span> </span><a href="#local-6989586621679059052"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059052"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679059053"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059052"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><a href="#local-6989586621679059053"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1357"></a><a name="applicativeTree"><a href="Data.Sequence.Internal.html#applicativeTree"><span class="hs-identifier">applicativeTree</span></a></a><span> </span><a name="local-6989586621679059466"><a href="#local-6989586621679059466"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679059467"><a href="#local-6989586621679059467"><span class="hs-identifier">mSize</span></a></a><span> </span><a name="local-6989586621679059468"><a href="#local-6989586621679059468"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679059466"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1358"></a><span>    </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span>
</span><a name="line-1359"></a><span>    </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><a href="#local-6989586621679059468"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-1360"></a><span>    </span><span class="hs-number">2</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059472"><span class="hs-identifier hs-var">deepA</span></a><span> </span><a href="#local-6989586621679059469"><span class="hs-identifier hs-var">one</span></a><span> </span><a href="#local-6989586621679059473"><span class="hs-identifier hs-var">emptyTree</span></a><span> </span><a href="#local-6989586621679059469"><span class="hs-identifier hs-var">one</span></a><span>
</span><a name="line-1361"></a><span>    </span><span class="hs-number">3</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059472"><span class="hs-identifier hs-var">deepA</span></a><span> </span><a href="#local-6989586621679059470"><span class="hs-identifier hs-var">two</span></a><span> </span><a href="#local-6989586621679059473"><span class="hs-identifier hs-var">emptyTree</span></a><span> </span><a href="#local-6989586621679059469"><span class="hs-identifier hs-var">one</span></a><span>
</span><a name="line-1362"></a><span>    </span><span class="hs-number">4</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059472"><span class="hs-identifier hs-var">deepA</span></a><span> </span><a href="#local-6989586621679059470"><span class="hs-identifier hs-var">two</span></a><span> </span><a href="#local-6989586621679059473"><span class="hs-identifier hs-var">emptyTree</span></a><span> </span><a href="#local-6989586621679059470"><span class="hs-identifier hs-var">two</span></a><span>
</span><a name="line-1363"></a><span>    </span><span class="hs-number">5</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059472"><span class="hs-identifier hs-var">deepA</span></a><span> </span><a href="#local-6989586621679059471"><span class="hs-identifier hs-var">three</span></a><span> </span><a href="#local-6989586621679059473"><span class="hs-identifier hs-var">emptyTree</span></a><span> </span><a href="#local-6989586621679059470"><span class="hs-identifier hs-var">two</span></a><span>
</span><a name="line-1364"></a><span>    </span><span class="hs-number">6</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059472"><span class="hs-identifier hs-var">deepA</span></a><span> </span><a href="#local-6989586621679059471"><span class="hs-identifier hs-var">three</span></a><span> </span><a href="#local-6989586621679059473"><span class="hs-identifier hs-var">emptyTree</span></a><span> </span><a href="#local-6989586621679059471"><span class="hs-identifier hs-var">three</span></a><span>
</span><a name="line-1365"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679059466"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Real.html#quotRem"><span class="hs-identifier hs-var">quotRem</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1366"></a><span>           </span><span class="hs-special">(</span><a name="local-6989586621679059476"><a href="#local-6989586621679059476"><span class="hs-identifier">q</span></a></a><span class="hs-special">,</span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059472"><span class="hs-identifier hs-var">deepA</span></a><span> </span><a href="#local-6989586621679059471"><span class="hs-identifier hs-var">three</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#applicativeTree"><span class="hs-identifier hs-var">applicativeTree</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059476"><span class="hs-identifier hs-var">q</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059474"><span class="hs-identifier hs-var">mSize'</span></a><span> </span><a href="#local-6989586621679059475"><span class="hs-identifier hs-var">n3</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059471"><span class="hs-identifier hs-var">three</span></a><span>
</span><a name="line-1367"></a><span>           </span><span class="hs-special">(</span><a name="local-6989586621679059477"><a href="#local-6989586621679059477"><span class="hs-identifier">q</span></a></a><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059472"><span class="hs-identifier hs-var">deepA</span></a><span> </span><a href="#local-6989586621679059470"><span class="hs-identifier hs-var">two</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#applicativeTree"><span class="hs-identifier hs-var">applicativeTree</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059477"><span class="hs-identifier hs-var">q</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059474"><span class="hs-identifier hs-var">mSize'</span></a><span> </span><a href="#local-6989586621679059475"><span class="hs-identifier hs-var">n3</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059470"><span class="hs-identifier hs-var">two</span></a><span>
</span><a name="line-1368"></a><span>           </span><span class="hs-special">(</span><a name="local-6989586621679059478"><a href="#local-6989586621679059478"><span class="hs-identifier">q</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059472"><span class="hs-identifier hs-var">deepA</span></a><span> </span><a href="#local-6989586621679059471"><span class="hs-identifier hs-var">three</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#applicativeTree"><span class="hs-identifier hs-var">applicativeTree</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059478"><span class="hs-identifier hs-var">q</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059474"><span class="hs-identifier hs-var">mSize'</span></a><span> </span><a href="#local-6989586621679059475"><span class="hs-identifier hs-var">n3</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059470"><span class="hs-identifier hs-var">two</span></a><span>
</span><a name="line-1369"></a><span>      </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679059474"><a href="#local-6989586621679059474"><span class="hs-identifier">mSize'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">3</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><span> </span><a href="#local-6989586621679059467"><span class="hs-identifier hs-var">mSize</span></a><span>
</span><a name="line-1370"></a><span>            </span><a name="local-6989586621679059475"><a href="#local-6989586621679059475"><span class="hs-identifier">n3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#liftA3"><span class="hs-identifier hs-var">liftA3</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a href="#local-6989586621679059474"><span class="hs-identifier hs-var">mSize'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059468"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679059468"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679059468"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-1371"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1372"></a><span>    </span><a name="local-6989586621679059469"><a href="#local-6989586621679059469"><span class="hs-identifier">one</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a href="#local-6989586621679059468"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-1373"></a><span>    </span><a name="local-6989586621679059470"><a href="#local-6989586621679059470"><span class="hs-identifier">two</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#liftA2"><span class="hs-identifier hs-var">liftA2</span></a><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679059468"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679059468"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-1374"></a><span>    </span><a name="local-6989586621679059471"><a href="#local-6989586621679059471"><span class="hs-identifier">three</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#liftA3"><span class="hs-identifier hs-var">liftA3</span></a><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679059468"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679059468"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679059468"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-1375"></a><span>    </span><a name="local-6989586621679059472"><a href="#local-6989586621679059472"><span class="hs-identifier">deepA</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#liftA3"><span class="hs-identifier hs-var">liftA3</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059466"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><span> </span><a href="#local-6989586621679059467"><span class="hs-identifier hs-var">mSize</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1376"></a><span>    </span><a name="local-6989586621679059473"><a href="#local-6989586621679059473"><span class="hs-identifier">emptyTree</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span>
</span><a name="line-1377"></a><span>
</span><a name="line-1378"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-1379"></a><span class="hs-comment">-- Construction</span><span>
</span><a name="line-1380"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-1381"></a><span>
</span><a name="line-1382"></a><span class="hs-comment">-- | \( O(1) \). The empty sequence.</span><span>
</span><a name="line-1383"></a><span class="hs-identifier">empty</span><span>           </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679059051"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1384"></a><a name="empty"><a href="Data.Sequence.Internal.html#empty"><span class="hs-identifier">empty</span></a></a><span>           </span><span class="hs-glyph">=</span><span>  </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span>
</span><a name="line-1385"></a><span>
</span><a name="line-1386"></a><span class="hs-comment">-- | \( O(1) \). A singleton sequence.</span><span>
</span><a name="line-1387"></a><span class="hs-identifier">singleton</span><span>       </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679059050"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679059050"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1388"></a><a name="singleton"><a href="Data.Sequence.Internal.html#singleton"><span class="hs-identifier">singleton</span></a></a><span> </span><a name="local-6989586621679059479"><a href="#local-6989586621679059479"><span class="hs-identifier">x</span></a></a><span>     </span><span class="hs-glyph">=</span><span>  </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-var">Elem</span></a><span> </span><a href="#local-6989586621679059479"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1389"></a><span>
</span><a name="line-1390"></a><span class="hs-comment">-- | \( O(\log n) \). @replicate n x@ is a sequence consisting of @n@ copies of @x@.</span><span>
</span><a name="line-1391"></a><span class="hs-identifier">replicate</span><span>       </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059049"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679059049"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1392"></a><a name="replicate"><a href="Data.Sequence.Internal.html#replicate"><span class="hs-identifier">replicate</span></a></a><span> </span><a name="local-6989586621679059480"><a href="#local-6989586621679059480"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679059481"><a href="#local-6989586621679059481"><span class="hs-identifier">x</span></a></a><span>
</span><a name="line-1393"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679059480"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a><span> </span><span class="hs-number">0</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">runIdentity</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#replicateA"><span class="hs-identifier hs-var">replicateA</span></a><span> </span><a href="#local-6989586621679059480"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Functor.Identity.html#Identity"><span class="hs-identifier hs-var">Identity</span></a><span> </span><a href="#local-6989586621679059481"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1394"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a><span> </span><span class="hs-string">&quot;replicate takes a nonnegative integer argument&quot;</span><span>
</span><a name="line-1395"></a><span>
</span><a name="line-1396"></a><span class="hs-comment">-- | 'replicateA' is an 'Applicative' version of 'replicate', and makes</span><span>
</span><a name="line-1397"></a><span class="hs-comment">-- \( O(\log n) \) calls to 'liftA2' and 'pure'.</span><span>
</span><a name="line-1398"></a><span class="hs-comment">--</span><span>
</span><a name="line-1399"></a><span class="hs-comment">-- &gt; replicateA n x = sequenceA (replicate n x)</span><span>
</span><a name="line-1400"></a><span class="hs-identifier">replicateA</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">Applicative</span></a><span> </span><a href="#local-6989586621679059047"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059047"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679059048"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059047"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679059048"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1401"></a><a name="replicateA"><a href="Data.Sequence.Internal.html#replicateA"><span class="hs-identifier">replicateA</span></a></a><span> </span><a name="local-6989586621679059482"><a href="#local-6989586621679059482"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679059483"><a href="#local-6989586621679059483"><span class="hs-identifier">x</span></a></a><span>
</span><a name="line-1402"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679059482"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a><span> </span><span class="hs-number">0</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="Data.Sequence.Internal.html#applicativeTree"><span class="hs-identifier hs-var">applicativeTree</span></a><span> </span><a href="#local-6989586621679059482"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-var">Elem</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-6989586621679059483"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-1403"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a><span> </span><span class="hs-string">&quot;replicateA takes a nonnegative integer argument&quot;</span><span>
</span><a name="line-1404"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">replicateA</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">State</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">b</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">State</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Seq</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1405"></a><span>
</span><a name="line-1406"></a><span class="hs-comment">-- | 'replicateM' is a sequence counterpart of 'Control.Monad.replicateM'.</span><span>
</span><a name="line-1407"></a><span class="hs-comment">--</span><span>
</span><a name="line-1408"></a><span class="hs-comment">-- &gt; replicateM n x = sequence (replicate n x)</span><span>
</span><a name="line-1409"></a><span class="hs-comment">--</span><span>
</span><a name="line-1410"></a><span class="hs-comment">-- For @base &gt;= 4.8.0@ and @containers &gt;= 0.5.11@, 'replicateM'</span><span>
</span><a name="line-1411"></a><span class="hs-comment">-- is a synonym for 'replicateA'.</span><span>
</span><a name="line-1412"></a><span class="hs-cpp">#if MIN_VERSION_base(4,8,0)
</span><span class="hs-identifier">replicateM</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">Applicative</span></a><span> </span><a href="#local-6989586621679059043"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059043"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679059044"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059043"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679059044"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1414"></a><a name="replicateM"><a href="Data.Sequence.Internal.html#replicateM"><span class="hs-identifier">replicateM</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#replicateA"><span class="hs-identifier hs-var">replicateA</span></a><span>
</span><a name="line-1415"></a><span class="hs-cpp">#else
</span><span class="hs-identifier">replicateM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Monad</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-1417"></a><span class="hs-identifier">replicateM</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">x</span><span>
</span><a name="line-1418"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-operator">&gt;=</span><span> </span><span class="hs-number">0</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Applicative.unwrapMonad</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">replicateA</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Applicative.WrapMonad</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1419"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;replicateM takes a nonnegative integer argument&quot;</span><span>
</span><a name="line-1420"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-1422"></a><span class="hs-comment">-- | /O(/log/ k)/. @'cycleTaking' k xs@ forms a sequence of length @k@ by</span><span>
</span><a name="line-1423"></a><span class="hs-comment">-- repeatedly concatenating @xs@ with itself. @xs@ may only be empty if</span><span>
</span><a name="line-1424"></a><span class="hs-comment">-- @k@ is 0.</span><span>
</span><a name="line-1425"></a><span class="hs-comment">--</span><span>
</span><a name="line-1426"></a><span class="hs-comment">-- prop&gt; cycleTaking k = fromList . take k . cycle . toList</span><span>
</span><a name="line-1427"></a><span>
</span><a name="line-1428"></a><span class="hs-comment">-- If you wish to concatenate a non-empty sequence @xs@ with itself precisely</span><span>
</span><a name="line-1429"></a><span class="hs-comment">-- @k@ times, you can use @cycleTaking (k * length xs)@ or just</span><span>
</span><a name="line-1430"></a><span class="hs-comment">-- @replicate k () *&gt; xs@.</span><span>
</span><a name="line-1431"></a><span class="hs-comment">--</span><span>
</span><a name="line-1432"></a><span class="hs-comment">-- @since 0.5.8</span><span>
</span><a name="line-1433"></a><span class="hs-identifier">cycleTaking</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679059042"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679059042"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1434"></a><a name="cycleTaking"><a href="Data.Sequence.Internal.html#cycleTaking"><span class="hs-identifier">cycleTaking</span></a></a><span> </span><a name="local-6989586621679059484"><a href="#local-6989586621679059484"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679059485"><a href="#local-6989586621679059485"><span class="hs-identifier">_xs</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679059484"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-1435"></a><span class="hs-identifier">cycleTaking</span><span> </span><a name="local-6989586621679059486"><a href="#local-6989586621679059486"><span class="hs-identifier">_n</span></a></a><span> </span><a name="local-6989586621679059487"><a href="#local-6989586621679059487"><span class="hs-identifier">xs</span></a></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Data.Sequence.Internal.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-6989586621679059487"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a><span> </span><span class="hs-string">&quot;cycleTaking cannot take a positive number of elements from an empty cycle.&quot;</span><span>
</span><a name="line-1436"></a><span class="hs-identifier">cycleTaking</span><span> </span><a name="local-6989586621679059488"><a href="#local-6989586621679059488"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679059489"><a href="#local-6989586621679059489"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#cycleNTimes"><span class="hs-identifier hs-var">cycleNTimes</span></a><span> </span><a href="#local-6989586621679059490"><span class="hs-identifier hs-var">reps</span></a><span> </span><a href="#local-6989586621679059489"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="Data.Sequence.Internal.html#%3E%3C"><span class="hs-operator hs-var">&gt;&lt;</span></a><span> </span><a href="Data.Sequence.Internal.html#take"><span class="hs-identifier hs-var">take</span></a><span> </span><a href="#local-6989586621679059491"><span class="hs-identifier hs-var">final</span></a><span> </span><a href="#local-6989586621679059489"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1437"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1438"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679059490"><a href="#local-6989586621679059490"><span class="hs-identifier">reps</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679059491"><a href="#local-6989586621679059491"><span class="hs-identifier">final</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679059488"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Real.html#quotRem"><span class="hs-identifier hs-var">quotRem</span></a><span class="hs-special">`</span><span> </span><a href="Data.Sequence.Internal.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-6989586621679059489"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1439"></a><span>
</span><a name="line-1440"></a><span class="hs-comment">-- \( O(\log(kn)) \). @'cycleNTimes' k xs@ concatenates @k@ copies of @xs@. This</span><span>
</span><a name="line-1441"></a><span class="hs-comment">-- operation uses time and additional space logarithmic in the size of its</span><span>
</span><a name="line-1442"></a><span class="hs-comment">-- result.</span><span>
</span><a name="line-1443"></a><span class="hs-identifier">cycleNTimes</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679059041"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679059041"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1444"></a><a name="cycleNTimes"><a href="Data.Sequence.Internal.html#cycleNTimes"><span class="hs-identifier">cycleNTimes</span></a></a><span> </span><a name="local-6989586621679059492"><a href="#local-6989586621679059492"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679059493"><a href="#local-6989586621679059493"><span class="hs-identifier">xs</span></a></a><span>
</span><a name="line-1445"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679059492"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a><span> </span><span class="hs-number">0</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-1446"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679059492"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a><span> </span><span class="hs-number">1</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679059493"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1447"></a><span class="hs-identifier">cycleNTimes</span><span> </span><a name="local-6989586621679059494"><a href="#local-6989586621679059494"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a name="local-6989586621679059495"><a href="#local-6989586621679059495"><span class="hs-identifier">xsFT</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Data.Sequence.Internal.html#rigidify"><span class="hs-identifier hs-var">rigidify</span></a><span> </span><a href="#local-6989586621679059495"><span class="hs-identifier hs-var">xsFT</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1448"></a><span>             </span><a href="Data.Sequence.Internal.html#RigidEmpty"><span class="hs-identifier hs-var">RigidEmpty</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-1449"></a><span>             </span><a href="Data.Sequence.Internal.html#RigidOne"><span class="hs-identifier hs-var">RigidOne</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-var">Elem</span></a><span> </span><a name="local-6989586621679059496"><a href="#local-6989586621679059496"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#replicate"><span class="hs-identifier hs-var">replicate</span></a><span> </span><a href="#local-6989586621679059494"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679059496"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1450"></a><span>             </span><a href="Data.Sequence.Internal.html#RigidTwo"><span class="hs-identifier hs-var">RigidTwo</span></a><span> </span><a name="local-6989586621679059497"><a href="#local-6989586621679059497"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679059498"><a href="#local-6989586621679059498"><span class="hs-identifier">x2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1451"></a><span>               </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059494"><span class="hs-identifier hs-var">n</span></a><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059499"><span class="hs-identifier hs-var">pair</span></a><span>
</span><a name="line-1452"></a><span>                    </span><span class="hs-special">(</span><span class="hs-identifier">runIdentity</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#applicativeTree"><span class="hs-identifier hs-var">applicativeTree</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059494"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Functor.Identity.html#Identity"><span class="hs-identifier hs-var">Identity</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059497"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="#local-6989586621679059498"><span class="hs-identifier hs-var">x2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1453"></a><span>                    </span><a href="#local-6989586621679059499"><span class="hs-identifier hs-var">pair</span></a><span>
</span><a name="line-1454"></a><span>               </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679059499"><a href="#local-6989586621679059499"><span class="hs-identifier">pair</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679059497"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="#local-6989586621679059498"><span class="hs-identifier hs-var">x2</span></a><span>
</span><a name="line-1455"></a><span>             </span><a href="Data.Sequence.Internal.html#RigidThree"><span class="hs-identifier hs-var">RigidThree</span></a><span> </span><a name="local-6989586621679059500"><a href="#local-6989586621679059500"><span class="hs-identifier">x1</span></a></a><span> </span><a name="local-6989586621679059501"><a href="#local-6989586621679059501"><span class="hs-identifier">x2</span></a></a><span> </span><a name="local-6989586621679059502"><a href="#local-6989586621679059502"><span class="hs-identifier">x3</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1456"></a><span>               </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059494"><span class="hs-identifier hs-var">n</span></a><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><span class="hs-number">3</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059503"><span class="hs-identifier hs-var">triple</span></a><span>
</span><a name="line-1457"></a><span>                    </span><span class="hs-special">(</span><span class="hs-identifier">runIdentity</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#applicativeTree"><span class="hs-identifier hs-var">applicativeTree</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059494"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Functor.Identity.html#Identity"><span class="hs-identifier hs-var">Identity</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059500"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="#local-6989586621679059501"><span class="hs-identifier hs-var">x2</span></a><span> </span><a href="#local-6989586621679059502"><span class="hs-identifier hs-var">x3</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1458"></a><span>                    </span><a href="#local-6989586621679059503"><span class="hs-identifier hs-var">triple</span></a><span>
</span><a name="line-1459"></a><span>               </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679059503"><a href="#local-6989586621679059503"><span class="hs-identifier">triple</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679059500"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="#local-6989586621679059501"><span class="hs-identifier hs-var">x2</span></a><span> </span><a href="#local-6989586621679059502"><span class="hs-identifier hs-var">x3</span></a><span>
</span><a name="line-1460"></a><span>             </span><a href="Data.Sequence.Internal.html#RigidFull"><span class="hs-identifier hs-var">RigidFull</span></a><span> </span><a name="local-6989586621679059504"><a href="#local-6989586621679059504"><span class="hs-identifier">r</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Rigid"><span class="hs-identifier hs-var">Rigid</span></a><span> </span><a name="local-6989586621679059505"><a href="#local-6989586621679059505"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679059506"><a href="#local-6989586621679059506"><span class="hs-identifier">pr</span></a></a><span> </span><a name="local-6989586621679059507"><a href="#local-6989586621679059507"><span class="hs-identifier">_m</span></a></a><span> </span><a name="local-6989586621679059508"><a href="#local-6989586621679059508"><span class="hs-identifier">sf</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1461"></a><span>                   </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059494"><span class="hs-identifier hs-var">n</span></a><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><a href="#local-6989586621679059505"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-1462"></a><span>                        </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#nodeToDigit"><span class="hs-identifier hs-var">nodeToDigit</span></a><span> </span><a href="#local-6989586621679059506"><span class="hs-identifier hs-var">pr</span></a><span class="hs-special">)</span><span>
</span><a name="line-1463"></a><span>                        </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#cycleNMiddle"><span class="hs-identifier hs-var">cycleNMiddle</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059494"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059504"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-1464"></a><span>                        </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#nodeToDigit"><span class="hs-identifier hs-var">nodeToDigit</span></a><span> </span><a href="#local-6989586621679059508"><span class="hs-identifier hs-var">sf</span></a><span class="hs-special">)</span><span>
</span><a name="line-1465"></a><span>
</span><a name="line-1466"></a><span class="hs-identifier">cycleNMiddle</span><span>
</span><a name="line-1467"></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span>
</span><a name="line-1468"></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Rigid"><span class="hs-identifier hs-type">Rigid</span></a><span> </span><a href="#local-6989586621679059040"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-1469"></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059040"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-1470"></a><span>
</span><a name="line-1471"></a><span class="hs-comment">-- Not at the bottom yet</span><span>
</span><a name="line-1472"></a><span>
</span><a name="line-1473"></a><a name="cycleNMiddle"><a href="Data.Sequence.Internal.html#cycleNMiddle"><span class="hs-identifier">cycleNMiddle</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679059509"><a href="#local-6989586621679059509"><span class="hs-identifier">n</span></a></a><span>
</span><a name="line-1474"></a><span>           </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Rigid"><span class="hs-identifier hs-var">Rigid</span></a><span> </span><a name="local-6989586621679059510"><a href="#local-6989586621679059510"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679059511"><a href="#local-6989586621679059511"><span class="hs-identifier">pr</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#DeepTh"><span class="hs-identifier hs-var">DeepTh</span></a><span> </span><a name="local-6989586621679059512"><a href="#local-6989586621679059512"><span class="hs-identifier">sm</span></a></a><span> </span><a name="local-6989586621679059513"><a href="#local-6989586621679059513"><span class="hs-identifier">prm</span></a></a><span> </span><a name="local-6989586621679059514"><a href="#local-6989586621679059514"><span class="hs-identifier">mm</span></a></a><span> </span><a name="local-6989586621679059515"><a href="#local-6989586621679059515"><span class="hs-identifier">sfm</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059516"><a href="#local-6989586621679059516"><span class="hs-identifier">sf</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1475"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059512"><span class="hs-identifier hs-var">sm</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679059510"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059509"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- note: sm = s - size pr - size sf</span><span>
</span><a name="line-1476"></a><span>           </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#digit12ToDigit"><span class="hs-identifier hs-var">digit12ToDigit</span></a><span> </span><a href="#local-6989586621679059513"><span class="hs-identifier hs-var">prm</span></a><span class="hs-special">)</span><span>
</span><a name="line-1477"></a><span>           </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#cycleNMiddle"><span class="hs-identifier hs-var">cycleNMiddle</span></a><span> </span><a href="#local-6989586621679059509"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1478"></a><span>                       </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Rigid"><span class="hs-identifier hs-var">Rigid</span></a><span> </span><a href="#local-6989586621679059510"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#squashL"><span class="hs-identifier hs-var">squashL</span></a><span> </span><a href="#local-6989586621679059511"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679059513"><span class="hs-identifier hs-var">prm</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059514"><span class="hs-identifier hs-var">mm</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#squashR"><span class="hs-identifier hs-var">squashR</span></a><span> </span><a href="#local-6989586621679059515"><span class="hs-identifier hs-var">sfm</span></a><span> </span><a href="#local-6989586621679059516"><span class="hs-identifier hs-var">sf</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1479"></a><span>           </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#digit12ToDigit"><span class="hs-identifier hs-var">digit12ToDigit</span></a><span> </span><a href="#local-6989586621679059515"><span class="hs-identifier hs-var">sfm</span></a><span class="hs-special">)</span><span>
</span><a name="line-1480"></a><span>
</span><a name="line-1481"></a><span class="hs-comment">-- At the bottom</span><span>
</span><a name="line-1482"></a><span>
</span><a name="line-1483"></a><span class="hs-identifier">cycleNMiddle</span><span> </span><a name="local-6989586621679059517"><a href="#local-6989586621679059517"><span class="hs-identifier">n</span></a></a><span>
</span><a name="line-1484"></a><span>           </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Rigid"><span class="hs-identifier hs-var">Rigid</span></a><span> </span><a name="local-6989586621679059518"><a href="#local-6989586621679059518"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679059519"><a href="#local-6989586621679059519"><span class="hs-identifier">pr</span></a></a><span> </span><a href="Data.Sequence.Internal.html#EmptyTh"><span class="hs-identifier hs-var">EmptyTh</span></a><span> </span><a name="local-6989586621679059520"><a href="#local-6989586621679059520"><span class="hs-identifier">sf</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1485"></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#deep"><span class="hs-identifier hs-var">deep</span></a><span>
</span><a name="line-1486"></a><span>            </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a href="#local-6989586621679059520"><span class="hs-identifier hs-var">sf</span></a><span class="hs-special">)</span><span>
</span><a name="line-1487"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier">runIdentity</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#applicativeTree"><span class="hs-identifier hs-var">applicativeTree</span></a><span> </span><a href="#local-6989586621679059517"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679059518"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Functor.Identity.html#Identity"><span class="hs-identifier hs-var">Identity</span></a><span> </span><a href="#local-6989586621679059521"><span class="hs-identifier hs-var">converted</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1488"></a><span>            </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a href="#local-6989586621679059519"><span class="hs-identifier hs-var">pr</span></a><span class="hs-special">)</span><span>
</span><a name="line-1489"></a><span>   </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679059521"><a href="#local-6989586621679059521"><span class="hs-identifier">converted</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059519"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679059520"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-1490"></a><span>
</span><a name="line-1491"></a><span class="hs-identifier">cycleNMiddle</span><span> </span><a name="local-6989586621679059522"><a href="#local-6989586621679059522"><span class="hs-identifier">n</span></a></a><span>
</span><a name="line-1492"></a><span>           </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Rigid"><span class="hs-identifier hs-var">Rigid</span></a><span> </span><a name="local-6989586621679059523"><a href="#local-6989586621679059523"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679059524"><a href="#local-6989586621679059524"><span class="hs-identifier">pr</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#SingleTh"><span class="hs-identifier hs-var">SingleTh</span></a><span> </span><a name="local-6989586621679059525"><a href="#local-6989586621679059525"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059526"><a href="#local-6989586621679059526"><span class="hs-identifier">sf</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1493"></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#deep"><span class="hs-identifier hs-var">deep</span></a><span>
</span><a name="line-1494"></a><span>            </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679059525"><span class="hs-identifier hs-var">q</span></a><span> </span><a href="#local-6989586621679059526"><span class="hs-identifier hs-var">sf</span></a><span class="hs-special">)</span><span>
</span><a name="line-1495"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier">runIdentity</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#applicativeTree"><span class="hs-identifier hs-var">applicativeTree</span></a><span> </span><a href="#local-6989586621679059522"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679059523"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Functor.Identity.html#Identity"><span class="hs-identifier hs-var">Identity</span></a><span> </span><a href="#local-6989586621679059527"><span class="hs-identifier hs-var">converted</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1496"></a><span>            </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679059524"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679059525"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span>
</span><a name="line-1497"></a><span>   </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679059527"><a href="#local-6989586621679059527"><span class="hs-identifier">converted</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059524"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679059525"><span class="hs-identifier hs-var">q</span></a><span> </span><a href="#local-6989586621679059526"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-1498"></a><span>
</span><a name="line-1499"></a><span>
</span><a name="line-1500"></a><span class="hs-comment">-- | \( O(1) \). Add an element to the left end of a sequence.</span><span>
</span><a name="line-1501"></a><span class="hs-comment">-- Mnemonic: a triangle with the single element at the pointy end.</span><span>
</span><a name="line-1502"></a><span class="hs-special">(</span><span class="hs-operator">&lt;|</span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679059039"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679059039"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679059039"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1503"></a><a name="local-6989586621679059528"><a href="#local-6989586621679059528"><span class="hs-identifier">x</span></a></a><span> </span><a name="%3C%7C"><a href="Data.Sequence.Internal.html#%3C%7C"><span class="hs-operator">&lt;|</span></a></a><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a name="local-6989586621679059529"><a href="#local-6989586621679059529"><span class="hs-identifier">xs</span></a></a><span>     </span><span class="hs-glyph">=</span><span>  </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-var">Elem</span></a><span> </span><a href="#local-6989586621679059528"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#consTree"><span class="hs-identifier hs-var">consTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679059529"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1504"></a><span>
</span><a name="line-1505"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">consTree</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1506"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">consTree</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1507"></a><span class="hs-identifier">consTree</span><span>        </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a><span> </span><a href="#local-6989586621679059036"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679059036"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><a href="#local-6989586621679059036"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><a href="#local-6989586621679059036"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1508"></a><a name="consTree"><a href="Data.Sequence.Internal.html#consTree"><span class="hs-identifier">consTree</span></a></a><span> </span><a name="local-6989586621679059530"><a href="#local-6989586621679059530"><span class="hs-identifier">a</span></a></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><a href="#local-6989586621679059530"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1509"></a><span class="hs-identifier">consTree</span><span> </span><a name="local-6989586621679059531"><a href="#local-6989586621679059531"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><a name="local-6989586621679059532"><a href="#local-6989586621679059532"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#deep"><span class="hs-identifier hs-var">deep</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a href="#local-6989586621679059531"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a href="#local-6989586621679059532"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-1510"></a><span class="hs-comment">-- As described in the paper, we force the middle of a tree</span><span>
</span><a name="line-1511"></a><span class="hs-comment">-- *before* consing onto it; this preserves the amortized</span><span>
</span><a name="line-1512"></a><span class="hs-comment">-- bounds but prevents repeated consing from building up</span><span>
</span><a name="line-1513"></a><span class="hs-comment">-- gigantic suspensions.</span><span>
</span><a name="line-1514"></a><span class="hs-identifier">consTree</span><span> </span><a name="local-6989586621679059533"><a href="#local-6989586621679059533"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679059534"><a href="#local-6989586621679059534"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679059535"><a href="#local-6989586621679059535"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059536"><a href="#local-6989586621679059536"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679059537"><a href="#local-6989586621679059537"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679059538"><a href="#local-6989586621679059538"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059539"><a href="#local-6989586621679059539"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679059540"><a href="#local-6989586621679059540"><span class="hs-identifier">sf</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679059539"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span>
</span><a name="line-1515"></a><span>    </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679059533"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679059534"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679059533"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059535"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059536"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679059537"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679059538"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#consTree"><span class="hs-identifier hs-var">consTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679059539"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059540"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-1516"></a><span class="hs-identifier">consTree</span><span> </span><a name="local-6989586621679059541"><a href="#local-6989586621679059541"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679059542"><a href="#local-6989586621679059542"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679059543"><a href="#local-6989586621679059543"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059544"><a href="#local-6989586621679059544"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679059545"><a href="#local-6989586621679059545"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059546"><a href="#local-6989586621679059546"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679059547"><a href="#local-6989586621679059547"><span class="hs-identifier">sf</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1517"></a><span>    </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679059541"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679059542"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a href="#local-6989586621679059541"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059543"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059544"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679059545"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059546"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679059547"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-1518"></a><span class="hs-identifier">consTree</span><span> </span><a name="local-6989586621679059548"><a href="#local-6989586621679059548"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679059549"><a href="#local-6989586621679059549"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679059550"><a href="#local-6989586621679059550"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059551"><a href="#local-6989586621679059551"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059552"><a href="#local-6989586621679059552"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679059553"><a href="#local-6989586621679059553"><span class="hs-identifier">sf</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1519"></a><span>    </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679059548"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679059549"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679059548"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059550"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059551"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059552"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679059553"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-1520"></a><span class="hs-identifier">consTree</span><span> </span><a name="local-6989586621679059554"><a href="#local-6989586621679059554"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679059555"><a href="#local-6989586621679059555"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679059556"><a href="#local-6989586621679059556"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059557"><a href="#local-6989586621679059557"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679059558"><a href="#local-6989586621679059558"><span class="hs-identifier">sf</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1521"></a><span>    </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679059554"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679059555"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679059554"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059556"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059557"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679059558"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-1522"></a><span>
</span><a name="line-1523"></a><span class="hs-identifier">cons'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679059035"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679059035"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679059035"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1524"></a><a name="cons%27"><a href="Data.Sequence.Internal.html#cons%27"><span class="hs-identifier">cons'</span></a></a><span> </span><a name="local-6989586621679059559"><a href="#local-6989586621679059559"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a name="local-6989586621679059560"><a href="#local-6989586621679059560"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-var">Elem</span></a><span> </span><a href="#local-6989586621679059559"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#consTree%27"><span class="hs-identifier hs-var">consTree'</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679059560"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1525"></a><span>
</span><a name="line-1526"></a><span class="hs-identifier">snoc'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679059034"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059034"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679059034"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1527"></a><a name="snoc%27"><a href="Data.Sequence.Internal.html#snoc%27"><span class="hs-identifier">snoc'</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a name="local-6989586621679059561"><a href="#local-6989586621679059561"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059562"><a href="#local-6989586621679059562"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059561"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#snocTree%27"><span class="hs-identifier hs-var">snocTree'</span></a><span class="hs-special">`</span><span> </span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-var">Elem</span></a><span> </span><a href="#local-6989586621679059562"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-1528"></a><span>
</span><a name="line-1529"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">consTree'</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1530"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">consTree'</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1531"></a><span class="hs-identifier">consTree'</span><span>        </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a><span> </span><a href="#local-6989586621679059031"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679059031"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><a href="#local-6989586621679059031"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><a href="#local-6989586621679059031"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1532"></a><a name="consTree%27"><a href="Data.Sequence.Internal.html#consTree%27"><span class="hs-identifier">consTree'</span></a></a><span> </span><a name="local-6989586621679059563"><a href="#local-6989586621679059563"><span class="hs-identifier">a</span></a></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><a href="#local-6989586621679059563"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1533"></a><span class="hs-identifier">consTree'</span><span> </span><a name="local-6989586621679059564"><a href="#local-6989586621679059564"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><a name="local-6989586621679059565"><a href="#local-6989586621679059565"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#deep"><span class="hs-identifier hs-var">deep</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a href="#local-6989586621679059564"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a href="#local-6989586621679059565"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-1534"></a><span class="hs-comment">-- As described in the paper, we force the middle of a tree</span><span>
</span><a name="line-1535"></a><span class="hs-comment">-- *before* consing onto it; this preserves the amortized</span><span>
</span><a name="line-1536"></a><span class="hs-comment">-- bounds but prevents repeated consing from building up</span><span>
</span><a name="line-1537"></a><span class="hs-comment">-- gigantic suspensions.</span><span>
</span><a name="line-1538"></a><span class="hs-identifier">consTree'</span><span> </span><a name="local-6989586621679059566"><a href="#local-6989586621679059566"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679059567"><a href="#local-6989586621679059567"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679059568"><a href="#local-6989586621679059568"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059569"><a href="#local-6989586621679059569"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679059570"><a href="#local-6989586621679059570"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679059571"><a href="#local-6989586621679059571"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059572"><a href="#local-6989586621679059572"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679059573"><a href="#local-6989586621679059573"><span class="hs-identifier">sf</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1539"></a><span>    </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679059566"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679059567"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679059566"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059568"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059574"><span class="hs-identifier hs-var">m'</span></a><span> </span><a href="#local-6989586621679059573"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-1540"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679059574"><a href="#local-6989586621679059574"><span class="hs-identifier">m'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679059575"><span class="hs-identifier hs-var">abc</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#consTree%27"><span class="hs-identifier hs-var">consTree'</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679059572"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-1541"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679059575"><a href="#local-6989586621679059575"><span class="hs-identifier">abc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059569"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679059570"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679059571"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-1542"></a><span class="hs-identifier">consTree'</span><span> </span><a name="local-6989586621679059576"><a href="#local-6989586621679059576"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679059577"><a href="#local-6989586621679059577"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679059578"><a href="#local-6989586621679059578"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059579"><a href="#local-6989586621679059579"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679059580"><a href="#local-6989586621679059580"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059581"><a href="#local-6989586621679059581"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679059582"><a href="#local-6989586621679059582"><span class="hs-identifier">sf</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1543"></a><span>    </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679059576"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679059577"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a href="#local-6989586621679059576"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059578"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059579"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679059580"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059581"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679059582"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-1544"></a><span class="hs-identifier">consTree'</span><span> </span><a name="local-6989586621679059583"><a href="#local-6989586621679059583"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679059584"><a href="#local-6989586621679059584"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679059585"><a href="#local-6989586621679059585"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059586"><a href="#local-6989586621679059586"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059587"><a href="#local-6989586621679059587"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679059588"><a href="#local-6989586621679059588"><span class="hs-identifier">sf</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1545"></a><span>    </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679059583"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679059584"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679059583"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059585"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059586"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059587"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679059588"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-1546"></a><span class="hs-identifier">consTree'</span><span> </span><a name="local-6989586621679059589"><a href="#local-6989586621679059589"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679059590"><a href="#local-6989586621679059590"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679059591"><a href="#local-6989586621679059591"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059592"><a href="#local-6989586621679059592"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679059593"><a href="#local-6989586621679059593"><span class="hs-identifier">sf</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1547"></a><span>    </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679059589"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679059590"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679059589"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059591"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059592"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679059593"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-1548"></a><span>
</span><a name="line-1549"></a><span class="hs-comment">-- | \( O(1) \). Add an element to the right end of a sequence.</span><span>
</span><a name="line-1550"></a><span class="hs-comment">-- Mnemonic: a triangle with the single element at the pointy end.</span><span>
</span><a name="line-1551"></a><span class="hs-special">(</span><span class="hs-operator">|&gt;</span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679059030"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059030"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679059030"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1552"></a><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a name="local-6989586621679059594"><a href="#local-6989586621679059594"><span class="hs-identifier">xs</span></a></a><span> </span><a name="%7C%3E"><a href="Data.Sequence.Internal.html#%7C%3E"><span class="hs-operator">|&gt;</span></a></a><span> </span><a name="local-6989586621679059595"><a href="#local-6989586621679059595"><span class="hs-identifier">x</span></a></a><span>     </span><span class="hs-glyph">=</span><span>  </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059594"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#snocTree"><span class="hs-identifier hs-var">snocTree</span></a><span class="hs-special">`</span><span> </span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-var">Elem</span></a><span> </span><a href="#local-6989586621679059595"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-1553"></a><span>
</span><a name="line-1554"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">snocTree</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1555"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">snocTree</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1556"></a><span class="hs-identifier">snocTree</span><span>        </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a><span> </span><a href="#local-6989586621679059027"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><a href="#local-6989586621679059027"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059027"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><a href="#local-6989586621679059027"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1557"></a><a name="snocTree"><a href="Data.Sequence.Internal.html#snocTree"><span class="hs-identifier">snocTree</span></a></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><a name="local-6989586621679059596"><a href="#local-6989586621679059596"><span class="hs-identifier">a</span></a></a><span>       </span><span class="hs-glyph">=</span><span>  </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><a href="#local-6989586621679059596"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1558"></a><span class="hs-identifier">snocTree</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><a name="local-6989586621679059597"><a href="#local-6989586621679059597"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059598"><a href="#local-6989586621679059598"><span class="hs-identifier">b</span></a></a><span>   </span><span class="hs-glyph">=</span><span>  </span><a href="Data.Sequence.Internal.html#deep"><span class="hs-identifier hs-var">deep</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a href="#local-6989586621679059597"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a href="#local-6989586621679059598"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-1559"></a><span class="hs-comment">-- See note on `seq` in `consTree`.</span><span>
</span><a name="line-1560"></a><span class="hs-identifier">snocTree</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679059599"><a href="#local-6989586621679059599"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679059600"><a href="#local-6989586621679059600"><span class="hs-identifier">pr</span></a></a><span> </span><a name="local-6989586621679059601"><a href="#local-6989586621679059601"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679059602"><a href="#local-6989586621679059602"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059603"><a href="#local-6989586621679059603"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059604"><a href="#local-6989586621679059604"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679059605"><a href="#local-6989586621679059605"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679059606"><a href="#local-6989586621679059606"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679059601"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span>
</span><a name="line-1561"></a><span>    </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059599"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679059606"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059600"><span class="hs-identifier hs-var">pr</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059601"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#snocTree"><span class="hs-identifier hs-var">snocTree</span></a><span class="hs-special">`</span><span> </span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059602"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059603"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059604"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679059605"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679059606"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-1562"></a><span class="hs-identifier">snocTree</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679059607"><a href="#local-6989586621679059607"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679059608"><a href="#local-6989586621679059608"><span class="hs-identifier">pr</span></a></a><span> </span><a name="local-6989586621679059609"><a href="#local-6989586621679059609"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679059610"><a href="#local-6989586621679059610"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059611"><a href="#local-6989586621679059611"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059612"><a href="#local-6989586621679059612"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679059613"><a href="#local-6989586621679059613"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1563"></a><span>    </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059607"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679059613"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059608"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679059609"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a href="#local-6989586621679059610"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059611"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059612"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679059613"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-1564"></a><span class="hs-identifier">snocTree</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679059614"><a href="#local-6989586621679059614"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679059615"><a href="#local-6989586621679059615"><span class="hs-identifier">pr</span></a></a><span> </span><a name="local-6989586621679059616"><a href="#local-6989586621679059616"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679059617"><a href="#local-6989586621679059617"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059618"><a href="#local-6989586621679059618"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679059619"><a href="#local-6989586621679059619"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1565"></a><span>    </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059614"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679059619"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059615"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679059616"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679059617"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059618"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059619"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-1566"></a><span class="hs-identifier">snocTree</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679059620"><a href="#local-6989586621679059620"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679059621"><a href="#local-6989586621679059621"><span class="hs-identifier">pr</span></a></a><span> </span><a name="local-6989586621679059622"><a href="#local-6989586621679059622"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679059623"><a href="#local-6989586621679059623"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679059624"><a href="#local-6989586621679059624"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1567"></a><span>    </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059620"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679059624"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059621"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679059622"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679059623"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059624"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-1568"></a><span>
</span><a name="line-1569"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">snocTree'</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1570"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">snocTree'</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1571"></a><span class="hs-identifier">snocTree'</span><span>        </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a><span> </span><a href="#local-6989586621679059024"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><a href="#local-6989586621679059024"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059024"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><a href="#local-6989586621679059024"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1572"></a><a name="snocTree%27"><a href="Data.Sequence.Internal.html#snocTree%27"><span class="hs-identifier">snocTree'</span></a></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><a name="local-6989586621679059625"><a href="#local-6989586621679059625"><span class="hs-identifier">a</span></a></a><span>       </span><span class="hs-glyph">=</span><span>  </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><a href="#local-6989586621679059625"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1573"></a><span class="hs-identifier">snocTree'</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><a name="local-6989586621679059626"><a href="#local-6989586621679059626"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059627"><a href="#local-6989586621679059627"><span class="hs-identifier">b</span></a></a><span>   </span><span class="hs-glyph">=</span><span>  </span><a href="Data.Sequence.Internal.html#deep"><span class="hs-identifier hs-var">deep</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a href="#local-6989586621679059626"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a href="#local-6989586621679059627"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-1574"></a><span class="hs-comment">-- See note on `seq` in `consTree`.</span><span>
</span><a name="line-1575"></a><span class="hs-identifier">snocTree'</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679059628"><a href="#local-6989586621679059628"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679059629"><a href="#local-6989586621679059629"><span class="hs-identifier">pr</span></a></a><span> </span><a name="local-6989586621679059630"><a href="#local-6989586621679059630"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679059631"><a href="#local-6989586621679059631"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059632"><a href="#local-6989586621679059632"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059633"><a href="#local-6989586621679059633"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679059634"><a href="#local-6989586621679059634"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679059635"><a href="#local-6989586621679059635"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1576"></a><span>    </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059628"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679059635"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059629"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679059636"><span class="hs-identifier hs-var">m'</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679059634"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679059635"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-1577"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679059636"><a href="#local-6989586621679059636"><span class="hs-identifier">m'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679059630"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#snocTree%27"><span class="hs-identifier hs-var">snocTree'</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679059637"><span class="hs-identifier hs-var">abc</span></a><span>
</span><a name="line-1578"></a><span>        </span><span class="hs-glyph">!</span><a name="local-6989586621679059637"><a href="#local-6989586621679059637"><span class="hs-identifier">abc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059631"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059632"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059633"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-1579"></a><span class="hs-identifier">snocTree'</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679059638"><a href="#local-6989586621679059638"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679059639"><a href="#local-6989586621679059639"><span class="hs-identifier">pr</span></a></a><span> </span><a name="local-6989586621679059640"><a href="#local-6989586621679059640"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679059641"><a href="#local-6989586621679059641"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059642"><a href="#local-6989586621679059642"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059643"><a href="#local-6989586621679059643"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679059644"><a href="#local-6989586621679059644"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1580"></a><span>    </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059638"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679059644"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059639"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679059640"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a href="#local-6989586621679059641"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059642"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059643"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679059644"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-1581"></a><span class="hs-identifier">snocTree'</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679059645"><a href="#local-6989586621679059645"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679059646"><a href="#local-6989586621679059646"><span class="hs-identifier">pr</span></a></a><span> </span><a name="local-6989586621679059647"><a href="#local-6989586621679059647"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679059648"><a href="#local-6989586621679059648"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059649"><a href="#local-6989586621679059649"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679059650"><a href="#local-6989586621679059650"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1582"></a><span>    </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059645"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679059650"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059646"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679059647"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679059648"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059649"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059650"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-1583"></a><span class="hs-identifier">snocTree'</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679059651"><a href="#local-6989586621679059651"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679059652"><a href="#local-6989586621679059652"><span class="hs-identifier">pr</span></a></a><span> </span><a name="local-6989586621679059653"><a href="#local-6989586621679059653"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679059654"><a href="#local-6989586621679059654"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679059655"><a href="#local-6989586621679059655"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1584"></a><span>    </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059651"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679059655"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059652"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679059653"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679059654"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059655"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-1585"></a><span>
</span><a name="line-1586"></a><span class="hs-comment">-- | \( O(\log(\min(n_1,n_2))) \). Concatenate two sequences.</span><span>
</span><a name="line-1587"></a><span class="hs-special">(</span><span class="hs-operator">&gt;&lt;</span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679059023"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679059023"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679059023"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1588"></a><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a name="local-6989586621679059656"><a href="#local-6989586621679059656"><span class="hs-identifier">xs</span></a></a><span> </span><a name="%3E%3C"><a href="Data.Sequence.Internal.html#%3E%3C"><span class="hs-operator">&gt;&lt;</span></a></a><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a name="local-6989586621679059657"><a href="#local-6989586621679059657"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#appendTree0"><span class="hs-identifier hs-var">appendTree0</span></a><span> </span><a href="#local-6989586621679059656"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679059657"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span>
</span><a name="line-1589"></a><span>
</span><a name="line-1590"></a><span class="hs-comment">-- The appendTree/addDigits gunk below is machine generated</span><span>
</span><a name="line-1591"></a><span>
</span><a name="line-1592"></a><span class="hs-identifier">appendTree0</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679059022"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679059022"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679059022"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1593"></a><a name="appendTree0"><a href="Data.Sequence.Internal.html#appendTree0"><span class="hs-identifier">appendTree0</span></a></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><a name="local-6989586621679059658"><a href="#local-6989586621679059658"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1594"></a><span>    </span><a href="#local-6989586621679059658"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1595"></a><span class="hs-identifier">appendTree0</span><span> </span><a name="local-6989586621679059659"><a href="#local-6989586621679059659"><span class="hs-identifier">xs</span></a></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1596"></a><span>    </span><a href="#local-6989586621679059659"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1597"></a><span class="hs-identifier">appendTree0</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><a name="local-6989586621679059660"><a href="#local-6989586621679059660"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059661"><a href="#local-6989586621679059661"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1598"></a><span>    </span><a href="#local-6989586621679059660"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#consTree"><span class="hs-identifier hs-var">consTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679059661"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1599"></a><span class="hs-identifier">appendTree0</span><span> </span><a name="local-6989586621679059662"><a href="#local-6989586621679059662"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><a name="local-6989586621679059663"><a href="#local-6989586621679059663"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1600"></a><span>    </span><a href="#local-6989586621679059662"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#snocTree"><span class="hs-identifier hs-var">snocTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679059663"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1601"></a><span class="hs-identifier">appendTree0</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679059664"><a href="#local-6989586621679059664"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-6989586621679059665"><a href="#local-6989586621679059665"><span class="hs-identifier">pr1</span></a></a><span> </span><a name="local-6989586621679059666"><a href="#local-6989586621679059666"><span class="hs-identifier">m1</span></a></a><span> </span><a name="local-6989586621679059667"><a href="#local-6989586621679059667"><span class="hs-identifier">sf1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679059668"><a href="#local-6989586621679059668"><span class="hs-identifier">s2</span></a></a><span> </span><a name="local-6989586621679059669"><a href="#local-6989586621679059669"><span class="hs-identifier">pr2</span></a></a><span> </span><a name="local-6989586621679059670"><a href="#local-6989586621679059670"><span class="hs-identifier">m2</span></a></a><span> </span><a name="local-6989586621679059671"><a href="#local-6989586621679059671"><span class="hs-identifier">sf2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1602"></a><span>    </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059664"><span class="hs-identifier hs-var">s1</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679059668"><span class="hs-identifier hs-var">s2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059665"><span class="hs-identifier hs-var">pr1</span></a><span> </span><a href="#local-6989586621679059672"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679059671"><span class="hs-identifier hs-var">sf2</span></a><span>
</span><a name="line-1603"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679059672"><a href="#local-6989586621679059672"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#addDigits0"><span class="hs-identifier hs-var">addDigits0</span></a><span> </span><a href="#local-6989586621679059666"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="#local-6989586621679059667"><span class="hs-identifier hs-var">sf1</span></a><span> </span><a href="#local-6989586621679059669"><span class="hs-identifier hs-var">pr2</span></a><span> </span><a href="#local-6989586621679059670"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1604"></a><span>
</span><a name="line-1605"></a><span class="hs-identifier">addDigits0</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679059021"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679059021"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679059021"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679059021"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679059021"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1606"></a><a name="addDigits0"><a href="Data.Sequence.Internal.html#addDigits0"><span class="hs-identifier">addDigits0</span></a></a><span> </span><a name="local-6989586621679059673"><a href="#local-6989586621679059673"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679059674"><a href="#local-6989586621679059674"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679059675"><a href="#local-6989586621679059675"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059676"><a href="#local-6989586621679059676"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1607"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree1"><span class="hs-identifier hs-var">appendTree1</span></a><span> </span><a href="#local-6989586621679059673"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059674"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059675"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059676"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1608"></a><span class="hs-identifier">addDigits0</span><span> </span><a name="local-6989586621679059677"><a href="#local-6989586621679059677"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679059678"><a href="#local-6989586621679059678"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679059679"><a href="#local-6989586621679059679"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059680"><a href="#local-6989586621679059680"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059681"><a href="#local-6989586621679059681"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1609"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree1"><span class="hs-identifier hs-var">appendTree1</span></a><span> </span><a href="#local-6989586621679059677"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059678"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059679"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059680"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059681"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1610"></a><span class="hs-identifier">addDigits0</span><span> </span><a name="local-6989586621679059682"><a href="#local-6989586621679059682"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679059683"><a href="#local-6989586621679059683"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679059684"><a href="#local-6989586621679059684"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059685"><a href="#local-6989586621679059685"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679059686"><a href="#local-6989586621679059686"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059687"><a href="#local-6989586621679059687"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1611"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree2"><span class="hs-identifier hs-var">appendTree2</span></a><span> </span><a href="#local-6989586621679059682"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059683"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059684"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059685"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679059686"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059687"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1612"></a><span class="hs-identifier">addDigits0</span><span> </span><a name="local-6989586621679059688"><a href="#local-6989586621679059688"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679059689"><a href="#local-6989586621679059689"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679059690"><a href="#local-6989586621679059690"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059691"><a href="#local-6989586621679059691"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679059692"><a href="#local-6989586621679059692"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679059693"><a href="#local-6989586621679059693"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059694"><a href="#local-6989586621679059694"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1613"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree2"><span class="hs-identifier hs-var">appendTree2</span></a><span> </span><a href="#local-6989586621679059688"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059689"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059690"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059691"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059692"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679059693"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059694"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1614"></a><span class="hs-identifier">addDigits0</span><span> </span><a name="local-6989586621679059695"><a href="#local-6989586621679059695"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679059696"><a href="#local-6989586621679059696"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059697"><a href="#local-6989586621679059697"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679059698"><a href="#local-6989586621679059698"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059699"><a href="#local-6989586621679059699"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1615"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree1"><span class="hs-identifier hs-var">appendTree1</span></a><span> </span><a href="#local-6989586621679059695"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059696"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059697"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059698"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059699"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1616"></a><span class="hs-identifier">addDigits0</span><span> </span><a name="local-6989586621679059700"><a href="#local-6989586621679059700"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679059701"><a href="#local-6989586621679059701"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059702"><a href="#local-6989586621679059702"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679059703"><a href="#local-6989586621679059703"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679059704"><a href="#local-6989586621679059704"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059705"><a href="#local-6989586621679059705"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1617"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree2"><span class="hs-identifier hs-var">appendTree2</span></a><span> </span><a href="#local-6989586621679059700"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059701"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059702"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059703"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679059704"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059705"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1618"></a><span class="hs-identifier">addDigits0</span><span> </span><a name="local-6989586621679059706"><a href="#local-6989586621679059706"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679059707"><a href="#local-6989586621679059707"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059708"><a href="#local-6989586621679059708"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679059709"><a href="#local-6989586621679059709"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679059710"><a href="#local-6989586621679059710"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679059711"><a href="#local-6989586621679059711"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059712"><a href="#local-6989586621679059712"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1619"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree2"><span class="hs-identifier hs-var">appendTree2</span></a><span> </span><a href="#local-6989586621679059706"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059707"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059708"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059709"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059710"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679059711"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059712"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1620"></a><span class="hs-identifier">addDigits0</span><span> </span><a name="local-6989586621679059713"><a href="#local-6989586621679059713"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679059714"><a href="#local-6989586621679059714"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059715"><a href="#local-6989586621679059715"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679059716"><a href="#local-6989586621679059716"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679059717"><a href="#local-6989586621679059717"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679059718"><a href="#local-6989586621679059718"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679059719"><a href="#local-6989586621679059719"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059720"><a href="#local-6989586621679059720"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1621"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree2"><span class="hs-identifier hs-var">appendTree2</span></a><span> </span><a href="#local-6989586621679059713"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059714"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059715"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059716"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059717"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679059718"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679059719"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059720"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1622"></a><span class="hs-identifier">addDigits0</span><span> </span><a name="local-6989586621679059721"><a href="#local-6989586621679059721"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679059722"><a href="#local-6989586621679059722"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059723"><a href="#local-6989586621679059723"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059724"><a href="#local-6989586621679059724"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679059725"><a href="#local-6989586621679059725"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059726"><a href="#local-6989586621679059726"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1623"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree2"><span class="hs-identifier hs-var">appendTree2</span></a><span> </span><a href="#local-6989586621679059721"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059722"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059723"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059724"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679059725"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059726"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1624"></a><span class="hs-identifier">addDigits0</span><span> </span><a name="local-6989586621679059727"><a href="#local-6989586621679059727"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679059728"><a href="#local-6989586621679059728"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059729"><a href="#local-6989586621679059729"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059730"><a href="#local-6989586621679059730"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679059731"><a href="#local-6989586621679059731"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679059732"><a href="#local-6989586621679059732"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059733"><a href="#local-6989586621679059733"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1625"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree2"><span class="hs-identifier hs-var">appendTree2</span></a><span> </span><a href="#local-6989586621679059727"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059728"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059729"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059730"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059731"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679059732"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059733"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1626"></a><span class="hs-identifier">addDigits0</span><span> </span><a name="local-6989586621679059734"><a href="#local-6989586621679059734"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679059735"><a href="#local-6989586621679059735"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059736"><a href="#local-6989586621679059736"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059737"><a href="#local-6989586621679059737"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679059738"><a href="#local-6989586621679059738"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679059739"><a href="#local-6989586621679059739"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679059740"><a href="#local-6989586621679059740"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059741"><a href="#local-6989586621679059741"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1627"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree2"><span class="hs-identifier hs-var">appendTree2</span></a><span> </span><a href="#local-6989586621679059734"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059735"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059736"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059737"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059738"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679059739"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679059740"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059741"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1628"></a><span class="hs-identifier">addDigits0</span><span> </span><a name="local-6989586621679059742"><a href="#local-6989586621679059742"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679059743"><a href="#local-6989586621679059743"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059744"><a href="#local-6989586621679059744"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059745"><a href="#local-6989586621679059745"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679059746"><a href="#local-6989586621679059746"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679059747"><a href="#local-6989586621679059747"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679059748"><a href="#local-6989586621679059748"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679059749"><a href="#local-6989586621679059749"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059750"><a href="#local-6989586621679059750"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1629"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679059742"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059743"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059744"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059745"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059746"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679059747"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059748"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679059749"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059750"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1630"></a><span class="hs-identifier">addDigits0</span><span> </span><a name="local-6989586621679059751"><a href="#local-6989586621679059751"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679059752"><a href="#local-6989586621679059752"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059753"><a href="#local-6989586621679059753"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059754"><a href="#local-6989586621679059754"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679059755"><a href="#local-6989586621679059755"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679059756"><a href="#local-6989586621679059756"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059757"><a href="#local-6989586621679059757"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1631"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree2"><span class="hs-identifier hs-var">appendTree2</span></a><span> </span><a href="#local-6989586621679059751"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059752"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059753"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059754"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059755"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679059756"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059757"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1632"></a><span class="hs-identifier">addDigits0</span><span> </span><a name="local-6989586621679059758"><a href="#local-6989586621679059758"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679059759"><a href="#local-6989586621679059759"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059760"><a href="#local-6989586621679059760"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059761"><a href="#local-6989586621679059761"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679059762"><a href="#local-6989586621679059762"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679059763"><a href="#local-6989586621679059763"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679059764"><a href="#local-6989586621679059764"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059765"><a href="#local-6989586621679059765"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1633"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree2"><span class="hs-identifier hs-var">appendTree2</span></a><span> </span><a href="#local-6989586621679059758"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059759"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059760"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059761"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059762"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679059763"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679059764"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059765"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1634"></a><span class="hs-identifier">addDigits0</span><span> </span><a name="local-6989586621679059766"><a href="#local-6989586621679059766"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679059767"><a href="#local-6989586621679059767"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059768"><a href="#local-6989586621679059768"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059769"><a href="#local-6989586621679059769"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679059770"><a href="#local-6989586621679059770"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679059771"><a href="#local-6989586621679059771"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679059772"><a href="#local-6989586621679059772"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679059773"><a href="#local-6989586621679059773"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059774"><a href="#local-6989586621679059774"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1635"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679059766"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059767"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059768"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059769"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059770"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679059771"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059772"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679059773"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059774"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1636"></a><span class="hs-identifier">addDigits0</span><span> </span><a name="local-6989586621679059775"><a href="#local-6989586621679059775"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679059776"><a href="#local-6989586621679059776"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059777"><a href="#local-6989586621679059777"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059778"><a href="#local-6989586621679059778"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679059779"><a href="#local-6989586621679059779"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679059780"><a href="#local-6989586621679059780"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679059781"><a href="#local-6989586621679059781"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679059782"><a href="#local-6989586621679059782"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679059783"><a href="#local-6989586621679059783"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059784"><a href="#local-6989586621679059784"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1637"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679059775"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059776"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059777"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059778"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059779"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679059780"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679059781"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059782"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679059783"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059784"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1638"></a><span>
</span><a name="line-1639"></a><span class="hs-identifier">appendTree1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059020"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059020"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059020"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059020"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1640"></a><a name="appendTree1"><a href="Data.Sequence.Internal.html#appendTree1"><span class="hs-identifier">appendTree1</span></a></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679059785"><a href="#local-6989586621679059785"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059786"><a href="#local-6989586621679059786"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1641"></a><span>    </span><a href="#local-6989586621679059785"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#consTree"><span class="hs-identifier hs-var">consTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679059786"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1642"></a><span class="hs-identifier">appendTree1</span><span> </span><a name="local-6989586621679059787"><a href="#local-6989586621679059787"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679059788"><a href="#local-6989586621679059788"><span class="hs-identifier">a</span></a></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1643"></a><span>    </span><a href="#local-6989586621679059787"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#snocTree"><span class="hs-identifier hs-var">snocTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679059788"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1644"></a><span class="hs-identifier">appendTree1</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><a name="local-6989586621679059789"><a href="#local-6989586621679059789"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679059790"><a href="#local-6989586621679059790"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059791"><a href="#local-6989586621679059791"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1645"></a><span>    </span><a href="#local-6989586621679059789"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#consTree"><span class="hs-identifier hs-var">consTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679059790"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#consTree"><span class="hs-identifier hs-var">consTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679059791"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1646"></a><span class="hs-identifier">appendTree1</span><span> </span><a name="local-6989586621679059792"><a href="#local-6989586621679059792"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679059793"><a href="#local-6989586621679059793"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><a name="local-6989586621679059794"><a href="#local-6989586621679059794"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1647"></a><span>    </span><a href="#local-6989586621679059792"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#snocTree"><span class="hs-identifier hs-var">snocTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679059793"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#snocTree"><span class="hs-identifier hs-var">snocTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679059794"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1648"></a><span class="hs-identifier">appendTree1</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679059795"><a href="#local-6989586621679059795"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-6989586621679059796"><a href="#local-6989586621679059796"><span class="hs-identifier">pr1</span></a></a><span> </span><a name="local-6989586621679059797"><a href="#local-6989586621679059797"><span class="hs-identifier">m1</span></a></a><span> </span><a name="local-6989586621679059798"><a href="#local-6989586621679059798"><span class="hs-identifier">sf1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059799"><a href="#local-6989586621679059799"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679059800"><a href="#local-6989586621679059800"><span class="hs-identifier">s2</span></a></a><span> </span><a name="local-6989586621679059801"><a href="#local-6989586621679059801"><span class="hs-identifier">pr2</span></a></a><span> </span><a name="local-6989586621679059802"><a href="#local-6989586621679059802"><span class="hs-identifier">m2</span></a></a><span> </span><a name="local-6989586621679059803"><a href="#local-6989586621679059803"><span class="hs-identifier">sf2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1649"></a><span>    </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059795"><span class="hs-identifier hs-var">s1</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679059799"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679059800"><span class="hs-identifier hs-var">s2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059796"><span class="hs-identifier hs-var">pr1</span></a><span> </span><a href="#local-6989586621679059804"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679059803"><span class="hs-identifier hs-var">sf2</span></a><span>
</span><a name="line-1650"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679059804"><a href="#local-6989586621679059804"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#addDigits1"><span class="hs-identifier hs-var">addDigits1</span></a><span> </span><a href="#local-6989586621679059797"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="#local-6989586621679059798"><span class="hs-identifier hs-var">sf1</span></a><span> </span><a href="#local-6989586621679059799"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059801"><span class="hs-identifier hs-var">pr2</span></a><span> </span><a href="#local-6989586621679059802"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1651"></a><span>
</span><a name="line-1652"></a><span class="hs-identifier">addDigits1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059019"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059019"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059019"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059019"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059019"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059019"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1653"></a><a name="addDigits1"><a href="Data.Sequence.Internal.html#addDigits1"><span class="hs-identifier">addDigits1</span></a></a><span> </span><a name="local-6989586621679059805"><a href="#local-6989586621679059805"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679059806"><a href="#local-6989586621679059806"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059807"><a href="#local-6989586621679059807"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679059808"><a href="#local-6989586621679059808"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059809"><a href="#local-6989586621679059809"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1654"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree1"><span class="hs-identifier hs-var">appendTree1</span></a><span> </span><a href="#local-6989586621679059805"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059806"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059807"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059808"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059809"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1655"></a><span class="hs-identifier">addDigits1</span><span> </span><a name="local-6989586621679059810"><a href="#local-6989586621679059810"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679059811"><a href="#local-6989586621679059811"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059812"><a href="#local-6989586621679059812"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679059813"><a href="#local-6989586621679059813"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679059814"><a href="#local-6989586621679059814"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059815"><a href="#local-6989586621679059815"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1656"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree2"><span class="hs-identifier hs-var">appendTree2</span></a><span> </span><a href="#local-6989586621679059810"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059811"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059812"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059813"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679059814"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059815"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1657"></a><span class="hs-identifier">addDigits1</span><span> </span><a name="local-6989586621679059816"><a href="#local-6989586621679059816"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679059817"><a href="#local-6989586621679059817"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059818"><a href="#local-6989586621679059818"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679059819"><a href="#local-6989586621679059819"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679059820"><a href="#local-6989586621679059820"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679059821"><a href="#local-6989586621679059821"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059822"><a href="#local-6989586621679059822"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1658"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree2"><span class="hs-identifier hs-var">appendTree2</span></a><span> </span><a href="#local-6989586621679059816"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059817"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059818"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059819"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059820"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679059821"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059822"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1659"></a><span class="hs-identifier">addDigits1</span><span> </span><a name="local-6989586621679059823"><a href="#local-6989586621679059823"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679059824"><a href="#local-6989586621679059824"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059825"><a href="#local-6989586621679059825"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679059826"><a href="#local-6989586621679059826"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679059827"><a href="#local-6989586621679059827"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679059828"><a href="#local-6989586621679059828"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679059829"><a href="#local-6989586621679059829"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059830"><a href="#local-6989586621679059830"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1660"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree2"><span class="hs-identifier hs-var">appendTree2</span></a><span> </span><a href="#local-6989586621679059823"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059824"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059825"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059826"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059827"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679059828"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679059829"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059830"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1661"></a><span class="hs-identifier">addDigits1</span><span> </span><a name="local-6989586621679059831"><a href="#local-6989586621679059831"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679059832"><a href="#local-6989586621679059832"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059833"><a href="#local-6989586621679059833"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059834"><a href="#local-6989586621679059834"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679059835"><a href="#local-6989586621679059835"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059836"><a href="#local-6989586621679059836"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1662"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree2"><span class="hs-identifier hs-var">appendTree2</span></a><span> </span><a href="#local-6989586621679059831"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059832"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059833"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059834"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679059835"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059836"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1663"></a><span class="hs-identifier">addDigits1</span><span> </span><a name="local-6989586621679059837"><a href="#local-6989586621679059837"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679059838"><a href="#local-6989586621679059838"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059839"><a href="#local-6989586621679059839"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059840"><a href="#local-6989586621679059840"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679059841"><a href="#local-6989586621679059841"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679059842"><a href="#local-6989586621679059842"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059843"><a href="#local-6989586621679059843"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1664"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree2"><span class="hs-identifier hs-var">appendTree2</span></a><span> </span><a href="#local-6989586621679059837"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059838"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059839"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059840"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059841"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679059842"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059843"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1665"></a><span class="hs-identifier">addDigits1</span><span> </span><a name="local-6989586621679059844"><a href="#local-6989586621679059844"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679059845"><a href="#local-6989586621679059845"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059846"><a href="#local-6989586621679059846"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059847"><a href="#local-6989586621679059847"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679059848"><a href="#local-6989586621679059848"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679059849"><a href="#local-6989586621679059849"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679059850"><a href="#local-6989586621679059850"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059851"><a href="#local-6989586621679059851"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1666"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree2"><span class="hs-identifier hs-var">appendTree2</span></a><span> </span><a href="#local-6989586621679059844"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059845"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059846"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059847"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059848"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679059849"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679059850"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059851"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1667"></a><span class="hs-identifier">addDigits1</span><span> </span><a name="local-6989586621679059852"><a href="#local-6989586621679059852"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679059853"><a href="#local-6989586621679059853"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059854"><a href="#local-6989586621679059854"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059855"><a href="#local-6989586621679059855"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679059856"><a href="#local-6989586621679059856"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679059857"><a href="#local-6989586621679059857"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679059858"><a href="#local-6989586621679059858"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679059859"><a href="#local-6989586621679059859"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059860"><a href="#local-6989586621679059860"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1668"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679059852"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059853"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059854"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059855"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059856"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679059857"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059858"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679059859"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059860"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1669"></a><span class="hs-identifier">addDigits1</span><span> </span><a name="local-6989586621679059861"><a href="#local-6989586621679059861"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679059862"><a href="#local-6989586621679059862"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059863"><a href="#local-6989586621679059863"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059864"><a href="#local-6989586621679059864"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059865"><a href="#local-6989586621679059865"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679059866"><a href="#local-6989586621679059866"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059867"><a href="#local-6989586621679059867"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1670"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree2"><span class="hs-identifier hs-var">appendTree2</span></a><span> </span><a href="#local-6989586621679059861"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059862"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059863"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059864"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059865"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679059866"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059867"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1671"></a><span class="hs-identifier">addDigits1</span><span> </span><a name="local-6989586621679059868"><a href="#local-6989586621679059868"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679059869"><a href="#local-6989586621679059869"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059870"><a href="#local-6989586621679059870"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059871"><a href="#local-6989586621679059871"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059872"><a href="#local-6989586621679059872"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679059873"><a href="#local-6989586621679059873"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679059874"><a href="#local-6989586621679059874"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059875"><a href="#local-6989586621679059875"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1672"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree2"><span class="hs-identifier hs-var">appendTree2</span></a><span> </span><a href="#local-6989586621679059868"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059869"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059870"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059871"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059872"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679059873"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679059874"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059875"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1673"></a><span class="hs-identifier">addDigits1</span><span> </span><a name="local-6989586621679059876"><a href="#local-6989586621679059876"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679059877"><a href="#local-6989586621679059877"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059878"><a href="#local-6989586621679059878"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059879"><a href="#local-6989586621679059879"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059880"><a href="#local-6989586621679059880"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679059881"><a href="#local-6989586621679059881"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679059882"><a href="#local-6989586621679059882"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679059883"><a href="#local-6989586621679059883"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059884"><a href="#local-6989586621679059884"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1674"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679059876"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059877"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059878"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059879"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059880"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679059881"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059882"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679059883"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059884"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1675"></a><span class="hs-identifier">addDigits1</span><span> </span><a name="local-6989586621679059885"><a href="#local-6989586621679059885"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679059886"><a href="#local-6989586621679059886"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059887"><a href="#local-6989586621679059887"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059888"><a href="#local-6989586621679059888"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059889"><a href="#local-6989586621679059889"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679059890"><a href="#local-6989586621679059890"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679059891"><a href="#local-6989586621679059891"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679059892"><a href="#local-6989586621679059892"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679059893"><a href="#local-6989586621679059893"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059894"><a href="#local-6989586621679059894"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1676"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679059885"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059886"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059887"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059888"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059889"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679059890"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679059891"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059892"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679059893"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059894"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1677"></a><span class="hs-identifier">addDigits1</span><span> </span><a name="local-6989586621679059895"><a href="#local-6989586621679059895"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679059896"><a href="#local-6989586621679059896"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059897"><a href="#local-6989586621679059897"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059898"><a href="#local-6989586621679059898"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679059899"><a href="#local-6989586621679059899"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059900"><a href="#local-6989586621679059900"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679059901"><a href="#local-6989586621679059901"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059902"><a href="#local-6989586621679059902"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1678"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree2"><span class="hs-identifier hs-var">appendTree2</span></a><span> </span><a href="#local-6989586621679059895"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059896"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059897"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059898"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059899"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679059900"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679059901"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059902"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1679"></a><span class="hs-identifier">addDigits1</span><span> </span><a name="local-6989586621679059903"><a href="#local-6989586621679059903"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679059904"><a href="#local-6989586621679059904"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059905"><a href="#local-6989586621679059905"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059906"><a href="#local-6989586621679059906"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679059907"><a href="#local-6989586621679059907"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059908"><a href="#local-6989586621679059908"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679059909"><a href="#local-6989586621679059909"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679059910"><a href="#local-6989586621679059910"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059911"><a href="#local-6989586621679059911"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1680"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679059903"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059904"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059905"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059906"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059907"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679059908"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059909"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679059910"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059911"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1681"></a><span class="hs-identifier">addDigits1</span><span> </span><a name="local-6989586621679059912"><a href="#local-6989586621679059912"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679059913"><a href="#local-6989586621679059913"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059914"><a href="#local-6989586621679059914"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059915"><a href="#local-6989586621679059915"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679059916"><a href="#local-6989586621679059916"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059917"><a href="#local-6989586621679059917"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679059918"><a href="#local-6989586621679059918"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679059919"><a href="#local-6989586621679059919"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679059920"><a href="#local-6989586621679059920"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059921"><a href="#local-6989586621679059921"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1682"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679059912"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059913"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059914"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059915"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059916"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679059917"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679059918"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059919"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679059920"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059921"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1683"></a><span class="hs-identifier">addDigits1</span><span> </span><a name="local-6989586621679059922"><a href="#local-6989586621679059922"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679059923"><a href="#local-6989586621679059923"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059924"><a href="#local-6989586621679059924"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059925"><a href="#local-6989586621679059925"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679059926"><a href="#local-6989586621679059926"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059927"><a href="#local-6989586621679059927"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679059928"><a href="#local-6989586621679059928"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679059929"><a href="#local-6989586621679059929"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679059930"><a href="#local-6989586621679059930"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621679059931"><a href="#local-6989586621679059931"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059932"><a href="#local-6989586621679059932"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1684"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679059922"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059923"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059924"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059925"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059926"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679059927"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679059928"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059929"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679059930"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-6989586621679059931"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059932"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1685"></a><span>
</span><a name="line-1686"></a><span class="hs-identifier">appendTree2</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059018"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059018"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059018"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059018"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059018"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1687"></a><a name="appendTree2"><a href="Data.Sequence.Internal.html#appendTree2"><span class="hs-identifier">appendTree2</span></a></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679059933"><a href="#local-6989586621679059933"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679059934"><a href="#local-6989586621679059934"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059935"><a href="#local-6989586621679059935"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1688"></a><span>    </span><a href="#local-6989586621679059933"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#consTree"><span class="hs-identifier hs-var">consTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679059934"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#consTree"><span class="hs-identifier hs-var">consTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679059935"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1689"></a><span class="hs-identifier">appendTree2</span><span> </span><a name="local-6989586621679059936"><a href="#local-6989586621679059936"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679059937"><a href="#local-6989586621679059937"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679059938"><a href="#local-6989586621679059938"><span class="hs-identifier">b</span></a></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1690"></a><span>    </span><a href="#local-6989586621679059936"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#snocTree"><span class="hs-identifier hs-var">snocTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679059937"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#snocTree"><span class="hs-identifier hs-var">snocTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679059938"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-1691"></a><span class="hs-identifier">appendTree2</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><a name="local-6989586621679059939"><a href="#local-6989586621679059939"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059940"><a href="#local-6989586621679059940"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059941"><a href="#local-6989586621679059941"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059942"><a href="#local-6989586621679059942"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1692"></a><span>    </span><a href="#local-6989586621679059939"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#consTree"><span class="hs-identifier hs-var">consTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679059940"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#consTree"><span class="hs-identifier hs-var">consTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679059941"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#consTree"><span class="hs-identifier hs-var">consTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679059942"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1693"></a><span class="hs-identifier">appendTree2</span><span> </span><a name="local-6989586621679059943"><a href="#local-6989586621679059943"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679059944"><a href="#local-6989586621679059944"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059945"><a href="#local-6989586621679059945"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><a name="local-6989586621679059946"><a href="#local-6989586621679059946"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1694"></a><span>    </span><a href="#local-6989586621679059943"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#snocTree"><span class="hs-identifier hs-var">snocTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679059944"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#snocTree"><span class="hs-identifier hs-var">snocTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679059945"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#snocTree"><span class="hs-identifier hs-var">snocTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679059946"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1695"></a><span class="hs-identifier">appendTree2</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679059947"><a href="#local-6989586621679059947"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-6989586621679059948"><a href="#local-6989586621679059948"><span class="hs-identifier">pr1</span></a></a><span> </span><a name="local-6989586621679059949"><a href="#local-6989586621679059949"><span class="hs-identifier">m1</span></a></a><span> </span><a name="local-6989586621679059950"><a href="#local-6989586621679059950"><span class="hs-identifier">sf1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059951"><a href="#local-6989586621679059951"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059952"><a href="#local-6989586621679059952"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679059953"><a href="#local-6989586621679059953"><span class="hs-identifier">s2</span></a></a><span> </span><a name="local-6989586621679059954"><a href="#local-6989586621679059954"><span class="hs-identifier">pr2</span></a></a><span> </span><a name="local-6989586621679059955"><a href="#local-6989586621679059955"><span class="hs-identifier">m2</span></a></a><span> </span><a name="local-6989586621679059956"><a href="#local-6989586621679059956"><span class="hs-identifier">sf2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1696"></a><span>    </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059947"><span class="hs-identifier hs-var">s1</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679059951"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679059952"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679059953"><span class="hs-identifier hs-var">s2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059948"><span class="hs-identifier hs-var">pr1</span></a><span> </span><a href="#local-6989586621679059957"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679059956"><span class="hs-identifier hs-var">sf2</span></a><span>
</span><a name="line-1697"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679059957"><a href="#local-6989586621679059957"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#addDigits2"><span class="hs-identifier hs-var">addDigits2</span></a><span> </span><a href="#local-6989586621679059949"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="#local-6989586621679059950"><span class="hs-identifier hs-var">sf1</span></a><span> </span><a href="#local-6989586621679059951"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059952"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059954"><span class="hs-identifier hs-var">pr2</span></a><span> </span><a href="#local-6989586621679059955"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1698"></a><span>
</span><a name="line-1699"></a><span class="hs-identifier">addDigits2</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059017"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059017"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059017"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059017"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059017"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059017"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059017"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1700"></a><a name="addDigits2"><a href="Data.Sequence.Internal.html#addDigits2"><span class="hs-identifier">addDigits2</span></a></a><span> </span><a name="local-6989586621679059958"><a href="#local-6989586621679059958"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679059959"><a href="#local-6989586621679059959"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059960"><a href="#local-6989586621679059960"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059961"><a href="#local-6989586621679059961"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679059962"><a href="#local-6989586621679059962"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059963"><a href="#local-6989586621679059963"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1701"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree2"><span class="hs-identifier hs-var">appendTree2</span></a><span> </span><a href="#local-6989586621679059958"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059959"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059960"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059961"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679059962"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059963"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1702"></a><span class="hs-identifier">addDigits2</span><span> </span><a name="local-6989586621679059964"><a href="#local-6989586621679059964"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679059965"><a href="#local-6989586621679059965"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059966"><a href="#local-6989586621679059966"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059967"><a href="#local-6989586621679059967"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679059968"><a href="#local-6989586621679059968"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679059969"><a href="#local-6989586621679059969"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059970"><a href="#local-6989586621679059970"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1703"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree2"><span class="hs-identifier hs-var">appendTree2</span></a><span> </span><a href="#local-6989586621679059964"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059965"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059966"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059967"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059968"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679059969"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059970"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1704"></a><span class="hs-identifier">addDigits2</span><span> </span><a name="local-6989586621679059971"><a href="#local-6989586621679059971"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679059972"><a href="#local-6989586621679059972"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059973"><a href="#local-6989586621679059973"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059974"><a href="#local-6989586621679059974"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679059975"><a href="#local-6989586621679059975"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679059976"><a href="#local-6989586621679059976"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679059977"><a href="#local-6989586621679059977"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059978"><a href="#local-6989586621679059978"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1705"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree2"><span class="hs-identifier hs-var">appendTree2</span></a><span> </span><a href="#local-6989586621679059971"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059972"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059973"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059974"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059975"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679059976"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679059977"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059978"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1706"></a><span class="hs-identifier">addDigits2</span><span> </span><a name="local-6989586621679059979"><a href="#local-6989586621679059979"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679059980"><a href="#local-6989586621679059980"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059981"><a href="#local-6989586621679059981"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059982"><a href="#local-6989586621679059982"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679059983"><a href="#local-6989586621679059983"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679059984"><a href="#local-6989586621679059984"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679059985"><a href="#local-6989586621679059985"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679059986"><a href="#local-6989586621679059986"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059987"><a href="#local-6989586621679059987"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1707"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679059979"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059980"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059981"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059982"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059983"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679059984"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059985"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679059986"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059987"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1708"></a><span class="hs-identifier">addDigits2</span><span> </span><a name="local-6989586621679059988"><a href="#local-6989586621679059988"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679059989"><a href="#local-6989586621679059989"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059990"><a href="#local-6989586621679059990"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059991"><a href="#local-6989586621679059991"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679059992"><a href="#local-6989586621679059992"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679059993"><a href="#local-6989586621679059993"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059994"><a href="#local-6989586621679059994"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1709"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree2"><span class="hs-identifier hs-var">appendTree2</span></a><span> </span><a href="#local-6989586621679059988"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059989"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059990"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059991"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679059992"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679059993"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059994"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1710"></a><span class="hs-identifier">addDigits2</span><span> </span><a name="local-6989586621679059995"><a href="#local-6989586621679059995"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679059996"><a href="#local-6989586621679059996"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059997"><a href="#local-6989586621679059997"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679059998"><a href="#local-6989586621679059998"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679059999"><a href="#local-6989586621679059999"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679060000"><a href="#local-6989586621679060000"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679060001"><a href="#local-6989586621679060001"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060002"><a href="#local-6989586621679060002"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1711"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree2"><span class="hs-identifier hs-var">appendTree2</span></a><span> </span><a href="#local-6989586621679059995"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059996"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679059997"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679059998"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679059999"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060000"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679060001"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060002"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1712"></a><span class="hs-identifier">addDigits2</span><span> </span><a name="local-6989586621679060003"><a href="#local-6989586621679060003"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679060004"><a href="#local-6989586621679060004"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060005"><a href="#local-6989586621679060005"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060006"><a href="#local-6989586621679060006"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060007"><a href="#local-6989586621679060007"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679060008"><a href="#local-6989586621679060008"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679060009"><a href="#local-6989586621679060009"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060010"><a href="#local-6989586621679060010"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060011"><a href="#local-6989586621679060011"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1713"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679060003"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060004"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060005"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060006"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060007"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060008"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060009"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060010"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060011"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1714"></a><span class="hs-identifier">addDigits2</span><span> </span><a name="local-6989586621679060012"><a href="#local-6989586621679060012"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679060013"><a href="#local-6989586621679060013"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060014"><a href="#local-6989586621679060014"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060015"><a href="#local-6989586621679060015"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060016"><a href="#local-6989586621679060016"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679060017"><a href="#local-6989586621679060017"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679060018"><a href="#local-6989586621679060018"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060019"><a href="#local-6989586621679060019"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679060020"><a href="#local-6989586621679060020"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060021"><a href="#local-6989586621679060021"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1715"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679060012"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060013"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060014"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060015"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060016"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060017"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679060018"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060019"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679060020"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060021"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1716"></a><span class="hs-identifier">addDigits2</span><span> </span><a name="local-6989586621679060022"><a href="#local-6989586621679060022"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679060023"><a href="#local-6989586621679060023"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060024"><a href="#local-6989586621679060024"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060025"><a href="#local-6989586621679060025"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060026"><a href="#local-6989586621679060026"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679060027"><a href="#local-6989586621679060027"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679060028"><a href="#local-6989586621679060028"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060029"><a href="#local-6989586621679060029"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1717"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree2"><span class="hs-identifier hs-var">appendTree2</span></a><span> </span><a href="#local-6989586621679060022"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060023"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060024"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060025"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060026"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060027"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679060028"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060029"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1718"></a><span class="hs-identifier">addDigits2</span><span> </span><a name="local-6989586621679060030"><a href="#local-6989586621679060030"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679060031"><a href="#local-6989586621679060031"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060032"><a href="#local-6989586621679060032"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060033"><a href="#local-6989586621679060033"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060034"><a href="#local-6989586621679060034"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679060035"><a href="#local-6989586621679060035"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679060036"><a href="#local-6989586621679060036"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060037"><a href="#local-6989586621679060037"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060038"><a href="#local-6989586621679060038"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1719"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679060030"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060031"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060032"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060033"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060034"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060035"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060036"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060037"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060038"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1720"></a><span class="hs-identifier">addDigits2</span><span> </span><a name="local-6989586621679060039"><a href="#local-6989586621679060039"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679060040"><a href="#local-6989586621679060040"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060041"><a href="#local-6989586621679060041"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060042"><a href="#local-6989586621679060042"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060043"><a href="#local-6989586621679060043"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679060044"><a href="#local-6989586621679060044"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679060045"><a href="#local-6989586621679060045"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060046"><a href="#local-6989586621679060046"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679060047"><a href="#local-6989586621679060047"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060048"><a href="#local-6989586621679060048"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1721"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679060039"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060040"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060041"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060042"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060043"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060044"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679060045"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060046"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679060047"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060048"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1722"></a><span class="hs-identifier">addDigits2</span><span> </span><a name="local-6989586621679060049"><a href="#local-6989586621679060049"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679060050"><a href="#local-6989586621679060050"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060051"><a href="#local-6989586621679060051"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060052"><a href="#local-6989586621679060052"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060053"><a href="#local-6989586621679060053"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679060054"><a href="#local-6989586621679060054"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679060055"><a href="#local-6989586621679060055"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060056"><a href="#local-6989586621679060056"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679060057"><a href="#local-6989586621679060057"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621679060058"><a href="#local-6989586621679060058"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060059"><a href="#local-6989586621679060059"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1723"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679060049"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060050"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060051"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060052"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060053"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060054"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679060055"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060056"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679060057"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-6989586621679060058"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060059"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1724"></a><span class="hs-identifier">addDigits2</span><span> </span><a name="local-6989586621679060060"><a href="#local-6989586621679060060"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679060061"><a href="#local-6989586621679060061"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060062"><a href="#local-6989586621679060062"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060063"><a href="#local-6989586621679060063"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060064"><a href="#local-6989586621679060064"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060065"><a href="#local-6989586621679060065"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679060066"><a href="#local-6989586621679060066"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679060067"><a href="#local-6989586621679060067"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060068"><a href="#local-6989586621679060068"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1725"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679060060"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060061"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060062"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060063"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060064"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060065"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060066"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060067"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060068"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1726"></a><span class="hs-identifier">addDigits2</span><span> </span><a name="local-6989586621679060069"><a href="#local-6989586621679060069"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679060070"><a href="#local-6989586621679060070"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060071"><a href="#local-6989586621679060071"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060072"><a href="#local-6989586621679060072"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060073"><a href="#local-6989586621679060073"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060074"><a href="#local-6989586621679060074"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679060075"><a href="#local-6989586621679060075"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679060076"><a href="#local-6989586621679060076"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679060077"><a href="#local-6989586621679060077"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060078"><a href="#local-6989586621679060078"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1727"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679060069"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060070"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060071"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060072"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060073"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060074"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679060075"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060076"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679060077"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060078"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1728"></a><span class="hs-identifier">addDigits2</span><span> </span><a name="local-6989586621679060079"><a href="#local-6989586621679060079"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679060080"><a href="#local-6989586621679060080"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060081"><a href="#local-6989586621679060081"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060082"><a href="#local-6989586621679060082"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060083"><a href="#local-6989586621679060083"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060084"><a href="#local-6989586621679060084"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679060085"><a href="#local-6989586621679060085"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679060086"><a href="#local-6989586621679060086"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679060087"><a href="#local-6989586621679060087"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621679060088"><a href="#local-6989586621679060088"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060089"><a href="#local-6989586621679060089"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1729"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679060079"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060080"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060081"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060082"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060083"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060084"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679060085"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060086"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679060087"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-6989586621679060088"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060089"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1730"></a><span class="hs-identifier">addDigits2</span><span> </span><a name="local-6989586621679060090"><a href="#local-6989586621679060090"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679060091"><a href="#local-6989586621679060091"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060092"><a href="#local-6989586621679060092"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060093"><a href="#local-6989586621679060093"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060094"><a href="#local-6989586621679060094"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060095"><a href="#local-6989586621679060095"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679060096"><a href="#local-6989586621679060096"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679060097"><a href="#local-6989586621679060097"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679060098"><a href="#local-6989586621679060098"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621679060099"><a href="#local-6989586621679060099"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679060100"><a href="#local-6989586621679060100"><span class="hs-identifier">j</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060101"><a href="#local-6989586621679060101"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1731"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree4"><span class="hs-identifier hs-var">appendTree4</span></a><span> </span><a href="#local-6989586621679060090"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060091"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060092"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060093"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060094"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060095"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679060096"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060097"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679060098"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060099"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060100"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060101"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1732"></a><span>
</span><a name="line-1733"></a><span class="hs-identifier">appendTree3</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059016"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059016"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059016"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059016"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059016"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059016"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1734"></a><a name="appendTree3"><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier">appendTree3</span></a></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060102"><a href="#local-6989586621679060102"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060103"><a href="#local-6989586621679060103"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060104"><a href="#local-6989586621679060104"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060105"><a href="#local-6989586621679060105"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1735"></a><span>    </span><a href="#local-6989586621679060102"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#consTree"><span class="hs-identifier hs-var">consTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060103"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#consTree"><span class="hs-identifier hs-var">consTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060104"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#consTree"><span class="hs-identifier hs-var">consTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060105"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1736"></a><span class="hs-identifier">appendTree3</span><span> </span><a name="local-6989586621679060106"><a href="#local-6989586621679060106"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060107"><a href="#local-6989586621679060107"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060108"><a href="#local-6989586621679060108"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060109"><a href="#local-6989586621679060109"><span class="hs-identifier">c</span></a></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1737"></a><span>    </span><a href="#local-6989586621679060106"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#snocTree"><span class="hs-identifier hs-var">snocTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060107"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#snocTree"><span class="hs-identifier hs-var">snocTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060108"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#snocTree"><span class="hs-identifier hs-var">snocTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060109"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-1738"></a><span class="hs-identifier">appendTree3</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><a name="local-6989586621679060110"><a href="#local-6989586621679060110"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060111"><a href="#local-6989586621679060111"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060112"><a href="#local-6989586621679060112"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060113"><a href="#local-6989586621679060113"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060114"><a href="#local-6989586621679060114"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1739"></a><span>    </span><a href="#local-6989586621679060110"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#consTree"><span class="hs-identifier hs-var">consTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060111"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#consTree"><span class="hs-identifier hs-var">consTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060112"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#consTree"><span class="hs-identifier hs-var">consTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060113"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#consTree"><span class="hs-identifier hs-var">consTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060114"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1740"></a><span class="hs-identifier">appendTree3</span><span> </span><a name="local-6989586621679060115"><a href="#local-6989586621679060115"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679060116"><a href="#local-6989586621679060116"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060117"><a href="#local-6989586621679060117"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060118"><a href="#local-6989586621679060118"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><a name="local-6989586621679060119"><a href="#local-6989586621679060119"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1741"></a><span>    </span><a href="#local-6989586621679060115"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#snocTree"><span class="hs-identifier hs-var">snocTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060116"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#snocTree"><span class="hs-identifier hs-var">snocTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060117"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#snocTree"><span class="hs-identifier hs-var">snocTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060118"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#snocTree"><span class="hs-identifier hs-var">snocTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060119"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1742"></a><span class="hs-identifier">appendTree3</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679060120"><a href="#local-6989586621679060120"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-6989586621679060121"><a href="#local-6989586621679060121"><span class="hs-identifier">pr1</span></a></a><span> </span><a name="local-6989586621679060122"><a href="#local-6989586621679060122"><span class="hs-identifier">m1</span></a></a><span> </span><a name="local-6989586621679060123"><a href="#local-6989586621679060123"><span class="hs-identifier">sf1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060124"><a href="#local-6989586621679060124"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060125"><a href="#local-6989586621679060125"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060126"><a href="#local-6989586621679060126"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679060127"><a href="#local-6989586621679060127"><span class="hs-identifier">s2</span></a></a><span> </span><a name="local-6989586621679060128"><a href="#local-6989586621679060128"><span class="hs-identifier">pr2</span></a></a><span> </span><a name="local-6989586621679060129"><a href="#local-6989586621679060129"><span class="hs-identifier">m2</span></a></a><span> </span><a name="local-6989586621679060130"><a href="#local-6989586621679060130"><span class="hs-identifier">sf2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1743"></a><span>    </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060120"><span class="hs-identifier hs-var">s1</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060124"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060125"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060126"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679060127"><span class="hs-identifier hs-var">s2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060121"><span class="hs-identifier hs-var">pr1</span></a><span> </span><a href="#local-6989586621679060131"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679060130"><span class="hs-identifier hs-var">sf2</span></a><span>
</span><a name="line-1744"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060131"><a href="#local-6989586621679060131"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#addDigits3"><span class="hs-identifier hs-var">addDigits3</span></a><span> </span><a href="#local-6989586621679060122"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="#local-6989586621679060123"><span class="hs-identifier hs-var">sf1</span></a><span> </span><a href="#local-6989586621679060124"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060125"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060126"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679060128"><span class="hs-identifier hs-var">pr2</span></a><span> </span><a href="#local-6989586621679060129"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1745"></a><span>
</span><a name="line-1746"></a><span class="hs-identifier">addDigits3</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059015"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059015"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059015"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059015"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059015"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059015"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059015"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059015"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1747"></a><a name="addDigits3"><a href="Data.Sequence.Internal.html#addDigits3"><span class="hs-identifier">addDigits3</span></a></a><span> </span><a name="local-6989586621679060132"><a href="#local-6989586621679060132"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679060133"><a href="#local-6989586621679060133"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060134"><a href="#local-6989586621679060134"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060135"><a href="#local-6989586621679060135"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060136"><a href="#local-6989586621679060136"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679060137"><a href="#local-6989586621679060137"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060138"><a href="#local-6989586621679060138"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1748"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree2"><span class="hs-identifier hs-var">appendTree2</span></a><span> </span><a href="#local-6989586621679060132"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060133"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060134"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060135"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060136"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060137"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060138"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1749"></a><span class="hs-identifier">addDigits3</span><span> </span><a name="local-6989586621679060139"><a href="#local-6989586621679060139"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679060140"><a href="#local-6989586621679060140"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060141"><a href="#local-6989586621679060141"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060142"><a href="#local-6989586621679060142"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060143"><a href="#local-6989586621679060143"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679060144"><a href="#local-6989586621679060144"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679060145"><a href="#local-6989586621679060145"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060146"><a href="#local-6989586621679060146"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1750"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree2"><span class="hs-identifier hs-var">appendTree2</span></a><span> </span><a href="#local-6989586621679060139"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060140"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060141"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060142"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060143"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060144"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679060145"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060146"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1751"></a><span class="hs-identifier">addDigits3</span><span> </span><a name="local-6989586621679060147"><a href="#local-6989586621679060147"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679060148"><a href="#local-6989586621679060148"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060149"><a href="#local-6989586621679060149"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060150"><a href="#local-6989586621679060150"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060151"><a href="#local-6989586621679060151"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679060152"><a href="#local-6989586621679060152"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679060153"><a href="#local-6989586621679060153"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060154"><a href="#local-6989586621679060154"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060155"><a href="#local-6989586621679060155"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1752"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679060147"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060148"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060149"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060150"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060151"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060152"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060153"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060154"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060155"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1753"></a><span class="hs-identifier">addDigits3</span><span> </span><a name="local-6989586621679060156"><a href="#local-6989586621679060156"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679060157"><a href="#local-6989586621679060157"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060158"><a href="#local-6989586621679060158"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060159"><a href="#local-6989586621679060159"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060160"><a href="#local-6989586621679060160"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679060161"><a href="#local-6989586621679060161"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679060162"><a href="#local-6989586621679060162"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060163"><a href="#local-6989586621679060163"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679060164"><a href="#local-6989586621679060164"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060165"><a href="#local-6989586621679060165"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1754"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679060156"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060157"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060158"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060159"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060160"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060161"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679060162"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060163"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679060164"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060165"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1755"></a><span class="hs-identifier">addDigits3</span><span> </span><a name="local-6989586621679060166"><a href="#local-6989586621679060166"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679060167"><a href="#local-6989586621679060167"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060168"><a href="#local-6989586621679060168"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060169"><a href="#local-6989586621679060169"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060170"><a href="#local-6989586621679060170"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060171"><a href="#local-6989586621679060171"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679060172"><a href="#local-6989586621679060172"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060173"><a href="#local-6989586621679060173"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1756"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree2"><span class="hs-identifier hs-var">appendTree2</span></a><span> </span><a href="#local-6989586621679060166"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060167"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060168"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060169"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060170"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060171"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679060172"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060173"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1757"></a><span class="hs-identifier">addDigits3</span><span> </span><a name="local-6989586621679060174"><a href="#local-6989586621679060174"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679060175"><a href="#local-6989586621679060175"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060176"><a href="#local-6989586621679060176"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060177"><a href="#local-6989586621679060177"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060178"><a href="#local-6989586621679060178"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679060179"><a href="#local-6989586621679060179"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679060180"><a href="#local-6989586621679060180"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060181"><a href="#local-6989586621679060181"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060182"><a href="#local-6989586621679060182"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1758"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679060174"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060175"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060176"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060177"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060178"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060179"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060180"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060181"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060182"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1759"></a><span class="hs-identifier">addDigits3</span><span> </span><a name="local-6989586621679060183"><a href="#local-6989586621679060183"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679060184"><a href="#local-6989586621679060184"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060185"><a href="#local-6989586621679060185"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060186"><a href="#local-6989586621679060186"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060187"><a href="#local-6989586621679060187"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679060188"><a href="#local-6989586621679060188"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679060189"><a href="#local-6989586621679060189"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060190"><a href="#local-6989586621679060190"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679060191"><a href="#local-6989586621679060191"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060192"><a href="#local-6989586621679060192"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1760"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679060183"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060184"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060185"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060186"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060187"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060188"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679060189"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060190"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679060191"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060192"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1761"></a><span class="hs-identifier">addDigits3</span><span> </span><a name="local-6989586621679060193"><a href="#local-6989586621679060193"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679060194"><a href="#local-6989586621679060194"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060195"><a href="#local-6989586621679060195"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060196"><a href="#local-6989586621679060196"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060197"><a href="#local-6989586621679060197"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679060198"><a href="#local-6989586621679060198"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679060199"><a href="#local-6989586621679060199"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060200"><a href="#local-6989586621679060200"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679060201"><a href="#local-6989586621679060201"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621679060202"><a href="#local-6989586621679060202"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060203"><a href="#local-6989586621679060203"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1762"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679060193"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060194"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060195"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060196"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060197"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060198"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679060199"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060200"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679060201"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-6989586621679060202"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060203"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1763"></a><span class="hs-identifier">addDigits3</span><span> </span><a name="local-6989586621679060204"><a href="#local-6989586621679060204"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679060205"><a href="#local-6989586621679060205"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060206"><a href="#local-6989586621679060206"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060207"><a href="#local-6989586621679060207"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060208"><a href="#local-6989586621679060208"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060209"><a href="#local-6989586621679060209"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060210"><a href="#local-6989586621679060210"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679060211"><a href="#local-6989586621679060211"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060212"><a href="#local-6989586621679060212"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1764"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679060204"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060205"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060206"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060207"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060208"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060209"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060210"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060211"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060212"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1765"></a><span class="hs-identifier">addDigits3</span><span> </span><a name="local-6989586621679060213"><a href="#local-6989586621679060213"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679060214"><a href="#local-6989586621679060214"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060215"><a href="#local-6989586621679060215"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060216"><a href="#local-6989586621679060216"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060217"><a href="#local-6989586621679060217"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679060218"><a href="#local-6989586621679060218"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679060219"><a href="#local-6989586621679060219"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679060220"><a href="#local-6989586621679060220"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679060221"><a href="#local-6989586621679060221"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060222"><a href="#local-6989586621679060222"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1766"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679060213"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060214"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060215"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060216"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060217"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060218"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679060219"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060220"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679060221"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060222"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1767"></a><span class="hs-identifier">addDigits3</span><span> </span><a name="local-6989586621679060223"><a href="#local-6989586621679060223"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679060224"><a href="#local-6989586621679060224"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060225"><a href="#local-6989586621679060225"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060226"><a href="#local-6989586621679060226"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060227"><a href="#local-6989586621679060227"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679060228"><a href="#local-6989586621679060228"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679060229"><a href="#local-6989586621679060229"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679060230"><a href="#local-6989586621679060230"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679060231"><a href="#local-6989586621679060231"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621679060232"><a href="#local-6989586621679060232"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060233"><a href="#local-6989586621679060233"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1768"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679060223"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060224"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060225"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060226"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060227"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060228"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679060229"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060230"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679060231"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-6989586621679060232"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060233"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1769"></a><span class="hs-identifier">addDigits3</span><span> </span><a name="local-6989586621679060234"><a href="#local-6989586621679060234"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679060235"><a href="#local-6989586621679060235"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060236"><a href="#local-6989586621679060236"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060237"><a href="#local-6989586621679060237"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060238"><a href="#local-6989586621679060238"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679060239"><a href="#local-6989586621679060239"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679060240"><a href="#local-6989586621679060240"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679060241"><a href="#local-6989586621679060241"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679060242"><a href="#local-6989586621679060242"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621679060243"><a href="#local-6989586621679060243"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679060244"><a href="#local-6989586621679060244"><span class="hs-identifier">j</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060245"><a href="#local-6989586621679060245"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1770"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree4"><span class="hs-identifier hs-var">appendTree4</span></a><span> </span><a href="#local-6989586621679060234"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060235"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060236"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060237"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060238"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060239"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679060240"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060241"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679060242"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060243"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060244"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060245"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1771"></a><span class="hs-identifier">addDigits3</span><span> </span><a name="local-6989586621679060246"><a href="#local-6989586621679060246"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679060247"><a href="#local-6989586621679060247"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060248"><a href="#local-6989586621679060248"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060249"><a href="#local-6989586621679060249"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060250"><a href="#local-6989586621679060250"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060251"><a href="#local-6989586621679060251"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060252"><a href="#local-6989586621679060252"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060253"><a href="#local-6989586621679060253"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679060254"><a href="#local-6989586621679060254"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060255"><a href="#local-6989586621679060255"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1772"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679060246"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060247"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060248"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060249"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060250"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060251"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679060252"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060253"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679060254"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060255"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1773"></a><span class="hs-identifier">addDigits3</span><span> </span><a name="local-6989586621679060256"><a href="#local-6989586621679060256"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679060257"><a href="#local-6989586621679060257"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060258"><a href="#local-6989586621679060258"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060259"><a href="#local-6989586621679060259"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060260"><a href="#local-6989586621679060260"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060261"><a href="#local-6989586621679060261"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679060262"><a href="#local-6989586621679060262"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060263"><a href="#local-6989586621679060263"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679060264"><a href="#local-6989586621679060264"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621679060265"><a href="#local-6989586621679060265"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060266"><a href="#local-6989586621679060266"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1774"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679060256"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060257"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060258"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060259"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060260"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060261"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679060262"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060263"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679060264"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-6989586621679060265"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060266"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1775"></a><span class="hs-identifier">addDigits3</span><span> </span><a name="local-6989586621679060267"><a href="#local-6989586621679060267"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679060268"><a href="#local-6989586621679060268"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060269"><a href="#local-6989586621679060269"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060270"><a href="#local-6989586621679060270"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060271"><a href="#local-6989586621679060271"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060272"><a href="#local-6989586621679060272"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679060273"><a href="#local-6989586621679060273"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060274"><a href="#local-6989586621679060274"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679060275"><a href="#local-6989586621679060275"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621679060276"><a href="#local-6989586621679060276"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679060277"><a href="#local-6989586621679060277"><span class="hs-identifier">j</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060278"><a href="#local-6989586621679060278"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1776"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree4"><span class="hs-identifier hs-var">appendTree4</span></a><span> </span><a href="#local-6989586621679060267"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060268"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060269"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060270"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060271"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060272"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679060273"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060274"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679060275"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060276"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060277"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060278"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1777"></a><span class="hs-identifier">addDigits3</span><span> </span><a name="local-6989586621679060279"><a href="#local-6989586621679060279"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679060280"><a href="#local-6989586621679060280"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060281"><a href="#local-6989586621679060281"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060282"><a href="#local-6989586621679060282"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060283"><a href="#local-6989586621679060283"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060284"><a href="#local-6989586621679060284"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679060285"><a href="#local-6989586621679060285"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060286"><a href="#local-6989586621679060286"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679060287"><a href="#local-6989586621679060287"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621679060288"><a href="#local-6989586621679060288"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679060289"><a href="#local-6989586621679060289"><span class="hs-identifier">j</span></a></a><span> </span><a name="local-6989586621679060290"><a href="#local-6989586621679060290"><span class="hs-identifier">k</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060291"><a href="#local-6989586621679060291"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1778"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree4"><span class="hs-identifier hs-var">appendTree4</span></a><span> </span><a href="#local-6989586621679060279"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060280"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060281"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060282"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060283"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060284"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679060285"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060286"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679060287"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-6989586621679060288"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060289"><span class="hs-identifier hs-var">j</span></a><span> </span><a href="#local-6989586621679060290"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060291"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1779"></a><span>
</span><a name="line-1780"></a><span class="hs-identifier">appendTree4</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059014"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059014"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059014"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059014"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059014"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059014"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059014"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1781"></a><a name="appendTree4"><a href="Data.Sequence.Internal.html#appendTree4"><span class="hs-identifier">appendTree4</span></a></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060292"><a href="#local-6989586621679060292"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060293"><a href="#local-6989586621679060293"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060294"><a href="#local-6989586621679060294"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060295"><a href="#local-6989586621679060295"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679060296"><a href="#local-6989586621679060296"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1782"></a><span>    </span><a href="#local-6989586621679060292"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#consTree"><span class="hs-identifier hs-var">consTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060293"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#consTree"><span class="hs-identifier hs-var">consTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060294"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#consTree"><span class="hs-identifier hs-var">consTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060295"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#consTree"><span class="hs-identifier hs-var">consTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060296"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1783"></a><span class="hs-identifier">appendTree4</span><span> </span><a name="local-6989586621679060297"><a href="#local-6989586621679060297"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060298"><a href="#local-6989586621679060298"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060299"><a href="#local-6989586621679060299"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060300"><a href="#local-6989586621679060300"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060301"><a href="#local-6989586621679060301"><span class="hs-identifier">d</span></a></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1784"></a><span>    </span><a href="#local-6989586621679060297"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#snocTree"><span class="hs-identifier hs-var">snocTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060298"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#snocTree"><span class="hs-identifier hs-var">snocTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060299"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#snocTree"><span class="hs-identifier hs-var">snocTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060300"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#snocTree"><span class="hs-identifier hs-var">snocTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060301"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-1785"></a><span class="hs-identifier">appendTree4</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><a name="local-6989586621679060302"><a href="#local-6989586621679060302"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060303"><a href="#local-6989586621679060303"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060304"><a href="#local-6989586621679060304"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060305"><a href="#local-6989586621679060305"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060306"><a href="#local-6989586621679060306"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679060307"><a href="#local-6989586621679060307"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1786"></a><span>    </span><a href="#local-6989586621679060302"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#consTree"><span class="hs-identifier hs-var">consTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060303"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#consTree"><span class="hs-identifier hs-var">consTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060304"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#consTree"><span class="hs-identifier hs-var">consTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060305"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#consTree"><span class="hs-identifier hs-var">consTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060306"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#consTree"><span class="hs-identifier hs-var">consTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060307"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1787"></a><span class="hs-identifier">appendTree4</span><span> </span><a name="local-6989586621679060308"><a href="#local-6989586621679060308"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679060309"><a href="#local-6989586621679060309"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060310"><a href="#local-6989586621679060310"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060311"><a href="#local-6989586621679060311"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060312"><a href="#local-6989586621679060312"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><a name="local-6989586621679060313"><a href="#local-6989586621679060313"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1788"></a><span>    </span><a href="#local-6989586621679060308"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#snocTree"><span class="hs-identifier hs-var">snocTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060309"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#snocTree"><span class="hs-identifier hs-var">snocTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060310"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#snocTree"><span class="hs-identifier hs-var">snocTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060311"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#snocTree"><span class="hs-identifier hs-var">snocTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060312"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#snocTree"><span class="hs-identifier hs-var">snocTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060313"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1789"></a><span class="hs-identifier">appendTree4</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679060314"><a href="#local-6989586621679060314"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-6989586621679060315"><a href="#local-6989586621679060315"><span class="hs-identifier">pr1</span></a></a><span> </span><a name="local-6989586621679060316"><a href="#local-6989586621679060316"><span class="hs-identifier">m1</span></a></a><span> </span><a name="local-6989586621679060317"><a href="#local-6989586621679060317"><span class="hs-identifier">sf1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060318"><a href="#local-6989586621679060318"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060319"><a href="#local-6989586621679060319"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060320"><a href="#local-6989586621679060320"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060321"><a href="#local-6989586621679060321"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679060322"><a href="#local-6989586621679060322"><span class="hs-identifier">s2</span></a></a><span> </span><a name="local-6989586621679060323"><a href="#local-6989586621679060323"><span class="hs-identifier">pr2</span></a></a><span> </span><a name="local-6989586621679060324"><a href="#local-6989586621679060324"><span class="hs-identifier">m2</span></a></a><span> </span><a name="local-6989586621679060325"><a href="#local-6989586621679060325"><span class="hs-identifier">sf2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1790"></a><span>    </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060314"><span class="hs-identifier hs-var">s1</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060318"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060319"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060320"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060321"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679060322"><span class="hs-identifier hs-var">s2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060315"><span class="hs-identifier hs-var">pr1</span></a><span> </span><a href="#local-6989586621679060326"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679060325"><span class="hs-identifier hs-var">sf2</span></a><span>
</span><a name="line-1791"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060326"><a href="#local-6989586621679060326"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#addDigits4"><span class="hs-identifier hs-var">addDigits4</span></a><span> </span><a href="#local-6989586621679060316"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="#local-6989586621679060317"><span class="hs-identifier hs-var">sf1</span></a><span> </span><a href="#local-6989586621679060318"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060319"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060320"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679060321"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060323"><span class="hs-identifier hs-var">pr2</span></a><span> </span><a href="#local-6989586621679060324"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1792"></a><span>
</span><a name="line-1793"></a><span class="hs-identifier">addDigits4</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059013"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059013"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059013"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059013"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059013"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059013"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059013"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059013"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679059013"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1794"></a><a name="addDigits4"><a href="Data.Sequence.Internal.html#addDigits4"><span class="hs-identifier">addDigits4</span></a></a><span> </span><a name="local-6989586621679060327"><a href="#local-6989586621679060327"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679060328"><a href="#local-6989586621679060328"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060329"><a href="#local-6989586621679060329"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060330"><a href="#local-6989586621679060330"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060331"><a href="#local-6989586621679060331"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060332"><a href="#local-6989586621679060332"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679060333"><a href="#local-6989586621679060333"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060334"><a href="#local-6989586621679060334"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1795"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree2"><span class="hs-identifier hs-var">appendTree2</span></a><span> </span><a href="#local-6989586621679060327"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060328"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060329"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060330"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060331"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060332"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679060333"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060334"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1796"></a><span class="hs-identifier">addDigits4</span><span> </span><a name="local-6989586621679060335"><a href="#local-6989586621679060335"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679060336"><a href="#local-6989586621679060336"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060337"><a href="#local-6989586621679060337"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060338"><a href="#local-6989586621679060338"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060339"><a href="#local-6989586621679060339"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679060340"><a href="#local-6989586621679060340"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679060341"><a href="#local-6989586621679060341"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060342"><a href="#local-6989586621679060342"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060343"><a href="#local-6989586621679060343"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1797"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679060335"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060336"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060337"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060338"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060339"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060340"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060341"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060342"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060343"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1798"></a><span class="hs-identifier">addDigits4</span><span> </span><a name="local-6989586621679060344"><a href="#local-6989586621679060344"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679060345"><a href="#local-6989586621679060345"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060346"><a href="#local-6989586621679060346"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060347"><a href="#local-6989586621679060347"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060348"><a href="#local-6989586621679060348"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679060349"><a href="#local-6989586621679060349"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679060350"><a href="#local-6989586621679060350"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060351"><a href="#local-6989586621679060351"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679060352"><a href="#local-6989586621679060352"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060353"><a href="#local-6989586621679060353"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1799"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679060344"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060345"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060346"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060347"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060348"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060349"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679060350"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060351"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679060352"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060353"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1800"></a><span class="hs-identifier">addDigits4</span><span> </span><a name="local-6989586621679060354"><a href="#local-6989586621679060354"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679060355"><a href="#local-6989586621679060355"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060356"><a href="#local-6989586621679060356"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060357"><a href="#local-6989586621679060357"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060358"><a href="#local-6989586621679060358"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679060359"><a href="#local-6989586621679060359"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679060360"><a href="#local-6989586621679060360"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060361"><a href="#local-6989586621679060361"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679060362"><a href="#local-6989586621679060362"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621679060363"><a href="#local-6989586621679060363"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060364"><a href="#local-6989586621679060364"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1801"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679060354"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060355"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060356"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060357"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060358"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060359"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679060360"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060361"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679060362"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-6989586621679060363"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060364"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1802"></a><span class="hs-identifier">addDigits4</span><span> </span><a name="local-6989586621679060365"><a href="#local-6989586621679060365"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679060366"><a href="#local-6989586621679060366"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060367"><a href="#local-6989586621679060367"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060368"><a href="#local-6989586621679060368"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060369"><a href="#local-6989586621679060369"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060370"><a href="#local-6989586621679060370"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060371"><a href="#local-6989586621679060371"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679060372"><a href="#local-6989586621679060372"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060373"><a href="#local-6989586621679060373"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1803"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679060365"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060366"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060367"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060368"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060369"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060370"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060371"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060372"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060373"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1804"></a><span class="hs-identifier">addDigits4</span><span> </span><a name="local-6989586621679060374"><a href="#local-6989586621679060374"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679060375"><a href="#local-6989586621679060375"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060376"><a href="#local-6989586621679060376"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060377"><a href="#local-6989586621679060377"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060378"><a href="#local-6989586621679060378"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679060379"><a href="#local-6989586621679060379"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679060380"><a href="#local-6989586621679060380"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679060381"><a href="#local-6989586621679060381"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679060382"><a href="#local-6989586621679060382"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060383"><a href="#local-6989586621679060383"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1805"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679060374"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060375"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060376"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060377"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060378"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060379"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679060380"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060381"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679060382"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060383"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1806"></a><span class="hs-identifier">addDigits4</span><span> </span><a name="local-6989586621679060384"><a href="#local-6989586621679060384"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679060385"><a href="#local-6989586621679060385"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060386"><a href="#local-6989586621679060386"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060387"><a href="#local-6989586621679060387"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060388"><a href="#local-6989586621679060388"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679060389"><a href="#local-6989586621679060389"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679060390"><a href="#local-6989586621679060390"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679060391"><a href="#local-6989586621679060391"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679060392"><a href="#local-6989586621679060392"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621679060393"><a href="#local-6989586621679060393"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060394"><a href="#local-6989586621679060394"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1807"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679060384"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060385"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060386"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060387"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060388"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060389"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679060390"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060391"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679060392"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-6989586621679060393"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060394"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1808"></a><span class="hs-identifier">addDigits4</span><span> </span><a name="local-6989586621679060395"><a href="#local-6989586621679060395"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679060396"><a href="#local-6989586621679060396"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060397"><a href="#local-6989586621679060397"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060398"><a href="#local-6989586621679060398"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060399"><a href="#local-6989586621679060399"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679060400"><a href="#local-6989586621679060400"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679060401"><a href="#local-6989586621679060401"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679060402"><a href="#local-6989586621679060402"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679060403"><a href="#local-6989586621679060403"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621679060404"><a href="#local-6989586621679060404"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679060405"><a href="#local-6989586621679060405"><span class="hs-identifier">j</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060406"><a href="#local-6989586621679060406"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1809"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree4"><span class="hs-identifier hs-var">appendTree4</span></a><span> </span><a href="#local-6989586621679060395"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060396"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060397"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060398"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060399"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060400"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679060401"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060402"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679060403"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060404"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060405"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060406"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1810"></a><span class="hs-identifier">addDigits4</span><span> </span><a name="local-6989586621679060407"><a href="#local-6989586621679060407"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679060408"><a href="#local-6989586621679060408"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060409"><a href="#local-6989586621679060409"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060410"><a href="#local-6989586621679060410"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060411"><a href="#local-6989586621679060411"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060412"><a href="#local-6989586621679060412"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060413"><a href="#local-6989586621679060413"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060414"><a href="#local-6989586621679060414"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679060415"><a href="#local-6989586621679060415"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060416"><a href="#local-6989586621679060416"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1811"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679060407"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060408"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060409"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060410"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060411"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060412"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679060413"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060414"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679060415"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060416"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1812"></a><span class="hs-identifier">addDigits4</span><span> </span><a name="local-6989586621679060417"><a href="#local-6989586621679060417"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679060418"><a href="#local-6989586621679060418"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060419"><a href="#local-6989586621679060419"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060420"><a href="#local-6989586621679060420"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060421"><a href="#local-6989586621679060421"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679060422"><a href="#local-6989586621679060422"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679060423"><a href="#local-6989586621679060423"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060424"><a href="#local-6989586621679060424"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679060425"><a href="#local-6989586621679060425"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621679060426"><a href="#local-6989586621679060426"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060427"><a href="#local-6989586621679060427"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1813"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679060417"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060418"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060419"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060420"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060421"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060422"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679060423"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060424"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679060425"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-6989586621679060426"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060427"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1814"></a><span class="hs-identifier">addDigits4</span><span> </span><a name="local-6989586621679060428"><a href="#local-6989586621679060428"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679060429"><a href="#local-6989586621679060429"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060430"><a href="#local-6989586621679060430"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060431"><a href="#local-6989586621679060431"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060432"><a href="#local-6989586621679060432"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679060433"><a href="#local-6989586621679060433"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679060434"><a href="#local-6989586621679060434"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060435"><a href="#local-6989586621679060435"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679060436"><a href="#local-6989586621679060436"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621679060437"><a href="#local-6989586621679060437"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679060438"><a href="#local-6989586621679060438"><span class="hs-identifier">j</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060439"><a href="#local-6989586621679060439"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1815"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree4"><span class="hs-identifier hs-var">appendTree4</span></a><span> </span><a href="#local-6989586621679060428"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060429"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060430"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060431"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060432"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060433"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679060434"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060435"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679060436"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060437"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060438"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060439"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1816"></a><span class="hs-identifier">addDigits4</span><span> </span><a name="local-6989586621679060440"><a href="#local-6989586621679060440"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679060441"><a href="#local-6989586621679060441"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060442"><a href="#local-6989586621679060442"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060443"><a href="#local-6989586621679060443"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060444"><a href="#local-6989586621679060444"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679060445"><a href="#local-6989586621679060445"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679060446"><a href="#local-6989586621679060446"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060447"><a href="#local-6989586621679060447"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679060448"><a href="#local-6989586621679060448"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621679060449"><a href="#local-6989586621679060449"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679060450"><a href="#local-6989586621679060450"><span class="hs-identifier">j</span></a></a><span> </span><a name="local-6989586621679060451"><a href="#local-6989586621679060451"><span class="hs-identifier">k</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060452"><a href="#local-6989586621679060452"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1817"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree4"><span class="hs-identifier hs-var">appendTree4</span></a><span> </span><a href="#local-6989586621679060440"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060441"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060442"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060443"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060444"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060445"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679060446"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060447"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679060448"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-6989586621679060449"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060450"><span class="hs-identifier hs-var">j</span></a><span> </span><a href="#local-6989586621679060451"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060452"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1818"></a><span class="hs-identifier">addDigits4</span><span> </span><a name="local-6989586621679060453"><a href="#local-6989586621679060453"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679060454"><a href="#local-6989586621679060454"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060455"><a href="#local-6989586621679060455"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060456"><a href="#local-6989586621679060456"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060457"><a href="#local-6989586621679060457"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060458"><a href="#local-6989586621679060458"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060459"><a href="#local-6989586621679060459"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060460"><a href="#local-6989586621679060460"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060461"><a href="#local-6989586621679060461"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679060462"><a href="#local-6989586621679060462"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060463"><a href="#local-6989586621679060463"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1819"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree3"><span class="hs-identifier hs-var">appendTree3</span></a><span> </span><a href="#local-6989586621679060453"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060454"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060455"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060456"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060457"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060458"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679060459"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060460"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679060461"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-6989586621679060462"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060463"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1820"></a><span class="hs-identifier">addDigits4</span><span> </span><a name="local-6989586621679060464"><a href="#local-6989586621679060464"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679060465"><a href="#local-6989586621679060465"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060466"><a href="#local-6989586621679060466"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060467"><a href="#local-6989586621679060467"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060468"><a href="#local-6989586621679060468"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060469"><a href="#local-6989586621679060469"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060470"><a href="#local-6989586621679060470"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060471"><a href="#local-6989586621679060471"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060472"><a href="#local-6989586621679060472"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679060473"><a href="#local-6989586621679060473"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679060474"><a href="#local-6989586621679060474"><span class="hs-identifier">j</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060475"><a href="#local-6989586621679060475"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1821"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree4"><span class="hs-identifier hs-var">appendTree4</span></a><span> </span><a href="#local-6989586621679060464"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060465"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060466"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060467"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060468"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060469"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679060470"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060471"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679060472"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060473"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060474"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060475"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1822"></a><span class="hs-identifier">addDigits4</span><span> </span><a name="local-6989586621679060476"><a href="#local-6989586621679060476"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679060477"><a href="#local-6989586621679060477"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060478"><a href="#local-6989586621679060478"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060479"><a href="#local-6989586621679060479"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060480"><a href="#local-6989586621679060480"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060481"><a href="#local-6989586621679060481"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060482"><a href="#local-6989586621679060482"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060483"><a href="#local-6989586621679060483"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060484"><a href="#local-6989586621679060484"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679060485"><a href="#local-6989586621679060485"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679060486"><a href="#local-6989586621679060486"><span class="hs-identifier">j</span></a></a><span> </span><a name="local-6989586621679060487"><a href="#local-6989586621679060487"><span class="hs-identifier">k</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060488"><a href="#local-6989586621679060488"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1823"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree4"><span class="hs-identifier hs-var">appendTree4</span></a><span> </span><a href="#local-6989586621679060476"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060477"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060478"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060479"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060480"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060481"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679060482"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060483"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679060484"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-6989586621679060485"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060486"><span class="hs-identifier hs-var">j</span></a><span> </span><a href="#local-6989586621679060487"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060488"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1824"></a><span class="hs-identifier">addDigits4</span><span> </span><a name="local-6989586621679060489"><a href="#local-6989586621679060489"><span class="hs-identifier">m1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679060490"><a href="#local-6989586621679060490"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060491"><a href="#local-6989586621679060491"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060492"><a href="#local-6989586621679060492"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060493"><a href="#local-6989586621679060493"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060494"><a href="#local-6989586621679060494"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060495"><a href="#local-6989586621679060495"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060496"><a href="#local-6989586621679060496"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060497"><a href="#local-6989586621679060497"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679060498"><a href="#local-6989586621679060498"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679060499"><a href="#local-6989586621679060499"><span class="hs-identifier">j</span></a></a><span> </span><a name="local-6989586621679060500"><a href="#local-6989586621679060500"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679060501"><a href="#local-6989586621679060501"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060502"><a href="#local-6989586621679060502"><span class="hs-identifier">m2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1825"></a><span>    </span><a href="Data.Sequence.Internal.html#appendTree4"><span class="hs-identifier hs-var">appendTree4</span></a><span> </span><a href="#local-6989586621679060489"><span class="hs-identifier hs-var">m1</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060490"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060491"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060492"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060493"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679060494"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679060495"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060496"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679060497"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-6989586621679060498"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060499"><span class="hs-identifier hs-var">j</span></a><span> </span><a href="#local-6989586621679060500"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679060501"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060502"><span class="hs-identifier hs-var">m2</span></a><span>
</span><a name="line-1826"></a><span>
</span><a name="line-1827"></a><span class="hs-comment">-- | Builds a sequence from a seed value.  Takes time linear in the</span><span>
</span><a name="line-1828"></a><span class="hs-comment">-- number of generated elements.  /WARNING:/ If the number of generated</span><span>
</span><a name="line-1829"></a><span class="hs-comment">-- elements is infinite, this method will not terminate.</span><span>
</span><a name="line-1830"></a><span class="hs-identifier">unfoldr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059011"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059012"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679059011"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059011"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679059012"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1831"></a><a name="unfoldr"><a href="Data.Sequence.Internal.html#unfoldr"><span class="hs-identifier">unfoldr</span></a></a><span> </span><a name="local-6989586621679060503"><a href="#local-6989586621679060503"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060504"><span class="hs-identifier hs-var">unfoldr'</span></a><span> </span><a href="Data.Sequence.Internal.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-1832"></a><span>  </span><span class="hs-comment">-- uses tail recursion rather than, for instance, the List implementation.</span><span>
</span><a name="line-1833"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679060504"><a href="#local-6989586621679060504"><span class="hs-identifier">unfoldr'</span></a></a><span> </span><span class="hs-glyph">!</span><span class="hs-keyword">as</span><span> </span><a name="local-6989586621679060506"><a href="#local-6989586621679060506"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679060549"><a href="#local-6989586621679060549"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679060550"><a href="#local-6989586621679060550"><span class="hs-identifier">b'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060504"><span class="hs-identifier hs-var">unfoldr'</span></a><span> </span><span class="hs-special">(</span><span class="hs-keyword">as</span><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#snoc%27"><span class="hs-identifier hs-var">snoc'</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060549"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060550"><span class="hs-identifier hs-var">b'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060503"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060506"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-1834"></a><span>
</span><a name="line-1835"></a><span class="hs-comment">-- | @'unfoldl' f x@ is equivalent to @'reverse' ('unfoldr' ('fmap' swap . f) x)@.</span><span>
</span><a name="line-1836"></a><span class="hs-identifier">unfoldl</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059009"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059009"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679059010"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059009"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679059010"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1837"></a><a name="unfoldl"><a href="Data.Sequence.Internal.html#unfoldl"><span class="hs-identifier">unfoldl</span></a></a><span> </span><a name="local-6989586621679060551"><a href="#local-6989586621679060551"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060552"><span class="hs-identifier hs-var">unfoldl'</span></a><span> </span><a href="Data.Sequence.Internal.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-1838"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679060552"><a href="#local-6989586621679060552"><span class="hs-identifier">unfoldl'</span></a></a><span> </span><span class="hs-glyph">!</span><span class="hs-keyword">as</span><span> </span><a name="local-6989586621679060554"><a href="#local-6989586621679060554"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679060555"><a href="#local-6989586621679060555"><span class="hs-identifier">b'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679060556"><a href="#local-6989586621679060556"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060552"><span class="hs-identifier hs-var">unfoldl'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060556"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#cons%27"><span class="hs-identifier hs-var">cons'</span></a><span class="hs-special">`</span><span> </span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060555"><span class="hs-identifier hs-var">b'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060551"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060554"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-1839"></a><span>
</span><a name="line-1840"></a><span class="hs-comment">-- | \( O(n) \).  Constructs a sequence by repeated application of a function</span><span>
</span><a name="line-1841"></a><span class="hs-comment">-- to a seed value.</span><span>
</span><a name="line-1842"></a><span class="hs-comment">--</span><span>
</span><a name="line-1843"></a><span class="hs-comment">-- &gt; iterateN n f x = fromList (Prelude.take n (Prelude.iterate f x))</span><span>
</span><a name="line-1844"></a><span class="hs-identifier">iterateN</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059008"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059008"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059008"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679059008"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1845"></a><a name="iterateN"><a href="Data.Sequence.Internal.html#iterateN"><span class="hs-identifier">iterateN</span></a></a><span> </span><a name="local-6989586621679060557"><a href="#local-6989586621679060557"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679060558"><a href="#local-6989586621679060558"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060559"><a href="#local-6989586621679060559"><span class="hs-identifier">x</span></a></a><span>
</span><a name="line-1846"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060557"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a><span> </span><span class="hs-number">0</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#replicateA"><span class="hs-identifier hs-var">replicateA</span></a><span> </span><a href="#local-6989586621679060557"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">(</span><a href="Utils.Containers.Internal.State.html#State"><span class="hs-identifier hs-var">State</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679060560"><a href="#local-6989586621679060560"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060558"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060560"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679060560"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Utils.Containers.Internal.State.html#execState"><span class="hs-identifier hs-var">execState</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060559"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1847"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a><span> </span><span class="hs-string">&quot;iterateN takes a nonnegative integer argument&quot;</span><span>
</span><a name="line-1848"></a><span>
</span><a name="line-1849"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-1850"></a><span class="hs-comment">-- Deconstruction</span><span>
</span><a name="line-1851"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-1852"></a><span>
</span><a name="line-1853"></a><span class="hs-comment">-- | \( O(1) \). Is this the empty sequence?</span><span>
</span><a name="line-1854"></a><span class="hs-identifier">null</span><span>            </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679059007"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a><span>
</span><a name="line-1855"></a><a name="null"><a href="Data.Sequence.Internal.html#null"><span class="hs-identifier">null</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a><span>
</span><a name="line-1856"></a><span class="hs-identifier">null</span><span> </span><span class="hs-identifier">_</span><span>            </span><span class="hs-glyph">=</span><span>  </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a><span>
</span><a name="line-1857"></a><span>
</span><a name="line-1858"></a><span class="hs-comment">-- | \( O(1) \). The number of elements in the sequence.</span><span>
</span><a name="line-1859"></a><span class="hs-identifier">length</span><span>          </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679059006"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span>
</span><a name="line-1860"></a><a name="length"><a href="Data.Sequence.Internal.html#length"><span class="hs-identifier">length</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a name="local-6989586621679060561"><a href="#local-6989586621679060561"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060561"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1861"></a><span>
</span><a name="line-1862"></a><span class="hs-comment">-- Views</span><span>
</span><a name="line-1863"></a><span>
</span><a name="line-1864"></a><span class="hs-keyword">data</span><span> </span><a name="ViewLTree"><a href="Data.Sequence.Internal.html#ViewLTree"><span class="hs-identifier">ViewLTree</span></a></a><span> </span><a name="local-6989586621679058048"><a href="#local-6989586621679058048"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="ConsLTree"><a href="Data.Sequence.Internal.html#ConsLTree"><span class="hs-identifier">ConsLTree</span></a></a><span> </span><a href="#local-6989586621679058048"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><a href="#local-6989586621679058048"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="EmptyLTree"><a href="Data.Sequence.Internal.html#EmptyLTree"><span class="hs-identifier">EmptyLTree</span></a></a><span>
</span><a name="line-1865"></a><span class="hs-keyword">data</span><span> </span><a name="ViewRTree"><a href="Data.Sequence.Internal.html#ViewRTree"><span class="hs-identifier">ViewRTree</span></a></a><span> </span><a name="local-6989586621679058047"><a href="#local-6989586621679058047"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="SnocRTree"><a href="Data.Sequence.Internal.html#SnocRTree"><span class="hs-identifier">SnocRTree</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><a href="#local-6989586621679058047"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679058047"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="EmptyRTree"><a href="Data.Sequence.Internal.html#EmptyRTree"><span class="hs-identifier">EmptyRTree</span></a></a><span>
</span><a name="line-1866"></a><span>
</span><a name="line-1867"></a><span class="hs-comment">-- | View of the left end of a sequence.</span><span>
</span><a name="line-1868"></a><span class="hs-keyword">data</span><span> </span><a name="ViewL"><a href="Data.Sequence.Internal.html#ViewL"><span class="hs-identifier">ViewL</span></a></a><span> </span><a name="local-6989586621679058046"><a href="#local-6989586621679058046"><span class="hs-identifier">a</span></a></a><span>
</span><a name="line-1869"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a name="EmptyL"><a href="Data.Sequence.Internal.html#EmptyL"><span class="hs-identifier">EmptyL</span></a></a><span>        </span><span class="hs-comment">-- ^ empty sequence</span><span>
</span><a name="line-1870"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679058046"><span class="hs-identifier hs-type">a</span></a><span> </span><a name="%3A%3C"><a href="Data.Sequence.Internal.html#%3A%3C"><span class="hs-operator">:&lt;</span></a></a><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679058046"><span class="hs-identifier hs-type">a</span></a><span>    </span><span class="hs-comment">-- ^ leftmost element and the rest of the sequence</span><span>
</span><a name="line-1871"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a><span class="hs-special">,</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Read.html#Read"><span class="hs-identifier hs-type">Read</span></a><span class="hs-special">)</span><span>
</span><a name="line-1872"></a><span>
</span><a name="line-1873"></a><span class="hs-cpp">#ifdef __GLASGOW_HASKELL__
</span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Data.html#Data"><span class="hs-identifier hs-type">Data</span></a><span> </span><a href="#local-6989586621679063180"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Data.html#Data"><span class="hs-identifier hs-type">Data</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#ViewL"><span class="hs-identifier hs-type">ViewL</span></a><span> </span><a href="#local-6989586621679063180"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1875"></a><span>
</span><a name="line-1876"></a><span class="hs-comment">-- | @since 0.5.8</span><span>
</span><a name="line-1877"></a><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Generics.html#Generic1"><span class="hs-identifier hs-type">Generic1</span></a><span> </span><a href="Data.Sequence.Internal.html#ViewL"><span class="hs-identifier hs-type">ViewL</span></a><span>
</span><a name="line-1878"></a><span>
</span><a name="line-1879"></a><span class="hs-comment">-- | @since 0.5.8</span><span>
</span><a name="line-1880"></a><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Generics.html#Generic"><span class="hs-identifier hs-type">Generic</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#ViewL"><span class="hs-identifier hs-type">ViewL</span></a><span> </span><a href="#local-6989586621679063179"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1881"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-1883"></a><span class="hs-identifier">INSTANCE_TYPEABLE1</span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Typeable.Internal.html#Typeable"><span class="hs-identifier hs-type">ViewL</span></a><span class="hs-special">)</span><span>
</span><a name="line-1884"></a><span>
</span><a name="line-1885"></a><span class="hs-keyword">instance</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Functor"><span class="hs-identifier hs-type">Functor</span></a><span> </span><a href="Data.Sequence.Internal.html#ViewL"><span class="hs-identifier hs-type">ViewL</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1886"></a><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">fmap</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1887"></a><span>    </span><a name="local-3458764513820541101"><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier">fmap</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="Data.Sequence.Internal.html#EmptyL"><span class="hs-identifier hs-var">EmptyL</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#EmptyL"><span class="hs-identifier hs-var">EmptyL</span></a><span>
</span><a name="line-1888"></a><span>    </span><span class="hs-identifier">fmap</span><span> </span><a name="local-6989586621679058194"><a href="#local-6989586621679058194"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679058195"><a href="#local-6989586621679058195"><span class="hs-identifier">x</span></a></a><span> </span><a href="Data.Sequence.Internal.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a><span> </span><a name="local-6989586621679058196"><a href="#local-6989586621679058196"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679058194"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058195"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="Data.Sequence.Internal.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><a href="#local-6989586621679058194"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058196"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1889"></a><span>
</span><a name="line-1890"></a><span class="hs-keyword">instance</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#Foldable"><span class="hs-identifier hs-type">Foldable</span></a><span> </span><a href="Data.Sequence.Internal.html#ViewL"><span class="hs-identifier hs-type">ViewL</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1891"></a><span>    </span><a name="local-8214565720323789017"><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier">foldr</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679058180"><a href="#local-6989586621679058180"><span class="hs-identifier">z</span></a></a><span> </span><a href="Data.Sequence.Internal.html#EmptyL"><span class="hs-identifier hs-var">EmptyL</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679058180"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-1892"></a><span>    </span><span class="hs-identifier">foldr</span><span> </span><a name="local-6989586621679058181"><a href="#local-6989586621679058181"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679058182"><a href="#local-6989586621679058182"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679058183"><a href="#local-6989586621679058183"><span class="hs-identifier">x</span></a></a><span> </span><a href="Data.Sequence.Internal.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a><span> </span><a name="local-6989586621679058184"><a href="#local-6989586621679058184"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679058181"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058183"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><a href="#local-6989586621679058181"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058182"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679058184"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1893"></a><span>
</span><a name="line-1894"></a><span>    </span><a name="local-8214565720323789015"><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldl"><span class="hs-identifier">foldl</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679058185"><a href="#local-6989586621679058185"><span class="hs-identifier">z</span></a></a><span> </span><a href="Data.Sequence.Internal.html#EmptyL"><span class="hs-identifier hs-var">EmptyL</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679058185"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-1895"></a><span>    </span><span class="hs-identifier">foldl</span><span> </span><a name="local-6989586621679058186"><a href="#local-6989586621679058186"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679058187"><a href="#local-6989586621679058187"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679058188"><a href="#local-6989586621679058188"><span class="hs-identifier">x</span></a></a><span> </span><a href="Data.Sequence.Internal.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a><span> </span><a name="local-6989586621679058189"><a href="#local-6989586621679058189"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldl"><span class="hs-identifier hs-var">foldl</span></a><span> </span><a href="#local-6989586621679058186"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679058186"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058187"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679058188"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679058189"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1896"></a><span>
</span><a name="line-1897"></a><span>    </span><a name="local-8214565720323789012"><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldl1"><span class="hs-identifier">foldl1</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="Data.Sequence.Internal.html#EmptyL"><span class="hs-identifier hs-var">EmptyL</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a><span> </span><span class="hs-string">&quot;foldl1: empty view&quot;</span><span>
</span><a name="line-1898"></a><span>    </span><span class="hs-identifier">foldl1</span><span> </span><a name="local-6989586621679058190"><a href="#local-6989586621679058190"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679058191"><a href="#local-6989586621679058191"><span class="hs-identifier">x</span></a></a><span> </span><a href="Data.Sequence.Internal.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a><span> </span><a name="local-6989586621679058192"><a href="#local-6989586621679058192"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldl"><span class="hs-identifier hs-var">foldl</span></a><span> </span><a href="#local-6989586621679058190"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058191"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679058192"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1899"></a><span>
</span><a name="line-1900"></a><span class="hs-cpp">#if MIN_VERSION_base(4,8,0)
</span><span>    </span><a name="local-8214565720323789010"><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier">null</span></a></a><span> </span><a href="Data.Sequence.Internal.html#EmptyL"><span class="hs-identifier hs-var">EmptyL</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a><span>
</span><a name="line-1902"></a><span>    </span><span class="hs-identifier">null</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span> </span><a href="Data.Sequence.Internal.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a><span>
</span><a name="line-1903"></a><span>
</span><a name="line-1904"></a><span>    </span><a name="local-8214565720323789009"><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier">length</span></a></a><span> </span><a href="Data.Sequence.Internal.html#EmptyL"><span class="hs-identifier hs-var">EmptyL</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-1905"></a><span>    </span><span class="hs-identifier">length</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span> </span><a href="Data.Sequence.Internal.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a><span> </span><a name="local-6989586621679058193"><a href="#local-6989586621679058193"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-6989586621679058193"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1906"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-1908"></a><span class="hs-keyword">instance</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Traversable.html#Traversable"><span class="hs-identifier hs-type">Traversable</span></a><span> </span><a href="Data.Sequence.Internal.html#ViewL"><span class="hs-identifier hs-type">ViewL</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1909"></a><span>    </span><a name="local-8214565720323787590"><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Traversable.html#traverse"><span class="hs-identifier">traverse</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="Data.Sequence.Internal.html#EmptyL"><span class="hs-identifier hs-var">EmptyL</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a><span> </span><a href="Data.Sequence.Internal.html#EmptyL"><span class="hs-identifier hs-var">EmptyL</span></a><span>
</span><a name="line-1910"></a><span>    </span><span class="hs-identifier">traverse</span><span> </span><a name="local-6989586621679058177"><a href="#local-6989586621679058177"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679058178"><a href="#local-6989586621679058178"><span class="hs-identifier">x</span></a></a><span> </span><a href="Data.Sequence.Internal.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a><span> </span><a name="local-6989586621679058179"><a href="#local-6989586621679058179"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#liftA2"><span class="hs-identifier hs-var">liftA2</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679058177"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058178"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Traversable.html#traverse"><span class="hs-identifier hs-var">traverse</span></a><span> </span><a href="#local-6989586621679058177"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058179"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1911"></a><span>
</span><a name="line-1912"></a><span class="hs-comment">-- | \( O(1) \). Analyse the left end of a sequence.</span><span>
</span><a name="line-1913"></a><span class="hs-identifier">viewl</span><span>           </span><span class="hs-glyph">::</span><span>  </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679059005"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#ViewL"><span class="hs-identifier hs-type">ViewL</span></a><span> </span><a href="#local-6989586621679059005"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1914"></a><a name="viewl"><a href="Data.Sequence.Internal.html#viewl"><span class="hs-identifier">viewl</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a name="local-6989586621679060562"><a href="#local-6989586621679060562"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">case</span><span> </span><a href="Data.Sequence.Internal.html#viewLTree"><span class="hs-identifier hs-var">viewLTree</span></a><span> </span><a href="#local-6989586621679060562"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1915"></a><span>    </span><a href="Data.Sequence.Internal.html#EmptyLTree"><span class="hs-identifier hs-var">EmptyLTree</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#EmptyL"><span class="hs-identifier hs-var">EmptyL</span></a><span>
</span><a name="line-1916"></a><span>    </span><a href="Data.Sequence.Internal.html#ConsLTree"><span class="hs-identifier hs-var">ConsLTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-var">Elem</span></a><span> </span><a name="local-6989586621679060563"><a href="#local-6989586621679060563"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060564"><a href="#local-6989586621679060564"><span class="hs-identifier">xs'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060563"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="Data.Sequence.Internal.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a href="#local-6989586621679060564"><span class="hs-identifier hs-var">xs'</span></a><span>
</span><a name="line-1917"></a><span>
</span><a name="line-1918"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">viewLTree</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">ViewLTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1919"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">viewLTree</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">ViewLTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1920"></a><span class="hs-identifier">viewLTree</span><span>       </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a><span> </span><a href="#local-6989586621679059002"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><a href="#local-6989586621679059002"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#ViewLTree"><span class="hs-identifier hs-type">ViewLTree</span></a><span> </span><a href="#local-6989586621679059002"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1921"></a><a name="viewLTree"><a href="Data.Sequence.Internal.html#viewLTree"><span class="hs-identifier">viewLTree</span></a></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span>                </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#EmptyLTree"><span class="hs-identifier hs-var">EmptyLTree</span></a><span>
</span><a name="line-1922"></a><span class="hs-identifier">viewLTree</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><a name="local-6989586621679060565"><a href="#local-6989586621679060565"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#ConsLTree"><span class="hs-identifier hs-var">ConsLTree</span></a><span> </span><a href="#local-6989586621679060565"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span>
</span><a name="line-1923"></a><span class="hs-identifier">viewLTree</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679060566"><a href="#local-6989586621679060566"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679060567"><a href="#local-6989586621679060567"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060568"><a href="#local-6989586621679060568"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679060569"><a href="#local-6989586621679060569"><span class="hs-identifier">sf</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#ConsLTree"><span class="hs-identifier hs-var">ConsLTree</span></a><span> </span><a href="#local-6989586621679060567"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#pullL"><span class="hs-identifier hs-var">pullL</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060566"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060567"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060568"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679060569"><span class="hs-identifier hs-var">sf</span></a><span class="hs-special">)</span><span>
</span><a name="line-1924"></a><span class="hs-identifier">viewLTree</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679060570"><a href="#local-6989586621679060570"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679060571"><a href="#local-6989586621679060571"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060572"><a href="#local-6989586621679060572"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060573"><a href="#local-6989586621679060573"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679060574"><a href="#local-6989586621679060574"><span class="hs-identifier">sf</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1925"></a><span>    </span><a href="Data.Sequence.Internal.html#ConsLTree"><span class="hs-identifier hs-var">ConsLTree</span></a><span> </span><a href="#local-6989586621679060571"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060570"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060571"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a href="#local-6989586621679060572"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060573"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679060574"><span class="hs-identifier hs-var">sf</span></a><span class="hs-special">)</span><span>
</span><a name="line-1926"></a><span class="hs-identifier">viewLTree</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679060575"><a href="#local-6989586621679060575"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679060576"><a href="#local-6989586621679060576"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060577"><a href="#local-6989586621679060577"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060578"><a href="#local-6989586621679060578"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060579"><a href="#local-6989586621679060579"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679060580"><a href="#local-6989586621679060580"><span class="hs-identifier">sf</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1927"></a><span>    </span><a href="Data.Sequence.Internal.html#ConsLTree"><span class="hs-identifier hs-var">ConsLTree</span></a><span> </span><a href="#local-6989586621679060576"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060575"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060576"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679060577"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060578"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060579"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679060580"><span class="hs-identifier hs-var">sf</span></a><span class="hs-special">)</span><span>
</span><a name="line-1928"></a><span class="hs-identifier">viewLTree</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679060581"><a href="#local-6989586621679060581"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679060582"><a href="#local-6989586621679060582"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060583"><a href="#local-6989586621679060583"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060584"><a href="#local-6989586621679060584"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060585"><a href="#local-6989586621679060585"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060586"><a href="#local-6989586621679060586"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679060587"><a href="#local-6989586621679060587"><span class="hs-identifier">sf</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1929"></a><span>    </span><a href="Data.Sequence.Internal.html#ConsLTree"><span class="hs-identifier hs-var">ConsLTree</span></a><span> </span><a href="#local-6989586621679060582"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060581"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060582"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679060583"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060584"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679060585"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060586"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679060587"><span class="hs-identifier hs-var">sf</span></a><span class="hs-special">)</span><span>
</span><a name="line-1930"></a><span>
</span><a name="line-1931"></a><span class="hs-comment">-- | View of the right end of a sequence.</span><span>
</span><a name="line-1932"></a><span class="hs-keyword">data</span><span> </span><a name="ViewR"><a href="Data.Sequence.Internal.html#ViewR"><span class="hs-identifier">ViewR</span></a></a><span> </span><a name="local-6989586621679058045"><a href="#local-6989586621679058045"><span class="hs-identifier">a</span></a></a><span>
</span><a name="line-1933"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a name="EmptyR"><a href="Data.Sequence.Internal.html#EmptyR"><span class="hs-identifier">EmptyR</span></a></a><span>        </span><span class="hs-comment">-- ^ empty sequence</span><span>
</span><a name="line-1934"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679058045"><span class="hs-identifier hs-type">a</span></a><span> </span><a name="%3A%3E"><a href="Data.Sequence.Internal.html#%3A%3E"><span class="hs-operator">:&gt;</span></a></a><span> </span><a href="#local-6989586621679058045"><span class="hs-identifier hs-type">a</span></a><span>    </span><span class="hs-comment">-- ^ the sequence minus the rightmost element,</span><span>
</span><a name="line-1935"></a><span>            </span><span class="hs-comment">-- and the rightmost element</span><span>
</span><a name="line-1936"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a><span class="hs-special">,</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Read.html#Read"><span class="hs-identifier hs-type">Read</span></a><span class="hs-special">)</span><span>
</span><a name="line-1937"></a><span>
</span><a name="line-1938"></a><span class="hs-cpp">#ifdef __GLASGOW_HASKELL__
</span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Data.html#Data"><span class="hs-identifier hs-type">Data</span></a><span> </span><a href="#local-6989586621679063178"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Data.html#Data"><span class="hs-identifier hs-type">Data</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#ViewR"><span class="hs-identifier hs-type">ViewR</span></a><span> </span><a href="#local-6989586621679063178"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1940"></a><span>
</span><a name="line-1941"></a><span class="hs-comment">-- | @since 0.5.8</span><span>
</span><a name="line-1942"></a><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Generics.html#Generic1"><span class="hs-identifier hs-type">Generic1</span></a><span> </span><a href="Data.Sequence.Internal.html#ViewR"><span class="hs-identifier hs-type">ViewR</span></a><span>
</span><a name="line-1943"></a><span>
</span><a name="line-1944"></a><span class="hs-comment">-- | @since 0.5.8</span><span>
</span><a name="line-1945"></a><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Generics.html#Generic"><span class="hs-identifier hs-type">Generic</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#ViewR"><span class="hs-identifier hs-type">ViewR</span></a><span> </span><a href="#local-6989586621679063177"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1946"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-1948"></a><span class="hs-identifier">INSTANCE_TYPEABLE1</span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Typeable.Internal.html#Typeable"><span class="hs-identifier hs-type">ViewR</span></a><span class="hs-special">)</span><span>
</span><a name="line-1949"></a><span>
</span><a name="line-1950"></a><span class="hs-keyword">instance</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Functor"><span class="hs-identifier hs-type">Functor</span></a><span> </span><a href="Data.Sequence.Internal.html#ViewR"><span class="hs-identifier hs-type">ViewR</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1951"></a><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">fmap</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1952"></a><span>    </span><a name="local-3458764513820541101"><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier">fmap</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="Data.Sequence.Internal.html#EmptyR"><span class="hs-identifier hs-var">EmptyR</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#EmptyR"><span class="hs-identifier hs-var">EmptyR</span></a><span>
</span><a name="line-1953"></a><span>    </span><span class="hs-identifier">fmap</span><span> </span><a name="local-6989586621679058174"><a href="#local-6989586621679058174"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679058175"><a href="#local-6989586621679058175"><span class="hs-identifier">xs</span></a></a><span> </span><a href="Data.Sequence.Internal.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a><span> </span><a name="local-6989586621679058176"><a href="#local-6989586621679058176"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><a href="#local-6989586621679058174"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058175"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="Data.Sequence.Internal.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a><span> </span><a href="#local-6989586621679058174"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058176"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1954"></a><span>
</span><a name="line-1955"></a><span class="hs-keyword">instance</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#Foldable"><span class="hs-identifier hs-type">Foldable</span></a><span> </span><a href="Data.Sequence.Internal.html#ViewR"><span class="hs-identifier hs-type">ViewR</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1956"></a><span>    </span><a name="local-8214565720323789019"><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldMap"><span class="hs-identifier">foldMap</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="Data.Sequence.Internal.html#EmptyR"><span class="hs-identifier hs-var">EmptyR</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a><span>
</span><a name="line-1957"></a><span>    </span><span class="hs-identifier">foldMap</span><span> </span><a name="local-6989586621679058157"><a href="#local-6989586621679058157"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679058158"><a href="#local-6989586621679058158"><span class="hs-identifier">xs</span></a></a><span> </span><a href="Data.Sequence.Internal.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a><span> </span><a name="local-6989586621679058159"><a href="#local-6989586621679058159"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldMap"><span class="hs-identifier hs-var">foldMap</span></a><span> </span><a href="#local-6989586621679058157"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058158"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="Data.Sequence.Internal.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="#local-6989586621679058157"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058159"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1958"></a><span>
</span><a name="line-1959"></a><span>    </span><a name="local-8214565720323789017"><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier">foldr</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679058160"><a href="#local-6989586621679058160"><span class="hs-identifier">z</span></a></a><span> </span><a href="Data.Sequence.Internal.html#EmptyR"><span class="hs-identifier hs-var">EmptyR</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679058160"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-1960"></a><span>    </span><span class="hs-identifier">foldr</span><span> </span><a name="local-6989586621679058161"><a href="#local-6989586621679058161"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679058162"><a href="#local-6989586621679058162"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679058163"><a href="#local-6989586621679058163"><span class="hs-identifier">xs</span></a></a><span> </span><a href="Data.Sequence.Internal.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a><span> </span><a name="local-6989586621679058164"><a href="#local-6989586621679058164"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><a href="#local-6989586621679058161"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679058161"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058164"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679058162"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679058163"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1961"></a><span>
</span><a name="line-1962"></a><span>    </span><a name="local-8214565720323789015"><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldl"><span class="hs-identifier">foldl</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679058165"><a href="#local-6989586621679058165"><span class="hs-identifier">z</span></a></a><span> </span><a href="Data.Sequence.Internal.html#EmptyR"><span class="hs-identifier hs-var">EmptyR</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679058165"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-1963"></a><span>    </span><span class="hs-identifier">foldl</span><span> </span><a name="local-6989586621679058166"><a href="#local-6989586621679058166"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679058167"><a href="#local-6989586621679058167"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679058168"><a href="#local-6989586621679058168"><span class="hs-identifier">xs</span></a></a><span> </span><a href="Data.Sequence.Internal.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a><span> </span><a name="local-6989586621679058169"><a href="#local-6989586621679058169"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldl"><span class="hs-identifier hs-var">foldl</span></a><span> </span><a href="#local-6989586621679058166"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058167"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679058168"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679058166"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679058169"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1964"></a><span>
</span><a name="line-1965"></a><span>    </span><a name="local-8214565720323789013"><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldr1"><span class="hs-identifier">foldr1</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="Data.Sequence.Internal.html#EmptyR"><span class="hs-identifier hs-var">EmptyR</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a><span> </span><span class="hs-string">&quot;foldr1: empty view&quot;</span><span>
</span><a name="line-1966"></a><span>    </span><span class="hs-identifier">foldr1</span><span> </span><a name="local-6989586621679058170"><a href="#local-6989586621679058170"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679058171"><a href="#local-6989586621679058171"><span class="hs-identifier">xs</span></a></a><span> </span><a href="Data.Sequence.Internal.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a><span> </span><a name="local-6989586621679058172"><a href="#local-6989586621679058172"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><a href="#local-6989586621679058170"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058172"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679058171"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1967"></a><span class="hs-cpp">#if MIN_VERSION_base(4,8,0)
</span><span>    </span><a name="local-8214565720323789010"><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier">null</span></a></a><span> </span><a href="Data.Sequence.Internal.html#EmptyR"><span class="hs-identifier hs-var">EmptyR</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a><span>
</span><a name="line-1969"></a><span>    </span><span class="hs-identifier">null</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span> </span><a href="Data.Sequence.Internal.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a><span>
</span><a name="line-1970"></a><span>
</span><a name="line-1971"></a><span>    </span><a name="local-8214565720323789009"><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier">length</span></a></a><span> </span><a href="Data.Sequence.Internal.html#EmptyR"><span class="hs-identifier hs-var">EmptyR</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-1972"></a><span>    </span><span class="hs-identifier">length</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679058173"><a href="#local-6989586621679058173"><span class="hs-identifier">xs</span></a></a><span> </span><a href="Data.Sequence.Internal.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-6989586621679058173"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">1</span><span>
</span><a name="line-1973"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-1975"></a><span class="hs-keyword">instance</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Traversable.html#Traversable"><span class="hs-identifier hs-type">Traversable</span></a><span> </span><a href="Data.Sequence.Internal.html#ViewR"><span class="hs-identifier hs-type">ViewR</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1976"></a><span>    </span><a name="local-8214565720323787590"><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Traversable.html#traverse"><span class="hs-identifier">traverse</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="Data.Sequence.Internal.html#EmptyR"><span class="hs-identifier hs-var">EmptyR</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a><span> </span><a href="Data.Sequence.Internal.html#EmptyR"><span class="hs-identifier hs-var">EmptyR</span></a><span>
</span><a name="line-1977"></a><span>    </span><span class="hs-identifier">traverse</span><span> </span><a name="local-6989586621679058154"><a href="#local-6989586621679058154"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679058155"><a href="#local-6989586621679058155"><span class="hs-identifier">xs</span></a></a><span> </span><a href="Data.Sequence.Internal.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a><span> </span><a name="local-6989586621679058156"><a href="#local-6989586621679058156"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#liftA2"><span class="hs-identifier hs-var">liftA2</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Traversable.html#traverse"><span class="hs-identifier hs-var">traverse</span></a><span> </span><a href="#local-6989586621679058154"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058155"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679058154"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058156"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-1978"></a><span>
</span><a name="line-1979"></a><span class="hs-comment">-- | \( O(1) \). Analyse the right end of a sequence.</span><span>
</span><a name="line-1980"></a><span class="hs-identifier">viewr</span><span>           </span><span class="hs-glyph">::</span><span>  </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679059001"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#ViewR"><span class="hs-identifier hs-type">ViewR</span></a><span> </span><a href="#local-6989586621679059001"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1981"></a><a name="viewr"><a href="Data.Sequence.Internal.html#viewr"><span class="hs-identifier">viewr</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a name="local-6989586621679060588"><a href="#local-6989586621679060588"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">case</span><span> </span><a href="Data.Sequence.Internal.html#viewRTree"><span class="hs-identifier hs-var">viewRTree</span></a><span> </span><a href="#local-6989586621679060588"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1982"></a><span>    </span><a href="Data.Sequence.Internal.html#EmptyRTree"><span class="hs-identifier hs-var">EmptyRTree</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#EmptyR"><span class="hs-identifier hs-var">EmptyR</span></a><span>
</span><a name="line-1983"></a><span>    </span><a href="Data.Sequence.Internal.html#SnocRTree"><span class="hs-identifier hs-var">SnocRTree</span></a><span> </span><a name="local-6989586621679060589"><a href="#local-6989586621679060589"><span class="hs-identifier">xs'</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-var">Elem</span></a><span> </span><a name="local-6989586621679060590"><a href="#local-6989586621679060590"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a href="#local-6989586621679060589"><span class="hs-identifier hs-var">xs'</span></a><span> </span><a href="Data.Sequence.Internal.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a><span> </span><a href="#local-6989586621679060590"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1984"></a><span>
</span><a name="line-1985"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">viewRTree</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">ViewRTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1986"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">viewRTree</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">ViewRTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1987"></a><span class="hs-identifier">viewRTree</span><span>       </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a><span> </span><a href="#local-6989586621679058998"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><a href="#local-6989586621679058998"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#ViewRTree"><span class="hs-identifier hs-type">ViewRTree</span></a><span> </span><a href="#local-6989586621679058998"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1988"></a><a name="viewRTree"><a href="Data.Sequence.Internal.html#viewRTree"><span class="hs-identifier">viewRTree</span></a></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span>                </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#EmptyRTree"><span class="hs-identifier hs-var">EmptyRTree</span></a><span>
</span><a name="line-1989"></a><span class="hs-identifier">viewRTree</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><a name="local-6989586621679060591"><a href="#local-6989586621679060591"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#SnocRTree"><span class="hs-identifier hs-var">SnocRTree</span></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><a href="#local-6989586621679060591"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-1990"></a><span class="hs-identifier">viewRTree</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679060592"><a href="#local-6989586621679060592"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679060593"><a href="#local-6989586621679060593"><span class="hs-identifier">pr</span></a></a><span> </span><a name="local-6989586621679060594"><a href="#local-6989586621679060594"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679060595"><a href="#local-6989586621679060595"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#SnocRTree"><span class="hs-identifier hs-var">SnocRTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#pullR"><span class="hs-identifier hs-var">pullR</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060592"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060595"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060593"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679060594"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060595"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-1991"></a><span class="hs-identifier">viewRTree</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679060596"><a href="#local-6989586621679060596"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679060597"><a href="#local-6989586621679060597"><span class="hs-identifier">pr</span></a></a><span> </span><a name="local-6989586621679060598"><a href="#local-6989586621679060598"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679060599"><a href="#local-6989586621679060599"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679060600"><a href="#local-6989586621679060600"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1992"></a><span>    </span><a href="Data.Sequence.Internal.html#SnocRTree"><span class="hs-identifier hs-var">SnocRTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060596"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060600"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060597"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679060598"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a href="#local-6989586621679060599"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060600"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-1993"></a><span class="hs-identifier">viewRTree</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679060601"><a href="#local-6989586621679060601"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679060602"><a href="#local-6989586621679060602"><span class="hs-identifier">pr</span></a></a><span> </span><a name="local-6989586621679060603"><a href="#local-6989586621679060603"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679060604"><a href="#local-6989586621679060604"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679060605"><a href="#local-6989586621679060605"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679060606"><a href="#local-6989586621679060606"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1994"></a><span>    </span><a href="Data.Sequence.Internal.html#SnocRTree"><span class="hs-identifier hs-var">SnocRTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060601"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060606"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060602"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679060603"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679060604"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679060605"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060606"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-1995"></a><span class="hs-identifier">viewRTree</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679060607"><a href="#local-6989586621679060607"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679060608"><a href="#local-6989586621679060608"><span class="hs-identifier">pr</span></a></a><span> </span><a name="local-6989586621679060609"><a href="#local-6989586621679060609"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679060610"><a href="#local-6989586621679060610"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679060611"><a href="#local-6989586621679060611"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679060612"><a href="#local-6989586621679060612"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679060613"><a href="#local-6989586621679060613"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1996"></a><span>    </span><a href="Data.Sequence.Internal.html#SnocRTree"><span class="hs-identifier hs-var">SnocRTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060607"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060613"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060608"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679060609"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679060610"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621679060611"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679060612"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060613"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-1997"></a><span>
</span><a name="line-1998"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-1999"></a><span class="hs-comment">-- Scans</span><span>
</span><a name="line-2000"></a><span class="hs-comment">--</span><span>
</span><a name="line-2001"></a><span class="hs-comment">-- These are not particularly complex applications of the Traversable</span><span>
</span><a name="line-2002"></a><span class="hs-comment">-- functor, though making the correspondence with Data.List exact</span><span>
</span><a name="line-2003"></a><span class="hs-comment">-- requires the use of (&lt;|) and (|&gt;).</span><span>
</span><a name="line-2004"></a><span class="hs-comment">--</span><span>
</span><a name="line-2005"></a><span class="hs-comment">-- Note that save for the single (&lt;|) or (|&gt;), we maintain the original</span><span>
</span><a name="line-2006"></a><span class="hs-comment">-- structure of the Seq, not having to do any restructuring of our own.</span><span>
</span><a name="line-2007"></a><span class="hs-comment">--</span><span>
</span><a name="line-2008"></a><span class="hs-comment">-- wasserman.louis@gmail.com, 5/23/09</span><span>
</span><a name="line-2009"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-2010"></a><span>
</span><a name="line-2011"></a><span class="hs-comment">-- | 'scanl' is similar to 'foldl', but returns a sequence of reduced</span><span>
</span><a name="line-2012"></a><span class="hs-comment">-- values from the left:</span><span>
</span><a name="line-2013"></a><span class="hs-comment">--</span><span>
</span><a name="line-2014"></a><span class="hs-comment">-- &gt; scanl f z (fromList [x1, x2, ...]) = fromList [z, z `f` x1, (z `f` x1) `f` x2, ...]</span><span>
</span><a name="line-2015"></a><span class="hs-identifier">scanl</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679058996"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058997"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058996"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058996"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679058997"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679058996"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2016"></a><a name="scanl"><a href="Data.Sequence.Internal.html#scanl"><span class="hs-identifier">scanl</span></a></a><span> </span><a name="local-6989586621679060614"><a href="#local-6989586621679060614"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060615"><a href="#local-6989586621679060615"><span class="hs-identifier">z0</span></a></a><span> </span><a name="local-6989586621679060616"><a href="#local-6989586621679060616"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060615"><span class="hs-identifier hs-var">z0</span></a><span> </span><a href="Data.Sequence.Internal.html#%3C%7C"><span class="hs-operator hs-var">&lt;|</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Traversable.html#mapAccumL"><span class="hs-identifier hs-var">mapAccumL</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679060617"><a href="#local-6989586621679060617"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679060618"><a href="#local-6989586621679060618"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679060619"><a href="#local-6989586621679060619"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060614"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060617"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679060618"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060619"><span class="hs-identifier hs-var">x'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679060619"><span class="hs-identifier hs-var">x'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060615"><span class="hs-identifier hs-var">z0</span></a><span> </span><a href="#local-6989586621679060616"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-2017"></a><span>
</span><a name="line-2018"></a><span class="hs-comment">-- | 'scanl1' is a variant of 'scanl' that has no starting value argument:</span><span>
</span><a name="line-2019"></a><span class="hs-comment">--</span><span>
</span><a name="line-2020"></a><span class="hs-comment">-- &gt; scanl1 f (fromList [x1, x2, ...]) = fromList [x1, x1 `f` x2, ...]</span><span>
</span><a name="line-2021"></a><span class="hs-identifier">scanl1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679058995"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058995"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058995"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679058995"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679058995"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2022"></a><a name="scanl1"><a href="Data.Sequence.Internal.html#scanl1"><span class="hs-identifier">scanl1</span></a></a><span> </span><a name="local-6989586621679060620"><a href="#local-6989586621679060620"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060621"><a href="#local-6989586621679060621"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Data.Sequence.Internal.html#viewl"><span class="hs-identifier hs-var">viewl</span></a><span> </span><a href="#local-6989586621679060621"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2023"></a><span>    </span><a href="Data.Sequence.Internal.html#EmptyL"><span class="hs-identifier hs-var">EmptyL</span></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a><span> </span><span class="hs-string">&quot;scanl1 takes a nonempty sequence as an argument&quot;</span><span>
</span><a name="line-2024"></a><span>    </span><a name="local-6989586621679060622"><a href="#local-6989586621679060622"><span class="hs-identifier">x</span></a></a><span> </span><a href="Data.Sequence.Internal.html#%3A%3C"><span class="hs-operator hs-var">:&lt;</span></a><span> </span><a name="local-6989586621679060623"><a href="#local-6989586621679060623"><span class="hs-identifier">xs'</span></a></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#scanl"><span class="hs-identifier hs-var">scanl</span></a><span> </span><a href="#local-6989586621679060620"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060622"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679060623"><span class="hs-identifier hs-var">xs'</span></a><span>
</span><a name="line-2025"></a><span>
</span><a name="line-2026"></a><span class="hs-comment">-- | 'scanr' is the right-to-left dual of 'scanl'.</span><span>
</span><a name="line-2027"></a><span class="hs-identifier">scanr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679058993"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058994"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058994"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058994"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679058993"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679058994"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-2028"></a><a name="scanr"><a href="Data.Sequence.Internal.html#scanr"><span class="hs-identifier">scanr</span></a></a><span> </span><a name="local-6989586621679060624"><a href="#local-6989586621679060624"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060625"><a href="#local-6989586621679060625"><span class="hs-identifier">z0</span></a></a><span> </span><a name="local-6989586621679060626"><a href="#local-6989586621679060626"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/Data.Traversable.html#mapAccumR"><span class="hs-identifier hs-var">mapAccumR</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679060627"><a href="#local-6989586621679060627"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679060628"><a href="#local-6989586621679060628"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679060629"><a href="#local-6989586621679060629"><span class="hs-identifier">z'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060624"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060628"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679060627"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060629"><span class="hs-identifier hs-var">z'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679060629"><span class="hs-identifier hs-var">z'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060625"><span class="hs-identifier hs-var">z0</span></a><span> </span><a href="#local-6989586621679060626"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span> </span><a href="#local-6989586621679060625"><span class="hs-identifier hs-var">z0</span></a><span>
</span><a name="line-2029"></a><span>
</span><a name="line-2030"></a><span class="hs-comment">-- | 'scanr1' is a variant of 'scanr' that has no starting value argument.</span><span>
</span><a name="line-2031"></a><span class="hs-identifier">scanr1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679058992"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058992"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058992"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679058992"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679058992"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2032"></a><a name="scanr1"><a href="Data.Sequence.Internal.html#scanr1"><span class="hs-identifier">scanr1</span></a></a><span> </span><a name="local-6989586621679060630"><a href="#local-6989586621679060630"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060631"><a href="#local-6989586621679060631"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Data.Sequence.Internal.html#viewr"><span class="hs-identifier hs-var">viewr</span></a><span> </span><a href="#local-6989586621679060631"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2033"></a><span>    </span><a href="Data.Sequence.Internal.html#EmptyR"><span class="hs-identifier hs-var">EmptyR</span></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a><span> </span><span class="hs-string">&quot;scanr1 takes a nonempty sequence as an argument&quot;</span><span>
</span><a name="line-2034"></a><span>    </span><a name="local-6989586621679060632"><a href="#local-6989586621679060632"><span class="hs-identifier">xs'</span></a></a><span> </span><a href="Data.Sequence.Internal.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a><span> </span><a name="local-6989586621679060633"><a href="#local-6989586621679060633"><span class="hs-identifier">x</span></a></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#scanr"><span class="hs-identifier hs-var">scanr</span></a><span> </span><a href="#local-6989586621679060630"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060633"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679060632"><span class="hs-identifier hs-var">xs'</span></a><span>
</span><a name="line-2035"></a><span>
</span><a name="line-2036"></a><span class="hs-comment">-- Indexing</span><span>
</span><a name="line-2037"></a><span>
</span><a name="line-2038"></a><span class="hs-comment">-- | \( O(\log(\min(i,n-i))) \). The element at the specified position,</span><span>
</span><a name="line-2039"></a><span class="hs-comment">-- counting from 0.  The argument should thus be a non-negative</span><span>
</span><a name="line-2040"></a><span class="hs-comment">-- integer less than the size of the sequence.</span><span>
</span><a name="line-2041"></a><span class="hs-comment">-- If the position is out of range, 'index' fails with an error.</span><span>
</span><a name="line-2042"></a><span class="hs-comment">--</span><span>
</span><a name="line-2043"></a><span class="hs-comment">-- prop&gt; xs `index` i = toList xs !! i</span><span>
</span><a name="line-2044"></a><span class="hs-comment">--</span><span>
</span><a name="line-2045"></a><span class="hs-comment">-- Caution: 'index' necessarily delays retrieving the requested</span><span>
</span><a name="line-2046"></a><span class="hs-comment">-- element until the result is forced. It can therefore lead to a space</span><span>
</span><a name="line-2047"></a><span class="hs-comment">-- leak if the result is stored, unforced, in another structure. To retrieve</span><span>
</span><a name="line-2048"></a><span class="hs-comment">-- an element immediately without forcing it, use 'lookup' or '(!?)'.</span><span>
</span><a name="line-2049"></a><span class="hs-identifier">index</span><span>           </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679058991"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058991"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2050"></a><a name="index"><a href="Data.Sequence.Internal.html#index"><span class="hs-identifier">index</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a name="local-6989586621679060634"><a href="#local-6989586621679060634"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060635"><a href="#local-6989586621679060635"><span class="hs-identifier">i</span></a></a><span>
</span><a name="line-2051"></a><span>  </span><span class="hs-comment">-- See note on unsigned arithmetic in splitAt</span><span>
</span><a name="line-2052"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a><span> </span><a href="#local-6989586621679060635"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060634"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Word"><span class="hs-identifier hs-type">Word</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Data.Sequence.Internal.html#lookupTree"><span class="hs-identifier hs-var">lookupTree</span></a><span> </span><a href="#local-6989586621679060635"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060634"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2053"></a><span>                </span><a href="Data.Sequence.Internal.html#Place"><span class="hs-identifier hs-var">Place</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-var">Elem</span></a><span> </span><a name="local-6989586621679060636"><a href="#local-6989586621679060636"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060636"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-2054"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>   </span><span class="hs-glyph">=</span><span>
</span><a name="line-2055"></a><span>      </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-string">&quot;index out of bounds in call to: Data.Sequence.index &quot;</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a><span> </span><a href="#local-6989586621679060635"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-2056"></a><span>
</span><a name="line-2057"></a><span class="hs-comment">-- | \( O(\log(\min(i,n-i))) \). The element at the specified position,</span><span>
</span><a name="line-2058"></a><span class="hs-comment">-- counting from 0. If the specified position is negative or at</span><span>
</span><a name="line-2059"></a><span class="hs-comment">-- least the length of the sequence, 'lookup' returns 'Nothing'.</span><span>
</span><a name="line-2060"></a><span class="hs-comment">--</span><span>
</span><a name="line-2061"></a><span class="hs-comment">-- prop&gt; 0 &lt;= i &lt; length xs ==&gt; lookup i xs == Just (toList xs !! i)</span><span>
</span><a name="line-2062"></a><span class="hs-comment">-- prop&gt; i &lt; 0 || i &gt;= length xs ==&gt; lookup i xs = Nothing</span><span>
</span><a name="line-2063"></a><span class="hs-comment">--</span><span>
</span><a name="line-2064"></a><span class="hs-comment">-- Unlike 'index', this can be used to retrieve an element without</span><span>
</span><a name="line-2065"></a><span class="hs-comment">-- forcing it. For example, to insert the fifth element of a sequence</span><span>
</span><a name="line-2066"></a><span class="hs-comment">-- @xs@ into a 'Data.Map.Lazy.Map' @m@ at key @k@, you could use</span><span>
</span><a name="line-2067"></a><span class="hs-comment">--</span><span>
</span><a name="line-2068"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-2069"></a><span class="hs-comment">-- case lookup 5 xs of</span><span>
</span><a name="line-2070"></a><span class="hs-comment">--   Nothing -&gt; m</span><span>
</span><a name="line-2071"></a><span class="hs-comment">--   Just x -&gt; 'Data.Map.Lazy.insert' k x m</span><span>
</span><a name="line-2072"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-2073"></a><span class="hs-comment">--</span><span>
</span><a name="line-2074"></a><span class="hs-comment">-- @since 0.5.8</span><span>
</span><a name="line-2075"></a><span class="hs-identifier">lookup</span><span>            </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679058990"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679058990"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2076"></a><a name="lookup"><a href="Data.Sequence.Internal.html#lookup"><span class="hs-identifier">lookup</span></a></a><span> </span><a name="local-6989586621679060637"><a href="#local-6989586621679060637"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a name="local-6989586621679060638"><a href="#local-6989586621679060638"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2077"></a><span>  </span><span class="hs-comment">-- Note: we perform the lookup *before* applying the Just constructor</span><span>
</span><a name="line-2078"></a><span>  </span><span class="hs-comment">-- to ensure that we don't hold a reference to the whole sequence in</span><span>
</span><a name="line-2079"></a><span>  </span><span class="hs-comment">-- a thunk. If we applied the Just constructor around the case, the</span><span>
</span><a name="line-2080"></a><span>  </span><span class="hs-comment">-- actual lookup wouldn't be performed unless and until the value was</span><span>
</span><a name="line-2081"></a><span>  </span><span class="hs-comment">-- forced.</span><span>
</span><a name="line-2082"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a><span> </span><a href="#local-6989586621679060637"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060638"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Word"><span class="hs-identifier hs-type">Word</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Data.Sequence.Internal.html#lookupTree"><span class="hs-identifier hs-var">lookupTree</span></a><span> </span><a href="#local-6989586621679060637"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060638"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2083"></a><span>                </span><a href="Data.Sequence.Internal.html#Place"><span class="hs-identifier hs-var">Place</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-var">Elem</span></a><span> </span><a name="local-6989586621679060639"><a href="#local-6989586621679060639"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679060639"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-2084"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-2085"></a><span>
</span><a name="line-2086"></a><span class="hs-comment">-- | \( O(\log(\min(i,n-i))) \). A flipped, infix version of `lookup`.</span><span>
</span><a name="line-2087"></a><span class="hs-comment">--</span><span>
</span><a name="line-2088"></a><span class="hs-comment">-- @since 0.5.8</span><span>
</span><a name="line-2089"></a><span class="hs-special">(</span><span class="hs-operator">!?</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>           </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679058989"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679058989"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2090"></a><span class="hs-special">(</span><a name="%21%3F"><a href="Data.Sequence.Internal.html#%21%3F"><span class="hs-operator">!?</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a><span> </span><a href="Data.Sequence.Internal.html#lookup"><span class="hs-identifier hs-var">lookup</span></a><span>
</span><a name="line-2091"></a><span>
</span><a name="line-2092"></a><span class="hs-keyword">data</span><span> </span><a name="Place"><a href="Data.Sequence.Internal.html#Place"><span class="hs-identifier">Place</span></a></a><span> </span><a name="local-6989586621679058044"><a href="#local-6989586621679058044"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Place"><a href="Data.Sequence.Internal.html#Place"><span class="hs-identifier">Place</span></a></a><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><a href="#local-6989586621679058044"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2093"></a><span class="hs-cpp">#ifdef TESTING
</span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier">Show</span><span>
</span><a name="line-2095"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-2097"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">lookupTree</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Place</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2098"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">lookupTree</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Place</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2099"></a><span class="hs-identifier">lookupTree</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a><span> </span><a href="#local-6989586621679058986"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><a href="#local-6989586621679058986"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Place"><span class="hs-identifier hs-type">Place</span></a><span> </span><a href="#local-6989586621679058986"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2100"></a><a name="lookupTree"><a href="Data.Sequence.Internal.html#lookupTree"><span class="hs-identifier">lookupTree</span></a></a><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a><span> </span><span class="hs-string">&quot;lookupTree of empty tree&quot;</span><span>
</span><a name="line-2101"></a><span class="hs-identifier">lookupTree</span><span> </span><a name="local-6989586621679060640"><a href="#local-6989586621679060640"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><a name="local-6989586621679060641"><a href="#local-6989586621679060641"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Place"><span class="hs-identifier hs-var">Place</span></a><span> </span><a href="#local-6989586621679060640"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060641"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-2102"></a><span class="hs-identifier">lookupTree</span><span> </span><a name="local-6989586621679060642"><a href="#local-6989586621679060642"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679060643"><a href="#local-6989586621679060643"><span class="hs-identifier">pr</span></a></a><span> </span><a name="local-6989586621679060644"><a href="#local-6989586621679060644"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679060645"><a href="#local-6989586621679060645"><span class="hs-identifier">sf</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2103"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060642"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060646"><span class="hs-identifier hs-var">spr</span></a><span>     </span><span class="hs-glyph">=</span><span>  </span><a href="Data.Sequence.Internal.html#lookupDigit"><span class="hs-identifier hs-var">lookupDigit</span></a><span> </span><a href="#local-6989586621679060642"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060643"><span class="hs-identifier hs-var">pr</span></a><span>
</span><a name="line-2104"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060642"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060647"><span class="hs-identifier hs-var">spm</span></a><span>     </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">case</span><span> </span><a href="Data.Sequence.Internal.html#lookupTree"><span class="hs-identifier hs-var">lookupTree</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060642"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060646"><span class="hs-identifier hs-var">spr</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060644"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2105"></a><span>                   </span><a href="Data.Sequence.Internal.html#Place"><span class="hs-identifier hs-var">Place</span></a><span> </span><a name="local-6989586621679060648"><a href="#local-6989586621679060648"><span class="hs-identifier">i'</span></a></a><span> </span><a name="local-6989586621679060649"><a href="#local-6989586621679060649"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#lookupNode"><span class="hs-identifier hs-var">lookupNode</span></a><span> </span><a href="#local-6989586621679060648"><span class="hs-identifier hs-var">i'</span></a><span> </span><a href="#local-6989586621679060649"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-2106"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>   </span><span class="hs-glyph">=</span><span>  </span><a href="Data.Sequence.Internal.html#lookupDigit"><span class="hs-identifier hs-var">lookupDigit</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060642"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060647"><span class="hs-identifier hs-var">spm</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060645"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2107"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2108"></a><span>    </span><a name="local-6989586621679060646"><a href="#local-6989586621679060646"><span class="hs-identifier">spr</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060643"><span class="hs-identifier hs-var">pr</span></a><span>
</span><a name="line-2109"></a><span>    </span><a name="local-6989586621679060647"><a href="#local-6989586621679060647"><span class="hs-identifier">spm</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060646"><span class="hs-identifier hs-var">spr</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060644"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-2110"></a><span>
</span><a name="line-2111"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">lookupNode</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Place</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2112"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">lookupNode</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Place</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2113"></a><span class="hs-identifier">lookupNode</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a><span> </span><a href="#local-6989586621679058983"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679058983"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Place"><span class="hs-identifier hs-type">Place</span></a><span> </span><a href="#local-6989586621679058983"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2114"></a><a name="lookupNode"><a href="Data.Sequence.Internal.html#lookupNode"><span class="hs-identifier">lookupNode</span></a></a><span> </span><a name="local-6989586621679060650"><a href="#local-6989586621679060650"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679060651"><a href="#local-6989586621679060651"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060652"><a href="#local-6989586621679060652"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2115"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060650"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060653"><span class="hs-identifier hs-var">sa</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Place"><span class="hs-identifier hs-var">Place</span></a><span> </span><a href="#local-6989586621679060650"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060651"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2116"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Place"><span class="hs-identifier hs-var">Place</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060650"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060653"><span class="hs-identifier hs-var">sa</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060652"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2117"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2118"></a><span>    </span><a name="local-6989586621679060653"><a href="#local-6989586621679060653"><span class="hs-identifier">sa</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060651"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2119"></a><span class="hs-identifier">lookupNode</span><span> </span><a name="local-6989586621679060654"><a href="#local-6989586621679060654"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679060655"><a href="#local-6989586621679060655"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060656"><a href="#local-6989586621679060656"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060657"><a href="#local-6989586621679060657"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2120"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060654"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060658"><span class="hs-identifier hs-var">sa</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Place"><span class="hs-identifier hs-var">Place</span></a><span> </span><a href="#local-6989586621679060654"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060655"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2121"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060654"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060659"><span class="hs-identifier hs-var">sab</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Place"><span class="hs-identifier hs-var">Place</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060654"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060658"><span class="hs-identifier hs-var">sa</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060656"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2122"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Place"><span class="hs-identifier hs-var">Place</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060654"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060659"><span class="hs-identifier hs-var">sab</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060657"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2123"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2124"></a><span>    </span><a name="local-6989586621679060658"><a href="#local-6989586621679060658"><span class="hs-identifier">sa</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060655"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2125"></a><span>    </span><a name="local-6989586621679060659"><a href="#local-6989586621679060659"><span class="hs-identifier">sab</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060658"><span class="hs-identifier hs-var">sa</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060656"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2126"></a><span>
</span><a name="line-2127"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">lookupDigit</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Digit</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Place</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2128"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">lookupDigit</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Digit</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Place</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2129"></a><span class="hs-identifier">lookupDigit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a><span> </span><a href="#local-6989586621679058980"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><a href="#local-6989586621679058980"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Place"><span class="hs-identifier hs-type">Place</span></a><span> </span><a href="#local-6989586621679058980"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2130"></a><a name="lookupDigit"><a href="Data.Sequence.Internal.html#lookupDigit"><span class="hs-identifier">lookupDigit</span></a></a><span> </span><a name="local-6989586621679060660"><a href="#local-6989586621679060660"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679060661"><a href="#local-6989586621679060661"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Place"><span class="hs-identifier hs-var">Place</span></a><span> </span><a href="#local-6989586621679060660"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060661"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2131"></a><span class="hs-identifier">lookupDigit</span><span> </span><a name="local-6989586621679060662"><a href="#local-6989586621679060662"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679060663"><a href="#local-6989586621679060663"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060664"><a href="#local-6989586621679060664"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2132"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060662"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060665"><span class="hs-identifier hs-var">sa</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Place"><span class="hs-identifier hs-var">Place</span></a><span> </span><a href="#local-6989586621679060662"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060663"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2133"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Place"><span class="hs-identifier hs-var">Place</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060662"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060665"><span class="hs-identifier hs-var">sa</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060664"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2134"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2135"></a><span>    </span><a name="local-6989586621679060665"><a href="#local-6989586621679060665"><span class="hs-identifier">sa</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060663"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2136"></a><span class="hs-identifier">lookupDigit</span><span> </span><a name="local-6989586621679060666"><a href="#local-6989586621679060666"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679060667"><a href="#local-6989586621679060667"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060668"><a href="#local-6989586621679060668"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060669"><a href="#local-6989586621679060669"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2137"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060666"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060670"><span class="hs-identifier hs-var">sa</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Place"><span class="hs-identifier hs-var">Place</span></a><span> </span><a href="#local-6989586621679060666"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060667"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2138"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060666"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060671"><span class="hs-identifier hs-var">sab</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Place"><span class="hs-identifier hs-var">Place</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060666"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060670"><span class="hs-identifier hs-var">sa</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060668"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2139"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Place"><span class="hs-identifier hs-var">Place</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060666"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060671"><span class="hs-identifier hs-var">sab</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060669"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2140"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2141"></a><span>    </span><a name="local-6989586621679060670"><a href="#local-6989586621679060670"><span class="hs-identifier">sa</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060667"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2142"></a><span>    </span><a name="local-6989586621679060671"><a href="#local-6989586621679060671"><span class="hs-identifier">sab</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060670"><span class="hs-identifier hs-var">sa</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060668"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2143"></a><span class="hs-identifier">lookupDigit</span><span> </span><a name="local-6989586621679060672"><a href="#local-6989586621679060672"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679060673"><a href="#local-6989586621679060673"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060674"><a href="#local-6989586621679060674"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060675"><a href="#local-6989586621679060675"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060676"><a href="#local-6989586621679060676"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2144"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060672"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060677"><span class="hs-identifier hs-var">sa</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Place"><span class="hs-identifier hs-var">Place</span></a><span> </span><a href="#local-6989586621679060672"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060673"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2145"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060672"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060678"><span class="hs-identifier hs-var">sab</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Place"><span class="hs-identifier hs-var">Place</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060672"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060677"><span class="hs-identifier hs-var">sa</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060674"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2146"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060672"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060679"><span class="hs-identifier hs-var">sabc</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Place"><span class="hs-identifier hs-var">Place</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060672"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060678"><span class="hs-identifier hs-var">sab</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060675"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2147"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Place"><span class="hs-identifier hs-var">Place</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060672"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060679"><span class="hs-identifier hs-var">sabc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060676"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-2148"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2149"></a><span>    </span><a name="local-6989586621679060677"><a href="#local-6989586621679060677"><span class="hs-identifier">sa</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060673"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2150"></a><span>    </span><a name="local-6989586621679060678"><a href="#local-6989586621679060678"><span class="hs-identifier">sab</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060677"><span class="hs-identifier hs-var">sa</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060674"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2151"></a><span>    </span><a name="local-6989586621679060679"><a href="#local-6989586621679060679"><span class="hs-identifier">sabc</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060678"><span class="hs-identifier hs-var">sab</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060675"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2152"></a><span>
</span><a name="line-2153"></a><span class="hs-comment">-- | \( O(\log(\min(i,n-i))) \). Replace the element at the specified position.</span><span>
</span><a name="line-2154"></a><span class="hs-comment">-- If the position is out of range, the original sequence is returned.</span><span>
</span><a name="line-2155"></a><span class="hs-identifier">update</span><span>          </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058979"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679058979"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679058979"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2156"></a><a name="update"><a href="Data.Sequence.Internal.html#update"><span class="hs-identifier">update</span></a></a><span> </span><a name="local-6989586621679060680"><a href="#local-6989586621679060680"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679060681"><a href="#local-6989586621679060681"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a name="local-6989586621679060682"><a href="#local-6989586621679060682"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2157"></a><span>  </span><span class="hs-comment">-- See note on unsigned arithmetic in splitAt</span><span>
</span><a name="line-2158"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a><span> </span><a href="#local-6989586621679060680"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060682"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Word"><span class="hs-identifier hs-type">Word</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#updateTree"><span class="hs-identifier hs-var">updateTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-var">Elem</span></a><span> </span><a href="#local-6989586621679060681"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060680"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060682"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-2159"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a href="#local-6989586621679060682"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-2160"></a><span>
</span><a name="line-2161"></a><span class="hs-comment">-- It seems a shame to copy the implementation of the top layer of</span><span>
</span><a name="line-2162"></a><span class="hs-comment">-- `adjust` instead of just using `update i x = adjust (const x) i`.</span><span>
</span><a name="line-2163"></a><span class="hs-comment">-- With the latter implementation, updating the same position many</span><span>
</span><a name="line-2164"></a><span class="hs-comment">-- times could lead to silly thunks building up around that position.</span><span>
</span><a name="line-2165"></a><span class="hs-comment">-- The thunks will each look like @const v a@, where @v@ is the new</span><span>
</span><a name="line-2166"></a><span class="hs-comment">-- value and @a@ the old.</span><span>
</span><a name="line-2167"></a><span class="hs-identifier">updateTree</span><span>      </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679058978"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679058978"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679058978"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-2168"></a><a name="updateTree"><a href="Data.Sequence.Internal.html#updateTree"><span class="hs-identifier">updateTree</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-comment">-- Unreachable</span><span>
</span><a name="line-2169"></a><span class="hs-identifier">updateTree</span><span> </span><a name="local-6989586621679060683"><a href="#local-6989586621679060683"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679060684"><a href="#local-6989586621679060684"><span class="hs-identifier">_i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><a href="#local-6989586621679060683"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-2170"></a><span class="hs-identifier">updateTree</span><span> </span><a name="local-6989586621679060685"><a href="#local-6989586621679060685"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679060686"><a href="#local-6989586621679060686"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679060687"><a href="#local-6989586621679060687"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679060688"><a href="#local-6989586621679060688"><span class="hs-identifier">pr</span></a></a><span> </span><a name="local-6989586621679060689"><a href="#local-6989586621679060689"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679060690"><a href="#local-6989586621679060690"><span class="hs-identifier">sf</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2171"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060686"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060691"><span class="hs-identifier hs-var">spr</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="#local-6989586621679060687"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#updateDigit"><span class="hs-identifier hs-var">updateDigit</span></a><span> </span><a href="#local-6989586621679060685"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679060686"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060688"><span class="hs-identifier hs-var">pr</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060689"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679060690"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2172"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060686"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060692"><span class="hs-identifier hs-var">spm</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060693"><a href="#local-6989586621679060693"><span class="hs-identifier">m'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#adjustTree"><span class="hs-identifier hs-var">adjustTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#updateNode"><span class="hs-identifier hs-var">updateNode</span></a><span> </span><a href="#local-6989586621679060685"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060686"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060691"><span class="hs-identifier hs-var">spr</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060689"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-2173"></a><span>                  </span><span class="hs-keyword">in</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="#local-6989586621679060687"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679060688"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679060693"><span class="hs-identifier hs-var">m'</span></a><span> </span><a href="#local-6989586621679060690"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2174"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="#local-6989586621679060687"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679060688"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679060689"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#updateDigit"><span class="hs-identifier hs-var">updateDigit</span></a><span> </span><a href="#local-6989586621679060685"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060686"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060692"><span class="hs-identifier hs-var">spm</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060690"><span class="hs-identifier hs-var">sf</span></a><span class="hs-special">)</span><span>
</span><a name="line-2175"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2176"></a><span>    </span><a name="local-6989586621679060691"><a href="#local-6989586621679060691"><span class="hs-identifier">spr</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060688"><span class="hs-identifier hs-var">pr</span></a><span>
</span><a name="line-2177"></a><span>    </span><a name="local-6989586621679060692"><a href="#local-6989586621679060692"><span class="hs-identifier">spm</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060691"><span class="hs-identifier hs-var">spr</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060689"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-2178"></a><span>
</span><a name="line-2179"></a><span class="hs-identifier">updateNode</span><span>      </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679058977"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679058977"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679058977"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-2180"></a><a name="updateNode"><a href="Data.Sequence.Internal.html#updateNode"><span class="hs-identifier">updateNode</span></a></a><span> </span><a name="local-6989586621679060694"><a href="#local-6989586621679060694"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679060695"><a href="#local-6989586621679060695"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a name="local-6989586621679060696"><a href="#local-6989586621679060696"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679060697"><a href="#local-6989586621679060697"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060698"><a href="#local-6989586621679060698"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2181"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060695"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060699"><span class="hs-identifier hs-var">sa</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a href="#local-6989586621679060696"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679060694"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679060698"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2182"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a href="#local-6989586621679060696"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679060697"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060694"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-2183"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2184"></a><span>    </span><a name="local-6989586621679060699"><a href="#local-6989586621679060699"><span class="hs-identifier">sa</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060697"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2185"></a><span class="hs-identifier">updateNode</span><span> </span><a name="local-6989586621679060700"><a href="#local-6989586621679060700"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679060701"><a href="#local-6989586621679060701"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a name="local-6989586621679060702"><a href="#local-6989586621679060702"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679060703"><a href="#local-6989586621679060703"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060704"><a href="#local-6989586621679060704"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060705"><a href="#local-6989586621679060705"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2186"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060701"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060706"><span class="hs-identifier hs-var">sa</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a href="#local-6989586621679060702"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679060700"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679060704"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060705"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2187"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060701"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060707"><span class="hs-identifier hs-var">sab</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a href="#local-6989586621679060702"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679060703"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060700"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679060705"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2188"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a href="#local-6989586621679060702"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679060703"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060704"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060700"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-2189"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2190"></a><span>    </span><a name="local-6989586621679060706"><a href="#local-6989586621679060706"><span class="hs-identifier">sa</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060703"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2191"></a><span>    </span><a name="local-6989586621679060707"><a href="#local-6989586621679060707"><span class="hs-identifier">sab</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060706"><span class="hs-identifier hs-var">sa</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060704"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2192"></a><span>
</span><a name="line-2193"></a><span class="hs-identifier">updateDigit</span><span>     </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679058976"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679058976"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679058976"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-2194"></a><a name="updateDigit"><a href="Data.Sequence.Internal.html#updateDigit"><span class="hs-identifier">updateDigit</span></a></a><span> </span><a name="local-6989586621679060708"><a href="#local-6989586621679060708"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060709"><a href="#local-6989586621679060709"><span class="hs-identifier">_i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a href="#local-6989586621679060708"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-2195"></a><span class="hs-identifier">updateDigit</span><span> </span><a name="local-6989586621679060710"><a href="#local-6989586621679060710"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679060711"><a href="#local-6989586621679060711"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679060712"><a href="#local-6989586621679060712"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060713"><a href="#local-6989586621679060713"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2196"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060711"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060714"><span class="hs-identifier hs-var">sa</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679060710"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679060713"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2197"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679060712"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060710"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-2198"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2199"></a><span>    </span><a name="local-6989586621679060714"><a href="#local-6989586621679060714"><span class="hs-identifier">sa</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060712"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2200"></a><span class="hs-identifier">updateDigit</span><span> </span><a name="local-6989586621679060715"><a href="#local-6989586621679060715"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679060716"><a href="#local-6989586621679060716"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679060717"><a href="#local-6989586621679060717"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060718"><a href="#local-6989586621679060718"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060719"><a href="#local-6989586621679060719"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2201"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060716"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060720"><span class="hs-identifier hs-var">sa</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679060715"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679060718"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060719"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2202"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060716"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060721"><span class="hs-identifier hs-var">sab</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679060717"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060715"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679060719"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2203"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679060717"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060718"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060715"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-2204"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2205"></a><span>    </span><a name="local-6989586621679060720"><a href="#local-6989586621679060720"><span class="hs-identifier">sa</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060717"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2206"></a><span>    </span><a name="local-6989586621679060721"><a href="#local-6989586621679060721"><span class="hs-identifier">sab</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060720"><span class="hs-identifier hs-var">sa</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060718"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2207"></a><span class="hs-identifier">updateDigit</span><span> </span><a name="local-6989586621679060722"><a href="#local-6989586621679060722"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679060723"><a href="#local-6989586621679060723"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679060724"><a href="#local-6989586621679060724"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060725"><a href="#local-6989586621679060725"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060726"><a href="#local-6989586621679060726"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060727"><a href="#local-6989586621679060727"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2208"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060723"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060728"><span class="hs-identifier hs-var">sa</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a href="#local-6989586621679060722"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679060725"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060726"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679060727"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-2209"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060723"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060729"><span class="hs-identifier hs-var">sab</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a href="#local-6989586621679060724"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060722"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679060726"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679060727"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-2210"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060723"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060730"><span class="hs-identifier hs-var">sabc</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a href="#local-6989586621679060724"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060725"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060722"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679060727"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-2211"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a href="#local-6989586621679060724"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060725"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060726"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679060722"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-2212"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2213"></a><span>    </span><a name="local-6989586621679060728"><a href="#local-6989586621679060728"><span class="hs-identifier">sa</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060724"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2214"></a><span>    </span><a name="local-6989586621679060729"><a href="#local-6989586621679060729"><span class="hs-identifier">sab</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060728"><span class="hs-identifier hs-var">sa</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060725"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2215"></a><span>    </span><a name="local-6989586621679060730"><a href="#local-6989586621679060730"><span class="hs-identifier">sabc</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060729"><span class="hs-identifier hs-var">sab</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060726"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2216"></a><span>
</span><a name="line-2217"></a><span class="hs-comment">-- | \( O(\log(\min(i,n-i))) \). Update the element at the specified position.  If</span><span>
</span><a name="line-2218"></a><span class="hs-comment">-- the position is out of range, the original sequence is returned.  'adjust'</span><span>
</span><a name="line-2219"></a><span class="hs-comment">-- can lead to poor performance and even memory leaks, because it does not</span><span>
</span><a name="line-2220"></a><span class="hs-comment">-- force the new value before installing it in the sequence. 'adjust'' should</span><span>
</span><a name="line-2221"></a><span class="hs-comment">-- usually be preferred.</span><span>
</span><a name="line-2222"></a><span class="hs-comment">--</span><span>
</span><a name="line-2223"></a><span class="hs-comment">-- @since 0.5.8</span><span>
</span><a name="line-2224"></a><span class="hs-identifier">adjust</span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679058975"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058975"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679058975"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679058975"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2225"></a><a name="adjust"><a href="Data.Sequence.Internal.html#adjust"><span class="hs-identifier">adjust</span></a></a><span> </span><a name="local-6989586621679060731"><a href="#local-6989586621679060731"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060732"><a href="#local-6989586621679060732"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a name="local-6989586621679060733"><a href="#local-6989586621679060733"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2226"></a><span>  </span><span class="hs-comment">-- See note on unsigned arithmetic in splitAt</span><span>
</span><a name="line-2227"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a><span> </span><a href="#local-6989586621679060732"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060733"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Word"><span class="hs-identifier hs-type">Word</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#adjustTree"><span class="hs-identifier hs-var">adjustTree</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><a href="#local-6989586621679060731"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060732"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060733"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-2228"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a href="#local-6989586621679060733"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-2229"></a><span>
</span><a name="line-2230"></a><span class="hs-comment">-- | \( O(\log(\min(i,n-i))) \). Update the element at the specified position.</span><span>
</span><a name="line-2231"></a><span class="hs-comment">-- If the position is out of range, the original sequence is returned.</span><span>
</span><a name="line-2232"></a><span class="hs-comment">-- The new value is forced before it is installed in the sequence.</span><span>
</span><a name="line-2233"></a><span class="hs-comment">--</span><span>
</span><a name="line-2234"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-2235"></a><span class="hs-comment">-- adjust' f i xs =</span><span>
</span><a name="line-2236"></a><span class="hs-comment">--  case xs !? i of</span><span>
</span><a name="line-2237"></a><span class="hs-comment">--    Nothing -&gt; xs</span><span>
</span><a name="line-2238"></a><span class="hs-comment">--    Just x -&gt; let !x' = f x</span><span>
</span><a name="line-2239"></a><span class="hs-comment">--              in update i x' xs</span><span>
</span><a name="line-2240"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-2241"></a><span class="hs-comment">--</span><span>
</span><a name="line-2242"></a><span class="hs-comment">-- @since 0.5.8</span><span>
</span><a name="line-2243"></a><span class="hs-identifier">adjust'</span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679058974"><a href="#local-6989586621679058974"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679058974"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058974"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679058974"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679058974"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2244"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 708
</span><a name="adjust%27"><a href="Data.Sequence.Internal.html#adjust%27"><span class="hs-identifier">adjust'</span></a></a><span> </span><a name="local-6989586621679060734"><a href="#local-6989586621679060734"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060735"><a href="#local-6989586621679060735"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679060736"><a href="#local-6989586621679060736"><span class="hs-identifier">xs</span></a></a><span>
</span><a name="line-2246"></a><span>  </span><span class="hs-comment">-- See note on unsigned arithmetic in splitAt</span><span>
</span><a name="line-2247"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a><span> </span><a href="#local-6989586621679060735"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-6989586621679060736"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Word"><span class="hs-identifier hs-type">Word</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2248"></a><span>      </span><span class="hs-identifier hs-var">coerce</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#adjustTree"><span class="hs-identifier hs-var">adjustTree</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060737"><a href="#local-6989586621679060737"><span class="hs-identifier">_k</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#ForceBox"><span class="hs-identifier hs-var">ForceBox</span></a><span> </span><a name="local-6989586621679060738"><a href="#local-6989586621679060738"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#ForceBox"><span class="hs-identifier hs-var">ForceBox</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060734"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060738"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060735"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">coerce</span><span> </span><a href="#local-6989586621679060736"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-2249"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060736"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-2250"></a><span class="hs-cpp">#else
</span><span class="hs-comment">-- This is inefficient, but fixing it would take a lot of fuss and bother</span><span>
</span><a name="line-2252"></a><span class="hs-comment">-- for little immediate gain. We can deal with that when we have another</span><span>
</span><a name="line-2253"></a><span class="hs-comment">-- Haskell implementation to worry about.</span><span>
</span><a name="line-2254"></a><span class="hs-identifier">adjust'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2255"></a><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-operator">!?</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2256"></a><span>    </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-2257"></a><span>    </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">x'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span>
</span><a name="line-2258"></a><span>              </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">update</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">x'</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-2259"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-2261"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">adjustTree</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">ForceBox</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">ForceBox</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">ForceBox</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">ForceBox</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2262"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">adjustTree</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2263"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">adjustTree</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2264"></a><span class="hs-identifier">adjustTree</span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a><span> </span><a href="#local-6989586621679058970"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#MaybeForce"><span class="hs-identifier hs-type">MaybeForce</span></a><span> </span><a href="#local-6989586621679058970"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058970"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058970"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-2265"></a><span>             </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><a href="#local-6989586621679058970"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><a href="#local-6989586621679058970"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2266"></a><a name="adjustTree"><a href="Data.Sequence.Internal.html#adjustTree"><span class="hs-identifier">adjustTree</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-comment">-- Unreachable</span><span>
</span><a name="line-2267"></a><span class="hs-identifier">adjustTree</span><span> </span><a name="local-6989586621679060739"><a href="#local-6989586621679060739"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060740"><a href="#local-6989586621679060740"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><a name="local-6989586621679060741"><a href="#local-6989586621679060741"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><a href="Data.Sequence.Internal.html#%24%21%3F"><span class="hs-operator hs-var">$!?</span></a><span> </span><a href="#local-6989586621679060739"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060740"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060741"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-2268"></a><span class="hs-identifier">adjustTree</span><span> </span><a name="local-6989586621679060742"><a href="#local-6989586621679060742"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060743"><a href="#local-6989586621679060743"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679060744"><a href="#local-6989586621679060744"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679060745"><a href="#local-6989586621679060745"><span class="hs-identifier">pr</span></a></a><span> </span><a name="local-6989586621679060746"><a href="#local-6989586621679060746"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679060747"><a href="#local-6989586621679060747"><span class="hs-identifier">sf</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2269"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060743"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060748"><span class="hs-identifier hs-var">spr</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="#local-6989586621679060744"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#adjustDigit"><span class="hs-identifier hs-var">adjustDigit</span></a><span> </span><a href="#local-6989586621679060742"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060743"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060745"><span class="hs-identifier hs-var">pr</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060746"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679060747"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2270"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060743"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060749"><span class="hs-identifier hs-var">spm</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060750"><a href="#local-6989586621679060750"><span class="hs-identifier">m'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#adjustTree"><span class="hs-identifier hs-var">adjustTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#adjustNode"><span class="hs-identifier hs-var">adjustNode</span></a><span> </span><a href="#local-6989586621679060742"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060743"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060748"><span class="hs-identifier hs-var">spr</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060746"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-2271"></a><span>                  </span><span class="hs-keyword">in</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="#local-6989586621679060744"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679060745"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679060750"><span class="hs-identifier hs-var">m'</span></a><span> </span><a href="#local-6989586621679060747"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2272"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="#local-6989586621679060744"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679060745"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679060746"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#adjustDigit"><span class="hs-identifier hs-var">adjustDigit</span></a><span> </span><a href="#local-6989586621679060742"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060743"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060749"><span class="hs-identifier hs-var">spm</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060747"><span class="hs-identifier hs-var">sf</span></a><span class="hs-special">)</span><span>
</span><a name="line-2273"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2274"></a><span>    </span><a name="local-6989586621679060748"><a href="#local-6989586621679060748"><span class="hs-identifier">spr</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060745"><span class="hs-identifier hs-var">pr</span></a><span>
</span><a name="line-2275"></a><span>    </span><a name="local-6989586621679060749"><a href="#local-6989586621679060749"><span class="hs-identifier">spm</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060748"><span class="hs-identifier hs-var">spr</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060746"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-2276"></a><span>
</span><a name="line-2277"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">adjustNode</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2278"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">adjustNode</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2279"></a><span class="hs-identifier">adjustNode</span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a><span> </span><a href="#local-6989586621679058967"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#MaybeForce"><span class="hs-identifier hs-type">MaybeForce</span></a><span> </span><a href="#local-6989586621679058967"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058967"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058967"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679058967"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679058967"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2280"></a><a name="adjustNode"><a href="Data.Sequence.Internal.html#adjustNode"><span class="hs-identifier">adjustNode</span></a></a><span> </span><a name="local-6989586621679060751"><a href="#local-6989586621679060751"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060752"><a href="#local-6989586621679060752"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a name="local-6989586621679060753"><a href="#local-6989586621679060753"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679060754"><a href="#local-6989586621679060754"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060755"><a href="#local-6989586621679060755"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2281"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060752"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060756"><span class="hs-identifier hs-var">sa</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679060757"><a href="#local-6989586621679060757"><span class="hs-identifier">fia</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060751"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060752"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060754"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679060757"><span class="hs-identifier hs-var">fia</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#mseq"><span class="hs-identifier hs-var">mseq</span></a><span class="hs-special">`</span><span> </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a href="#local-6989586621679060753"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679060757"><span class="hs-identifier hs-var">fia</span></a><span> </span><a href="#local-6989586621679060755"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2282"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679060758"><a href="#local-6989586621679060758"><span class="hs-identifier">fisab</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060751"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060752"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060756"><span class="hs-identifier hs-var">sa</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060755"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679060758"><span class="hs-identifier hs-var">fisab</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#mseq"><span class="hs-identifier hs-var">mseq</span></a><span class="hs-special">`</span><span> </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a href="#local-6989586621679060753"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679060754"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060758"><span class="hs-identifier hs-var">fisab</span></a><span>
</span><a name="line-2283"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2284"></a><span>    </span><a name="local-6989586621679060756"><a href="#local-6989586621679060756"><span class="hs-identifier">sa</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060754"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2285"></a><span class="hs-identifier">adjustNode</span><span> </span><a name="local-6989586621679060759"><a href="#local-6989586621679060759"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060760"><a href="#local-6989586621679060760"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a name="local-6989586621679060761"><a href="#local-6989586621679060761"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679060762"><a href="#local-6989586621679060762"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060763"><a href="#local-6989586621679060763"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060764"><a href="#local-6989586621679060764"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2286"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060760"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060765"><span class="hs-identifier hs-var">sa</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679060767"><a href="#local-6989586621679060767"><span class="hs-identifier">fia</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060759"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060760"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060762"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679060767"><span class="hs-identifier hs-var">fia</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#mseq"><span class="hs-identifier hs-var">mseq</span></a><span class="hs-special">`</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a href="#local-6989586621679060761"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679060767"><span class="hs-identifier hs-var">fia</span></a><span> </span><a href="#local-6989586621679060763"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060764"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2287"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060760"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060766"><span class="hs-identifier hs-var">sab</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679060768"><a href="#local-6989586621679060768"><span class="hs-identifier">fisab</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060759"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060760"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060765"><span class="hs-identifier hs-var">sa</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060763"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679060768"><span class="hs-identifier hs-var">fisab</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#mseq"><span class="hs-identifier hs-var">mseq</span></a><span class="hs-special">`</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a href="#local-6989586621679060761"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679060762"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060768"><span class="hs-identifier hs-var">fisab</span></a><span> </span><a href="#local-6989586621679060764"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2288"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679060769"><a href="#local-6989586621679060769"><span class="hs-identifier">fisabc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060759"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060760"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060766"><span class="hs-identifier hs-var">sab</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060764"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679060769"><span class="hs-identifier hs-var">fisabc</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#mseq"><span class="hs-identifier hs-var">mseq</span></a><span class="hs-special">`</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a href="#local-6989586621679060761"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679060762"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060763"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060769"><span class="hs-identifier hs-var">fisabc</span></a><span>
</span><a name="line-2289"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2290"></a><span>    </span><a name="local-6989586621679060765"><a href="#local-6989586621679060765"><span class="hs-identifier">sa</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060762"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2291"></a><span>    </span><a name="local-6989586621679060766"><a href="#local-6989586621679060766"><span class="hs-identifier">sab</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060765"><span class="hs-identifier hs-var">sa</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060763"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2292"></a><span>
</span><a name="line-2293"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">adjustDigit</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Digit</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Digit</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2294"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">adjustDigit</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Digit</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Digit</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2295"></a><span class="hs-identifier">adjustDigit</span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a><span> </span><a href="#local-6989586621679058964"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#MaybeForce"><span class="hs-identifier hs-type">MaybeForce</span></a><span> </span><a href="#local-6989586621679058964"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058964"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058964"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><a href="#local-6989586621679058964"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><a href="#local-6989586621679058964"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2296"></a><a name="adjustDigit"><a href="Data.Sequence.Internal.html#adjustDigit"><span class="hs-identifier">adjustDigit</span></a></a><span> </span><a name="local-6989586621679060770"><a href="#local-6989586621679060770"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060771"><a href="#local-6989586621679060771"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679060772"><a href="#local-6989586621679060772"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a href="Data.Sequence.Internal.html#%24%21%3F"><span class="hs-operator hs-var">$!?</span></a><span> </span><a href="#local-6989586621679060770"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060771"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060772"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2297"></a><span class="hs-identifier">adjustDigit</span><span> </span><a name="local-6989586621679060773"><a href="#local-6989586621679060773"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060774"><a href="#local-6989586621679060774"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679060775"><a href="#local-6989586621679060775"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060776"><a href="#local-6989586621679060776"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2298"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060774"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060777"><span class="hs-identifier hs-var">sa</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679060778"><a href="#local-6989586621679060778"><span class="hs-identifier">fia</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060773"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060774"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060775"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679060778"><span class="hs-identifier hs-var">fia</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#mseq"><span class="hs-identifier hs-var">mseq</span></a><span class="hs-special">`</span><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679060778"><span class="hs-identifier hs-var">fia</span></a><span> </span><a href="#local-6989586621679060776"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2299"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679060779"><a href="#local-6989586621679060779"><span class="hs-identifier">fisab</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060773"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060774"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060777"><span class="hs-identifier hs-var">sa</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060776"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679060779"><span class="hs-identifier hs-var">fisab</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#mseq"><span class="hs-identifier hs-var">mseq</span></a><span class="hs-special">`</span><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679060775"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060779"><span class="hs-identifier hs-var">fisab</span></a><span>
</span><a name="line-2300"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2301"></a><span>    </span><a name="local-6989586621679060777"><a href="#local-6989586621679060777"><span class="hs-identifier">sa</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060775"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2302"></a><span class="hs-identifier">adjustDigit</span><span> </span><a name="local-6989586621679060780"><a href="#local-6989586621679060780"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060781"><a href="#local-6989586621679060781"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679060782"><a href="#local-6989586621679060782"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060783"><a href="#local-6989586621679060783"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060784"><a href="#local-6989586621679060784"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2303"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060781"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060785"><span class="hs-identifier hs-var">sa</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679060787"><a href="#local-6989586621679060787"><span class="hs-identifier">fia</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060780"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060781"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060782"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679060787"><span class="hs-identifier hs-var">fia</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#mseq"><span class="hs-identifier hs-var">mseq</span></a><span class="hs-special">`</span><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679060787"><span class="hs-identifier hs-var">fia</span></a><span> </span><a href="#local-6989586621679060783"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060784"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2304"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060781"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060786"><span class="hs-identifier hs-var">sab</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679060788"><a href="#local-6989586621679060788"><span class="hs-identifier">fisab</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060780"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060781"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060785"><span class="hs-identifier hs-var">sa</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060783"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679060788"><span class="hs-identifier hs-var">fisab</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#mseq"><span class="hs-identifier hs-var">mseq</span></a><span class="hs-special">`</span><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679060782"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060788"><span class="hs-identifier hs-var">fisab</span></a><span> </span><a href="#local-6989586621679060784"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2305"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679060789"><a href="#local-6989586621679060789"><span class="hs-identifier">fisabc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060780"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060781"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060786"><span class="hs-identifier hs-var">sab</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060784"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679060789"><span class="hs-identifier hs-var">fisabc</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#mseq"><span class="hs-identifier hs-var">mseq</span></a><span class="hs-special">`</span><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679060782"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060783"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060789"><span class="hs-identifier hs-var">fisabc</span></a><span>
</span><a name="line-2306"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2307"></a><span>    </span><a name="local-6989586621679060785"><a href="#local-6989586621679060785"><span class="hs-identifier">sa</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060782"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2308"></a><span>    </span><a name="local-6989586621679060786"><a href="#local-6989586621679060786"><span class="hs-identifier">sab</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060785"><span class="hs-identifier hs-var">sa</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060783"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2309"></a><span class="hs-identifier">adjustDigit</span><span> </span><a name="local-6989586621679060790"><a href="#local-6989586621679060790"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060791"><a href="#local-6989586621679060791"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679060792"><a href="#local-6989586621679060792"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060793"><a href="#local-6989586621679060793"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060794"><a href="#local-6989586621679060794"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060795"><a href="#local-6989586621679060795"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2310"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060791"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060796"><span class="hs-identifier hs-var">sa</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679060799"><a href="#local-6989586621679060799"><span class="hs-identifier">fia</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060790"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060791"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060792"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679060799"><span class="hs-identifier hs-var">fia</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#mseq"><span class="hs-identifier hs-var">mseq</span></a><span class="hs-special">`</span><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a href="#local-6989586621679060799"><span class="hs-identifier hs-var">fia</span></a><span> </span><a href="#local-6989586621679060793"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060794"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679060795"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-2311"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060791"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060797"><span class="hs-identifier hs-var">sab</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679060800"><a href="#local-6989586621679060800"><span class="hs-identifier">fisab</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060790"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060791"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060796"><span class="hs-identifier hs-var">sa</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060793"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679060800"><span class="hs-identifier hs-var">fisab</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#mseq"><span class="hs-identifier hs-var">mseq</span></a><span class="hs-special">`</span><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a href="#local-6989586621679060792"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060800"><span class="hs-identifier hs-var">fisab</span></a><span> </span><a href="#local-6989586621679060794"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679060795"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-2312"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060791"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060798"><span class="hs-identifier hs-var">sabc</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679060801"><a href="#local-6989586621679060801"><span class="hs-identifier">fisabc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060790"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060791"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060797"><span class="hs-identifier hs-var">sab</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060794"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679060801"><span class="hs-identifier hs-var">fisabc</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#mseq"><span class="hs-identifier hs-var">mseq</span></a><span class="hs-special">`</span><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a href="#local-6989586621679060792"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060793"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060801"><span class="hs-identifier hs-var">fisabc</span></a><span> </span><a href="#local-6989586621679060795"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-2313"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679060802"><a href="#local-6989586621679060802"><span class="hs-identifier">fisabcd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060790"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060791"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060798"><span class="hs-identifier hs-var">sabc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060795"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679060802"><span class="hs-identifier hs-var">fisabcd</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#mseq"><span class="hs-identifier hs-var">mseq</span></a><span class="hs-special">`</span><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a href="#local-6989586621679060792"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060793"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060794"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679060802"><span class="hs-identifier hs-var">fisabcd</span></a><span>
</span><a name="line-2314"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2315"></a><span>    </span><a name="local-6989586621679060796"><a href="#local-6989586621679060796"><span class="hs-identifier">sa</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060792"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2316"></a><span>    </span><a name="local-6989586621679060797"><a href="#local-6989586621679060797"><span class="hs-identifier">sab</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060796"><span class="hs-identifier hs-var">sa</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060793"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2317"></a><span>    </span><a name="local-6989586621679060798"><a href="#local-6989586621679060798"><span class="hs-identifier">sabc</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060797"><span class="hs-identifier hs-var">sab</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060794"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2318"></a><span>
</span><a name="line-2319"></a><span class="hs-comment">-- | \( O(\log(\min(i,n-i))) \). @'insertAt' i x xs@ inserts @x@ into @xs@</span><span>
</span><a name="line-2320"></a><span class="hs-comment">-- at the index @i@, shifting the rest of the sequence over.</span><span>
</span><a name="line-2321"></a><span class="hs-comment">--</span><span>
</span><a name="line-2322"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-2323"></a><span class="hs-comment">-- insertAt 2 x (fromList [a,b,c,d]) = fromList [a,b,x,c,d]</span><span>
</span><a name="line-2324"></a><span class="hs-comment">-- insertAt 4 x (fromList [a,b,c,d]) = insertAt 10 x (fromList [a,b,c,d])</span><span>
</span><a name="line-2325"></a><span class="hs-comment">--                                   = fromList [a,b,c,d,x]</span><span>
</span><a name="line-2326"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-2327"></a><span class="hs-comment">--</span><span>
</span><a name="line-2328"></a><span class="hs-comment">-- prop&gt; insertAt i x xs = take i xs &gt;&lt; singleton x &gt;&lt; drop i xs</span><span>
</span><a name="line-2329"></a><span class="hs-comment">--</span><span>
</span><a name="line-2330"></a><span class="hs-comment">-- @since 0.5.8</span><span>
</span><a name="line-2331"></a><span class="hs-identifier">insertAt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058963"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679058963"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679058963"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2332"></a><a name="insertAt"><a href="Data.Sequence.Internal.html#insertAt"><span class="hs-identifier">insertAt</span></a></a><span> </span><a name="local-6989586621679060803"><a href="#local-6989586621679060803"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679060804"><a href="#local-6989586621679060804"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060805"><a href="#local-6989586621679060805"><span class="hs-identifier">s</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a name="local-6989586621679060806"><a href="#local-6989586621679060806"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2333"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a><span> </span><a href="#local-6989586621679060803"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060806"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Word"><span class="hs-identifier hs-type">Word</span></a><span class="hs-special">)</span><span>
</span><a name="line-2334"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#insTree"><span class="hs-identifier hs-var">insTree</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="Data.Sequence.Internal.html#InsTwo"><span class="hs-identifier hs-var">InsTwo</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-var">Elem</span></a><span> </span><a href="#local-6989586621679060804"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060803"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060806"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-2335"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060803"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060804"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="Data.Sequence.Internal.html#%3C%7C"><span class="hs-operator hs-var">&lt;|</span></a><span> </span><a href="#local-6989586621679060805"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-2336"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060805"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="Data.Sequence.Internal.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a><span> </span><a href="#local-6989586621679060804"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2337"></a><span>
</span><a name="line-2338"></a><span class="hs-keyword">data</span><span> </span><a name="Ins"><a href="Data.Sequence.Internal.html#Ins"><span class="hs-identifier">Ins</span></a></a><span> </span><a name="local-6989586621679058043"><a href="#local-6989586621679058043"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="InsOne"><a href="Data.Sequence.Internal.html#InsOne"><span class="hs-identifier">InsOne</span></a></a><span> </span><a href="#local-6989586621679058043"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="InsTwo"><a href="Data.Sequence.Internal.html#InsTwo"><span class="hs-identifier">InsTwo</span></a></a><span> </span><a href="#local-6989586621679058043"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679058043"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2339"></a><span>
</span><a name="line-2340"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">insTree</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Ins</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2341"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">insTree</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Ins</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2342"></a><span class="hs-identifier">insTree</span><span>      </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a><span> </span><a href="#local-6989586621679058960"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058960"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Ins"><span class="hs-identifier hs-type">Ins</span></a><span> </span><a href="#local-6989586621679058960"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-2343"></a><span>             </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><a href="#local-6989586621679058960"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><a href="#local-6989586621679058960"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2344"></a><a name="insTree"><a href="Data.Sequence.Internal.html#insTree"><span class="hs-identifier">insTree</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-comment">-- Unreachable</span><span>
</span><a name="line-2345"></a><span class="hs-identifier">insTree</span><span> </span><a name="local-6989586621679060807"><a href="#local-6989586621679060807"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060808"><a href="#local-6989586621679060808"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><a name="local-6989586621679060809"><a href="#local-6989586621679060809"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679060807"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060808"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060809"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2346"></a><span>  </span><a href="Data.Sequence.Internal.html#InsOne"><span class="hs-identifier hs-var">InsOne</span></a><span> </span><a name="local-6989586621679060810"><a href="#local-6989586621679060810"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><a href="#local-6989586621679060810"><span class="hs-identifier hs-var">x'</span></a><span>
</span><a name="line-2347"></a><span>  </span><a href="Data.Sequence.Internal.html#InsTwo"><span class="hs-identifier hs-var">InsTwo</span></a><span> </span><a name="local-6989586621679060811"><a href="#local-6989586621679060811"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679060812"><a href="#local-6989586621679060812"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#deep"><span class="hs-identifier hs-var">deep</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a href="#local-6989586621679060811"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a href="#local-6989586621679060812"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-2348"></a><span class="hs-identifier">insTree</span><span> </span><a name="local-6989586621679060813"><a href="#local-6989586621679060813"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060814"><a href="#local-6989586621679060814"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679060815"><a href="#local-6989586621679060815"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679060816"><a href="#local-6989586621679060816"><span class="hs-identifier">pr</span></a></a><span> </span><a name="local-6989586621679060817"><a href="#local-6989586621679060817"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679060818"><a href="#local-6989586621679060818"><span class="hs-identifier">sf</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2349"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060814"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060819"><span class="hs-identifier hs-var">spr</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Data.Sequence.Internal.html#insLeftDigit"><span class="hs-identifier hs-var">insLeftDigit</span></a><span> </span><a href="#local-6989586621679060813"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060814"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060816"><span class="hs-identifier hs-var">pr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2350"></a><span>     </span><a href="Data.Sequence.Internal.html#InsLeftDig"><span class="hs-identifier hs-var">InsLeftDig</span></a><span> </span><a name="local-6989586621679060821"><a href="#local-6989586621679060821"><span class="hs-identifier">pr'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060815"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060821"><span class="hs-identifier hs-var">pr'</span></a><span> </span><a href="#local-6989586621679060817"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679060818"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2351"></a><span>     </span><a href="Data.Sequence.Internal.html#InsDigNode"><span class="hs-identifier hs-var">InsDigNode</span></a><span> </span><a name="local-6989586621679060822"><a href="#local-6989586621679060822"><span class="hs-identifier">pr'</span></a></a><span> </span><a name="local-6989586621679060823"><a href="#local-6989586621679060823"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060817"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060815"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060822"><span class="hs-identifier hs-var">pr'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060823"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#consTree"><span class="hs-identifier hs-var">consTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060817"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060818"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2352"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060814"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060820"><span class="hs-identifier hs-var">spm</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060824"><a href="#local-6989586621679060824"><span class="hs-identifier">m'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#insTree"><span class="hs-identifier hs-var">insTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#insNode"><span class="hs-identifier hs-var">insNode</span></a><span> </span><a href="#local-6989586621679060813"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060814"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060819"><span class="hs-identifier hs-var">spr</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060817"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-2353"></a><span>                  </span><span class="hs-keyword">in</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060815"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060816"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679060824"><span class="hs-identifier hs-var">m'</span></a><span> </span><a href="#local-6989586621679060818"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2354"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Data.Sequence.Internal.html#insRightDigit"><span class="hs-identifier hs-var">insRightDigit</span></a><span> </span><a href="#local-6989586621679060813"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060814"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060820"><span class="hs-identifier hs-var">spm</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060818"><span class="hs-identifier hs-var">sf</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2355"></a><span>     </span><a href="Data.Sequence.Internal.html#InsRightDig"><span class="hs-identifier hs-var">InsRightDig</span></a><span> </span><a name="local-6989586621679060825"><a href="#local-6989586621679060825"><span class="hs-identifier">sf'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060815"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060816"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679060817"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679060825"><span class="hs-identifier hs-var">sf'</span></a><span>
</span><a name="line-2356"></a><span>     </span><a href="Data.Sequence.Internal.html#InsNodeDig"><span class="hs-identifier hs-var">InsNodeDig</span></a><span> </span><a name="local-6989586621679060826"><a href="#local-6989586621679060826"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679060827"><a href="#local-6989586621679060827"><span class="hs-identifier">sf'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060817"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060815"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060816"><span class="hs-identifier hs-var">pr</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060817"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">`</span><a href="Data.Sequence.Internal.html#snocTree"><span class="hs-identifier hs-var">snocTree</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679060826"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060827"><span class="hs-identifier hs-var">sf'</span></a><span>
</span><a name="line-2357"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2358"></a><span>    </span><a name="local-6989586621679060819"><a href="#local-6989586621679060819"><span class="hs-identifier">spr</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060816"><span class="hs-identifier hs-var">pr</span></a><span>
</span><a name="line-2359"></a><span>    </span><a name="local-6989586621679060820"><a href="#local-6989586621679060820"><span class="hs-identifier">spm</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060819"><span class="hs-identifier hs-var">spr</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060817"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-2360"></a><span>
</span><a name="line-2361"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">insNode</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Ins</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Ins</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2362"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">insNode</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Ins</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Ins</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2363"></a><span class="hs-identifier">insNode</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a><span> </span><a href="#local-6989586621679058957"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058957"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Ins"><span class="hs-identifier hs-type">Ins</span></a><span> </span><a href="#local-6989586621679058957"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679058957"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Ins"><span class="hs-identifier hs-type">Ins</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679058957"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-2364"></a><a name="insNode"><a href="Data.Sequence.Internal.html#insNode"><span class="hs-identifier">insNode</span></a></a><span> </span><a name="local-6989586621679060828"><a href="#local-6989586621679060828"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060829"><a href="#local-6989586621679060829"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a name="local-6989586621679060830"><a href="#local-6989586621679060830"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679060831"><a href="#local-6989586621679060831"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060832"><a href="#local-6989586621679060832"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2365"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060829"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060833"><span class="hs-identifier hs-var">sa</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679060828"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060829"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060831"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2366"></a><span>      </span><a href="Data.Sequence.Internal.html#InsOne"><span class="hs-identifier hs-var">InsOne</span></a><span> </span><a name="local-6989586621679060834"><a href="#local-6989586621679060834"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsOne"><span class="hs-identifier hs-var">InsOne</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060830"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060834"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679060832"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2367"></a><span>      </span><a href="Data.Sequence.Internal.html#InsTwo"><span class="hs-identifier hs-var">InsTwo</span></a><span> </span><a name="local-6989586621679060835"><a href="#local-6989586621679060835"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679060836"><a href="#local-6989586621679060836"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsOne"><span class="hs-identifier hs-var">InsOne</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060830"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060835"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679060836"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679060832"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2368"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679060828"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060829"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060833"><span class="hs-identifier hs-var">sa</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060832"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2369"></a><span>      </span><a href="Data.Sequence.Internal.html#InsOne"><span class="hs-identifier hs-var">InsOne</span></a><span> </span><a name="local-6989586621679060837"><a href="#local-6989586621679060837"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsOne"><span class="hs-identifier hs-var">InsOne</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060830"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060831"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060837"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2370"></a><span>      </span><a href="Data.Sequence.Internal.html#InsTwo"><span class="hs-identifier hs-var">InsTwo</span></a><span> </span><a name="local-6989586621679060838"><a href="#local-6989586621679060838"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679060839"><a href="#local-6989586621679060839"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsOne"><span class="hs-identifier hs-var">InsOne</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060830"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060831"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060838"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679060839"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2371"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679060833"><a href="#local-6989586621679060833"><span class="hs-identifier">sa</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060831"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2372"></a><span class="hs-identifier">insNode</span><span> </span><a name="local-6989586621679060840"><a href="#local-6989586621679060840"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060841"><a href="#local-6989586621679060841"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a name="local-6989586621679060842"><a href="#local-6989586621679060842"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679060843"><a href="#local-6989586621679060843"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060844"><a href="#local-6989586621679060844"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060845"><a href="#local-6989586621679060845"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2373"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060841"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060846"><span class="hs-identifier hs-var">sa</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679060840"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060841"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060843"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2374"></a><span>      </span><a href="Data.Sequence.Internal.html#InsOne"><span class="hs-identifier hs-var">InsOne</span></a><span> </span><a name="local-6989586621679060848"><a href="#local-6989586621679060848"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsOne"><span class="hs-identifier hs-var">InsOne</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060842"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060848"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679060844"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060845"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2375"></a><span>      </span><a href="Data.Sequence.Internal.html#InsTwo"><span class="hs-identifier hs-var">InsTwo</span></a><span> </span><a name="local-6989586621679060849"><a href="#local-6989586621679060849"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679060850"><a href="#local-6989586621679060850"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsTwo"><span class="hs-identifier hs-var">InsTwo</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060846"><span class="hs-identifier hs-var">sa</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060849"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679060850"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060842"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060846"><span class="hs-identifier hs-var">sa</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060844"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060845"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-2376"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060841"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060847"><span class="hs-identifier hs-var">sab</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679060840"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060841"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060846"><span class="hs-identifier hs-var">sa</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060844"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2377"></a><span>      </span><a href="Data.Sequence.Internal.html#InsOne"><span class="hs-identifier hs-var">InsOne</span></a><span> </span><a name="local-6989586621679060851"><a href="#local-6989586621679060851"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsOne"><span class="hs-identifier hs-var">InsOne</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060842"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060843"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060851"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679060845"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2378"></a><span>      </span><a href="Data.Sequence.Internal.html#InsTwo"><span class="hs-identifier hs-var">InsTwo</span></a><span> </span><a name="local-6989586621679060852"><a href="#local-6989586621679060852"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679060853"><a href="#local-6989586621679060853"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsTwo"><span class="hs-identifier hs-var">InsTwo</span></a><span> </span><a href="#local-6989586621679060854"><span class="hs-identifier hs-var">am</span></a><span> </span><a href="#local-6989586621679060855"><span class="hs-identifier hs-var">nc</span></a><span>
</span><a name="line-2379"></a><span>        </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060854"><a href="#local-6989586621679060854"><span class="hs-identifier">am</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060843"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060852"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-2380"></a><span>              </span><span class="hs-glyph">!</span><a name="local-6989586621679060855"><a href="#local-6989586621679060855"><span class="hs-identifier">nc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#node2"><span class="hs-identifier hs-var">node2</span></a><span> </span><a href="#local-6989586621679060853"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679060845"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2381"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679060840"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060841"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060847"><span class="hs-identifier hs-var">sab</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060845"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2382"></a><span>      </span><a href="Data.Sequence.Internal.html#InsOne"><span class="hs-identifier hs-var">InsOne</span></a><span> </span><a name="local-6989586621679060856"><a href="#local-6989586621679060856"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsOne"><span class="hs-identifier hs-var">InsOne</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060842"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060843"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060844"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060856"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2383"></a><span>      </span><a href="Data.Sequence.Internal.html#InsTwo"><span class="hs-identifier hs-var">InsTwo</span></a><span> </span><a name="local-6989586621679060857"><a href="#local-6989586621679060857"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679060858"><a href="#local-6989586621679060858"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsTwo"><span class="hs-identifier hs-var">InsTwo</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a href="#local-6989586621679060847"><span class="hs-identifier hs-var">sab</span></a><span> </span><a href="#local-6989586621679060843"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060844"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060842"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060847"><span class="hs-identifier hs-var">sab</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060857"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679060858"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-2384"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679060846"><a href="#local-6989586621679060846"><span class="hs-identifier">sa</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060843"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2385"></a><span>        </span><a name="local-6989586621679060847"><a href="#local-6989586621679060847"><span class="hs-identifier">sab</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060846"><span class="hs-identifier hs-var">sa</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060844"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2386"></a><span>
</span><a name="line-2387"></a><span class="hs-keyword">data</span><span> </span><a name="InsDigNode"><a href="Data.Sequence.Internal.html#InsDigNode"><span class="hs-identifier">InsDigNode</span></a></a><span> </span><a name="local-6989586621679058042"><a href="#local-6989586621679058042"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="InsLeftDig"><a href="Data.Sequence.Internal.html#InsLeftDig"><span class="hs-identifier">InsLeftDig</span></a></a><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><a href="#local-6989586621679058042"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="InsDigNode"><a href="Data.Sequence.Internal.html#InsDigNode"><span class="hs-identifier">InsDigNode</span></a></a><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><a href="#local-6989586621679058042"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679058042"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-2388"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">insLeftDigit</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Ins</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Digit</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">InsDigNode</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2389"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">insLeftDigit</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Ins</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Digit</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">InsDigNode</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2390"></a><span class="hs-identifier">insLeftDigit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a><span> </span><a href="#local-6989586621679058954"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058954"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Ins"><span class="hs-identifier hs-type">Ins</span></a><span> </span><a href="#local-6989586621679058954"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><a href="#local-6989586621679058954"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsDigNode"><span class="hs-identifier hs-type">InsDigNode</span></a><span> </span><a href="#local-6989586621679058954"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2391"></a><a name="insLeftDigit"><a href="Data.Sequence.Internal.html#insLeftDigit"><span class="hs-identifier">insLeftDigit</span></a></a><span> </span><a name="local-6989586621679060859"><a href="#local-6989586621679060859"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060860"><a href="#local-6989586621679060860"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679060861"><a href="#local-6989586621679060861"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679060859"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060860"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060861"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2392"></a><span>  </span><a href="Data.Sequence.Internal.html#InsOne"><span class="hs-identifier hs-var">InsOne</span></a><span> </span><a name="local-6989586621679060862"><a href="#local-6989586621679060862"><span class="hs-identifier">a'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsLeftDig"><span class="hs-identifier hs-var">InsLeftDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a href="#local-6989586621679060862"><span class="hs-identifier hs-var">a'</span></a><span>
</span><a name="line-2393"></a><span>  </span><a href="Data.Sequence.Internal.html#InsTwo"><span class="hs-identifier hs-var">InsTwo</span></a><span> </span><a name="local-6989586621679060863"><a href="#local-6989586621679060863"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679060864"><a href="#local-6989586621679060864"><span class="hs-identifier">a2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsLeftDig"><span class="hs-identifier hs-var">InsLeftDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679060863"><span class="hs-identifier hs-var">a1</span></a><span> </span><a href="#local-6989586621679060864"><span class="hs-identifier hs-var">a2</span></a><span>
</span><a name="line-2394"></a><span class="hs-identifier">insLeftDigit</span><span> </span><a name="local-6989586621679060865"><a href="#local-6989586621679060865"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060866"><a href="#local-6989586621679060866"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679060867"><a href="#local-6989586621679060867"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060868"><a href="#local-6989586621679060868"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2395"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060866"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060869"><span class="hs-identifier hs-var">sa</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679060865"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060866"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060867"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2396"></a><span>     </span><a href="Data.Sequence.Internal.html#InsOne"><span class="hs-identifier hs-var">InsOne</span></a><span> </span><a name="local-6989586621679060870"><a href="#local-6989586621679060870"><span class="hs-identifier">a'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsLeftDig"><span class="hs-identifier hs-var">InsLeftDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679060870"><span class="hs-identifier hs-var">a'</span></a><span> </span><a href="#local-6989586621679060868"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2397"></a><span>     </span><a href="Data.Sequence.Internal.html#InsTwo"><span class="hs-identifier hs-var">InsTwo</span></a><span> </span><a name="local-6989586621679060871"><a href="#local-6989586621679060871"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679060872"><a href="#local-6989586621679060872"><span class="hs-identifier">a2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsLeftDig"><span class="hs-identifier hs-var">InsLeftDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679060871"><span class="hs-identifier hs-var">a1</span></a><span> </span><a href="#local-6989586621679060872"><span class="hs-identifier hs-var">a2</span></a><span> </span><a href="#local-6989586621679060868"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2398"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679060865"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060866"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060869"><span class="hs-identifier hs-var">sa</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060868"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2399"></a><span>     </span><a href="Data.Sequence.Internal.html#InsOne"><span class="hs-identifier hs-var">InsOne</span></a><span> </span><a name="local-6989586621679060873"><a href="#local-6989586621679060873"><span class="hs-identifier">b'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsLeftDig"><span class="hs-identifier hs-var">InsLeftDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679060867"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060873"><span class="hs-identifier hs-var">b'</span></a><span>
</span><a name="line-2400"></a><span>     </span><a href="Data.Sequence.Internal.html#InsTwo"><span class="hs-identifier hs-var">InsTwo</span></a><span> </span><a name="local-6989586621679060874"><a href="#local-6989586621679060874"><span class="hs-identifier">b1</span></a></a><span> </span><a name="local-6989586621679060875"><a href="#local-6989586621679060875"><span class="hs-identifier">b2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsLeftDig"><span class="hs-identifier hs-var">InsLeftDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679060867"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060874"><span class="hs-identifier hs-var">b1</span></a><span> </span><a href="#local-6989586621679060875"><span class="hs-identifier hs-var">b2</span></a><span>
</span><a name="line-2401"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679060869"><a href="#local-6989586621679060869"><span class="hs-identifier">sa</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060867"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2402"></a><span class="hs-identifier">insLeftDigit</span><span> </span><a name="local-6989586621679060876"><a href="#local-6989586621679060876"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060877"><a href="#local-6989586621679060877"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679060878"><a href="#local-6989586621679060878"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060879"><a href="#local-6989586621679060879"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060880"><a href="#local-6989586621679060880"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2403"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060877"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060881"><span class="hs-identifier hs-var">sa</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679060876"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060877"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060878"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2404"></a><span>     </span><a href="Data.Sequence.Internal.html#InsOne"><span class="hs-identifier hs-var">InsOne</span></a><span> </span><a name="local-6989586621679060883"><a href="#local-6989586621679060883"><span class="hs-identifier">a'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsLeftDig"><span class="hs-identifier hs-var">InsLeftDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679060883"><span class="hs-identifier hs-var">a'</span></a><span> </span><a href="#local-6989586621679060879"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060880"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2405"></a><span>     </span><a href="Data.Sequence.Internal.html#InsTwo"><span class="hs-identifier hs-var">InsTwo</span></a><span> </span><a name="local-6989586621679060884"><a href="#local-6989586621679060884"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679060885"><a href="#local-6989586621679060885"><span class="hs-identifier">a2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsLeftDig"><span class="hs-identifier hs-var">InsLeftDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a href="#local-6989586621679060884"><span class="hs-identifier hs-var">a1</span></a><span> </span><a href="#local-6989586621679060885"><span class="hs-identifier hs-var">a2</span></a><span> </span><a href="#local-6989586621679060879"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060880"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2406"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060877"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060882"><span class="hs-identifier hs-var">sab</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679060876"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060877"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060881"><span class="hs-identifier hs-var">sa</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060879"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2407"></a><span>     </span><a href="Data.Sequence.Internal.html#InsOne"><span class="hs-identifier hs-var">InsOne</span></a><span> </span><a name="local-6989586621679060886"><a href="#local-6989586621679060886"><span class="hs-identifier">b'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsLeftDig"><span class="hs-identifier hs-var">InsLeftDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679060878"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060886"><span class="hs-identifier hs-var">b'</span></a><span> </span><a href="#local-6989586621679060880"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2408"></a><span>     </span><a href="Data.Sequence.Internal.html#InsTwo"><span class="hs-identifier hs-var">InsTwo</span></a><span> </span><a name="local-6989586621679060887"><a href="#local-6989586621679060887"><span class="hs-identifier">b1</span></a></a><span> </span><a name="local-6989586621679060888"><a href="#local-6989586621679060888"><span class="hs-identifier">b2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsLeftDig"><span class="hs-identifier hs-var">InsLeftDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a href="#local-6989586621679060878"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060887"><span class="hs-identifier hs-var">b1</span></a><span> </span><a href="#local-6989586621679060888"><span class="hs-identifier hs-var">b2</span></a><span> </span><a href="#local-6989586621679060880"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2409"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679060876"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060877"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060882"><span class="hs-identifier hs-var">sab</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060880"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2410"></a><span>     </span><a href="Data.Sequence.Internal.html#InsOne"><span class="hs-identifier hs-var">InsOne</span></a><span> </span><a name="local-6989586621679060889"><a href="#local-6989586621679060889"><span class="hs-identifier">c'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsLeftDig"><span class="hs-identifier hs-var">InsLeftDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679060878"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060879"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060889"><span class="hs-identifier hs-var">c'</span></a><span>
</span><a name="line-2411"></a><span>     </span><a href="Data.Sequence.Internal.html#InsTwo"><span class="hs-identifier hs-var">InsTwo</span></a><span> </span><a name="local-6989586621679060890"><a href="#local-6989586621679060890"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-6989586621679060891"><a href="#local-6989586621679060891"><span class="hs-identifier">c2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsLeftDig"><span class="hs-identifier hs-var">InsLeftDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a href="#local-6989586621679060878"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060879"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060890"><span class="hs-identifier hs-var">c1</span></a><span> </span><a href="#local-6989586621679060891"><span class="hs-identifier hs-var">c2</span></a><span>
</span><a name="line-2412"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679060881"><a href="#local-6989586621679060881"><span class="hs-identifier">sa</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060878"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2413"></a><span>        </span><a name="local-6989586621679060882"><a href="#local-6989586621679060882"><span class="hs-identifier">sab</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060881"><span class="hs-identifier hs-var">sa</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060879"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2414"></a><span class="hs-identifier">insLeftDigit</span><span> </span><a name="local-6989586621679060892"><a href="#local-6989586621679060892"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060893"><a href="#local-6989586621679060893"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679060894"><a href="#local-6989586621679060894"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060895"><a href="#local-6989586621679060895"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060896"><a href="#local-6989586621679060896"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060897"><a href="#local-6989586621679060897"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2415"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060893"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060898"><span class="hs-identifier hs-var">sa</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679060892"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060893"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060894"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2416"></a><span>     </span><a href="Data.Sequence.Internal.html#InsOne"><span class="hs-identifier hs-var">InsOne</span></a><span> </span><a name="local-6989586621679060901"><a href="#local-6989586621679060901"><span class="hs-identifier">a'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsLeftDig"><span class="hs-identifier hs-var">InsLeftDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a href="#local-6989586621679060901"><span class="hs-identifier hs-var">a'</span></a><span> </span><a href="#local-6989586621679060895"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060896"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679060897"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-2417"></a><span>     </span><a href="Data.Sequence.Internal.html#InsTwo"><span class="hs-identifier hs-var">InsTwo</span></a><span> </span><a name="local-6989586621679060902"><a href="#local-6989586621679060902"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679060903"><a href="#local-6989586621679060903"><span class="hs-identifier">a2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsDigNode"><span class="hs-identifier hs-var">InsDigNode</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679060902"><span class="hs-identifier hs-var">a1</span></a><span> </span><a href="#local-6989586621679060903"><span class="hs-identifier hs-var">a2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060895"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060896"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679060897"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-2418"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060893"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060899"><span class="hs-identifier hs-var">sab</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679060892"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060893"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060898"><span class="hs-identifier hs-var">sa</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060895"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2419"></a><span>     </span><a href="Data.Sequence.Internal.html#InsOne"><span class="hs-identifier hs-var">InsOne</span></a><span> </span><a name="local-6989586621679060904"><a href="#local-6989586621679060904"><span class="hs-identifier">b'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsLeftDig"><span class="hs-identifier hs-var">InsLeftDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a href="#local-6989586621679060894"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060904"><span class="hs-identifier hs-var">b'</span></a><span> </span><a href="#local-6989586621679060896"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679060897"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-2420"></a><span>     </span><a href="Data.Sequence.Internal.html#InsTwo"><span class="hs-identifier hs-var">InsTwo</span></a><span> </span><a name="local-6989586621679060905"><a href="#local-6989586621679060905"><span class="hs-identifier">b1</span></a></a><span> </span><a name="local-6989586621679060906"><a href="#local-6989586621679060906"><span class="hs-identifier">b2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsDigNode"><span class="hs-identifier hs-var">InsDigNode</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679060894"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060905"><span class="hs-identifier hs-var">b1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060906"><span class="hs-identifier hs-var">b2</span></a><span> </span><a href="#local-6989586621679060896"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679060897"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-2421"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060893"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060900"><span class="hs-identifier hs-var">sabc</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679060892"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060893"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060899"><span class="hs-identifier hs-var">sab</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060896"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2422"></a><span>     </span><a href="Data.Sequence.Internal.html#InsOne"><span class="hs-identifier hs-var">InsOne</span></a><span> </span><a name="local-6989586621679060907"><a href="#local-6989586621679060907"><span class="hs-identifier">c'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsLeftDig"><span class="hs-identifier hs-var">InsLeftDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a href="#local-6989586621679060894"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060895"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060907"><span class="hs-identifier hs-var">c'</span></a><span> </span><a href="#local-6989586621679060897"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-2423"></a><span>     </span><a href="Data.Sequence.Internal.html#InsTwo"><span class="hs-identifier hs-var">InsTwo</span></a><span> </span><a name="local-6989586621679060908"><a href="#local-6989586621679060908"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-6989586621679060909"><a href="#local-6989586621679060909"><span class="hs-identifier">c2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsDigNode"><span class="hs-identifier hs-var">InsDigNode</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679060894"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060895"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060908"><span class="hs-identifier hs-var">c1</span></a><span> </span><a href="#local-6989586621679060909"><span class="hs-identifier hs-var">c2</span></a><span> </span><a href="#local-6989586621679060897"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-2424"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679060892"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060893"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060900"><span class="hs-identifier hs-var">sabc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060897"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2425"></a><span>     </span><a href="Data.Sequence.Internal.html#InsOne"><span class="hs-identifier hs-var">InsOne</span></a><span> </span><a name="local-6989586621679060910"><a href="#local-6989586621679060910"><span class="hs-identifier">d'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsLeftDig"><span class="hs-identifier hs-var">InsLeftDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a href="#local-6989586621679060894"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060895"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060896"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679060910"><span class="hs-identifier hs-var">d'</span></a><span>
</span><a name="line-2426"></a><span>     </span><a href="Data.Sequence.Internal.html#InsTwo"><span class="hs-identifier hs-var">InsTwo</span></a><span> </span><a name="local-6989586621679060911"><a href="#local-6989586621679060911"><span class="hs-identifier">d1</span></a></a><span> </span><a name="local-6989586621679060912"><a href="#local-6989586621679060912"><span class="hs-identifier">d2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsDigNode"><span class="hs-identifier hs-var">InsDigNode</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679060894"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060895"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060896"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679060911"><span class="hs-identifier hs-var">d1</span></a><span> </span><a href="#local-6989586621679060912"><span class="hs-identifier hs-var">d2</span></a><span class="hs-special">)</span><span>
</span><a name="line-2427"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679060898"><a href="#local-6989586621679060898"><span class="hs-identifier">sa</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060894"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2428"></a><span>        </span><a name="local-6989586621679060899"><a href="#local-6989586621679060899"><span class="hs-identifier">sab</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060898"><span class="hs-identifier hs-var">sa</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060895"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2429"></a><span>        </span><a name="local-6989586621679060900"><a href="#local-6989586621679060900"><span class="hs-identifier">sabc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060899"><span class="hs-identifier hs-var">sab</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060896"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2430"></a><span>
</span><a name="line-2431"></a><span class="hs-keyword">data</span><span> </span><a name="InsNodeDig"><a href="Data.Sequence.Internal.html#InsNodeDig"><span class="hs-identifier">InsNodeDig</span></a></a><span> </span><a name="local-6989586621679058041"><a href="#local-6989586621679058041"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="InsRightDig"><a href="Data.Sequence.Internal.html#InsRightDig"><span class="hs-identifier">InsRightDig</span></a></a><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><a href="#local-6989586621679058041"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="InsNodeDig"><a href="Data.Sequence.Internal.html#InsNodeDig"><span class="hs-identifier">InsNodeDig</span></a></a><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679058041"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><a href="#local-6989586621679058041"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-2432"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">insRightDigit</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Ins</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Digit</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">InsNodeDig</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2433"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">insRightDigit</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Ins</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Digit</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">InsNodeDig</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2434"></a><span class="hs-identifier">insRightDigit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a><span> </span><a href="#local-6989586621679058951"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058951"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Ins"><span class="hs-identifier hs-type">Ins</span></a><span> </span><a href="#local-6989586621679058951"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><a href="#local-6989586621679058951"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsNodeDig"><span class="hs-identifier hs-type">InsNodeDig</span></a><span> </span><a href="#local-6989586621679058951"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2435"></a><a name="insRightDigit"><a href="Data.Sequence.Internal.html#insRightDigit"><span class="hs-identifier">insRightDigit</span></a></a><span> </span><a name="local-6989586621679060913"><a href="#local-6989586621679060913"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060914"><a href="#local-6989586621679060914"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679060915"><a href="#local-6989586621679060915"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679060913"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060914"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060915"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2436"></a><span>  </span><a href="Data.Sequence.Internal.html#InsOne"><span class="hs-identifier hs-var">InsOne</span></a><span> </span><a name="local-6989586621679060916"><a href="#local-6989586621679060916"><span class="hs-identifier">a'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsRightDig"><span class="hs-identifier hs-var">InsRightDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a href="#local-6989586621679060916"><span class="hs-identifier hs-var">a'</span></a><span>
</span><a name="line-2437"></a><span>  </span><a href="Data.Sequence.Internal.html#InsTwo"><span class="hs-identifier hs-var">InsTwo</span></a><span> </span><a name="local-6989586621679060917"><a href="#local-6989586621679060917"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679060918"><a href="#local-6989586621679060918"><span class="hs-identifier">a2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsRightDig"><span class="hs-identifier hs-var">InsRightDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679060917"><span class="hs-identifier hs-var">a1</span></a><span> </span><a href="#local-6989586621679060918"><span class="hs-identifier hs-var">a2</span></a><span>
</span><a name="line-2438"></a><span class="hs-identifier">insRightDigit</span><span> </span><a name="local-6989586621679060919"><a href="#local-6989586621679060919"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060920"><a href="#local-6989586621679060920"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679060921"><a href="#local-6989586621679060921"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060922"><a href="#local-6989586621679060922"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2439"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060920"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060923"><span class="hs-identifier hs-var">sa</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679060919"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060920"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060921"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2440"></a><span>     </span><a href="Data.Sequence.Internal.html#InsOne"><span class="hs-identifier hs-var">InsOne</span></a><span> </span><a name="local-6989586621679060924"><a href="#local-6989586621679060924"><span class="hs-identifier">a'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsRightDig"><span class="hs-identifier hs-var">InsRightDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679060924"><span class="hs-identifier hs-var">a'</span></a><span> </span><a href="#local-6989586621679060922"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2441"></a><span>     </span><a href="Data.Sequence.Internal.html#InsTwo"><span class="hs-identifier hs-var">InsTwo</span></a><span> </span><a name="local-6989586621679060925"><a href="#local-6989586621679060925"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679060926"><a href="#local-6989586621679060926"><span class="hs-identifier">a2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsRightDig"><span class="hs-identifier hs-var">InsRightDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679060925"><span class="hs-identifier hs-var">a1</span></a><span> </span><a href="#local-6989586621679060926"><span class="hs-identifier hs-var">a2</span></a><span> </span><a href="#local-6989586621679060922"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2442"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679060919"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060920"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060923"><span class="hs-identifier hs-var">sa</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060922"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2443"></a><span>     </span><a href="Data.Sequence.Internal.html#InsOne"><span class="hs-identifier hs-var">InsOne</span></a><span> </span><a name="local-6989586621679060927"><a href="#local-6989586621679060927"><span class="hs-identifier">b'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsRightDig"><span class="hs-identifier hs-var">InsRightDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679060921"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060927"><span class="hs-identifier hs-var">b'</span></a><span>
</span><a name="line-2444"></a><span>     </span><a href="Data.Sequence.Internal.html#InsTwo"><span class="hs-identifier hs-var">InsTwo</span></a><span> </span><a name="local-6989586621679060928"><a href="#local-6989586621679060928"><span class="hs-identifier">b1</span></a></a><span> </span><a name="local-6989586621679060929"><a href="#local-6989586621679060929"><span class="hs-identifier">b2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsRightDig"><span class="hs-identifier hs-var">InsRightDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679060921"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060928"><span class="hs-identifier hs-var">b1</span></a><span> </span><a href="#local-6989586621679060929"><span class="hs-identifier hs-var">b2</span></a><span>
</span><a name="line-2445"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679060923"><a href="#local-6989586621679060923"><span class="hs-identifier">sa</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060921"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2446"></a><span class="hs-identifier">insRightDigit</span><span> </span><a name="local-6989586621679060930"><a href="#local-6989586621679060930"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060931"><a href="#local-6989586621679060931"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679060932"><a href="#local-6989586621679060932"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060933"><a href="#local-6989586621679060933"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060934"><a href="#local-6989586621679060934"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2447"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060931"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060935"><span class="hs-identifier hs-var">sa</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679060930"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060931"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060932"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2448"></a><span>     </span><a href="Data.Sequence.Internal.html#InsOne"><span class="hs-identifier hs-var">InsOne</span></a><span> </span><a name="local-6989586621679060937"><a href="#local-6989586621679060937"><span class="hs-identifier">a'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsRightDig"><span class="hs-identifier hs-var">InsRightDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679060937"><span class="hs-identifier hs-var">a'</span></a><span> </span><a href="#local-6989586621679060933"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060934"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2449"></a><span>     </span><a href="Data.Sequence.Internal.html#InsTwo"><span class="hs-identifier hs-var">InsTwo</span></a><span> </span><a name="local-6989586621679060938"><a href="#local-6989586621679060938"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679060939"><a href="#local-6989586621679060939"><span class="hs-identifier">a2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsRightDig"><span class="hs-identifier hs-var">InsRightDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a href="#local-6989586621679060938"><span class="hs-identifier hs-var">a1</span></a><span> </span><a href="#local-6989586621679060939"><span class="hs-identifier hs-var">a2</span></a><span> </span><a href="#local-6989586621679060933"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060934"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2450"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060931"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060936"><span class="hs-identifier hs-var">sab</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679060930"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060931"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060935"><span class="hs-identifier hs-var">sa</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060933"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2451"></a><span>     </span><a href="Data.Sequence.Internal.html#InsOne"><span class="hs-identifier hs-var">InsOne</span></a><span> </span><a name="local-6989586621679060940"><a href="#local-6989586621679060940"><span class="hs-identifier">b'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsRightDig"><span class="hs-identifier hs-var">InsRightDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679060932"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060940"><span class="hs-identifier hs-var">b'</span></a><span> </span><a href="#local-6989586621679060934"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2452"></a><span>     </span><a href="Data.Sequence.Internal.html#InsTwo"><span class="hs-identifier hs-var">InsTwo</span></a><span> </span><a name="local-6989586621679060941"><a href="#local-6989586621679060941"><span class="hs-identifier">b1</span></a></a><span> </span><a name="local-6989586621679060942"><a href="#local-6989586621679060942"><span class="hs-identifier">b2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsRightDig"><span class="hs-identifier hs-var">InsRightDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a href="#local-6989586621679060932"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060941"><span class="hs-identifier hs-var">b1</span></a><span> </span><a href="#local-6989586621679060942"><span class="hs-identifier hs-var">b2</span></a><span> </span><a href="#local-6989586621679060934"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2453"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679060930"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060931"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060936"><span class="hs-identifier hs-var">sab</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060934"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2454"></a><span>     </span><a href="Data.Sequence.Internal.html#InsOne"><span class="hs-identifier hs-var">InsOne</span></a><span> </span><a name="local-6989586621679060943"><a href="#local-6989586621679060943"><span class="hs-identifier">c'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsRightDig"><span class="hs-identifier hs-var">InsRightDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679060932"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060933"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060943"><span class="hs-identifier hs-var">c'</span></a><span>
</span><a name="line-2455"></a><span>     </span><a href="Data.Sequence.Internal.html#InsTwo"><span class="hs-identifier hs-var">InsTwo</span></a><span> </span><a name="local-6989586621679060944"><a href="#local-6989586621679060944"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-6989586621679060945"><a href="#local-6989586621679060945"><span class="hs-identifier">c2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsRightDig"><span class="hs-identifier hs-var">InsRightDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a href="#local-6989586621679060932"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060933"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060944"><span class="hs-identifier hs-var">c1</span></a><span> </span><a href="#local-6989586621679060945"><span class="hs-identifier hs-var">c2</span></a><span>
</span><a name="line-2456"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679060935"><a href="#local-6989586621679060935"><span class="hs-identifier">sa</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060932"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2457"></a><span>        </span><a name="local-6989586621679060936"><a href="#local-6989586621679060936"><span class="hs-identifier">sab</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060935"><span class="hs-identifier hs-var">sa</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060933"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2458"></a><span class="hs-identifier">insRightDigit</span><span> </span><a name="local-6989586621679060946"><a href="#local-6989586621679060946"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679060947"><a href="#local-6989586621679060947"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679060948"><a href="#local-6989586621679060948"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060949"><a href="#local-6989586621679060949"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060950"><a href="#local-6989586621679060950"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679060951"><a href="#local-6989586621679060951"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2459"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060947"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060952"><span class="hs-identifier hs-var">sa</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679060946"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060947"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060948"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2460"></a><span>     </span><a href="Data.Sequence.Internal.html#InsOne"><span class="hs-identifier hs-var">InsOne</span></a><span> </span><a name="local-6989586621679060955"><a href="#local-6989586621679060955"><span class="hs-identifier">a'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsRightDig"><span class="hs-identifier hs-var">InsRightDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a href="#local-6989586621679060955"><span class="hs-identifier hs-var">a'</span></a><span> </span><a href="#local-6989586621679060949"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060950"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679060951"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-2461"></a><span>     </span><a href="Data.Sequence.Internal.html#InsTwo"><span class="hs-identifier hs-var">InsTwo</span></a><span> </span><a name="local-6989586621679060956"><a href="#local-6989586621679060956"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679060957"><a href="#local-6989586621679060957"><span class="hs-identifier">a2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsNodeDig"><span class="hs-identifier hs-var">InsNodeDig</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060956"><span class="hs-identifier hs-var">a1</span></a><span> </span><a href="#local-6989586621679060957"><span class="hs-identifier hs-var">a2</span></a><span> </span><a href="#local-6989586621679060949"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679060950"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679060951"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-2462"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060947"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060953"><span class="hs-identifier hs-var">sab</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679060946"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060947"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060952"><span class="hs-identifier hs-var">sa</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060949"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2463"></a><span>     </span><a href="Data.Sequence.Internal.html#InsOne"><span class="hs-identifier hs-var">InsOne</span></a><span> </span><a name="local-6989586621679060958"><a href="#local-6989586621679060958"><span class="hs-identifier">b'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsRightDig"><span class="hs-identifier hs-var">InsRightDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a href="#local-6989586621679060948"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060958"><span class="hs-identifier hs-var">b'</span></a><span> </span><a href="#local-6989586621679060950"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679060951"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-2464"></a><span>     </span><a href="Data.Sequence.Internal.html#InsTwo"><span class="hs-identifier hs-var">InsTwo</span></a><span> </span><a name="local-6989586621679060959"><a href="#local-6989586621679060959"><span class="hs-identifier">b1</span></a></a><span> </span><a name="local-6989586621679060960"><a href="#local-6989586621679060960"><span class="hs-identifier">b2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsNodeDig"><span class="hs-identifier hs-var">InsNodeDig</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060948"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060959"><span class="hs-identifier hs-var">b1</span></a><span> </span><a href="#local-6989586621679060960"><span class="hs-identifier hs-var">b2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679060950"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679060951"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-2465"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060947"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060954"><span class="hs-identifier hs-var">sabc</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679060946"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060947"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060953"><span class="hs-identifier hs-var">sab</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060950"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2466"></a><span>     </span><a href="Data.Sequence.Internal.html#InsOne"><span class="hs-identifier hs-var">InsOne</span></a><span> </span><a name="local-6989586621679060961"><a href="#local-6989586621679060961"><span class="hs-identifier">c'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsRightDig"><span class="hs-identifier hs-var">InsRightDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a href="#local-6989586621679060948"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060949"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060961"><span class="hs-identifier hs-var">c'</span></a><span> </span><a href="#local-6989586621679060951"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-2467"></a><span>     </span><a href="Data.Sequence.Internal.html#InsTwo"><span class="hs-identifier hs-var">InsTwo</span></a><span> </span><a name="local-6989586621679060962"><a href="#local-6989586621679060962"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-6989586621679060963"><a href="#local-6989586621679060963"><span class="hs-identifier">c2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsNodeDig"><span class="hs-identifier hs-var">InsNodeDig</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060948"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060949"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060962"><span class="hs-identifier hs-var">c1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679060963"><span class="hs-identifier hs-var">c2</span></a><span> </span><a href="#local-6989586621679060951"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-2468"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679060946"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060947"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060954"><span class="hs-identifier hs-var">sabc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060951"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2469"></a><span>     </span><a href="Data.Sequence.Internal.html#InsOne"><span class="hs-identifier hs-var">InsOne</span></a><span> </span><a name="local-6989586621679060964"><a href="#local-6989586621679060964"><span class="hs-identifier">d'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsRightDig"><span class="hs-identifier hs-var">InsRightDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a href="#local-6989586621679060948"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060949"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060950"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679060964"><span class="hs-identifier hs-var">d'</span></a><span>
</span><a name="line-2470"></a><span>     </span><a href="Data.Sequence.Internal.html#InsTwo"><span class="hs-identifier hs-var">InsTwo</span></a><span> </span><a name="local-6989586621679060965"><a href="#local-6989586621679060965"><span class="hs-identifier">d1</span></a></a><span> </span><a name="local-6989586621679060966"><a href="#local-6989586621679060966"><span class="hs-identifier">d2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#InsNodeDig"><span class="hs-identifier hs-var">InsNodeDig</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679060948"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060949"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060950"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679060965"><span class="hs-identifier hs-var">d1</span></a><span> </span><a href="#local-6989586621679060966"><span class="hs-identifier hs-var">d2</span></a><span class="hs-special">)</span><span>
</span><a name="line-2471"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679060952"><a href="#local-6989586621679060952"><span class="hs-identifier">sa</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060948"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2472"></a><span>        </span><a name="local-6989586621679060953"><a href="#local-6989586621679060953"><span class="hs-identifier">sab</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060952"><span class="hs-identifier hs-var">sa</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060949"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2473"></a><span>        </span><a name="local-6989586621679060954"><a href="#local-6989586621679060954"><span class="hs-identifier">sabc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060953"><span class="hs-identifier hs-var">sab</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060950"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2474"></a><span>
</span><a name="line-2475"></a><span class="hs-comment">-- | \( O(\log(\min(i,n-i))) \). Delete the element of a sequence at a given</span><span>
</span><a name="line-2476"></a><span class="hs-comment">-- index. Return the original sequence if the index is out of range.</span><span>
</span><a name="line-2477"></a><span class="hs-comment">--</span><span>
</span><a name="line-2478"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-2479"></a><span class="hs-comment">-- deleteAt 2 [a,b,c,d] = [a,b,d]</span><span>
</span><a name="line-2480"></a><span class="hs-comment">-- deleteAt 4 [a,b,c,d] = deleteAt (-1) [a,b,c,d] = [a,b,c,d]</span><span>
</span><a name="line-2481"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-2482"></a><span class="hs-comment">--</span><span>
</span><a name="line-2483"></a><span class="hs-comment">-- @since 0.5.8</span><span>
</span><a name="line-2484"></a><span class="hs-identifier">deleteAt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679058950"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679058950"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2485"></a><a name="deleteAt"><a href="Data.Sequence.Internal.html#deleteAt"><span class="hs-identifier">deleteAt</span></a></a><span> </span><a name="local-6989586621679060967"><a href="#local-6989586621679060967"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a name="local-6989586621679060968"><a href="#local-6989586621679060968"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2486"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a><span> </span><a href="#local-6989586621679060967"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060968"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Word"><span class="hs-identifier hs-type">Word</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#delTreeE"><span class="hs-identifier hs-var">delTreeE</span></a><span> </span><a href="#local-6989586621679060967"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060968"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-2487"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a href="#local-6989586621679060968"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-2488"></a><span>
</span><a name="line-2489"></a><span class="hs-identifier">delTreeE</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679058949"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679058949"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-2490"></a><a name="delTreeE"><a href="Data.Sequence.Internal.html#delTreeE"><span class="hs-identifier">delTreeE</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060969"><a href="#local-6989586621679060969"><span class="hs-identifier">_i</span></a></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-comment">-- Unreachable</span><span>
</span><a name="line-2491"></a><span class="hs-identifier">delTreeE</span><span> </span><a name="local-6989586621679060970"><a href="#local-6989586621679060970"><span class="hs-identifier">_i</span></a></a><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span>
</span><a name="line-2492"></a><span class="hs-identifier">delTreeE</span><span> </span><a name="local-6989586621679060971"><a href="#local-6989586621679060971"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679060972"><a href="#local-6989586621679060972"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679060973"><a href="#local-6989586621679060973"><span class="hs-identifier">pr</span></a></a><span> </span><a name="local-6989586621679060974"><a href="#local-6989586621679060974"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679060975"><a href="#local-6989586621679060975"><span class="hs-identifier">sf</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2493"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060971"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060976"><span class="hs-identifier hs-var">spr</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#delLeftDigitE"><span class="hs-identifier hs-var">delLeftDigitE</span></a><span> </span><a href="#local-6989586621679060971"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679060972"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679060973"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679060974"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679060975"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2494"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060971"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679060977"><span class="hs-identifier hs-var">spm</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Data.Sequence.Internal.html#delTree"><span class="hs-identifier hs-var">delTree</span></a><span> </span><a href="Data.Sequence.Internal.html#delNodeE"><span class="hs-identifier hs-var">delNodeE</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060971"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060976"><span class="hs-identifier hs-var">spr</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060974"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2495"></a><span>     </span><a href="Data.Sequence.Internal.html#FullTree"><span class="hs-identifier hs-var">FullTree</span></a><span> </span><a name="local-6989586621679060978"><a href="#local-6989586621679060978"><span class="hs-identifier">m'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060972"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060973"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679060978"><span class="hs-identifier hs-var">m'</span></a><span> </span><a href="#local-6989586621679060975"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2496"></a><span>     </span><a href="Data.Sequence.Internal.html#DefectTree"><span class="hs-identifier hs-var">DefectTree</span></a><span> </span><a name="local-6989586621679060979"><a href="#local-6989586621679060979"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#delRebuildMiddle"><span class="hs-identifier hs-var">delRebuildMiddle</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060972"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060973"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679060979"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679060975"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2497"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#delRightDigitE"><span class="hs-identifier hs-var">delRightDigitE</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060971"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679060977"><span class="hs-identifier hs-var">spm</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060972"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679060973"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679060974"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679060975"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2498"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679060976"><a href="#local-6989586621679060976"><span class="hs-identifier">spr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060973"><span class="hs-identifier hs-var">pr</span></a><span>
</span><a name="line-2499"></a><span>        </span><a name="local-6989586621679060977"><a href="#local-6989586621679060977"><span class="hs-identifier">spm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060976"><span class="hs-identifier hs-var">spr</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679060974"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-2500"></a><span>
</span><a name="line-2501"></a><span class="hs-identifier">delNodeE</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679058948"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Del"><span class="hs-identifier hs-type">Del</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679058948"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-2502"></a><a name="delNodeE"><a href="Data.Sequence.Internal.html#delNodeE"><span class="hs-identifier">delNodeE</span></a></a><span> </span><a name="local-6989586621679060980"><a href="#local-6989586621679060980"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679060981"><a href="#local-6989586621679060981"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060982"><a href="#local-6989586621679060982"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679060983"><a href="#local-6989586621679060983"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679060980"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2503"></a><span>  </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Full"><span class="hs-identifier hs-var">Full</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="#local-6989586621679060982"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679060983"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2504"></a><span>  </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Full"><span class="hs-identifier hs-var">Full</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="#local-6989586621679060981"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060983"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2505"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Full"><span class="hs-identifier hs-var">Full</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="#local-6989586621679060981"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679060982"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2506"></a><span class="hs-identifier">delNodeE</span><span> </span><a name="local-6989586621679060984"><a href="#local-6989586621679060984"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679060985"><a href="#local-6989586621679060985"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060986"><a href="#local-6989586621679060986"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679060984"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2507"></a><span>  </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Defect"><span class="hs-identifier hs-var">Defect</span></a><span> </span><a href="#local-6989586621679060986"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2508"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Defect"><span class="hs-identifier hs-var">Defect</span></a><span> </span><a href="#local-6989586621679060985"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2509"></a><span>
</span><a name="line-2510"></a><span>
</span><a name="line-2511"></a><span class="hs-identifier">delLeftDigitE</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679058947"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679058947"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679058947"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679058947"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-2512"></a><a name="delLeftDigitE"><a href="Data.Sequence.Internal.html#delLeftDigitE"><span class="hs-identifier">delLeftDigitE</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679060987"><a href="#local-6989586621679060987"><span class="hs-identifier">_i</span></a></a><span> </span><a name="local-6989586621679060988"><a href="#local-6989586621679060988"><span class="hs-identifier">s</span></a></a><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><a name="local-6989586621679060989"><a href="#local-6989586621679060989"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679060990"><a href="#local-6989586621679060990"><span class="hs-identifier">sf</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#pullL"><span class="hs-identifier hs-var">pullL</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060988"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060989"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679060990"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2513"></a><span class="hs-identifier">delLeftDigitE</span><span> </span><a name="local-6989586621679060991"><a href="#local-6989586621679060991"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679060992"><a href="#local-6989586621679060992"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679060993"><a href="#local-6989586621679060993"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679060994"><a href="#local-6989586621679060994"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060995"><a href="#local-6989586621679060995"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679060996"><a href="#local-6989586621679060996"><span class="hs-identifier">sf</span></a></a><span>
</span><a name="line-2514"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060991"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060992"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a href="#local-6989586621679060994"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060995"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679060996"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2515"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060992"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a href="#local-6989586621679060993"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060995"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679060996"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2516"></a><span class="hs-identifier">delLeftDigitE</span><span> </span><a name="local-6989586621679060997"><a href="#local-6989586621679060997"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679060998"><a href="#local-6989586621679060998"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679060999"><a href="#local-6989586621679060999"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679061000"><a href="#local-6989586621679061000"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679061001"><a href="#local-6989586621679061001"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679061002"><a href="#local-6989586621679061002"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679061003"><a href="#local-6989586621679061003"><span class="hs-identifier">sf</span></a></a><span>
</span><a name="line-2517"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060997"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060998"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679061000"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679061001"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061002"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679061003"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2518"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060997"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060998"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679060999"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679061001"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061002"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679061003"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2519"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060998"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679060999"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679061000"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061002"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679061003"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2520"></a><span class="hs-identifier">delLeftDigitE</span><span> </span><a name="local-6989586621679061004"><a href="#local-6989586621679061004"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679061005"><a href="#local-6989586621679061005"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679061006"><a href="#local-6989586621679061006"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679061007"><a href="#local-6989586621679061007"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679061008"><a href="#local-6989586621679061008"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679061009"><a href="#local-6989586621679061009"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679061010"><a href="#local-6989586621679061010"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679061011"><a href="#local-6989586621679061011"><span class="hs-identifier">sf</span></a></a><span>
</span><a name="line-2521"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679061004"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061005"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679061007"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679061008"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679061009"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061010"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679061011"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2522"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679061004"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061005"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679061006"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679061008"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679061009"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061010"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679061011"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2523"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679061004"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061005"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679061006"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679061007"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679061009"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061010"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679061011"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2524"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061005"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679061006"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679061007"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679061008"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061010"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679061011"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2525"></a><span>
</span><a name="line-2526"></a><span class="hs-identifier">delRightDigitE</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679058946"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679058946"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679058946"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">Elem</span></a><span> </span><a href="#local-6989586621679058946"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-2527"></a><a name="delRightDigitE"><a href="Data.Sequence.Internal.html#delRightDigitE"><span class="hs-identifier">delRightDigitE</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061012"><a href="#local-6989586621679061012"><span class="hs-identifier">_i</span></a></a><span> </span><a name="local-6989586621679061013"><a href="#local-6989586621679061013"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679061014"><a href="#local-6989586621679061014"><span class="hs-identifier">pr</span></a></a><span> </span><a name="local-6989586621679061015"><a href="#local-6989586621679061015"><span class="hs-identifier">m</span></a></a><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#pullR"><span class="hs-identifier hs-var">pullR</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061013"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061014"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679061015"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-2528"></a><span class="hs-identifier">delRightDigitE</span><span> </span><a name="local-6989586621679061016"><a href="#local-6989586621679061016"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679061017"><a href="#local-6989586621679061017"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679061018"><a href="#local-6989586621679061018"><span class="hs-identifier">pr</span></a></a><span> </span><a name="local-6989586621679061019"><a href="#local-6989586621679061019"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679061020"><a href="#local-6989586621679061020"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679061021"><a href="#local-6989586621679061021"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2529"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679061016"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061017"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061018"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679061019"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a href="#local-6989586621679061021"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-2530"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061017"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061018"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679061019"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a href="#local-6989586621679061020"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-2531"></a><span class="hs-identifier">delRightDigitE</span><span> </span><a name="local-6989586621679061022"><a href="#local-6989586621679061022"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679061023"><a href="#local-6989586621679061023"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679061024"><a href="#local-6989586621679061024"><span class="hs-identifier">pr</span></a></a><span> </span><a name="local-6989586621679061025"><a href="#local-6989586621679061025"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679061026"><a href="#local-6989586621679061026"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679061027"><a href="#local-6989586621679061027"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679061028"><a href="#local-6989586621679061028"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2532"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679061022"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061023"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061024"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679061025"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679061027"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679061028"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-2533"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679061022"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061023"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061024"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679061025"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679061026"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679061028"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-2534"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#deep"><span class="hs-identifier hs-var">deep</span></a><span> </span><a href="#local-6989586621679061024"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679061025"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679061026"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679061027"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-2535"></a><span class="hs-identifier">delRightDigitE</span><span> </span><a name="local-6989586621679061029"><a href="#local-6989586621679061029"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679061030"><a href="#local-6989586621679061030"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679061031"><a href="#local-6989586621679061031"><span class="hs-identifier">pr</span></a></a><span> </span><a name="local-6989586621679061032"><a href="#local-6989586621679061032"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679061033"><a href="#local-6989586621679061033"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679061034"><a href="#local-6989586621679061034"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679061035"><a href="#local-6989586621679061035"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679061036"><a href="#local-6989586621679061036"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2536"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679061029"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061030"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061031"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679061032"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679061034"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679061035"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679061036"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-2537"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679061029"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061030"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061031"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679061032"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679061033"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679061035"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679061036"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-2538"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679061029"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061030"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061031"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679061032"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679061033"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679061034"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679061036"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-2539"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061030"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061031"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679061032"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679061033"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679061034"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679061035"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-2540"></a><span>
</span><a name="line-2541"></a><span class="hs-keyword">data</span><span> </span><a name="DelTree"><a href="Data.Sequence.Internal.html#DelTree"><span class="hs-identifier">DelTree</span></a></a><span> </span><a name="local-6989586621679058040"><a href="#local-6989586621679058040"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="FullTree"><a href="Data.Sequence.Internal.html#FullTree"><span class="hs-identifier">FullTree</span></a></a><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679058040"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="DefectTree"><a href="Data.Sequence.Internal.html#DefectTree"><span class="hs-identifier">DefectTree</span></a></a><span> </span><a href="#local-6989586621679058040"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2542"></a><span>
</span><a name="line-2543"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">delTree</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Del</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">DelTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2544"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">delTree</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Del</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">DelTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2545"></a><span class="hs-identifier">delTree</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a><span> </span><a href="#local-6989586621679058943"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679058943"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Del"><span class="hs-identifier hs-type">Del</span></a><span> </span><a href="#local-6989586621679058943"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679058943"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#DelTree"><span class="hs-identifier hs-type">DelTree</span></a><span> </span><a href="#local-6989586621679058943"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2546"></a><a name="delTree"><a href="Data.Sequence.Internal.html#delTree"><span class="hs-identifier">delTree</span></a></a><span> </span><a name="local-6989586621679061037"><a href="#local-6989586621679061037"><span class="hs-identifier">_f</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061038"><a href="#local-6989586621679061038"><span class="hs-identifier">_i</span></a></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#FullTree"><span class="hs-identifier hs-var">FullTree</span></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-comment">-- Unreachable</span><span>
</span><a name="line-2547"></a><span class="hs-identifier">delTree</span><span> </span><a name="local-6989586621679061039"><a href="#local-6989586621679061039"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679061040"><a href="#local-6989586621679061040"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><a name="local-6989586621679061041"><a href="#local-6989586621679061041"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061039"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679061040"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679061041"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2548"></a><span>  </span><a href="Data.Sequence.Internal.html#Full"><span class="hs-identifier hs-var">Full</span></a><span> </span><a name="local-6989586621679061042"><a href="#local-6989586621679061042"><span class="hs-identifier">a'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullTree"><span class="hs-identifier hs-var">FullTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><a href="#local-6989586621679061042"><span class="hs-identifier hs-var">a'</span></a><span class="hs-special">)</span><span>
</span><a name="line-2549"></a><span>  </span><a href="Data.Sequence.Internal.html#Defect"><span class="hs-identifier hs-var">Defect</span></a><span> </span><a name="local-6989586621679061043"><a href="#local-6989586621679061043"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#DefectTree"><span class="hs-identifier hs-var">DefectTree</span></a><span> </span><a href="#local-6989586621679061043"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-2550"></a><span class="hs-identifier">delTree</span><span> </span><a name="local-6989586621679061044"><a href="#local-6989586621679061044"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679061045"><a href="#local-6989586621679061045"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679061046"><a href="#local-6989586621679061046"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679061047"><a href="#local-6989586621679061047"><span class="hs-identifier">pr</span></a></a><span> </span><a name="local-6989586621679061048"><a href="#local-6989586621679061048"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679061049"><a href="#local-6989586621679061049"><span class="hs-identifier">sf</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2551"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679061045"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679061050"><span class="hs-identifier hs-var">spr</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Data.Sequence.Internal.html#delDigit"><span class="hs-identifier hs-var">delDigit</span></a><span> </span><a href="#local-6989586621679061044"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679061045"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679061047"><span class="hs-identifier hs-var">pr</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2552"></a><span>     </span><a href="Data.Sequence.Internal.html#FullDig"><span class="hs-identifier hs-var">FullDig</span></a><span> </span><a name="local-6989586621679061052"><a href="#local-6989586621679061052"><span class="hs-identifier">pr'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullTree"><span class="hs-identifier hs-var">FullTree</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061046"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061052"><span class="hs-identifier hs-var">pr'</span></a><span> </span><a href="#local-6989586621679061048"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679061049"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2553"></a><span>     </span><a href="Data.Sequence.Internal.html#DefectDig"><span class="hs-identifier hs-var">DefectDig</span></a><span> </span><a name="local-6989586621679061053"><a href="#local-6989586621679061053"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Data.Sequence.Internal.html#viewLTree"><span class="hs-identifier hs-var">viewLTree</span></a><span> </span><a href="#local-6989586621679061048"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2554"></a><span>                      </span><a href="Data.Sequence.Internal.html#EmptyLTree"><span class="hs-identifier hs-var">EmptyLTree</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullTree"><span class="hs-identifier hs-var">FullTree</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#delRebuildRightDigit"><span class="hs-identifier hs-var">delRebuildRightDigit</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061046"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061053"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679061049"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2555"></a><span>                      </span><a href="Data.Sequence.Internal.html#ConsLTree"><span class="hs-identifier hs-var">ConsLTree</span></a><span> </span><a name="local-6989586621679061054"><a href="#local-6989586621679061054"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679061055"><a href="#local-6989586621679061055"><span class="hs-identifier">m'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullTree"><span class="hs-identifier hs-var">FullTree</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#delRebuildLeftSide"><span class="hs-identifier hs-var">delRebuildLeftSide</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061046"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061053"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679061054"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679061055"><span class="hs-identifier hs-var">m'</span></a><span> </span><a href="#local-6989586621679061049"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2556"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679061045"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679061051"><span class="hs-identifier hs-var">spm</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Data.Sequence.Internal.html#delTree"><span class="hs-identifier hs-var">delTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#delNode"><span class="hs-identifier hs-var">delNode</span></a><span> </span><a href="#local-6989586621679061044"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061045"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061050"><span class="hs-identifier hs-var">spr</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061048"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2557"></a><span>     </span><a href="Data.Sequence.Internal.html#FullTree"><span class="hs-identifier hs-var">FullTree</span></a><span> </span><a name="local-6989586621679061056"><a href="#local-6989586621679061056"><span class="hs-identifier">m'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullTree"><span class="hs-identifier hs-var">FullTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061046"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061047"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679061056"><span class="hs-identifier hs-var">m'</span></a><span> </span><a href="#local-6989586621679061049"><span class="hs-identifier hs-var">sf</span></a><span class="hs-special">)</span><span>
</span><a name="line-2558"></a><span>     </span><a href="Data.Sequence.Internal.html#DefectTree"><span class="hs-identifier hs-var">DefectTree</span></a><span> </span><a name="local-6989586621679061057"><a href="#local-6989586621679061057"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullTree"><span class="hs-identifier hs-var">FullTree</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#delRebuildMiddle"><span class="hs-identifier hs-var">delRebuildMiddle</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061046"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061047"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679061057"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679061049"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2559"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Data.Sequence.Internal.html#delDigit"><span class="hs-identifier hs-var">delDigit</span></a><span> </span><a href="#local-6989586621679061044"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061045"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061051"><span class="hs-identifier hs-var">spm</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061049"><span class="hs-identifier hs-var">sf</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2560"></a><span>     </span><a href="Data.Sequence.Internal.html#FullDig"><span class="hs-identifier hs-var">FullDig</span></a><span> </span><a name="local-6989586621679061058"><a href="#local-6989586621679061058"><span class="hs-identifier">sf'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullTree"><span class="hs-identifier hs-var">FullTree</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061046"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061047"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679061048"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679061058"><span class="hs-identifier hs-var">sf'</span></a><span>
</span><a name="line-2561"></a><span>     </span><a href="Data.Sequence.Internal.html#DefectDig"><span class="hs-identifier hs-var">DefectDig</span></a><span> </span><a name="local-6989586621679061059"><a href="#local-6989586621679061059"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Data.Sequence.Internal.html#viewRTree"><span class="hs-identifier hs-var">viewRTree</span></a><span> </span><a href="#local-6989586621679061048"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2562"></a><span>                      </span><a href="Data.Sequence.Internal.html#EmptyRTree"><span class="hs-identifier hs-var">EmptyRTree</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullTree"><span class="hs-identifier hs-var">FullTree</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#delRebuildLeftDigit"><span class="hs-identifier hs-var">delRebuildLeftDigit</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061046"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061047"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679061059"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-2563"></a><span>                      </span><a href="Data.Sequence.Internal.html#SnocRTree"><span class="hs-identifier hs-var">SnocRTree</span></a><span> </span><a name="local-6989586621679061060"><a href="#local-6989586621679061060"><span class="hs-identifier">m'</span></a></a><span> </span><a name="local-6989586621679061061"><a href="#local-6989586621679061061"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullTree"><span class="hs-identifier hs-var">FullTree</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#delRebuildRightSide"><span class="hs-identifier hs-var">delRebuildRightSide</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061046"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061047"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679061060"><span class="hs-identifier hs-var">m'</span></a><span> </span><a href="#local-6989586621679061061"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679061059"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-2564"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679061050"><a href="#local-6989586621679061050"><span class="hs-identifier">spr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061047"><span class="hs-identifier hs-var">pr</span></a><span>
</span><a name="line-2565"></a><span>        </span><a name="local-6989586621679061051"><a href="#local-6989586621679061051"><span class="hs-identifier">spm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679061050"><span class="hs-identifier hs-var">spr</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061048"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-2566"></a><span>
</span><a name="line-2567"></a><span class="hs-keyword">data</span><span> </span><a name="Del"><a href="Data.Sequence.Internal.html#Del"><span class="hs-identifier">Del</span></a></a><span> </span><a name="local-6989586621679058039"><a href="#local-6989586621679058039"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Full"><a href="Data.Sequence.Internal.html#Full"><span class="hs-identifier">Full</span></a></a><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679058039"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="Defect"><a href="Data.Sequence.Internal.html#Defect"><span class="hs-identifier">Defect</span></a></a><span> </span><a href="#local-6989586621679058039"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2568"></a><span>
</span><a name="line-2569"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">delNode</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Del</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Del</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2570"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">delNode</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Del</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Del</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2571"></a><span class="hs-identifier">delNode</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a><span> </span><a href="#local-6989586621679058940"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679058940"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Del"><span class="hs-identifier hs-type">Del</span></a><span> </span><a href="#local-6989586621679058940"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679058940"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Del"><span class="hs-identifier hs-type">Del</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679058940"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-2572"></a><a name="delNode"><a href="Data.Sequence.Internal.html#delNode"><span class="hs-identifier">delNode</span></a></a><span> </span><a name="local-6989586621679061062"><a href="#local-6989586621679061062"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679061063"><a href="#local-6989586621679061063"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a name="local-6989586621679061064"><a href="#local-6989586621679061064"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679061065"><a href="#local-6989586621679061065"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679061066"><a href="#local-6989586621679061066"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679061067"><a href="#local-6989586621679061067"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2573"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679061063"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679061068"><span class="hs-identifier hs-var">sa</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061062"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679061063"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679061065"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2574"></a><span>     </span><a href="Data.Sequence.Internal.html#Full"><span class="hs-identifier hs-var">Full</span></a><span> </span><a name="local-6989586621679061070"><a href="#local-6989586621679061070"><span class="hs-identifier">a'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Full"><span class="hs-identifier hs-var">Full</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061064"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061070"><span class="hs-identifier hs-var">a'</span></a><span> </span><a href="#local-6989586621679061066"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679061067"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2575"></a><span>     </span><a href="Data.Sequence.Internal.html#Defect"><span class="hs-identifier hs-var">Defect</span></a><span> </span><a name="local-6989586621679061071"><a href="#local-6989586621679061071"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061072"><a href="#local-6989586621679061072"><span class="hs-identifier">se</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061071"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061066"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2576"></a><span>       </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a name="local-6989586621679061073"><a href="#local-6989586621679061073"><span class="hs-identifier">sxyz</span></a></a><span> </span><a name="local-6989586621679061074"><a href="#local-6989586621679061074"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061075"><a href="#local-6989586621679061075"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679061076"><a href="#local-6989586621679061076"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Full"><span class="hs-identifier hs-var">Full</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061064"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061072"><span class="hs-identifier hs-var">se</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061077"><span class="hs-identifier hs-var">sx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061071"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679061074"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061073"><span class="hs-identifier hs-var">sxyz</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061077"><span class="hs-identifier hs-var">sx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061075"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679061076"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061067"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2577"></a><span>         </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061077"><a href="#local-6989586621679061077"><span class="hs-identifier">sx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061074"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-2578"></a><span>       </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a name="local-6989586621679061078"><a href="#local-6989586621679061078"><span class="hs-identifier">sxy</span></a></a><span> </span><a name="local-6989586621679061079"><a href="#local-6989586621679061079"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061080"><a href="#local-6989586621679061080"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Full"><span class="hs-identifier hs-var">Full</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061064"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061078"><span class="hs-identifier hs-var">sxy</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061072"><span class="hs-identifier hs-var">se</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061071"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679061079"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061080"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061067"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2579"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679061063"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679061069"><span class="hs-identifier hs-var">sab</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061062"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061063"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061068"><span class="hs-identifier hs-var">sa</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061066"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2580"></a><span>     </span><a href="Data.Sequence.Internal.html#Full"><span class="hs-identifier hs-var">Full</span></a><span> </span><a name="local-6989586621679061081"><a href="#local-6989586621679061081"><span class="hs-identifier">b'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Full"><span class="hs-identifier hs-var">Full</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061064"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061065"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679061081"><span class="hs-identifier hs-var">b'</span></a><span> </span><a href="#local-6989586621679061067"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2581"></a><span>     </span><a href="Data.Sequence.Internal.html#Defect"><span class="hs-identifier hs-var">Defect</span></a><span> </span><a name="local-6989586621679061082"><a href="#local-6989586621679061082"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061083"><a href="#local-6989586621679061083"><span class="hs-identifier">se</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061082"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061065"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2582"></a><span>       </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a name="local-6989586621679061084"><a href="#local-6989586621679061084"><span class="hs-identifier">sxyz</span></a></a><span> </span><a name="local-6989586621679061085"><a href="#local-6989586621679061085"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061086"><a href="#local-6989586621679061086"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679061087"><a href="#local-6989586621679061087"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Full"><span class="hs-identifier hs-var">Full</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061064"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061084"><span class="hs-identifier hs-var">sxyz</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061088"><span class="hs-identifier hs-var">sz</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061085"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061086"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061088"><span class="hs-identifier hs-var">sz</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061083"><span class="hs-identifier hs-var">se</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061087"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679061082"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061067"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2583"></a><span>         </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061088"><a href="#local-6989586621679061088"><span class="hs-identifier">sz</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061087"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-2584"></a><span>       </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a name="local-6989586621679061089"><a href="#local-6989586621679061089"><span class="hs-identifier">sxy</span></a></a><span> </span><a name="local-6989586621679061090"><a href="#local-6989586621679061090"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061091"><a href="#local-6989586621679061091"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Full"><span class="hs-identifier hs-var">Full</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061064"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061089"><span class="hs-identifier hs-var">sxy</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061083"><span class="hs-identifier hs-var">se</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061090"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061091"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679061082"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061067"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2585"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061062"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061063"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061069"><span class="hs-identifier hs-var">sab</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061067"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2586"></a><span>     </span><a href="Data.Sequence.Internal.html#Full"><span class="hs-identifier hs-var">Full</span></a><span> </span><a name="local-6989586621679061092"><a href="#local-6989586621679061092"><span class="hs-identifier">c'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Full"><span class="hs-identifier hs-var">Full</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061064"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061065"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679061066"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679061092"><span class="hs-identifier hs-var">c'</span></a><span>
</span><a name="line-2587"></a><span>     </span><a href="Data.Sequence.Internal.html#Defect"><span class="hs-identifier hs-var">Defect</span></a><span> </span><a name="local-6989586621679061093"><a href="#local-6989586621679061093"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061094"><a href="#local-6989586621679061094"><span class="hs-identifier">se</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061093"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061066"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2588"></a><span>       </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a name="local-6989586621679061095"><a href="#local-6989586621679061095"><span class="hs-identifier">sxyz</span></a></a><span> </span><a name="local-6989586621679061096"><a href="#local-6989586621679061096"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061097"><a href="#local-6989586621679061097"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679061098"><a href="#local-6989586621679061098"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Full"><span class="hs-identifier hs-var">Full</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061064"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061065"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061095"><span class="hs-identifier hs-var">sxyz</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061099"><span class="hs-identifier hs-var">sz</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061096"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061097"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061099"><span class="hs-identifier hs-var">sz</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061094"><span class="hs-identifier hs-var">se</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061098"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679061093"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-2589"></a><span>         </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061099"><a href="#local-6989586621679061099"><span class="hs-identifier">sz</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061098"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-2590"></a><span>       </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a name="local-6989586621679061100"><a href="#local-6989586621679061100"><span class="hs-identifier">sxy</span></a></a><span> </span><a name="local-6989586621679061101"><a href="#local-6989586621679061101"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061102"><a href="#local-6989586621679061102"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Full"><span class="hs-identifier hs-var">Full</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061064"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061065"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061100"><span class="hs-identifier hs-var">sxy</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061094"><span class="hs-identifier hs-var">se</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061101"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061102"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679061093"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-2591"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679061068"><a href="#local-6989586621679061068"><span class="hs-identifier">sa</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061065"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2592"></a><span>        </span><a name="local-6989586621679061069"><a href="#local-6989586621679061069"><span class="hs-identifier">sab</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679061068"><span class="hs-identifier hs-var">sa</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061066"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2593"></a><span class="hs-identifier">delNode</span><span> </span><a name="local-6989586621679061103"><a href="#local-6989586621679061103"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679061104"><a href="#local-6989586621679061104"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a name="local-6989586621679061105"><a href="#local-6989586621679061105"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679061106"><a href="#local-6989586621679061106"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679061107"><a href="#local-6989586621679061107"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2594"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679061104"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679061108"><span class="hs-identifier hs-var">sa</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061103"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679061104"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679061106"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2595"></a><span>     </span><a href="Data.Sequence.Internal.html#Full"><span class="hs-identifier hs-var">Full</span></a><span> </span><a name="local-6989586621679061109"><a href="#local-6989586621679061109"><span class="hs-identifier">a'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Full"><span class="hs-identifier hs-var">Full</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061105"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061109"><span class="hs-identifier hs-var">a'</span></a><span> </span><a href="#local-6989586621679061107"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2596"></a><span>     </span><a href="Data.Sequence.Internal.html#Defect"><span class="hs-identifier hs-var">Defect</span></a><span> </span><a name="local-6989586621679061110"><a href="#local-6989586621679061110"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061111"><a href="#local-6989586621679061111"><span class="hs-identifier">se</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061110"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061107"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2597"></a><span>       </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a name="local-6989586621679061112"><a href="#local-6989586621679061112"><span class="hs-identifier">sxyz</span></a></a><span> </span><a name="local-6989586621679061113"><a href="#local-6989586621679061113"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061114"><a href="#local-6989586621679061114"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679061115"><a href="#local-6989586621679061115"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Full"><span class="hs-identifier hs-var">Full</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061105"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061111"><span class="hs-identifier hs-var">se</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061116"><span class="hs-identifier hs-var">sx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061110"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679061113"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061112"><span class="hs-identifier hs-var">sxyz</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061116"><span class="hs-identifier hs-var">sx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061114"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679061115"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-2598"></a><span>        </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061116"><a href="#local-6989586621679061116"><span class="hs-identifier">sx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061113"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-2599"></a><span>       </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679061117"><a href="#local-6989586621679061117"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061118"><a href="#local-6989586621679061118"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Defect"><span class="hs-identifier hs-var">Defect</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061105"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061110"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679061117"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061118"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-2600"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061103"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061104"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061108"><span class="hs-identifier hs-var">sa</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061107"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2601"></a><span>     </span><a href="Data.Sequence.Internal.html#Full"><span class="hs-identifier hs-var">Full</span></a><span> </span><a name="local-6989586621679061119"><a href="#local-6989586621679061119"><span class="hs-identifier">b'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Full"><span class="hs-identifier hs-var">Full</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061105"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061106"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679061119"><span class="hs-identifier hs-var">b'</span></a><span>
</span><a name="line-2602"></a><span>     </span><a href="Data.Sequence.Internal.html#Defect"><span class="hs-identifier hs-var">Defect</span></a><span> </span><a name="local-6989586621679061120"><a href="#local-6989586621679061120"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061121"><a href="#local-6989586621679061121"><span class="hs-identifier">se</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061120"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061106"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2603"></a><span>       </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a name="local-6989586621679061122"><a href="#local-6989586621679061122"><span class="hs-identifier">sxyz</span></a></a><span> </span><a name="local-6989586621679061123"><a href="#local-6989586621679061123"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061124"><a href="#local-6989586621679061124"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679061125"><a href="#local-6989586621679061125"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Full"><span class="hs-identifier hs-var">Full</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061105"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061122"><span class="hs-identifier hs-var">sxyz</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061126"><span class="hs-identifier hs-var">sz</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061123"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061124"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061126"><span class="hs-identifier hs-var">sz</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061121"><span class="hs-identifier hs-var">se</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061125"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679061120"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-2604"></a><span>         </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061126"><a href="#local-6989586621679061126"><span class="hs-identifier">sz</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061125"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-2605"></a><span>       </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679061127"><a href="#local-6989586621679061127"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061128"><a href="#local-6989586621679061128"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Defect"><span class="hs-identifier hs-var">Defect</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061105"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061127"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061128"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679061120"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-2606"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679061108"><a href="#local-6989586621679061108"><span class="hs-identifier">sa</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061106"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2607"></a><span>
</span><a name="line-2608"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">delRebuildRightDigit</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Digit</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2609"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">delRebuildRightDigit</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Digit</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2610"></a><span class="hs-identifier">delRebuildRightDigit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a><span> </span><a href="#local-6989586621679058937"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058937"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679058937"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679058937"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-2611"></a><a name="delRebuildRightDigit"><a href="Data.Sequence.Internal.html#delRebuildRightDigit"><span class="hs-identifier">delRebuildRightDigit</span></a></a><span> </span><a name="local-6989586621679061129"><a href="#local-6989586621679061129"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679061130"><a href="#local-6989586621679061130"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679061131"><a href="#local-6989586621679061131"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061132"><a href="#local-6989586621679061132"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061130"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061131"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2612"></a><span>  </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a name="local-6989586621679061133"><a href="#local-6989586621679061133"><span class="hs-identifier">sxyz</span></a></a><span> </span><a name="local-6989586621679061134"><a href="#local-6989586621679061134"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061135"><a href="#local-6989586621679061135"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679061136"><a href="#local-6989586621679061136"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="#local-6989586621679061129"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061132"><span class="hs-identifier hs-var">sp</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061137"><span class="hs-identifier hs-var">sx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061130"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679061134"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061133"><span class="hs-identifier hs-var">sxyz</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061137"><span class="hs-identifier hs-var">sx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061135"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679061136"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2613"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061137"><a href="#local-6989586621679061137"><span class="hs-identifier">sx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061134"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-2614"></a><span>  </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a name="local-6989586621679061138"><a href="#local-6989586621679061138"><span class="hs-identifier">sxy</span></a></a><span> </span><a name="local-6989586621679061139"><a href="#local-6989586621679061139"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061140"><a href="#local-6989586621679061140"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061132"><span class="hs-identifier hs-var">sp</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061138"><span class="hs-identifier hs-var">sxy</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061130"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679061139"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061140"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-2615"></a><span class="hs-identifier">delRebuildRightDigit</span><span> </span><a name="local-6989586621679061141"><a href="#local-6989586621679061141"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679061142"><a href="#local-6989586621679061142"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679061143"><a href="#local-6989586621679061143"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679061144"><a href="#local-6989586621679061144"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061145"><a href="#local-6989586621679061145"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061142"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061143"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2616"></a><span>  </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a name="local-6989586621679061146"><a href="#local-6989586621679061146"><span class="hs-identifier">sxyz</span></a></a><span> </span><a name="local-6989586621679061147"><a href="#local-6989586621679061147"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061148"><a href="#local-6989586621679061148"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679061149"><a href="#local-6989586621679061149"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="#local-6989586621679061141"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061145"><span class="hs-identifier hs-var">sp</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061150"><span class="hs-identifier hs-var">sx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061142"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679061147"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061146"><span class="hs-identifier hs-var">sxyz</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061150"><span class="hs-identifier hs-var">sx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061148"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679061149"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a href="#local-6989586621679061144"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-2617"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061150"><a href="#local-6989586621679061150"><span class="hs-identifier">sx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061147"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-2618"></a><span>  </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a name="local-6989586621679061151"><a href="#local-6989586621679061151"><span class="hs-identifier">sxy</span></a></a><span> </span><a name="local-6989586621679061152"><a href="#local-6989586621679061152"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061153"><a href="#local-6989586621679061153"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="#local-6989586621679061141"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061145"><span class="hs-identifier hs-var">sp</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061151"><span class="hs-identifier hs-var">sxy</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061142"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679061152"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061153"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a href="#local-6989586621679061144"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-2619"></a><span class="hs-identifier">delRebuildRightDigit</span><span> </span><a name="local-6989586621679061154"><a href="#local-6989586621679061154"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679061155"><a href="#local-6989586621679061155"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679061156"><a href="#local-6989586621679061156"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679061157"><a href="#local-6989586621679061157"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679061158"><a href="#local-6989586621679061158"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061159"><a href="#local-6989586621679061159"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061155"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061156"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2620"></a><span>  </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a name="local-6989586621679061160"><a href="#local-6989586621679061160"><span class="hs-identifier">sxyz</span></a></a><span> </span><a name="local-6989586621679061161"><a href="#local-6989586621679061161"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061162"><a href="#local-6989586621679061162"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679061163"><a href="#local-6989586621679061163"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="#local-6989586621679061154"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061159"><span class="hs-identifier hs-var">sp</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061164"><span class="hs-identifier hs-var">sx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061155"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679061161"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061160"><span class="hs-identifier hs-var">sxyz</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061164"><span class="hs-identifier hs-var">sx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061162"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679061163"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679061157"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679061158"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-2621"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061164"><a href="#local-6989586621679061164"><span class="hs-identifier">sx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061161"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-2622"></a><span>  </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a name="local-6989586621679061165"><a href="#local-6989586621679061165"><span class="hs-identifier">sxy</span></a></a><span> </span><a name="local-6989586621679061166"><a href="#local-6989586621679061166"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061167"><a href="#local-6989586621679061167"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="#local-6989586621679061154"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061159"><span class="hs-identifier hs-var">sp</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061165"><span class="hs-identifier hs-var">sxy</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061155"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679061166"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061167"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061157"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a href="#local-6989586621679061158"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-2623"></a><span class="hs-identifier">delRebuildRightDigit</span><span> </span><a name="local-6989586621679061168"><a href="#local-6989586621679061168"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679061169"><a href="#local-6989586621679061169"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679061170"><a href="#local-6989586621679061170"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679061171"><a href="#local-6989586621679061171"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679061172"><a href="#local-6989586621679061172"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679061173"><a href="#local-6989586621679061173"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061174"><a href="#local-6989586621679061174"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061169"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061170"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2624"></a><span>  </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a name="local-6989586621679061175"><a href="#local-6989586621679061175"><span class="hs-identifier">sxyz</span></a></a><span> </span><a name="local-6989586621679061176"><a href="#local-6989586621679061176"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061177"><a href="#local-6989586621679061177"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679061178"><a href="#local-6989586621679061178"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="#local-6989586621679061168"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061174"><span class="hs-identifier hs-var">sp</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061179"><span class="hs-identifier hs-var">sx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061169"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679061176"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061175"><span class="hs-identifier hs-var">sxyz</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061179"><span class="hs-identifier hs-var">sx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061177"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679061178"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061171"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679061172"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679061173"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-2625"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061179"><a href="#local-6989586621679061179"><span class="hs-identifier">sx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061176"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-2626"></a><span>  </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a name="local-6989586621679061180"><a href="#local-6989586621679061180"><span class="hs-identifier">sxy</span></a></a><span> </span><a name="local-6989586621679061181"><a href="#local-6989586621679061181"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061182"><a href="#local-6989586621679061182"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="#local-6989586621679061168"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061174"><span class="hs-identifier hs-var">sp</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061180"><span class="hs-identifier hs-var">sxy</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061169"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679061181"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061182"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061171"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679061172"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679061173"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-2627"></a><span>
</span><a name="line-2628"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">delRebuildLeftDigit</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Digit</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2629"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">delRebuildLeftDigit</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Digit</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2630"></a><span class="hs-identifier">delRebuildLeftDigit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a><span> </span><a href="#local-6989586621679058934"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679058934"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058934"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679058934"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-2631"></a><a name="delRebuildLeftDigit"><a href="Data.Sequence.Internal.html#delRebuildLeftDigit"><span class="hs-identifier">delRebuildLeftDigit</span></a></a><span> </span><a name="local-6989586621679061183"><a href="#local-6989586621679061183"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679061184"><a href="#local-6989586621679061184"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679061185"><a href="#local-6989586621679061185"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061186"><a href="#local-6989586621679061186"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061185"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061184"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2632"></a><span>  </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a name="local-6989586621679061187"><a href="#local-6989586621679061187"><span class="hs-identifier">sxyz</span></a></a><span> </span><a name="local-6989586621679061188"><a href="#local-6989586621679061188"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061189"><a href="#local-6989586621679061189"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679061190"><a href="#local-6989586621679061190"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="#local-6989586621679061183"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061187"><span class="hs-identifier hs-var">sxyz</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061191"><span class="hs-identifier hs-var">sz</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061188"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061189"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061191"><span class="hs-identifier hs-var">sz</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061186"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061190"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679061185"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2633"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061191"><a href="#local-6989586621679061191"><span class="hs-identifier">sz</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061190"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-2634"></a><span>  </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a name="local-6989586621679061192"><a href="#local-6989586621679061192"><span class="hs-identifier">sxy</span></a></a><span> </span><a name="local-6989586621679061193"><a href="#local-6989586621679061193"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061194"><a href="#local-6989586621679061194"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061192"><span class="hs-identifier hs-var">sxy</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061186"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061193"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061194"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679061185"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-2635"></a><span class="hs-identifier">delRebuildLeftDigit</span><span> </span><a name="local-6989586621679061195"><a href="#local-6989586621679061195"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679061196"><a href="#local-6989586621679061196"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679061197"><a href="#local-6989586621679061197"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679061198"><a href="#local-6989586621679061198"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061199"><a href="#local-6989586621679061199"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061198"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061197"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2636"></a><span>  </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a name="local-6989586621679061200"><a href="#local-6989586621679061200"><span class="hs-identifier">sxyz</span></a></a><span> </span><a name="local-6989586621679061201"><a href="#local-6989586621679061201"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061202"><a href="#local-6989586621679061202"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679061203"><a href="#local-6989586621679061203"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="#local-6989586621679061195"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679061196"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061200"><span class="hs-identifier hs-var">sxyz</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061204"><span class="hs-identifier hs-var">sz</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061201"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061202"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061204"><span class="hs-identifier hs-var">sz</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061199"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061203"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679061198"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2637"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061204"><a href="#local-6989586621679061204"><span class="hs-identifier">sz</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061203"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-2638"></a><span>  </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a name="local-6989586621679061205"><a href="#local-6989586621679061205"><span class="hs-identifier">sxy</span></a></a><span> </span><a name="local-6989586621679061206"><a href="#local-6989586621679061206"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061207"><a href="#local-6989586621679061207"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="#local-6989586621679061195"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a href="#local-6989586621679061196"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061205"><span class="hs-identifier hs-var">sxy</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061199"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061206"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061207"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679061198"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2639"></a><span class="hs-identifier">delRebuildLeftDigit</span><span> </span><a name="local-6989586621679061208"><a href="#local-6989586621679061208"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679061209"><a href="#local-6989586621679061209"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679061210"><a href="#local-6989586621679061210"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679061211"><a href="#local-6989586621679061211"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679061212"><a href="#local-6989586621679061212"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061213"><a href="#local-6989586621679061213"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061212"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061211"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2640"></a><span>  </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a name="local-6989586621679061214"><a href="#local-6989586621679061214"><span class="hs-identifier">sxyz</span></a></a><span> </span><a name="local-6989586621679061215"><a href="#local-6989586621679061215"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061216"><a href="#local-6989586621679061216"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679061217"><a href="#local-6989586621679061217"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="#local-6989586621679061208"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679061209"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679061210"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061214"><span class="hs-identifier hs-var">sxyz</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061218"><span class="hs-identifier hs-var">sz</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061215"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061216"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061218"><span class="hs-identifier hs-var">sz</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061213"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061217"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679061212"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2641"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061218"><a href="#local-6989586621679061218"><span class="hs-identifier">sz</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061217"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-2642"></a><span>  </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a name="local-6989586621679061219"><a href="#local-6989586621679061219"><span class="hs-identifier">sxy</span></a></a><span> </span><a name="local-6989586621679061220"><a href="#local-6989586621679061220"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061221"><a href="#local-6989586621679061221"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="#local-6989586621679061208"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679061209"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679061210"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061219"><span class="hs-identifier hs-var">sxy</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061213"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061220"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061221"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679061212"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2643"></a><span class="hs-identifier">delRebuildLeftDigit</span><span> </span><a name="local-6989586621679061222"><a href="#local-6989586621679061222"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679061223"><a href="#local-6989586621679061223"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679061224"><a href="#local-6989586621679061224"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679061225"><a href="#local-6989586621679061225"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679061226"><a href="#local-6989586621679061226"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679061227"><a href="#local-6989586621679061227"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061228"><a href="#local-6989586621679061228"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061227"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061226"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2644"></a><span>  </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a name="local-6989586621679061229"><a href="#local-6989586621679061229"><span class="hs-identifier">sxyz</span></a></a><span> </span><a name="local-6989586621679061230"><a href="#local-6989586621679061230"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061231"><a href="#local-6989586621679061231"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679061232"><a href="#local-6989586621679061232"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="#local-6989586621679061222"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679061223"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679061224"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679061225"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061229"><span class="hs-identifier hs-var">sxyz</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061233"><span class="hs-identifier hs-var">sz</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061230"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061231"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061233"><span class="hs-identifier hs-var">sz</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061228"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061232"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679061227"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2645"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061233"><a href="#local-6989586621679061233"><span class="hs-identifier">sz</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061232"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-2646"></a><span>  </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a name="local-6989586621679061234"><a href="#local-6989586621679061234"><span class="hs-identifier">sxy</span></a></a><span> </span><a name="local-6989586621679061235"><a href="#local-6989586621679061235"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061236"><a href="#local-6989586621679061236"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="#local-6989586621679061222"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679061223"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679061224"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679061225"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061234"><span class="hs-identifier hs-var">sxy</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061228"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061235"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061236"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679061227"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2647"></a><span>
</span><a name="line-2648"></a><span class="hs-identifier">delRebuildLeftSide</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a><span> </span><a href="#local-6989586621679058933"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2649"></a><span>                   </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058933"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679058933"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679058933"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679058933"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-2650"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679058933"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-2651"></a><a name="delRebuildLeftSide"><a href="Data.Sequence.Internal.html#delRebuildLeftSide"><span class="hs-identifier">delRebuildLeftSide</span></a></a><span> </span><a name="local-6989586621679061237"><a href="#local-6989586621679061237"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679061238"><a href="#local-6989586621679061238"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679061239"><a href="#local-6989586621679061239"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679061240"><a href="#local-6989586621679061240"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679061241"><a href="#local-6989586621679061241"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679061242"><a href="#local-6989586621679061242"><span class="hs-identifier">sf</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061243"><a href="#local-6989586621679061243"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061238"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061239"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2652"></a><span>  </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a name="local-6989586621679061244"><a href="#local-6989586621679061244"><span class="hs-identifier">sxy</span></a></a><span> </span><a name="local-6989586621679061245"><a href="#local-6989586621679061245"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061246"><a href="#local-6989586621679061246"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="#local-6989586621679061237"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061243"><span class="hs-identifier hs-var">sp</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061244"><span class="hs-identifier hs-var">sxy</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061238"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679061245"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061246"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061240"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061241"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679061242"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2653"></a><span>  </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a name="local-6989586621679061247"><a href="#local-6989586621679061247"><span class="hs-identifier">sxyz</span></a></a><span> </span><a name="local-6989586621679061248"><a href="#local-6989586621679061248"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061249"><a href="#local-6989586621679061249"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679061250"><a href="#local-6989586621679061250"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="#local-6989586621679061237"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061243"><span class="hs-identifier hs-var">sp</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061251"><span class="hs-identifier hs-var">sx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061238"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679061248"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061247"><span class="hs-identifier hs-var">sxyz</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061251"><span class="hs-identifier hs-var">sx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061249"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679061250"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061240"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061241"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679061242"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2654"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061251"><a href="#local-6989586621679061251"><span class="hs-identifier">sx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061248"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-2655"></a><span class="hs-identifier">delRebuildLeftSide</span><span> </span><a name="local-6989586621679061252"><a href="#local-6989586621679061252"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679061253"><a href="#local-6989586621679061253"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679061254"><a href="#local-6989586621679061254"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679061255"><a href="#local-6989586621679061255"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679061256"><a href="#local-6989586621679061256"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679061257"><a href="#local-6989586621679061257"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679061258"><a href="#local-6989586621679061258"><span class="hs-identifier">sf</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061259"><a href="#local-6989586621679061259"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061253"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061254"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2656"></a><span>  </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a name="local-6989586621679061260"><a href="#local-6989586621679061260"><span class="hs-identifier">sxy</span></a></a><span> </span><a name="local-6989586621679061261"><a href="#local-6989586621679061261"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061262"><a href="#local-6989586621679061262"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="#local-6989586621679061252"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061259"><span class="hs-identifier hs-var">sp</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061260"><span class="hs-identifier hs-var">sxy</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061253"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679061261"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061262"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061255"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679061256"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061257"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679061258"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2657"></a><span>  </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a name="local-6989586621679061263"><a href="#local-6989586621679061263"><span class="hs-identifier">sxyz</span></a></a><span> </span><a name="local-6989586621679061264"><a href="#local-6989586621679061264"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061265"><a href="#local-6989586621679061265"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679061266"><a href="#local-6989586621679061266"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="#local-6989586621679061252"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061259"><span class="hs-identifier hs-var">sp</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061267"><span class="hs-identifier hs-var">sx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061253"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679061264"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061263"><span class="hs-identifier hs-var">sxyz</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061267"><span class="hs-identifier hs-var">sx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061265"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679061266"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061255"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679061256"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061257"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679061258"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2658"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061267"><a href="#local-6989586621679061267"><span class="hs-identifier">sx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061264"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-2659"></a><span>
</span><a name="line-2660"></a><span class="hs-identifier">delRebuildRightSide</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a><span> </span><a href="#local-6989586621679058932"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2661"></a><span>                    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679058932"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679058932"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679058932"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058932"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2662"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679058932"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-2663"></a><a name="delRebuildRightSide"><a href="Data.Sequence.Internal.html#delRebuildRightSide"><span class="hs-identifier">delRebuildRightSide</span></a></a><span> </span><a name="local-6989586621679061268"><a href="#local-6989586621679061268"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679061269"><a href="#local-6989586621679061269"><span class="hs-identifier">pr</span></a></a><span> </span><a name="local-6989586621679061270"><a href="#local-6989586621679061270"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679061271"><a href="#local-6989586621679061271"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679061272"><a href="#local-6989586621679061272"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679061273"><a href="#local-6989586621679061273"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061274"><a href="#local-6989586621679061274"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061273"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061272"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2664"></a><span>  </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a name="local-6989586621679061275"><a href="#local-6989586621679061275"><span class="hs-identifier">sxy</span></a></a><span> </span><a name="local-6989586621679061276"><a href="#local-6989586621679061276"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061277"><a href="#local-6989586621679061277"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="#local-6989586621679061268"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679061269"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679061270"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679061271"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061275"><span class="hs-identifier hs-var">sxy</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061274"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061276"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061277"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679061273"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2665"></a><span>  </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a name="local-6989586621679061278"><a href="#local-6989586621679061278"><span class="hs-identifier">sxyz</span></a></a><span> </span><a name="local-6989586621679061279"><a href="#local-6989586621679061279"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061280"><a href="#local-6989586621679061280"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679061281"><a href="#local-6989586621679061281"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="#local-6989586621679061268"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679061269"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679061270"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679061271"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061278"><span class="hs-identifier hs-var">sxyz</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061282"><span class="hs-identifier hs-var">sz</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061279"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061280"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061282"><span class="hs-identifier hs-var">sz</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061274"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061281"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679061273"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2666"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061282"><a href="#local-6989586621679061282"><span class="hs-identifier">sz</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061281"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-2667"></a><span class="hs-identifier">delRebuildRightSide</span><span> </span><a name="local-6989586621679061283"><a href="#local-6989586621679061283"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679061284"><a href="#local-6989586621679061284"><span class="hs-identifier">pr</span></a></a><span> </span><a name="local-6989586621679061285"><a href="#local-6989586621679061285"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679061286"><a href="#local-6989586621679061286"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679061287"><a href="#local-6989586621679061287"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679061288"><a href="#local-6989586621679061288"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679061289"><a href="#local-6989586621679061289"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061290"><a href="#local-6989586621679061290"><span class="hs-identifier">sp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061289"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061288"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2668"></a><span>  </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a name="local-6989586621679061291"><a href="#local-6989586621679061291"><span class="hs-identifier">sxy</span></a></a><span> </span><a name="local-6989586621679061292"><a href="#local-6989586621679061292"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061293"><a href="#local-6989586621679061293"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="#local-6989586621679061283"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679061284"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679061285"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679061286"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679061287"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061291"><span class="hs-identifier hs-var">sxy</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061290"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061292"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061293"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679061289"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2669"></a><span>  </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a name="local-6989586621679061294"><a href="#local-6989586621679061294"><span class="hs-identifier">sxyz</span></a></a><span> </span><a name="local-6989586621679061295"><a href="#local-6989586621679061295"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061296"><a href="#local-6989586621679061296"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679061297"><a href="#local-6989586621679061297"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="#local-6989586621679061283"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679061284"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679061285"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a href="#local-6989586621679061286"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679061287"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061294"><span class="hs-identifier hs-var">sxyz</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061298"><span class="hs-identifier hs-var">sz</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061295"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061296"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061298"><span class="hs-identifier hs-var">sz</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061290"><span class="hs-identifier hs-var">sp</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061297"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679061289"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2670"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061298"><a href="#local-6989586621679061298"><span class="hs-identifier">sz</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061297"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-2671"></a><span>
</span><a name="line-2672"></a><span class="hs-identifier">delRebuildMiddle</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a><span> </span><a href="#local-6989586621679058931"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2673"></a><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><a href="#local-6989586621679058931"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058931"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><a href="#local-6989586621679058931"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2674"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><a href="#local-6989586621679058931"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2675"></a><a name="delRebuildMiddle"><a href="Data.Sequence.Internal.html#delRebuildMiddle"><span class="hs-identifier">delRebuildMiddle</span></a></a><span> </span><a name="local-6989586621679061299"><a href="#local-6989586621679061299"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679061300"><a href="#local-6989586621679061300"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679061301"><a href="#local-6989586621679061301"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679061302"><a href="#local-6989586621679061302"><span class="hs-identifier">sf</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="#local-6989586621679061299"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679061300"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679061301"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><a href="#local-6989586621679061302"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2676"></a><span class="hs-identifier">delRebuildMiddle</span><span> </span><a name="local-6989586621679061303"><a href="#local-6989586621679061303"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679061304"><a href="#local-6989586621679061304"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679061305"><a href="#local-6989586621679061305"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679061306"><a href="#local-6989586621679061306"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679061307"><a href="#local-6989586621679061307"><span class="hs-identifier">sf</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="#local-6989586621679061303"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679061304"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679061305"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679061306"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><a href="#local-6989586621679061307"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2677"></a><span class="hs-identifier">delRebuildMiddle</span><span> </span><a name="local-6989586621679061308"><a href="#local-6989586621679061308"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679061309"><a href="#local-6989586621679061309"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679061310"><a href="#local-6989586621679061310"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679061311"><a href="#local-6989586621679061311"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679061312"><a href="#local-6989586621679061312"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679061313"><a href="#local-6989586621679061313"><span class="hs-identifier">sf</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="#local-6989586621679061308"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a href="#local-6989586621679061309"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679061310"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679061311"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679061312"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><a href="#local-6989586621679061313"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2678"></a><span class="hs-identifier">delRebuildMiddle</span><span> </span><a name="local-6989586621679061314"><a href="#local-6989586621679061314"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679061315"><a href="#local-6989586621679061315"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679061316"><a href="#local-6989586621679061316"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679061317"><a href="#local-6989586621679061317"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679061318"><a href="#local-6989586621679061318"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679061319"><a href="#local-6989586621679061319"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679061320"><a href="#local-6989586621679061320"><span class="hs-identifier">sf</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="#local-6989586621679061314"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679061315"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679061316"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#node3"><span class="hs-identifier hs-var">node3</span></a><span> </span><a href="#local-6989586621679061317"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679061318"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679061319"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061320"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2679"></a><span>
</span><a name="line-2680"></a><span class="hs-keyword">data</span><span> </span><a name="DelDig"><a href="Data.Sequence.Internal.html#DelDig"><span class="hs-identifier">DelDig</span></a></a><span> </span><a name="local-6989586621679058038"><a href="#local-6989586621679058038"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="FullDig"><a href="Data.Sequence.Internal.html#FullDig"><span class="hs-identifier">FullDig</span></a></a><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679058038"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="DefectDig"><a href="Data.Sequence.Internal.html#DefectDig"><span class="hs-identifier">DefectDig</span></a></a><span> </span><a href="#local-6989586621679058038"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2681"></a><span>
</span><a name="line-2682"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">delDigit</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Del</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Digit</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">DelDig</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2683"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">delDigit</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Del</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Digit</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">DelDig</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2684"></a><span class="hs-identifier">delDigit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a><span> </span><a href="#local-6989586621679058928"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679058928"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Del"><span class="hs-identifier hs-type">Del</span></a><span> </span><a href="#local-6989586621679058928"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679058928"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#DelDig"><span class="hs-identifier hs-type">DelDig</span></a><span> </span><a href="#local-6989586621679058928"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-2685"></a><a name="delDigit"><a href="Data.Sequence.Internal.html#delDigit"><span class="hs-identifier">delDigit</span></a></a><span> </span><a name="local-6989586621679061321"><a href="#local-6989586621679061321"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061322"><a href="#local-6989586621679061322"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679061323"><a href="#local-6989586621679061323"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061321"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679061322"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679061323"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2686"></a><span>  </span><a href="Data.Sequence.Internal.html#Full"><span class="hs-identifier hs-var">Full</span></a><span> </span><a name="local-6989586621679061324"><a href="#local-6989586621679061324"><span class="hs-identifier">a'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullDig"><span class="hs-identifier hs-var">FullDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a href="#local-6989586621679061324"><span class="hs-identifier hs-var">a'</span></a><span>
</span><a name="line-2687"></a><span>  </span><a href="Data.Sequence.Internal.html#Defect"><span class="hs-identifier hs-var">Defect</span></a><span> </span><a name="local-6989586621679061325"><a href="#local-6989586621679061325"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#DefectDig"><span class="hs-identifier hs-var">DefectDig</span></a><span> </span><a href="#local-6989586621679061325"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-2688"></a><span class="hs-identifier">delDigit</span><span> </span><a name="local-6989586621679061326"><a href="#local-6989586621679061326"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679061327"><a href="#local-6989586621679061327"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679061328"><a href="#local-6989586621679061328"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679061329"><a href="#local-6989586621679061329"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2689"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679061327"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679061330"><span class="hs-identifier hs-var">sa</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061326"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679061327"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679061328"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2690"></a><span>     </span><a href="Data.Sequence.Internal.html#Full"><span class="hs-identifier hs-var">Full</span></a><span> </span><a name="local-6989586621679061331"><a href="#local-6989586621679061331"><span class="hs-identifier">a'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullDig"><span class="hs-identifier hs-var">FullDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679061331"><span class="hs-identifier hs-var">a'</span></a><span> </span><a href="#local-6989586621679061329"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2691"></a><span>     </span><a href="Data.Sequence.Internal.html#Defect"><span class="hs-identifier hs-var">Defect</span></a><span> </span><a name="local-6989586621679061332"><a href="#local-6989586621679061332"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061333"><a href="#local-6989586621679061333"><span class="hs-identifier">se</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061332"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061329"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2692"></a><span>       </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a name="local-6989586621679061334"><a href="#local-6989586621679061334"><span class="hs-identifier">sxyz</span></a></a><span> </span><a name="local-6989586621679061335"><a href="#local-6989586621679061335"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061336"><a href="#local-6989586621679061336"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679061337"><a href="#local-6989586621679061337"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullDig"><span class="hs-identifier hs-var">FullDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061333"><span class="hs-identifier hs-var">se</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061338"><span class="hs-identifier hs-var">sx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061332"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679061335"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061334"><span class="hs-identifier hs-var">sxyz</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061338"><span class="hs-identifier hs-var">sx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061336"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679061337"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-2693"></a><span>         </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061338"><a href="#local-6989586621679061338"><span class="hs-identifier">sx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061335"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-2694"></a><span>       </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a name="local-6989586621679061339"><a href="#local-6989586621679061339"><span class="hs-identifier">sxy</span></a></a><span> </span><a name="local-6989586621679061340"><a href="#local-6989586621679061340"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061341"><a href="#local-6989586621679061341"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullDig"><span class="hs-identifier hs-var">FullDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061333"><span class="hs-identifier hs-var">se</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061339"><span class="hs-identifier hs-var">sxy</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061332"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679061340"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061341"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-2695"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061326"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061327"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061330"><span class="hs-identifier hs-var">sa</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061329"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2696"></a><span>     </span><a href="Data.Sequence.Internal.html#Full"><span class="hs-identifier hs-var">Full</span></a><span> </span><a name="local-6989586621679061342"><a href="#local-6989586621679061342"><span class="hs-identifier">b'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullDig"><span class="hs-identifier hs-var">FullDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679061328"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679061342"><span class="hs-identifier hs-var">b'</span></a><span>
</span><a name="line-2697"></a><span>     </span><a href="Data.Sequence.Internal.html#Defect"><span class="hs-identifier hs-var">Defect</span></a><span> </span><a name="local-6989586621679061343"><a href="#local-6989586621679061343"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061344"><a href="#local-6989586621679061344"><span class="hs-identifier">se</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061343"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061328"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2698"></a><span>       </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a name="local-6989586621679061345"><a href="#local-6989586621679061345"><span class="hs-identifier">sxyz</span></a></a><span> </span><a name="local-6989586621679061346"><a href="#local-6989586621679061346"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061347"><a href="#local-6989586621679061347"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679061348"><a href="#local-6989586621679061348"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullDig"><span class="hs-identifier hs-var">FullDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061345"><span class="hs-identifier hs-var">sxyz</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061349"><span class="hs-identifier hs-var">sz</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061346"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061347"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061349"><span class="hs-identifier hs-var">sz</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061344"><span class="hs-identifier hs-var">se</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061348"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679061343"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-2699"></a><span>         </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061349"><a href="#local-6989586621679061349"><span class="hs-identifier">sz</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061348"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-2700"></a><span>       </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a name="local-6989586621679061350"><a href="#local-6989586621679061350"><span class="hs-identifier">sxy</span></a></a><span> </span><a name="local-6989586621679061351"><a href="#local-6989586621679061351"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061352"><a href="#local-6989586621679061352"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullDig"><span class="hs-identifier hs-var">FullDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061350"><span class="hs-identifier hs-var">sxy</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061344"><span class="hs-identifier hs-var">se</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061351"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061352"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679061343"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-2701"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679061330"><a href="#local-6989586621679061330"><span class="hs-identifier">sa</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061328"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2702"></a><span class="hs-identifier">delDigit</span><span> </span><a name="local-6989586621679061353"><a href="#local-6989586621679061353"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679061354"><a href="#local-6989586621679061354"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679061355"><a href="#local-6989586621679061355"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679061356"><a href="#local-6989586621679061356"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679061357"><a href="#local-6989586621679061357"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2703"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679061354"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679061358"><span class="hs-identifier hs-var">sa</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061353"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679061354"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679061355"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2704"></a><span>     </span><a href="Data.Sequence.Internal.html#Full"><span class="hs-identifier hs-var">Full</span></a><span> </span><a name="local-6989586621679061360"><a href="#local-6989586621679061360"><span class="hs-identifier">a'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullDig"><span class="hs-identifier hs-var">FullDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679061360"><span class="hs-identifier hs-var">a'</span></a><span> </span><a href="#local-6989586621679061356"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679061357"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2705"></a><span>     </span><a href="Data.Sequence.Internal.html#Defect"><span class="hs-identifier hs-var">Defect</span></a><span> </span><a name="local-6989586621679061361"><a href="#local-6989586621679061361"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061362"><a href="#local-6989586621679061362"><span class="hs-identifier">se</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061361"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061356"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2706"></a><span>       </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a name="local-6989586621679061363"><a href="#local-6989586621679061363"><span class="hs-identifier">sxyz</span></a></a><span> </span><a name="local-6989586621679061364"><a href="#local-6989586621679061364"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061365"><a href="#local-6989586621679061365"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679061366"><a href="#local-6989586621679061366"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullDig"><span class="hs-identifier hs-var">FullDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061362"><span class="hs-identifier hs-var">se</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061367"><span class="hs-identifier hs-var">sx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061361"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679061364"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061363"><span class="hs-identifier hs-var">sxyz</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061367"><span class="hs-identifier hs-var">sx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061365"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679061366"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061357"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2707"></a><span>         </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061367"><a href="#local-6989586621679061367"><span class="hs-identifier">sx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061364"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-2708"></a><span>       </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a name="local-6989586621679061368"><a href="#local-6989586621679061368"><span class="hs-identifier">sxy</span></a></a><span> </span><a name="local-6989586621679061369"><a href="#local-6989586621679061369"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061370"><a href="#local-6989586621679061370"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullDig"><span class="hs-identifier hs-var">FullDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061362"><span class="hs-identifier hs-var">se</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061368"><span class="hs-identifier hs-var">sxy</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061361"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679061369"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061370"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061357"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2709"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679061354"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679061359"><span class="hs-identifier hs-var">sab</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061353"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061354"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061358"><span class="hs-identifier hs-var">sa</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061356"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2710"></a><span>     </span><a href="Data.Sequence.Internal.html#Full"><span class="hs-identifier hs-var">Full</span></a><span> </span><a name="local-6989586621679061371"><a href="#local-6989586621679061371"><span class="hs-identifier">b'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullDig"><span class="hs-identifier hs-var">FullDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679061355"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679061371"><span class="hs-identifier hs-var">b'</span></a><span> </span><a href="#local-6989586621679061357"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2711"></a><span>     </span><a href="Data.Sequence.Internal.html#Defect"><span class="hs-identifier hs-var">Defect</span></a><span> </span><a name="local-6989586621679061372"><a href="#local-6989586621679061372"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061373"><a href="#local-6989586621679061373"><span class="hs-identifier">se</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061372"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061355"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2712"></a><span>       </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a name="local-6989586621679061374"><a href="#local-6989586621679061374"><span class="hs-identifier">sxyz</span></a></a><span> </span><a name="local-6989586621679061375"><a href="#local-6989586621679061375"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061376"><a href="#local-6989586621679061376"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679061377"><a href="#local-6989586621679061377"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullDig"><span class="hs-identifier hs-var">FullDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061374"><span class="hs-identifier hs-var">sxyz</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061378"><span class="hs-identifier hs-var">sz</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061375"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061376"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061378"><span class="hs-identifier hs-var">sz</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061373"><span class="hs-identifier hs-var">se</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061377"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679061372"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061357"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2713"></a><span>         </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061378"><a href="#local-6989586621679061378"><span class="hs-identifier">sz</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061377"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-2714"></a><span>       </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a name="local-6989586621679061379"><a href="#local-6989586621679061379"><span class="hs-identifier">sxy</span></a></a><span> </span><a name="local-6989586621679061380"><a href="#local-6989586621679061380"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061381"><a href="#local-6989586621679061381"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullDig"><span class="hs-identifier hs-var">FullDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061379"><span class="hs-identifier hs-var">sxy</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061373"><span class="hs-identifier hs-var">se</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061380"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061381"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679061372"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061357"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2715"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061353"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061354"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061359"><span class="hs-identifier hs-var">sab</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061357"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2716"></a><span>     </span><a href="Data.Sequence.Internal.html#Full"><span class="hs-identifier hs-var">Full</span></a><span> </span><a name="local-6989586621679061382"><a href="#local-6989586621679061382"><span class="hs-identifier">c'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullDig"><span class="hs-identifier hs-var">FullDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679061355"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679061356"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679061382"><span class="hs-identifier hs-var">c'</span></a><span>
</span><a name="line-2717"></a><span>     </span><a href="Data.Sequence.Internal.html#Defect"><span class="hs-identifier hs-var">Defect</span></a><span> </span><a name="local-6989586621679061383"><a href="#local-6989586621679061383"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061384"><a href="#local-6989586621679061384"><span class="hs-identifier">se</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061383"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061356"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2718"></a><span>       </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a name="local-6989586621679061385"><a href="#local-6989586621679061385"><span class="hs-identifier">sxyz</span></a></a><span> </span><a name="local-6989586621679061386"><a href="#local-6989586621679061386"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061387"><a href="#local-6989586621679061387"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679061388"><a href="#local-6989586621679061388"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullDig"><span class="hs-identifier hs-var">FullDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679061355"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061385"><span class="hs-identifier hs-var">sxyz</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061389"><span class="hs-identifier hs-var">sz</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061386"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061387"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061389"><span class="hs-identifier hs-var">sz</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061384"><span class="hs-identifier hs-var">se</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061388"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679061383"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-2719"></a><span>         </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061389"><a href="#local-6989586621679061389"><span class="hs-identifier">sz</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061388"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-2720"></a><span>       </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a name="local-6989586621679061390"><a href="#local-6989586621679061390"><span class="hs-identifier">sxy</span></a></a><span> </span><a name="local-6989586621679061391"><a href="#local-6989586621679061391"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061392"><a href="#local-6989586621679061392"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullDig"><span class="hs-identifier hs-var">FullDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679061355"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061390"><span class="hs-identifier hs-var">sxy</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061384"><span class="hs-identifier hs-var">se</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061391"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061392"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679061383"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-2721"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679061358"><a href="#local-6989586621679061358"><span class="hs-identifier">sa</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061355"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2722"></a><span>        </span><a name="local-6989586621679061359"><a href="#local-6989586621679061359"><span class="hs-identifier">sab</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679061358"><span class="hs-identifier hs-var">sa</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061356"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2723"></a><span class="hs-identifier">delDigit</span><span> </span><a name="local-6989586621679061393"><a href="#local-6989586621679061393"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679061394"><a href="#local-6989586621679061394"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679061395"><a href="#local-6989586621679061395"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679061396"><a href="#local-6989586621679061396"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679061397"><a href="#local-6989586621679061397"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679061398"><a href="#local-6989586621679061398"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2724"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679061394"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679061399"><span class="hs-identifier hs-var">sa</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061393"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679061394"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679061395"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2725"></a><span>     </span><a href="Data.Sequence.Internal.html#Full"><span class="hs-identifier hs-var">Full</span></a><span> </span><a name="local-6989586621679061402"><a href="#local-6989586621679061402"><span class="hs-identifier">a'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullDig"><span class="hs-identifier hs-var">FullDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a href="#local-6989586621679061402"><span class="hs-identifier hs-var">a'</span></a><span> </span><a href="#local-6989586621679061396"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679061397"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679061398"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-2726"></a><span>     </span><a href="Data.Sequence.Internal.html#Defect"><span class="hs-identifier hs-var">Defect</span></a><span> </span><a name="local-6989586621679061403"><a href="#local-6989586621679061403"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061404"><a href="#local-6989586621679061404"><span class="hs-identifier">se</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061403"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061396"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2727"></a><span>       </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a name="local-6989586621679061405"><a href="#local-6989586621679061405"><span class="hs-identifier">sxyz</span></a></a><span> </span><a name="local-6989586621679061406"><a href="#local-6989586621679061406"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061407"><a href="#local-6989586621679061407"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679061408"><a href="#local-6989586621679061408"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullDig"><span class="hs-identifier hs-var">FullDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061404"><span class="hs-identifier hs-var">se</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061409"><span class="hs-identifier hs-var">sx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061403"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679061406"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061405"><span class="hs-identifier hs-var">sxyz</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061409"><span class="hs-identifier hs-var">sx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061407"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679061408"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061397"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679061398"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-2728"></a><span>         </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061409"><a href="#local-6989586621679061409"><span class="hs-identifier">sx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061406"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-2729"></a><span>       </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a name="local-6989586621679061410"><a href="#local-6989586621679061410"><span class="hs-identifier">sxy</span></a></a><span> </span><a name="local-6989586621679061411"><a href="#local-6989586621679061411"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061412"><a href="#local-6989586621679061412"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullDig"><span class="hs-identifier hs-var">FullDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061404"><span class="hs-identifier hs-var">se</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061410"><span class="hs-identifier hs-var">sxy</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061403"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679061411"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061412"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061397"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679061398"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-2730"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679061394"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679061400"><span class="hs-identifier hs-var">sab</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061393"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061394"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061399"><span class="hs-identifier hs-var">sa</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061396"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2731"></a><span>     </span><a href="Data.Sequence.Internal.html#Full"><span class="hs-identifier hs-var">Full</span></a><span> </span><a name="local-6989586621679061413"><a href="#local-6989586621679061413"><span class="hs-identifier">b'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullDig"><span class="hs-identifier hs-var">FullDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a href="#local-6989586621679061395"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679061413"><span class="hs-identifier hs-var">b'</span></a><span> </span><a href="#local-6989586621679061397"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679061398"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-2732"></a><span>     </span><a href="Data.Sequence.Internal.html#Defect"><span class="hs-identifier hs-var">Defect</span></a><span> </span><a name="local-6989586621679061414"><a href="#local-6989586621679061414"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061415"><a href="#local-6989586621679061415"><span class="hs-identifier">se</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061414"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061395"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2733"></a><span>       </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a name="local-6989586621679061416"><a href="#local-6989586621679061416"><span class="hs-identifier">sxyz</span></a></a><span> </span><a name="local-6989586621679061417"><a href="#local-6989586621679061417"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061418"><a href="#local-6989586621679061418"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679061419"><a href="#local-6989586621679061419"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullDig"><span class="hs-identifier hs-var">FullDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061416"><span class="hs-identifier hs-var">sxyz</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061420"><span class="hs-identifier hs-var">sz</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061417"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061418"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061420"><span class="hs-identifier hs-var">sz</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061415"><span class="hs-identifier hs-var">se</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061419"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679061414"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061397"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679061398"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-2734"></a><span>         </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061420"><a href="#local-6989586621679061420"><span class="hs-identifier">sz</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061419"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-2735"></a><span>       </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a name="local-6989586621679061421"><a href="#local-6989586621679061421"><span class="hs-identifier">sxy</span></a></a><span> </span><a name="local-6989586621679061422"><a href="#local-6989586621679061422"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061423"><a href="#local-6989586621679061423"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullDig"><span class="hs-identifier hs-var">FullDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061421"><span class="hs-identifier hs-var">sxy</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061415"><span class="hs-identifier hs-var">se</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061422"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061423"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679061414"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061397"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679061398"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-2736"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679061394"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="#local-6989586621679061401"><span class="hs-identifier hs-var">sabc</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061393"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061394"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061400"><span class="hs-identifier hs-var">sab</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061397"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2737"></a><span>     </span><a href="Data.Sequence.Internal.html#Full"><span class="hs-identifier hs-var">Full</span></a><span> </span><a name="local-6989586621679061424"><a href="#local-6989586621679061424"><span class="hs-identifier">c'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullDig"><span class="hs-identifier hs-var">FullDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a href="#local-6989586621679061395"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679061396"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679061424"><span class="hs-identifier hs-var">c'</span></a><span> </span><a href="#local-6989586621679061398"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-2738"></a><span>     </span><a href="Data.Sequence.Internal.html#Defect"><span class="hs-identifier hs-var">Defect</span></a><span> </span><a name="local-6989586621679061425"><a href="#local-6989586621679061425"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061426"><a href="#local-6989586621679061426"><span class="hs-identifier">se</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061425"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061396"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2739"></a><span>       </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a name="local-6989586621679061427"><a href="#local-6989586621679061427"><span class="hs-identifier">sxyz</span></a></a><span> </span><a name="local-6989586621679061428"><a href="#local-6989586621679061428"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061429"><a href="#local-6989586621679061429"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679061430"><a href="#local-6989586621679061430"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullDig"><span class="hs-identifier hs-var">FullDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a href="#local-6989586621679061395"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061427"><span class="hs-identifier hs-var">sxyz</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061431"><span class="hs-identifier hs-var">sz</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061428"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061429"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061431"><span class="hs-identifier hs-var">sz</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061426"><span class="hs-identifier hs-var">se</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061430"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679061425"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061398"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-2740"></a><span>         </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061431"><a href="#local-6989586621679061431"><span class="hs-identifier">sz</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061430"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-2741"></a><span>       </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a name="local-6989586621679061432"><a href="#local-6989586621679061432"><span class="hs-identifier">sxy</span></a></a><span> </span><a name="local-6989586621679061433"><a href="#local-6989586621679061433"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061434"><a href="#local-6989586621679061434"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullDig"><span class="hs-identifier hs-var">FullDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679061395"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061432"><span class="hs-identifier hs-var">sxy</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061426"><span class="hs-identifier hs-var">se</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061433"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061434"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679061425"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061398"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-2742"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061393"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061394"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061401"><span class="hs-identifier hs-var">sabc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061398"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2743"></a><span>     </span><a href="Data.Sequence.Internal.html#Full"><span class="hs-identifier hs-var">Full</span></a><span> </span><a name="local-6989586621679061435"><a href="#local-6989586621679061435"><span class="hs-identifier">d'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullDig"><span class="hs-identifier hs-var">FullDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a href="#local-6989586621679061395"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679061396"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679061397"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679061435"><span class="hs-identifier hs-var">d'</span></a><span>
</span><a name="line-2744"></a><span>     </span><a href="Data.Sequence.Internal.html#Defect"><span class="hs-identifier hs-var">Defect</span></a><span> </span><a name="local-6989586621679061436"><a href="#local-6989586621679061436"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061437"><a href="#local-6989586621679061437"><span class="hs-identifier">se</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061436"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061397"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2745"></a><span>       </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a name="local-6989586621679061438"><a href="#local-6989586621679061438"><span class="hs-identifier">sxyz</span></a></a><span> </span><a name="local-6989586621679061439"><a href="#local-6989586621679061439"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061440"><a href="#local-6989586621679061440"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679061441"><a href="#local-6989586621679061441"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullDig"><span class="hs-identifier hs-var">FullDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a href="#local-6989586621679061395"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679061396"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061438"><span class="hs-identifier hs-var">sxyz</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061442"><span class="hs-identifier hs-var">sz</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061439"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061440"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061442"><span class="hs-identifier hs-var">sz</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061437"><span class="hs-identifier hs-var">se</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061441"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679061436"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-2746"></a><span>         </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061442"><a href="#local-6989586621679061442"><span class="hs-identifier">sz</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061441"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-2747"></a><span>       </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a name="local-6989586621679061443"><a href="#local-6989586621679061443"><span class="hs-identifier">sxy</span></a></a><span> </span><a name="local-6989586621679061444"><a href="#local-6989586621679061444"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679061445"><a href="#local-6989586621679061445"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FullDig"><span class="hs-identifier hs-var">FullDig</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679061395"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679061396"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061443"><span class="hs-identifier hs-var">sxy</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061437"><span class="hs-identifier hs-var">se</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061444"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679061445"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679061436"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-2748"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679061399"><a href="#local-6989586621679061399"><span class="hs-identifier">sa</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061395"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2749"></a><span>        </span><a name="local-6989586621679061400"><a href="#local-6989586621679061400"><span class="hs-identifier">sab</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679061399"><span class="hs-identifier hs-var">sa</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061396"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2750"></a><span>        </span><a name="local-6989586621679061401"><a href="#local-6989586621679061401"><span class="hs-identifier">sabc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679061400"><span class="hs-identifier hs-var">sab</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061397"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2751"></a><span>
</span><a name="line-2752"></a><span>
</span><a name="line-2753"></a><span class="hs-comment">-- | A generalization of 'fmap', 'mapWithIndex' takes a mapping</span><span>
</span><a name="line-2754"></a><span class="hs-comment">-- function that also depends on the element's index, and applies it to every</span><span>
</span><a name="line-2755"></a><span class="hs-comment">-- element in the sequence.</span><span>
</span><a name="line-2756"></a><span class="hs-identifier">mapWithIndex</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058926"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679058927"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679058926"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679058927"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-2757"></a><a name="mapWithIndex"><a href="Data.Sequence.Internal.html#mapWithIndex"><span class="hs-identifier">mapWithIndex</span></a></a><span> </span><a name="local-6989586621679061446"><a href="#local-6989586621679061446"><span class="hs-identifier">f'</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a name="local-6989586621679061447"><a href="#local-6989586621679061447"><span class="hs-identifier">xs'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-6989586621679061448"><span class="hs-identifier hs-var">mapWithIndexTree</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679061519"><a href="#local-6989586621679061519"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-var">Elem</span></a><span> </span><a name="local-6989586621679061520"><a href="#local-6989586621679061520"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-var">Elem</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061446"><span class="hs-identifier hs-var">f'</span></a><span> </span><a href="#local-6989586621679061519"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679061520"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679061447"><span class="hs-identifier hs-var">xs'</span></a><span>
</span><a name="line-2758"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2759"></a><span>  </span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">mapWithIndexTree</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">y</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">y</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">b</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2760"></a><span>  </span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">mapWithIndexTree</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">y</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">y</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">b</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2761"></a><span>  </span><span class="hs-identifier">mapWithIndexTree</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a><span> </span><a href="#local-6989586621679061455"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679061455"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679061456"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><a href="#local-6989586621679061455"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a><span> </span><a href="#local-6989586621679061456"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-2762"></a><span>  </span><a name="local-6989586621679061448"><a href="#local-6989586621679061448"><span class="hs-identifier">mapWithIndexTree</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061469"><a href="#local-6989586621679061469"><span class="hs-identifier">_s</span></a></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span>
</span><a name="line-2763"></a><span>  </span><span class="hs-identifier">mapWithIndexTree</span><span> </span><a name="local-6989586621679061470"><a href="#local-6989586621679061470"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679061471"><a href="#local-6989586621679061471"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><a name="local-6989586621679061472"><a href="#local-6989586621679061472"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-6989586621679061470"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679061471"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679061472"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-2764"></a><span>  </span><span class="hs-identifier">mapWithIndexTree</span><span> </span><a name="local-6989586621679061473"><a href="#local-6989586621679061473"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679061474"><a href="#local-6989586621679061474"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a name="local-6989586621679061475"><a href="#local-6989586621679061475"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679061476"><a href="#local-6989586621679061476"><span class="hs-identifier">pr</span></a></a><span> </span><a name="local-6989586621679061477"><a href="#local-6989586621679061477"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679061478"><a href="#local-6989586621679061478"><span class="hs-identifier">sf</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2765"></a><span>          </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="#local-6989586621679061475"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-2766"></a><span>               </span><span class="hs-special">(</span><a href="#local-6989586621679061449"><span class="hs-identifier hs-var">mapWithIndexDigit</span></a><span> </span><a href="#local-6989586621679061473"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679061474"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679061476"><span class="hs-identifier hs-var">pr</span></a><span class="hs-special">)</span><span>
</span><a name="line-2767"></a><span>               </span><span class="hs-special">(</span><a href="#local-6989586621679061448"><span class="hs-identifier hs-var">mapWithIndexTree</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061450"><span class="hs-identifier hs-var">mapWithIndexNode</span></a><span> </span><a href="#local-6989586621679061473"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061479"><span class="hs-identifier hs-var">sPspr</span></a><span> </span><a href="#local-6989586621679061477"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-2768"></a><span>               </span><span class="hs-special">(</span><a href="#local-6989586621679061449"><span class="hs-identifier hs-var">mapWithIndexDigit</span></a><span> </span><a href="#local-6989586621679061473"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679061480"><span class="hs-identifier hs-var">sPsprm</span></a><span> </span><a href="#local-6989586621679061478"><span class="hs-identifier hs-var">sf</span></a><span class="hs-special">)</span><span>
</span><a name="line-2769"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2770"></a><span>      </span><span class="hs-glyph">!</span><a name="local-6989586621679061479"><a href="#local-6989586621679061479"><span class="hs-identifier">sPspr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679061474"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061476"><span class="hs-identifier hs-var">pr</span></a><span>
</span><a name="line-2771"></a><span>      </span><span class="hs-glyph">!</span><a name="local-6989586621679061480"><a href="#local-6989586621679061480"><span class="hs-identifier">sPsprm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679061479"><span class="hs-identifier hs-var">sPspr</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061477"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-2772"></a><span>
</span><a name="line-2773"></a><span>  </span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">mapWithIndexDigit</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">y</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Digit</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">y</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Digit</span><span> </span><span class="hs-pragma">b</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2774"></a><span>  </span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">mapWithIndexDigit</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">y</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Digit</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">y</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Digit</span><span> </span><span class="hs-pragma">b</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2775"></a><span>  </span><span class="hs-identifier">mapWithIndexDigit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a><span> </span><a href="#local-6989586621679061461"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679061461"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679061462"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><a href="#local-6989586621679061461"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><a href="#local-6989586621679061462"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-2776"></a><span>  </span><a name="local-6989586621679061449"><a href="#local-6989586621679061449"><span class="hs-identifier">mapWithIndexDigit</span></a></a><span> </span><a name="local-6989586621679061481"><a href="#local-6989586621679061481"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679061482"><a href="#local-6989586621679061482"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><a name="local-6989586621679061483"><a href="#local-6989586621679061483"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061481"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679061482"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679061483"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-2777"></a><span>  </span><span class="hs-identifier">mapWithIndexDigit</span><span> </span><a name="local-6989586621679061484"><a href="#local-6989586621679061484"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679061485"><a href="#local-6989586621679061485"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a name="local-6989586621679061486"><a href="#local-6989586621679061486"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679061487"><a href="#local-6989586621679061487"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061484"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679061485"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679061486"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061484"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679061488"><span class="hs-identifier hs-var">sPsa</span></a><span> </span><a href="#local-6989586621679061487"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-2778"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2779"></a><span>      </span><span class="hs-glyph">!</span><a name="local-6989586621679061488"><a href="#local-6989586621679061488"><span class="hs-identifier">sPsa</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679061485"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061486"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2780"></a><span>  </span><span class="hs-identifier">mapWithIndexDigit</span><span> </span><a name="local-6989586621679061489"><a href="#local-6989586621679061489"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679061490"><a href="#local-6989586621679061490"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a name="local-6989586621679061491"><a href="#local-6989586621679061491"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679061492"><a href="#local-6989586621679061492"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679061493"><a href="#local-6989586621679061493"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2781"></a><span>                                      </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061489"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679061490"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679061491"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061489"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679061494"><span class="hs-identifier hs-var">sPsa</span></a><span> </span><a href="#local-6989586621679061492"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061489"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679061495"><span class="hs-identifier hs-var">sPsab</span></a><span> </span><a href="#local-6989586621679061493"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-2782"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2783"></a><span>      </span><span class="hs-glyph">!</span><a name="local-6989586621679061494"><a href="#local-6989586621679061494"><span class="hs-identifier">sPsa</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679061490"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061491"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2784"></a><span>      </span><span class="hs-glyph">!</span><a name="local-6989586621679061495"><a href="#local-6989586621679061495"><span class="hs-identifier">sPsab</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679061494"><span class="hs-identifier hs-var">sPsa</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061492"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2785"></a><span>  </span><span class="hs-identifier">mapWithIndexDigit</span><span> </span><a name="local-6989586621679061496"><a href="#local-6989586621679061496"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679061497"><a href="#local-6989586621679061497"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a name="local-6989586621679061498"><a href="#local-6989586621679061498"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679061499"><a href="#local-6989586621679061499"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679061500"><a href="#local-6989586621679061500"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679061501"><a href="#local-6989586621679061501"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2786"></a><span>                          </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061496"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679061497"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679061498"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061496"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679061502"><span class="hs-identifier hs-var">sPsa</span></a><span> </span><a href="#local-6989586621679061499"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061496"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679061503"><span class="hs-identifier hs-var">sPsab</span></a><span> </span><a href="#local-6989586621679061500"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061496"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679061504"><span class="hs-identifier hs-var">sPsabc</span></a><span> </span><a href="#local-6989586621679061501"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-2787"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2788"></a><span>      </span><span class="hs-glyph">!</span><a name="local-6989586621679061502"><a href="#local-6989586621679061502"><span class="hs-identifier">sPsa</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679061497"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061498"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2789"></a><span>      </span><span class="hs-glyph">!</span><a name="local-6989586621679061503"><a href="#local-6989586621679061503"><span class="hs-identifier">sPsab</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679061502"><span class="hs-identifier hs-var">sPsa</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061499"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2790"></a><span>      </span><span class="hs-glyph">!</span><a name="local-6989586621679061504"><a href="#local-6989586621679061504"><span class="hs-identifier">sPsabc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679061503"><span class="hs-identifier hs-var">sPsab</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061500"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-2791"></a><span>
</span><a name="line-2792"></a><span>  </span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">mapWithIndexNode</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">y</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">y</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">b</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2793"></a><span>  </span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">mapWithIndexNode</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">y</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Int</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">y</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">b</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2794"></a><span>  </span><span class="hs-identifier">mapWithIndexNode</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">Sized</span></a><span> </span><a href="#local-6989586621679061467"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679061467"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679061468"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679061467"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679061468"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-2795"></a><span>  </span><a name="local-6989586621679061450"><a href="#local-6989586621679061450"><span class="hs-identifier">mapWithIndexNode</span></a></a><span> </span><a name="local-6989586621679061505"><a href="#local-6989586621679061505"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679061506"><a href="#local-6989586621679061506"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a name="local-6989586621679061507"><a href="#local-6989586621679061507"><span class="hs-identifier">ns</span></a></a><span> </span><a name="local-6989586621679061508"><a href="#local-6989586621679061508"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679061509"><a href="#local-6989586621679061509"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a href="#local-6989586621679061507"><span class="hs-identifier hs-var">ns</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061505"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679061506"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679061508"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061505"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679061510"><span class="hs-identifier hs-var">sPsa</span></a><span> </span><a href="#local-6989586621679061509"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-2796"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2797"></a><span>      </span><span class="hs-glyph">!</span><a name="local-6989586621679061510"><a href="#local-6989586621679061510"><span class="hs-identifier">sPsa</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679061506"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061508"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2798"></a><span>  </span><span class="hs-identifier">mapWithIndexNode</span><span> </span><a name="local-6989586621679061511"><a href="#local-6989586621679061511"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679061512"><a href="#local-6989586621679061512"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a name="local-6989586621679061513"><a href="#local-6989586621679061513"><span class="hs-identifier">ns</span></a></a><span> </span><a name="local-6989586621679061514"><a href="#local-6989586621679061514"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679061515"><a href="#local-6989586621679061515"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679061516"><a href="#local-6989586621679061516"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2799"></a><span>                                     </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a href="#local-6989586621679061513"><span class="hs-identifier hs-var">ns</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061511"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679061512"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679061514"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061511"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679061517"><span class="hs-identifier hs-var">sPsa</span></a><span> </span><a href="#local-6989586621679061515"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061511"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679061518"><span class="hs-identifier hs-var">sPsab</span></a><span> </span><a href="#local-6989586621679061516"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-2800"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2801"></a><span>      </span><span class="hs-glyph">!</span><a name="local-6989586621679061517"><a href="#local-6989586621679061517"><span class="hs-identifier">sPsa</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679061512"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061514"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-2802"></a><span>      </span><span class="hs-glyph">!</span><a name="local-6989586621679061518"><a href="#local-6989586621679061518"><span class="hs-identifier">sPsab</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679061517"><span class="hs-identifier hs-var">sPsa</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061515"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2803"></a><span>
</span><a name="line-2804"></a><span class="hs-cpp">#ifdef __GLASGOW_HASKELL__
</span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">mapWithIndex</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2806"></a><span class="hs-pragma">{-# RULES</span><span>
</span><a name="line-2807"></a><span class="hs-pragma">&quot;mapWithIndex/mapWithIndex&quot;</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">mapWithIndex</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">mapWithIndex</span><span> </span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">xs</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span>
</span><a name="line-2808"></a><span>  </span><span class="hs-pragma">mapWithIndex</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span class="hs-pragma">k</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">k</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">k</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">xs</span><span>
</span><a name="line-2809"></a><span class="hs-pragma">&quot;mapWithIndex/fmapSeq&quot;</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">mapWithIndex</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">fmapSeq</span><span> </span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">xs</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span>
</span><a name="line-2810"></a><span>  </span><span class="hs-pragma">mapWithIndex</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span class="hs-pragma">k</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">k</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">xs</span><span>
</span><a name="line-2811"></a><span class="hs-pragma">&quot;fmapSeq/mapWithIndex&quot;</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">fmapSeq</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">mapWithIndex</span><span> </span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">xs</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span>
</span><a name="line-2812"></a><span>  </span><span class="hs-pragma">mapWithIndex</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span class="hs-pragma">k</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">k</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">xs</span><span>
</span><a name="line-2813"></a><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2814"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-2816"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">foldWithIndexDigit</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2817"></a><span class="hs-identifier">foldWithIndexDigit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Sized</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-2818"></a><span class="hs-identifier">foldWithIndexDigit</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">!</span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-2819"></a><a name="foldWithIndexDigit"><a href="Data.Sequence.Internal.html#foldWithIndexDigit"><span class="hs-identifier">foldWithIndexDigit</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-operator">&lt;+&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">f</span><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><a href="#local-6989586621679061521"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">sPsa</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-2820"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2821"></a><span>    </span><span class="hs-glyph">!</span><span class="hs-identifier">sPsa</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-2822"></a><span class="hs-identifier">foldWithIndexDigit</span><span> </span><span class="hs-special">(</span><span class="hs-operator">&lt;+&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">sPsa</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">sPsab</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-2823"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2824"></a><span>    </span><span class="hs-glyph">!</span><span class="hs-identifier">sPsa</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-2825"></a><span>    </span><span class="hs-glyph">!</span><span class="hs-identifier">sPsab</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sPsa</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-2826"></a><span class="hs-identifier">foldWithIndexDigit</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#size"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061534"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2827"></a><span>    </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">sPsa</span><span> </span><a name="local-6989586621679061538"><a href="#local-6989586621679061538"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><a name="local-6989586621679061540"><a href="#local-6989586621679061540"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-identifier">sPsab</span><span> </span><a name="local-6989586621679061541"><a href="#local-6989586621679061541"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><a name="local-6989586621679061544"><a href="#local-6989586621679061544"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-identifier">sPsabc</span><span> </span><span class="hs-identifier">d</span><span>
</span><a name="line-2828"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2829"></a><span>    </span><span class="hs-glyph">!</span><span class="hs-identifier">sPsa</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-2830"></a><span>    </span><span class="hs-glyph">!</span><span class="hs-identifier">sPsab</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sPsa</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-2831"></a><span>    </span><span class="hs-glyph">!</span><span class="hs-identifier">sPsabc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sPsab</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-2832"></a><span>
</span><a name="line-2833"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">foldWithIndexNode</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2834"></a><span class="hs-identifier">foldWithIndexNode</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Sized</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">m</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span>
</span><a name="line-2835"></a><span class="hs-identifier">foldWithIndexNode</span><span> </span><span class="hs-special">(</span><span class="hs-operator">&lt;+&gt;</span><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">!</span><a href="#local-6989586621679058922"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node2</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="#local-6989586621679058923"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">sPsa</span><span> </span><a href="#local-6989586621679058923"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-2836"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2837"></a><span>    </span><span class="hs-glyph">!</span><span class="hs-identifier">sPsa</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-2838"></a><span class="hs-identifier">foldWithIndexNode</span><span> </span><span class="hs-special">(</span><span class="hs-operator">&lt;+&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">sPsa</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">sPsab</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-2839"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2840"></a><span>    </span><span class="hs-glyph">!</span><span class="hs-identifier">sPsa</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-2841"></a><span>    </span><span class="hs-glyph">!</span><span class="hs-identifier">sPsab</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sPsa</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-2842"></a><span>
</span><a name="line-2843"></a><span class="hs-comment">-- A generalization of 'foldMap', 'foldMapWithIndex' takes a folding</span><span>
</span><a name="line-2844"></a><span class="hs-comment">-- function that also depends on the element's index, and applies it to every</span><span>
</span><a name="line-2845"></a><span class="hs-comment">-- element in the sequence.</span><span>
</span><a name="line-2846"></a><span class="hs-comment">--</span><span>
</span><a name="line-2847"></a><span class="hs-comment">-- @since 0.5.8</span><span>
</span><a name="line-2848"></a><span class="hs-identifier">foldMapWithIndex</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Monoid</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span>
</span><a name="line-2849"></a><span class="hs-identifier">foldMapWithIndex</span><span> </span><span class="hs-identifier">f'</span><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Monoid"><span class="hs-identifier hs-type">Seq</span></a><span> </span><span class="hs-identifier">xs'</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldMapWithIndexTreeE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">lift_elem</span><span> </span><span class="hs-identifier">f'</span><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-identifier">xs'</span><span>
</span><a name="line-2850"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2851"></a><span>  </span><span class="hs-identifier">lift_elem</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span>
</span><a name="line-2852"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 708
</span><span>  </span><span class="hs-identifier">lift_elem</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">coerce</span><span> </span><span class="hs-identifier">g</span><span>
</span><a name="line-2854"></a><span class="hs-cpp">#else
</span><span>  </span><span class="hs-identifier">lift_elem</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-2856"></a><span class="hs-cpp">#endif
</span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">lift_elem</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2858"></a><span class="hs-comment">-- We have to specialize these functions by hand, unfortunately, because</span><span>
</span><a name="line-2859"></a><span class="hs-comment">-- GHC does not specialize until *all* instances are determined.</span><span>
</span><a name="line-2860"></a><span class="hs-comment">-- Although the Sized instance is known at compile time, the Monoid</span><span>
</span><a name="line-2861"></a><span class="hs-comment">-- instance generally is not.</span><span>
</span><a name="line-2862"></a><span>  </span><span class="hs-identifier">foldMapWithIndexTreeE</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Monoid</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span>
</span><a name="line-2863"></a><span>  </span><span class="hs-identifier">foldMapWithIndexTreeE</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">!</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Monoid"><span class="hs-identifier hs-type">_s</span></a><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mempty</span><span>
</span><a name="line-2864"></a><span>  </span><a name="local-6989586621679061565"><a href="#local-6989586621679061565"><span class="hs-identifier">foldMapWithIndexTreeE</span></a></a><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-2865"></a><span>  </span><span class="hs-identifier">foldMapWithIndexTreeE</span><span> </span><a name="local-6989586621679061587"><a href="#local-6989586621679061587"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679061588"><a href="#local-6989586621679061588"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">_</span></a><span> </span><a name="local-6989586621679061589"><a href="#local-6989586621679061589"><span class="hs-identifier">pr</span></a></a><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2866"></a><span>               </span><span class="hs-identifier">foldMapWithIndexDigitE</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-operator">&lt;&gt;</span><span>
</span><a name="line-2867"></a><span>               </span><a href="#local-6989586621679061567"><span class="hs-identifier hs-var">foldMapWithIndexTreeN</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldMapWithIndexNodeE</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">sPspr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-operator">&lt;&gt;</span><span>
</span><a name="line-2868"></a><span>               </span><span class="hs-identifier">foldMapWithIndexDigitE</span><span> </span><a href="#local-6989586621679061569"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679061569"><span class="hs-identifier hs-var">sPsprm</span></a><span> </span><a href="#local-6989586621679061569"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2869"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2870"></a><span>      </span><span class="hs-glyph">!</span><span class="hs-identifier">sPspr</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">pr</span><span>
</span><a name="line-2871"></a><span>      </span><span class="hs-glyph">!</span><span class="hs-identifier">sPsprm</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sPspr</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">m</span><span>
</span><a name="line-2872"></a><span>
</span><a name="line-2873"></a><span>  </span><span class="hs-identifier">foldMapWithIndexTreeN</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Monoid</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span>
</span><a name="line-2874"></a><span>  </span><span class="hs-identifier">foldMapWithIndexTreeN</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">!</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Monoid"><span class="hs-identifier hs-type">_s</span></a><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mempty</span><span>
</span><a name="line-2875"></a><span>  </span><a name="local-6989586621679061566"><a href="#local-6989586621679061566"><span class="hs-identifier">foldMapWithIndexTreeN</span></a></a><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-2876"></a><span>  </span><span class="hs-identifier">foldMapWithIndexTreeN</span><span> </span><a name="local-6989586621679061598"><a href="#local-6989586621679061598"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679061599"><a href="#local-6989586621679061599"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">_</span></a><span> </span><a name="local-6989586621679061600"><a href="#local-6989586621679061600"><span class="hs-identifier">pr</span></a></a><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2877"></a><span>               </span><span class="hs-identifier">foldMapWithIndexDigitN</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-operator">&lt;&gt;</span><span>
</span><a name="line-2878"></a><span>               </span><a href="#local-6989586621679061568"><span class="hs-identifier hs-var">foldMapWithIndexTreeN</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldMapWithIndexNodeN</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">sPspr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-operator">&lt;&gt;</span><span>
</span><a name="line-2879"></a><span>               </span><span class="hs-identifier">foldMapWithIndexDigitN</span><span> </span><a href="#local-6989586621679061570"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679061570"><span class="hs-identifier hs-var">sPsprm</span></a><span> </span><a href="#local-6989586621679061570"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-2880"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2881"></a><span>      </span><span class="hs-glyph">!</span><span class="hs-identifier">sPspr</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">pr</span><span>
</span><a name="line-2882"></a><span>      </span><span class="hs-glyph">!</span><span class="hs-identifier">sPsprm</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sPspr</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">m</span><span>
</span><a name="line-2883"></a><span>
</span><a name="line-2884"></a><span>  </span><span class="hs-identifier">foldMapWithIndexDigitE</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Monoid</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span>
</span><a name="line-2885"></a><span>  </span><span class="hs-identifier">foldMapWithIndexDigitE</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">i</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Monoid"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldWithIndexDigit</span><span> </span><span class="hs-special">(</span><span class="hs-operator">&lt;&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">t</span><span>
</span><a name="line-2886"></a><span>
</span><a name="line-2887"></a><span>  </span><span class="hs-identifier">foldMapWithIndexDigitN</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Monoid</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span>
</span><a name="line-2888"></a><span>  </span><span class="hs-identifier">foldMapWithIndexDigitN</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">i</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Monoid"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldWithIndexDigit</span><span> </span><span class="hs-special">(</span><span class="hs-operator">&lt;&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">t</span><span>
</span><a name="line-2889"></a><span>
</span><a name="line-2890"></a><span>  </span><span class="hs-identifier">foldMapWithIndexNodeE</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Monoid</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span>
</span><a name="line-2891"></a><span>  </span><span class="hs-identifier">foldMapWithIndexNodeE</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">i</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Monoid"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldWithIndexNode</span><span> </span><span class="hs-special">(</span><span class="hs-operator">&lt;&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">f</span><span> </span><a href="#local-6989586621679061581"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-identifier">t</span><span>
</span><a name="line-2892"></a><span>
</span><a name="line-2893"></a><span>  </span><span class="hs-identifier">foldMapWithIndexNodeN</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Monoid</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span>
</span><a name="line-2894"></a><span>  </span><span class="hs-identifier">foldMapWithIndexNodeN</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">i</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Monoid"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldWithIndexNode</span><span> </span><span class="hs-special">(</span><span class="hs-operator">&lt;&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">f</span><span> </span><a href="#local-6989586621679061583"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-identifier">t</span><span>
</span><a name="line-2895"></a><span>
</span><a name="line-2896"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__
</span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="hs-pragma">foldMapWithIndex</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2898"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-2900"></a><span class="hs-comment">-- | 'traverseWithIndex' is a version of 'traverse' that also offers</span><span>
</span><a name="line-2901"></a><span class="hs-comment">-- access to the index of each element.</span><span>
</span><a name="line-2902"></a><span class="hs-comment">--</span><span>
</span><a name="line-2903"></a><span class="hs-comment">-- @since 0.5.8</span><span>
</span><a name="line-2904"></a><span class="hs-identifier">traverseWithIndex</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Applicative</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-2905"></a><span class="hs-identifier">traverseWithIndex</span><span> </span><span class="hs-identifier">f'</span><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">xs'</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">traverseWithIndexTreeE</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Elem</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">f'</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-identifier">xs'</span><span>
</span><a name="line-2906"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2907"></a><span class="hs-comment">-- We have to specialize these functions by hand, unfortunately, because</span><span>
</span><a name="line-2908"></a><span class="hs-comment">-- GHC does not specialize until *all* instances are determined.</span><span>
</span><a name="line-2909"></a><span class="hs-comment">-- Although the Sized instance is known at compile time, the Applicative</span><span>
</span><a name="line-2910"></a><span class="hs-comment">-- instance generally is not.</span><span>
</span><a name="line-2911"></a><span>  </span><span class="hs-identifier">traverseWithIndexTreeE</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Applicative</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-2912"></a><span>  </span><span class="hs-identifier">traverseWithIndexTreeE</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">!</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">_s</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">EmptyT</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pure</span><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-2913"></a><span>  </span><a name="local-6989586621679061622"><a href="#local-6989586621679061622"><span class="hs-identifier">traverseWithIndexTreeE</span></a></a><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Single</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-2914"></a><span>  </span><span class="hs-identifier">traverseWithIndexTreeE</span><span> </span><a name="local-6989586621679061655"><a href="#local-6989586621679061655"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679061656"><a href="#local-6989586621679061656"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">n</span></a><span> </span><a name="local-6989586621679061657"><a href="#local-6989586621679061657"><span class="hs-identifier">pr</span></a></a><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2915"></a><span>          </span><span class="hs-identifier">liftA3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span>
</span><a name="line-2916"></a><span>               </span><span class="hs-special">(</span><span class="hs-identifier">traverseWithIndexDigitE</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span class="hs-special">)</span><span>
</span><a name="line-2917"></a><span>               </span><span class="hs-special">(</span><a href="#local-6989586621679061624"><span class="hs-identifier hs-var">traverseWithIndexTreeN</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">traverseWithIndexNodeE</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">sPspr</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span>
</span><a name="line-2918"></a><span>               </span><span class="hs-special">(</span><span class="hs-identifier">traverseWithIndexDigitE</span><span> </span><a href="#local-6989586621679061627"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679061627"><span class="hs-identifier hs-var">sPsprm</span></a><span> </span><a href="#local-6989586621679061627"><span class="hs-identifier hs-var">sf</span></a><span class="hs-special">)</span><span>
</span><a name="line-2919"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2920"></a><span>      </span><span class="hs-glyph">!</span><span class="hs-identifier">sPspr</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">pr</span><span>
</span><a name="line-2921"></a><span>      </span><span class="hs-glyph">!</span><span class="hs-identifier">sPsprm</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sPspr</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">m</span><span>
</span><a name="line-2922"></a><span>
</span><a name="line-2923"></a><span>  </span><span class="hs-identifier">traverseWithIndexTreeN</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Applicative</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-2924"></a><span>  </span><span class="hs-identifier">traverseWithIndexTreeN</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">!</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">_s</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">EmptyT</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pure</span><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-2925"></a><span>  </span><a name="local-6989586621679061623"><a href="#local-6989586621679061623"><span class="hs-identifier">traverseWithIndexTreeN</span></a></a><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Single</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-2926"></a><span>  </span><span class="hs-identifier">traverseWithIndexTreeN</span><span> </span><a name="local-6989586621679061667"><a href="#local-6989586621679061667"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679061668"><a href="#local-6989586621679061668"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">n</span></a><span> </span><a name="local-6989586621679061669"><a href="#local-6989586621679061669"><span class="hs-identifier">pr</span></a></a><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2927"></a><span>          </span><span class="hs-identifier">liftA3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span>
</span><a name="line-2928"></a><span>               </span><span class="hs-special">(</span><span class="hs-identifier">traverseWithIndexDigitN</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span class="hs-special">)</span><span>
</span><a name="line-2929"></a><span>               </span><span class="hs-special">(</span><a href="#local-6989586621679061625"><span class="hs-identifier hs-var">traverseWithIndexTreeN</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">traverseWithIndexNodeN</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">sPspr</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span>
</span><a name="line-2930"></a><span>               </span><span class="hs-special">(</span><span class="hs-identifier">traverseWithIndexDigitN</span><span> </span><a href="#local-6989586621679061628"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679061628"><span class="hs-identifier hs-var">sPsprm</span></a><span> </span><a href="#local-6989586621679061628"><span class="hs-identifier hs-var">sf</span></a><span class="hs-special">)</span><span>
</span><a name="line-2931"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2932"></a><span>      </span><span class="hs-glyph">!</span><span class="hs-identifier">sPspr</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">pr</span><span>
</span><a name="line-2933"></a><span>      </span><span class="hs-glyph">!</span><span class="hs-identifier">sPsprm</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sPspr</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">m</span><span>
</span><a name="line-2934"></a><span>
</span><a name="line-2935"></a><span>  </span><span class="hs-identifier">traverseWithIndexDigitE</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Applicative</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Digit</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-2936"></a><span>  </span><span class="hs-identifier">traverseWithIndexDigitE</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">i</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">traverseWithIndexDigit</span><span> </span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679061637"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-identifier">t</span><span>
</span><a name="line-2937"></a><span>
</span><a name="line-2938"></a><span>  </span><span class="hs-identifier">traverseWithIndexDigitN</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Applicative</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Digit</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-2939"></a><span>  </span><span class="hs-identifier">traverseWithIndexDigitN</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">i</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">traverseWithIndexDigit</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679061640"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-identifier">t</span><span>
</span><a name="line-2940"></a><span>
</span><a name="line-2941"></a><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">traverseWithIndexDigit</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2942"></a><span>  </span><span class="hs-identifier">traverseWithIndexDigit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Applicative</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Sized</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Digit</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-2943"></a><span>  </span><span class="hs-identifier">traverseWithIndexDigit</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">One</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">One</span><span> </span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-operator hs-type">&lt;$&gt;</span></a><span> </span><a href="Data.Sequence.Internal.html#Sized"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679061643"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-2944"></a><span>  </span><a name="local-6989586621679061626"><a href="#local-6989586621679061626"><span class="hs-identifier">traverseWithIndexDigit</span></a></a><span> </span><a name="local-6989586621679061684"><a href="#local-6989586621679061684"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">liftA2</span><span> </span><span class="hs-identifier">Two</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">sPsa</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-2945"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2946"></a><span>      </span><span class="hs-glyph">!</span><span class="hs-identifier">sPsa</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-2947"></a><span>  </span><span class="hs-identifier">traverseWithIndexDigit</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2948"></a><span>                                      </span><span class="hs-identifier">liftA3</span><span> </span><span class="hs-identifier">Three</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">sPsa</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">sPsab</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-2949"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2950"></a><span>      </span><span class="hs-glyph">!</span><span class="hs-identifier">sPsa</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-2951"></a><span>      </span><span class="hs-glyph">!</span><span class="hs-identifier">sPsab</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sPsa</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-2952"></a><span>  </span><span class="hs-identifier">traverseWithIndexDigit</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679061695"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2953"></a><span>                          </span><span class="hs-identifier">liftA3</span><span> </span><span class="hs-identifier">Four</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679061703"><a href="#local-6989586621679061703"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679061704"><a href="#local-6989586621679061704"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">sPsa</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">sPsab</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">sPsabc</span><span> </span><span class="hs-identifier">d</span><span>
</span><a name="line-2954"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2955"></a><span>      </span><span class="hs-glyph">!</span><span class="hs-identifier">sPsa</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-2956"></a><span>      </span><span class="hs-glyph">!</span><span class="hs-identifier">sPsab</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sPsa</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-2957"></a><span>      </span><span class="hs-glyph">!</span><span class="hs-identifier">sPsabc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sPsab</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-2958"></a><span>
</span><a name="line-2959"></a><span>  </span><span class="hs-identifier">traverseWithIndexNodeE</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Applicative</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-2960"></a><span>  </span><span class="hs-identifier">traverseWithIndexNodeE</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">i</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">traverseWithIndexNode</span><span> </span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">t</span><span>
</span><a name="line-2961"></a><span>
</span><a name="line-2962"></a><span>  </span><span class="hs-identifier">traverseWithIndexNodeN</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Applicative</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-2963"></a><span>  </span><span class="hs-identifier">traverseWithIndexNodeN</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">i</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">traverseWithIndexNode</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">t</span><span>
</span><a name="line-2964"></a><span>
</span><a name="line-2965"></a><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">traverseWithIndexNode</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2966"></a><span>  </span><span class="hs-identifier">traverseWithIndexNode</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Applicative</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Sized</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-2967"></a><span>  </span><span class="hs-identifier">traverseWithIndexNode</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">Node2</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#Applicative"><span class="hs-identifier hs-type">ns</span></a><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">liftA2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node2</span><span> </span><span class="hs-identifier">ns</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">sPsa</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-2968"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2969"></a><span>      </span><span class="hs-glyph">!</span><span class="hs-identifier">sPsa</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-2970"></a><span>  </span><span class="hs-identifier">traverseWithIndexNode</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">ns</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2971"></a><span>                           </span><span class="hs-identifier">liftA3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">ns</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">sPsa</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">sPsab</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-2972"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-2973"></a><span>      </span><span class="hs-glyph">!</span><span class="hs-identifier">sPsa</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-2974"></a><span>      </span><span class="hs-glyph">!</span><span class="hs-identifier">sPsab</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sPsa</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-2975"></a><span>
</span><a name="line-2976"></a><span>
</span><a name="line-2977"></a><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">traverseWithIndex</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2978"></a><span class="hs-cpp">#ifdef __GLASGOW_HASKELL__
</span><span class="hs-pragma">{-# RULES</span><span>
</span><a name="line-2980"></a><span class="hs-pragma">&quot;travWithIndex/mapWithIndex&quot;</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">traverseWithIndex</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">mapWithIndex</span><span> </span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">xs</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span>
</span><a name="line-2981"></a><span>  </span><span class="hs-pragma">traverseWithIndex</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span class="hs-pragma">k</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">k</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">k</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">xs</span><span>
</span><a name="line-2982"></a><span class="hs-pragma">&quot;travWithIndex/fmapSeq&quot;</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">traverseWithIndex</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">fmapSeq</span><span> </span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">xs</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span>
</span><a name="line-2983"></a><span>  </span><span class="hs-pragma">traverseWithIndex</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span class="hs-pragma">k</span><span> </span><span class="hs-pragma">a</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">k</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">xs</span><span>
</span><a name="line-2984"></a><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-2985"></a><span class="hs-cpp">#endif
</span><span class="hs-comment">{-
It might be nice to be able to rewrite

traverseWithIndex f (fromFunction i g)
to
replicateAWithIndex i (\k -&gt; f k (g k))
and
traverse f (fromFunction i g)
to
replicateAWithIndex i (f . g)

but we don't have replicateAWithIndex as yet.

We might wish for a rule like
&quot;fmapSeq/travWithIndex&quot; forall f g xs . fmapSeq f &lt;$&gt; traverseWithIndex g xs =
  traverseWithIndex (\k a -&gt; f &lt;$&gt; g k a) xs
Unfortunately, this rule could screw up the inliner's treatment of
fmap in general, and it also relies on the arbitrary Functor being
valid.
-}</span><span>
</span><a name="line-3006"></a><span>
</span><a name="line-3007"></a><span>
</span><a name="line-3008"></a><span class="hs-comment">-- | \( O(n) \). Convert a given sequence length and a function representing that</span><span>
</span><a name="line-3009"></a><span class="hs-comment">-- sequence into a sequence.</span><span>
</span><a name="line-3010"></a><span class="hs-comment">--</span><span>
</span><a name="line-3011"></a><span class="hs-comment">-- @since 0.5.6.2</span><span>
</span><a name="line-3012"></a><span class="hs-identifier">fromFunction</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-3013"></a><span class="hs-identifier">fromFunction</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;Data.Sequence.fromFunction called with negative len&quot;</span><span>
</span><a name="line-3014"></a><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">len</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-operator hs-type">==</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">empty</span><span>
</span><a name="line-3015"></a><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Err.html#error"><span class="hs-identifier hs-var">Seq</span></a><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">create</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">lift_elem</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-identifier">len</span><span>
</span><a name="line-3016"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3017"></a><span>    </span><span class="hs-identifier">create</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679061732"><span class="hs-identifier hs-var">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-3018"></a><span>    </span><span class="hs-identifier">create</span><span> </span><span class="hs-identifier">b</span><span class="hs-comment">{-tree_builder-}</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">s</span><span class="hs-comment">{-tree_size-}</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">i</span><span class="hs-comment">{-start_index-}</span><span> </span><span class="hs-identifier">trees</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">trees</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3019"></a><span>       </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Single</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">i</span><span>
</span><a name="line-3020"></a><span>       </span><span class="hs-number">2</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-number">2</span><span class="hs-operator">*</span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">i</span><span class="hs-operator">+</span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3021"></a><span>       </span><span class="hs-number">3</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">*</span></a><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">createTwo</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">i</span><span class="hs-operator">+</span><span class="hs-number">2</span><span class="hs-operator">*</span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3022"></a><span>       </span><span class="hs-number">4</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">4</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><a href="#local-6989586621679061737"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">createTwo</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">createTwo</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">i</span><span class="hs-operator">+</span><span class="hs-number">2</span><span class="hs-operator">*</span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3023"></a><span>       </span><span class="hs-number">5</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">5</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><a href="#local-6989586621679061737"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">createThree</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">createTwo</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">i</span><span class="hs-operator">+</span><span class="hs-number">3</span><span class="hs-operator">*</span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3024"></a><span>       </span><span class="hs-number">6</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">6</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><a href="#local-6989586621679061737"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">createThree</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">createThree</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061737"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator">+</span><span class="hs-number">3</span><span class="hs-operator">*</span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3025"></a><span>       </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">trees</span><span> </span><span class="hs-special">`</span><a href="#local-6989586621679061741"><span class="hs-identifier hs-var">quotRem</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3026"></a><span>           </span><span class="hs-special">(</span><span class="hs-identifier">trees'</span><span class="hs-special">,</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679061741"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">trees</span><span class="hs-operator">*</span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">createTwo</span><span> </span><a href="#local-6989586621679061741"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-3027"></a><span>                              </span><span class="hs-special">(</span><span class="hs-identifier">create</span><span> </span><span class="hs-identifier">mb</span><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><span class="hs-operator">*</span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">i</span><span class="hs-operator">+</span><span class="hs-number">2</span><span class="hs-operator">*</span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">trees'</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3028"></a><span>                              </span><span class="hs-special">(</span><span class="hs-identifier">createTwo</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061740"><span class="hs-identifier hs-var">i</span></a><a href="#local-6989586621679061740"><span class="hs-operator hs-var">+</span></a><span class="hs-special">(</span><span class="hs-number">2</span><a href="#local-6989586621679061740"><span class="hs-operator hs-var">+</span></a><span class="hs-number">3</span><a href="#local-6989586621679061740"><span class="hs-operator hs-var">*</span></a><span class="hs-special">(</span><span class="hs-identifier">trees'</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-operator">*</span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3029"></a><span>           </span><span class="hs-special">(</span><span class="hs-identifier">trees'</span><span class="hs-special">,</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061732"><span class="hs-identifier hs-var">trees</span></a><span class="hs-operator">*</span><a href="#local-6989586621679061742"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">createThree</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span>
</span><a name="line-3030"></a><span>                              </span><span class="hs-special">(</span><a href="#local-6989586621679061740"><span class="hs-identifier hs-var">create</span></a><span> </span><a href="#local-6989586621679061740"><span class="hs-identifier hs-var">mb</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">*</span></a><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2A"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator">+</span><span class="hs-number">3</span><a href="#local-6989586621679061746"><span class="hs-operator hs-var">*</span></a><a href="#local-6989586621679061746"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">trees'</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3031"></a><span>                              </span><span class="hs-special">(</span><span class="hs-identifier">createTwo</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061741"><span class="hs-identifier hs-var">i</span></a><a href="#local-6989586621679061741"><span class="hs-operator hs-var">+</span></a><span class="hs-special">(</span><span class="hs-number">3</span><a href="#local-6989586621679061741"><span class="hs-operator hs-var">+</span></a><span class="hs-number">3</span><a href="#local-6989586621679061741"><span class="hs-operator hs-var">*</span></a><span class="hs-special">(</span><span class="hs-identifier">trees'</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-operator">*</span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3032"></a><span>           </span><span class="hs-special">(</span><span class="hs-identifier">trees'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061732"><span class="hs-identifier hs-var">trees</span></a><span class="hs-operator">*</span><a href="#local-6989586621679061742"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">createThree</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span>
</span><a name="line-3033"></a><span>                              </span><span class="hs-special">(</span><a href="#local-6989586621679061740"><span class="hs-identifier hs-var">create</span></a><span> </span><a href="#local-6989586621679061740"><span class="hs-identifier hs-var">mb</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">*</span></a><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2A"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator">+</span><span class="hs-number">3</span><a href="#local-6989586621679061747"><span class="hs-operator hs-var">*</span></a><a href="#local-6989586621679061747"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">trees'</span><span class="hs-glyph">-</span><span class="hs-number">2</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3034"></a><span>                              </span><span class="hs-special">(</span><span class="hs-identifier">createThree</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061741"><span class="hs-identifier hs-var">i</span></a><a href="#local-6989586621679061741"><span class="hs-operator hs-var">+</span></a><span class="hs-special">(</span><span class="hs-number">3</span><a href="#local-6989586621679061741"><span class="hs-operator hs-var">+</span></a><span class="hs-number">3</span><a href="#local-6989586621679061741"><span class="hs-operator hs-var">*</span></a><span class="hs-special">(</span><span class="hs-identifier">trees'</span><span class="hs-glyph">-</span><span class="hs-number">2</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-operator">*</span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3035"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-3036"></a><span>        </span><span class="hs-identifier">createTwo</span><span> </span><span class="hs-identifier">j</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Two</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">j</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061741"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061741"><span class="hs-identifier hs-var">j</span></a><span> </span><a href="#local-6989586621679061741"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679061741"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3037"></a><span>        </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">createTwo</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-3038"></a><span>        </span><span class="hs-identifier">createThree</span><span> </span><span class="hs-identifier">j</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Three</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><a href="#local-6989586621679061736"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061737"><span class="hs-identifier hs-var">j</span></a><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">j</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-number">2</span><span class="hs-operator">*</span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3039"></a><span>        </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">createThree</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-3040"></a><span>        </span><a name="local-6989586621679061741"><a href="#local-6989586621679061741"><span class="hs-identifier">mb</span></a></a><span> </span><a name="local-6989586621679061741"><a href="#local-6989586621679061741"><span class="hs-identifier">j</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Node3</span><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><span class="hs-operator">*</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier">j</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061736"><span class="hs-identifier hs-var">j</span></a><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061736"><span class="hs-identifier hs-var">j</span></a><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-number">2</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">*</span></a><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3041"></a><span>        </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">mb</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-3042"></a><span>
</span><a name="line-3043"></a><span>    </span><span class="hs-identifier">lift_elem</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3044"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 708
</span><span>    </span><span class="hs-identifier">lift_elem</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">coerce</span><span> </span><a href="#local-6989586621679061735"><span class="hs-identifier hs-type">g</span></a><span>
</span><a name="line-3046"></a><span class="hs-cpp">#else
</span><span>    </span><a name="local-6989586621679061733"><a href="#local-6989586621679061733"><span class="hs-identifier">lift_elem</span></a></a><span> </span><a name="local-6989586621679061749"><a href="#local-6989586621679061749"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Elem</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679061749"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-3048"></a><span class="hs-cpp">#endif
</span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">lift_elem</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-3050"></a><span>
</span><a name="line-3051"></a><span class="hs-comment">-- | \( O(n) \). Create a sequence consisting of the elements of an 'Array'.</span><span>
</span><a name="line-3052"></a><span class="hs-comment">-- Note that the resulting sequence elements may be evaluated lazily (as on GHC),</span><span>
</span><a name="line-3053"></a><span class="hs-comment">-- so you must force the entire structure to be sure that the original array</span><span>
</span><a name="line-3054"></a><span class="hs-comment">-- can be garbage-collected.</span><span>
</span><a name="line-3055"></a><span class="hs-comment">--</span><span>
</span><a name="line-3056"></a><span class="hs-comment">-- @since 0.5.6.2</span><span>
</span><a name="line-3057"></a><span class="hs-identifier">fromArray</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Ix</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Array</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-3058"></a><span class="hs-cpp">#ifdef __GLASGOW_HASKELL__
</span><span class="hs-identifier">fromArray</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fromFunction</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">GHC.Arr.numElements</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">GHC.Arr.unsafeAt</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3060"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-3061"></a><span>  </span><span class="hs-comment">-- The following definition uses (Ix i) constraing, which is needed for the</span><span>
</span><a name="line-3062"></a><span>  </span><span class="hs-comment">-- other fromArray definition.</span><span>
</span><a name="line-3063"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Data.Array.rangeSize</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Data.Array.bounds</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3064"></a><span class="hs-cpp">#else
</span><span class="hs-identifier">fromArray</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Arr.html#rangeSize"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Arr.html#rangeSize"><span class="hs-identifier hs-var">fromList2</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Data.Array.rangeSize</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Data.Array.bounds</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Data.Array.elems</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3066"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-3068"></a><span class="hs-comment">-- Splitting</span><span>
</span><a name="line-3069"></a><span>
</span><a name="line-3070"></a><span class="hs-comment">-- | \( O(\log(\min(i,n-i))) \). The first @i@ elements of a sequence.</span><span>
</span><a name="line-3071"></a><span class="hs-comment">-- If @i@ is negative, @'take' i s@ yields the empty sequence.</span><span>
</span><a name="line-3072"></a><span class="hs-comment">-- If the sequence contains fewer than @i@ elements, the whole sequence</span><span>
</span><a name="line-3073"></a><span class="hs-comment">-- is returned.</span><span>
</span><a name="line-3074"></a><span class="hs-identifier">take</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-3075"></a><span class="hs-identifier">take</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">xs</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">t</span><span class="hs-special">)</span><span>
</span><a name="line-3076"></a><span>    </span><span class="hs-comment">-- See note on unsigned arithmetic in splitAt</span><span>
</span><a name="line-3077"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Word</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-3078"></a><span>      </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">takeTreeE</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">t</span><span class="hs-special">)</span><span>
</span><a name="line-3079"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Real.html#fromIntegral"><span class="hs-operator hs-var">&lt;=</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">empty</span><span>
</span><a name="line-3080"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#takeTreeE"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-3081"></a><span>
</span><a name="line-3082"></a><span class="hs-identifier">takeTreeE</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3083"></a><span class="hs-identifier">takeTreeE</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_i</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-3084"></a><span class="hs-identifier">takeTreeE</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">t</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">_</span></a><span class="hs-special">)</span><span>
</span><a name="line-3085"></a><span>   </span><span class="hs-glyph">|</span><span> </span><a name="takeTreeE"><a href="Data.Sequence.Internal.html#takeTreeE"><span class="hs-identifier">i</span></a></a><span> </span><a name="takeTreeE"><a href="Data.Sequence.Internal.html#takeTreeE"><span class="hs-operator">&lt;=</span></a></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span>
</span><a name="line-3086"></a><span>   </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-3087"></a><span class="hs-identifier">takeTreeE</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span>
</span><a name="line-3088"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">spr</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">takePrefixE</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">pr</span><span>
</span><a name="line-3089"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">spm</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">takeTreeN</span><span> </span><span class="hs-identifier">im</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3090"></a><span>            </span><span class="hs-identifier">ml</span><span> </span><span class="hs-operator">:*:</span><span> </span><a href="Data.Sequence.Internal.html#takePrefixE"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">takeMiddleE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">im</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">ml</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">spr</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">ml</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-3091"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">takeSuffixE</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#takeTreeN"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">spm</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3092"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3093"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">spr</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><a href="Data.Sequence.Internal.html#takeSuffixE"><span class="hs-identifier hs-var">pr</span></a><span>
</span><a name="line-3094"></a><span>    </span><span class="hs-identifier">spm</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">spr</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">m</span><span>
</span><a name="line-3095"></a><span>    </span><a name="local-6989586621679061762"><a href="#local-6989586621679061762"><span class="hs-identifier">im</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">spr</span><span>
</span><a name="line-3096"></a><span>
</span><a name="line-3097"></a><span class="hs-identifier">takeTreeN</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">StrictPair</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3098"></a><span class="hs-identifier">takeTreeN</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_i</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;takeTreeN of empty tree&quot;</span><span>
</span><a name="line-3099"></a><span class="hs-identifier">takeTreeN</span><span> </span><span class="hs-identifier">_i</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-operator hs-type">:*:</span></a><span> </span><a href="#local-6989586621679058911"><span class="hs-identifier hs-type">x</span></a><span>
</span><a name="line-3100"></a><a name="takeTreeN"><a href="Data.Sequence.Internal.html#takeTreeN"><span class="hs-identifier">takeTreeN</span></a></a><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-identifier">pr</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Err.html#error"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Err.html#error"><span class="hs-identifier hs-var">sf</span></a><span class="hs-special">)</span><span>
</span><a name="line-3101"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">spr</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">takePrefixN</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-identifier">pr</span><span>
</span><a name="line-3102"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">spm</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">takeTreeN</span><span> </span><span class="hs-identifier">im</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3103"></a><span>            </span><span class="hs-identifier">ml</span><span> </span><span class="hs-operator">:*:</span><span> </span><a href="Data.Sequence.Internal.html#takePrefixN"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">takeMiddleN</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">im</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">ml</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">spr</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">ml</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-3104"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">takeSuffixN</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#takeTreeN"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">spm</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3105"></a><span>    </span><span class="hs-identifier">spr</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><a name="local-6989586621679061779"><a href="#local-6989586621679061779"><span class="hs-identifier">pr</span></a></a><span>
</span><a name="line-3106"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">spm</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">spr</span><span> </span><a href="Data.Sequence.Internal.html#takeSuffixN"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#takeSuffixN"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="Data.Sequence.Internal.html#takeSuffixN"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-3107"></a><span>    </span><a name="local-6989586621679061775"><a href="#local-6989586621679061775"><span class="hs-identifier">im</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">spr</span><span>
</span><a name="line-3108"></a><span>
</span><a name="line-3109"></a><span class="hs-identifier">takeMiddleN</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span>
</span><a name="line-3110"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3111"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">StrictPair</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3112"></a><span class="hs-identifier">takeMiddleN</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">spr</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">pr</span></a><span> </span><span class="hs-identifier">ml</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node2</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">a</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-3113"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">sa</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Utils.Containers.Internal.StrictPair.html#StrictPair"><span class="hs-identifier hs-type">pullR</span></a><span> </span><span class="hs-identifier">sprml</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">pr</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">ml</span></a><span> </span><span class="hs-operator">:*:</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-3114"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">sprmla</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">ml</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3115"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3116"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">sa</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-3117"></a><span>    </span><span class="hs-identifier">sprml</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">spr</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">ml</span><span>
</span><a name="line-3118"></a><span>    </span><span class="hs-identifier">sprmla</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">sa</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-identifier">sprml</span><span>
</span><a name="line-3119"></a><span class="hs-identifier">takeMiddleN</span><span> </span><span class="hs-identifier">i</span><span> </span><a href="#local-6989586621679061781"><span class="hs-identifier hs-var">spr</span></a><span> </span><span class="hs-identifier">pr</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">ml</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-3120"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679061788"><a href="#local-6989586621679061788"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679061788"><a href="#local-6989586621679061788"><span class="hs-operator">&lt;</span></a></a><span> </span><a name="local-6989586621679061788"><a href="#local-6989586621679061788"><span class="hs-identifier">sa</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pullR</span><span> </span><span class="hs-identifier">sprml</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">ml</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-3121"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">sab</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">sprmla</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">ml</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3122"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#pullR"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-identifier">sprmlab</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">ml</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-3123"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3124"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">sa</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-3125"></a><span>    </span><span class="hs-identifier">sab</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sa</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3126"></a><span>    </span><span class="hs-identifier">sprml</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">spr</span></a><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">ml</span><span>
</span><a name="line-3127"></a><span>    </span><span class="hs-identifier">sprmla</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679061796"><span class="hs-identifier hs-var">sa</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-identifier">sprml</span><span>
</span><a name="line-3128"></a><span>    </span><span class="hs-identifier">sprmlab</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sprmla</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3129"></a><span>
</span><a name="line-3130"></a><span class="hs-identifier">takeMiddleE</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679061799"><span class="hs-identifier hs-var">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span>
</span><a name="line-3131"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3132"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3133"></a><span class="hs-identifier">takeMiddleE</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">spr</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">pr</span></a><span> </span><span class="hs-identifier">ml</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node2</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">a</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">_</span></a><span class="hs-special">)</span><span>
</span><a name="line-3134"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-number">1</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">pullR</span></a><span> </span><span class="hs-identifier">sprml</span><span> </span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">pr</span></a><span> </span><span class="hs-identifier">ml</span><span>
</span><a name="line-3135"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">sprmla</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">ml</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3136"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3137"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">sprml</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">spr</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-identifier">size</span><span> </span><a href="#local-6989586621679061807"><span class="hs-identifier hs-var">ml</span></a><span>
</span><a name="line-3138"></a><span>    </span><span class="hs-identifier">sprmla</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">sprml</span><span>
</span><a name="line-3139"></a><span class="hs-identifier">takeMiddleE</span><span> </span><span class="hs-identifier">i</span><span> </span><a href="#local-6989586621679061802"><span class="hs-identifier hs-var">spr</span></a><span> </span><span class="hs-identifier">pr</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">ml</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-3140"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679061807"><a href="#local-6989586621679061807"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679061807"><a href="#local-6989586621679061807"><span class="hs-operator">&lt;</span></a></a><span> </span><span class="hs-number">1</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679061806"><span class="hs-identifier hs-var">pullR</span></a><span> </span><span class="hs-identifier">sprml</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">ml</span><span>
</span><a name="line-3141"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-number">2</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">sprmla</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">ml</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3142"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#pullR"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-identifier">sprmlab</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">ml</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-3143"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3144"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">sprml</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">spr</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-identifier">size</span><span> </span><a href="#local-6989586621679061816"><span class="hs-identifier hs-var">ml</span></a><span>
</span><a name="line-3145"></a><span>    </span><span class="hs-identifier">sprmla</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">sprml</span><span>
</span><a name="line-3146"></a><span>    </span><span class="hs-identifier">sprmlab</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sprmla</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">1</span><span>
</span><a name="line-3147"></a><span>
</span><a name="line-3148"></a><span class="hs-identifier">takePrefixE</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679061815"><span class="hs-identifier hs-var">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3149"></a><span class="hs-identifier">takePrefixE</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_i</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-3150"></a><span class="hs-identifier">takePrefixE</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-special">(</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Two</span></a><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-3151"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="takePrefixE"><a href="Data.Sequence.Internal.html#takePrefixE"><span class="hs-identifier">i</span></a></a><span> </span><a name="takePrefixE"><a href="Data.Sequence.Internal.html#takePrefixE"><span class="hs-operator">&lt;</span></a></a><span> </span><span class="hs-number">1</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-3152"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-3153"></a><span class="hs-identifier">takePrefixE</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-3154"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-operator hs-var">&lt;</span></a><span> </span><span class="hs-number">1</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">EmptyT</span></a><span>
</span><a name="line-3155"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-number">2</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-3156"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-3157"></a><span class="hs-identifier">takePrefixE</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-3158"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-operator hs-var">&lt;</span></a><span> </span><span class="hs-number">1</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-3159"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-number">2</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-3160"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679061823"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><span class="hs-number">3</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-3161"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-number">3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-3162"></a><span>
</span><a name="line-3163"></a><span class="hs-identifier">takePrefixN</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3164"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">StrictPair</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3165"></a><span class="hs-identifier">takePrefixN</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_i</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-3166"></a><span class="hs-identifier">takePrefixN</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-3167"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="takePrefixN"><a href="Data.Sequence.Internal.html#takePrefixN"><span class="hs-identifier">i</span></a></a><span> </span><a name="takePrefixN"><a href="Data.Sequence.Internal.html#takePrefixN"><span class="hs-operator">&lt;</span></a></a><span> </span><a name="takePrefixN"><a href="Data.Sequence.Internal.html#takePrefixN"><span class="hs-identifier">sa</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-operator">:*:</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-3168"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3169"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3170"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">sa</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-3171"></a><span class="hs-identifier">takePrefixN</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-3172"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679061832"><a href="#local-6989586621679061832"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">sa</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-3173"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">sab</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Single</span><span> </span><a name="local-6989586621679061836"><a href="#local-6989586621679061836"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3174"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-identifier">sab</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-3175"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3176"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">sa</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-3177"></a><span>    </span><span class="hs-identifier">sab</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sa</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3178"></a><span class="hs-identifier">takePrefixN</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span>
</span><a name="line-3179"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679061838"><a href="#local-6989586621679061838"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679061838"><a href="#local-6989586621679061838"><span class="hs-operator">&lt;</span></a></a><span> </span><span class="hs-identifier">sa</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-3180"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">sab</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3181"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679061839"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><span class="hs-identifier">sabc</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-identifier">sab</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-3182"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-identifier">sabc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">d</span><span>
</span><a name="line-3183"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3184"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">sa</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-3185"></a><span>    </span><span class="hs-identifier">sab</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sa</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3186"></a><span>    </span><span class="hs-identifier">sabc</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">sab</span></a><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-3187"></a><span>
</span><a name="line-3188"></a><span class="hs-identifier">takeSuffixE</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-3189"></a><span>   </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3190"></a><span class="hs-identifier">takeSuffixE</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_i</span><span> </span><span class="hs-glyph">!</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier">pr</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">_</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pullR</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679058906"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">pr</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-3191"></a><span class="hs-identifier">takeSuffixE</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-identifier">s</span><span> </span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">pr</span></a><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-3192"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="takeSuffixE"><a href="Data.Sequence.Internal.html#takeSuffixE"><span class="hs-identifier">i</span></a></a><span> </span><a name="takeSuffixE"><a href="Data.Sequence.Internal.html#takeSuffixE"><span class="hs-operator">&lt;</span></a></a><span> </span><span class="hs-number">1</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pullR</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span> </span><a href="Data.Sequence.Internal.html#pullR"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-3193"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3194"></a><span class="hs-identifier">takeSuffixE</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span> </span><a href="Data.Sequence.Internal.html#pullR"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><a href="#local-6989586621679061853"><span class="hs-identifier hs-var">_</span></a><span class="hs-special">)</span><span>
</span><a name="line-3195"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-operator hs-var">&lt;</span></a><span> </span><span class="hs-number">1</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pullR</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">3</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span>
</span><a name="line-3196"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-number">2</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3197"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#pullR"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-3198"></a><span class="hs-identifier">takeSuffixE</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><a href="#local-6989586621679061858"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679061859"><span class="hs-identifier hs-var">_</span></a><span class="hs-special">)</span><span>
</span><a name="line-3199"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-operator hs-var">&lt;</span></a><span> </span><span class="hs-number">1</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pullR</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">4</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span>
</span><a name="line-3200"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-number">2</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">3</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3201"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679061862"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><span class="hs-number">3</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#pullR"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-3202"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061863"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061864"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679061865"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-3203"></a><span>
</span><a name="line-3204"></a><span class="hs-identifier">takeSuffixN</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-3205"></a><span>   </span><span class="hs-identifier">StrictPair</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3206"></a><span class="hs-identifier">takeSuffixN</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_i</span><span> </span><span class="hs-glyph">!</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier">pr</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pullR</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679058905"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">size</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">pr</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-operator">:*:</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-3207"></a><span class="hs-identifier">takeSuffixN</span><span> </span><a href="Utils.Containers.Internal.StrictPair.html#StrictPair"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-identifier">s</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">pr</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">Two</span></a><span> </span><span class="hs-identifier">a</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-3208"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="takeSuffixN"><a href="Data.Sequence.Internal.html#takeSuffixN"><span class="hs-identifier">i</span></a></a><span> </span><a name="takeSuffixN"><a href="Data.Sequence.Internal.html#takeSuffixN"><span class="hs-operator">&lt;</span></a></a><span> </span><a name="takeSuffixN"><a href="Data.Sequence.Internal.html#takeSuffixN"><span class="hs-identifier">sa</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pullR</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">sa</span><span> </span><span class="hs-glyph">-</span><span> </span><a href="Data.Sequence.Internal.html#pullR"><span class="hs-identifier hs-var">size</span></a><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-3209"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3210"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3211"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">sa</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-3212"></a><span class="hs-identifier">takeSuffixN</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-3213"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679061880"><a href="#local-6989586621679061880"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">sa</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pullR</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">sab</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-3214"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">sab</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3215"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#pullR"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">size</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#-"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">pr</span></a><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><a href="#local-6989586621679061884"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-3216"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3217"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">sa</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-3218"></a><span>    </span><span class="hs-identifier">sab</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sa</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3219"></a><span class="hs-identifier">takeSuffixN</span><span> </span><span class="hs-identifier">i</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679061885"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span>
</span><a name="line-3220"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679061889"><a href="#local-6989586621679061889"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679061889"><a href="#local-6989586621679061889"><span class="hs-operator">&lt;</span></a></a><span> </span><span class="hs-identifier">sa</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pullR</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">sa</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">sbcd</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-3221"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">sab</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">sbcd</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3222"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679061890"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><span class="hs-identifier">sabc</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#pullR"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">scd</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span> </span><a href="#local-6989586621679061903"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><a href="#local-6989586621679061893"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-3223"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061891"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679061903"><span class="hs-identifier hs-var">sd</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span> </span><a href="#local-6989586621679061892"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><a href="#local-6989586621679061894"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-identifier">b</span><span> </span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">d</span><span>
</span><a name="line-3224"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3225"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">sa</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-3226"></a><span>    </span><span class="hs-identifier">sab</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sa</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3227"></a><span>    </span><span class="hs-identifier">sabc</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">sab</span></a><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-3228"></a><span>    </span><a name="local-6989586621679061899"><a href="#local-6989586621679061899"><span class="hs-identifier">sd</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-3229"></a><span>    </span><a name="local-6989586621679061900"><a href="#local-6989586621679061900"><span class="hs-identifier">scd</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">c</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-identifier">sd</span><span>
</span><a name="line-3230"></a><span>    </span><span class="hs-identifier">sbcd</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679061897"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">scd</span><span>
</span><a name="line-3231"></a><span>
</span><a name="line-3232"></a><span class="hs-comment">-- | \( O(\log(\min(i,n-i))) \). Elements of a sequence after the first @i@.</span><span>
</span><a name="line-3233"></a><span class="hs-comment">-- If @i@ is negative, @'drop' i s@ yields the whole sequence.</span><span>
</span><a name="line-3234"></a><span class="hs-comment">-- If the sequence contains fewer than @i@ elements, the empty sequence</span><span>
</span><a name="line-3235"></a><span class="hs-comment">-- is returned.</span><span>
</span><a name="line-3236"></a><span class="hs-identifier">drop</span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-3237"></a><span class="hs-identifier">drop</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">xs</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">t</span><span class="hs-special">)</span><span>
</span><a name="line-3238"></a><span>    </span><span class="hs-comment">-- See note on unsigned arithmetic in splitAt</span><span>
</span><a name="line-3239"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Word</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-3240"></a><span>      </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">takeTreeER</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">t</span><span class="hs-special">)</span><span>
</span><a name="line-3241"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Real.html#fromIntegral"><span class="hs-operator hs-var">&lt;=</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-3242"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#takeTreeER"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-3243"></a><span>
</span><a name="line-3244"></a><span class="hs-comment">-- We implement `drop` using a &quot;take from the rear&quot; strategy.  There's no</span><span>
</span><a name="line-3245"></a><span class="hs-comment">-- particular technical reason for this; it just lets us reuse the arithmetic</span><span>
</span><a name="line-3246"></a><span class="hs-comment">-- from `take` (which itself reuses the arithmetic from `splitAt`) instead of</span><span>
</span><a name="line-3247"></a><span class="hs-comment">-- figuring it out from scratch and ending up with lots of off-by-one errors.</span><span>
</span><a name="line-3248"></a><span class="hs-identifier">takeTreeER</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3249"></a><span class="hs-identifier">takeTreeER</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_i</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-3250"></a><span class="hs-identifier">takeTreeER</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">t</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">_</span></a><span class="hs-special">)</span><span>
</span><a name="line-3251"></a><span>   </span><span class="hs-glyph">|</span><span> </span><a name="takeTreeER"><a href="Data.Sequence.Internal.html#takeTreeER"><span class="hs-identifier">i</span></a></a><span> </span><a name="takeTreeER"><a href="Data.Sequence.Internal.html#takeTreeER"><span class="hs-operator">&lt;=</span></a></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-3252"></a><span>   </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-3253"></a><span class="hs-identifier">takeTreeER</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span>
</span><a name="line-3254"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">ssf</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">takeSuffixER</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3255"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">ssm</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">takeTreeNR</span><span> </span><span class="hs-identifier">im</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3256"></a><span>            </span><span class="hs-identifier">xs</span><span> </span><span class="hs-operator">:*:</span><span> </span><a href="Data.Sequence.Internal.html#takeSuffixER"><span class="hs-identifier hs-var">mr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">takeMiddleER</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">im</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">mr</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">ssf</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-identifier">mr</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3257"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">takePrefixER</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#takeTreeNR"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">ssm</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3258"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3259"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">ssf</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><a href="Data.Sequence.Internal.html#takePrefixER"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-3260"></a><span>    </span><span class="hs-identifier">ssm</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ssf</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">m</span><span>
</span><a name="line-3261"></a><span>    </span><a name="local-6989586621679061915"><a href="#local-6989586621679061915"><span class="hs-identifier">im</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">ssf</span><span>
</span><a name="line-3262"></a><span>
</span><a name="line-3263"></a><span class="hs-identifier">takeTreeNR</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">StrictPair</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3264"></a><span class="hs-identifier">takeTreeNR</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_i</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;takeTreeNR of empty tree&quot;</span><span>
</span><a name="line-3265"></a><span class="hs-identifier">takeTreeNR</span><span> </span><span class="hs-identifier">_i</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-3266"></a><a name="takeTreeNR"><a href="Data.Sequence.Internal.html#takeTreeNR"><span class="hs-identifier">takeTreeNR</span></a></a><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-identifier">pr</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Err.html#error"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Err.html#error"><span class="hs-identifier hs-var">sf</span></a><span class="hs-special">)</span><span>
</span><a name="line-3267"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">ssf</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">takeSuffixNR</span><span> </span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-3268"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">ssm</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">takeTreeNR</span><span> </span><span class="hs-identifier">im</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3269"></a><span>            </span><span class="hs-identifier">xs</span><span> </span><span class="hs-operator">:*:</span><span> </span><a href="Data.Sequence.Internal.html#takeSuffixNR"><span class="hs-identifier hs-var">mr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">takeMiddleNR</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">im</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">mr</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">ssf</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-identifier">mr</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3270"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">takePrefixNR</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#takeTreeNR"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">ssm</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3271"></a><span>    </span><span class="hs-identifier">ssf</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><a name="local-6989586621679061932"><a href="#local-6989586621679061932"><span class="hs-identifier">sf</span></a></a><span>
</span><a name="line-3272"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">ssm</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ssf</span><span> </span><a href="Data.Sequence.Internal.html#takePrefixNR"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#takePrefixNR"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="Data.Sequence.Internal.html#takePrefixNR"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-3273"></a><span>    </span><a name="local-6989586621679061928"><a href="#local-6989586621679061928"><span class="hs-identifier">im</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">ssf</span><span>
</span><a name="line-3274"></a><span>
</span><a name="line-3275"></a><span class="hs-identifier">takeMiddleNR</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span>
</span><a name="line-3276"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3277"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">StrictPair</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3278"></a><span class="hs-identifier">takeMiddleNR</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">ssf</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node2</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">mr</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">sf</span></a><span>
</span><a name="line-3279"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">sb</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Utils.Containers.Internal.StrictPair.html#StrictPair"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="Utils.Containers.Internal.StrictPair.html#StrictPair"><span class="hs-operator hs-type">:*:</span></a><span> </span><span class="hs-identifier">pullL</span><span> </span><span class="hs-identifier">ssfmr</span><span> </span><span class="hs-identifier">mr</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">sf</span></a><span>
</span><a name="line-3280"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">a</span><span> </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-operator hs-var">:*:</span></a><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">ssfmrb</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">mr</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3281"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3282"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">sb</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3283"></a><span>    </span><span class="hs-identifier">ssfmr</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ssf</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">mr</span><span>
</span><a name="line-3284"></a><span>    </span><span class="hs-identifier">ssfmrb</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">sb</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-identifier">ssfmr</span><span>
</span><a name="line-3285"></a><span class="hs-identifier">takeMiddleNR</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">ssf</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><a href="#local-6989586621679061937"><span class="hs-identifier hs-var">_</span></a><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">mr</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3286"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679061941"><a href="#local-6989586621679061941"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679061941"><a href="#local-6989586621679061941"><span class="hs-operator">&lt;</span></a></a><span> </span><a name="local-6989586621679061941"><a href="#local-6989586621679061941"><span class="hs-identifier">sc</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">c</span><span> </span><a href="#local-6989586621679061940"><span class="hs-operator hs-var">:*:</span></a><span> </span><span class="hs-identifier">pullL</span><span> </span><span class="hs-identifier">ssfmr</span><span> </span><span class="hs-identifier">mr</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3287"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">sbc</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">b</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-operator hs-var">:*:</span></a><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">ssfmrc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">mr</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3288"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679061946"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-operator hs-var">:*:</span></a><span> </span><a href="Data.Sequence.Internal.html#pullL"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-identifier">ssfmrbc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">mr</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3289"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3290"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">sc</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-3291"></a><span>    </span><span class="hs-identifier">sbc</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sc</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3292"></a><span>    </span><span class="hs-identifier">ssfmr</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">ssf</span></a><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">mr</span><span>
</span><a name="line-3293"></a><span>    </span><span class="hs-identifier">ssfmrc</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679061949"><span class="hs-identifier hs-var">sc</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-identifier">ssfmr</span><span>
</span><a name="line-3294"></a><span>    </span><span class="hs-identifier">ssfmrbc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ssfmrc</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3295"></a><span>
</span><a name="line-3296"></a><span class="hs-identifier">takeMiddleER</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679061952"><span class="hs-identifier hs-var">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">Int</span></a><span>
</span><a name="line-3297"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3298"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3299"></a><span class="hs-identifier">takeMiddleER</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">ssf</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node2</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">mr</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">sf</span></a><span>
</span><a name="line-3300"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-number">1</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">pullL</span></a><span> </span><span class="hs-identifier">ssfmr</span><span> </span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">mr</span></a><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3301"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">ssfmrb</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">mr</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3302"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3303"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">ssfmr</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ssf</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-identifier">size</span><span> </span><a href="#local-6989586621679061960"><span class="hs-identifier hs-var">mr</span></a><span>
</span><a name="line-3304"></a><span>    </span><span class="hs-identifier">ssfmrb</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">ssfmr</span><span>
</span><a name="line-3305"></a><span class="hs-identifier">takeMiddleER</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">ssf</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><a href="#local-6989586621679061957"><span class="hs-identifier hs-var">_</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">mr</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3306"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679061960"><a href="#local-6989586621679061960"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679061960"><a href="#local-6989586621679061960"><span class="hs-operator">&lt;</span></a></a><span> </span><span class="hs-number">1</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679061959"><span class="hs-identifier hs-var">pullL</span></a><span> </span><span class="hs-identifier">ssfmr</span><span> </span><span class="hs-identifier">mr</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3307"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-number">2</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">ssfmrc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><a name="local-6989586621679061965"><a href="#local-6989586621679061965"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679061966"><a href="#local-6989586621679061966"><span class="hs-identifier">mr</span></a></a><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3308"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#pullL"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-identifier">ssfmrbc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">mr</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3309"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3310"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">ssfmr</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ssf</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-identifier">size</span><span> </span><a href="#local-6989586621679061969"><span class="hs-identifier hs-var">mr</span></a><span>
</span><a name="line-3311"></a><span>    </span><span class="hs-identifier">ssfmrc</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">ssfmr</span><span>
</span><a name="line-3312"></a><span>    </span><span class="hs-identifier">ssfmrbc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ssfmr</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">2</span><span>
</span><a name="line-3313"></a><span>
</span><a name="line-3314"></a><span class="hs-identifier">takeSuffixER</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679061967"><span class="hs-identifier hs-var">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3315"></a><span class="hs-identifier">takeSuffixER</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_i</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-3316"></a><span class="hs-identifier">takeSuffixER</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-special">(</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Two</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-3317"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="takeSuffixER"><a href="Data.Sequence.Internal.html#takeSuffixER"><span class="hs-identifier">i</span></a></a><span> </span><a name="takeSuffixER"><a href="Data.Sequence.Internal.html#takeSuffixER"><span class="hs-operator">&lt;</span></a></a><span> </span><span class="hs-number">1</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-3318"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3319"></a><span class="hs-identifier">takeSuffixER</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">_</span></a><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-3320"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-operator hs-var">&lt;</span></a><span> </span><span class="hs-number">1</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">EmptyT</span></a><span>
</span><a name="line-3321"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-number">2</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-3322"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-3323"></a><span class="hs-identifier">takeSuffixER</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">_</span></a><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679061975"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span>
</span><a name="line-3324"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-operator hs-var">&lt;</span></a><span> </span><span class="hs-number">1</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-3325"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-number">2</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Single</span><span> </span><a name="local-6989586621679061978"><a href="#local-6989586621679061978"><span class="hs-identifier">d</span></a></a><span>
</span><a name="line-3326"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679061976"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><span class="hs-number">3</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span>
</span><a name="line-3327"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-number">3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span>
</span><a name="line-3328"></a><span>
</span><a name="line-3329"></a><span class="hs-identifier">takeSuffixNR</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-3330"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">StrictPair</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3331"></a><span class="hs-identifier">takeSuffixNR</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_i</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-3332"></a><span class="hs-identifier">takeSuffixNR</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-3333"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="takeSuffixNR"><a href="Data.Sequence.Internal.html#takeSuffixNR"><span class="hs-identifier">i</span></a></a><span> </span><a name="takeSuffixNR"><a href="Data.Sequence.Internal.html#takeSuffixNR"><span class="hs-operator">&lt;</span></a></a><span> </span><a name="takeSuffixNR"><a href="Data.Sequence.Internal.html#takeSuffixNR"><span class="hs-identifier">sb</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-3334"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3335"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3336"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">sb</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3337"></a><span class="hs-identifier">takeSuffixNR</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-3338"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679061985"><a href="#local-6989586621679061985"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">sc</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-3339"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">sbc</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-3340"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679061989"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-operator hs-var">:*:</span></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-identifier">sbc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-3341"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3342"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">sc</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-3343"></a><span>    </span><span class="hs-identifier">sbc</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sc</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3344"></a><span class="hs-identifier">takeSuffixNR</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span>
</span><a name="line-3345"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679061991"><a href="#local-6989586621679061991"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679061991"><a href="#local-6989586621679061991"><span class="hs-operator">&lt;</span></a></a><span> </span><span class="hs-identifier">sd</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">d</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-operator hs-var">:*:</span></a><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-3346"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">scd</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">d</span><span>
</span><a name="line-3347"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679061992"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><span class="hs-identifier">sbcd</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679061996"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-operator hs-var">:*:</span></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-identifier">scd</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span>
</span><a name="line-3348"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679061995"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-operator hs-var">:*:</span></a><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-identifier">sbcd</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span>
</span><a name="line-3349"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3350"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">sd</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">d</span><span>
</span><a name="line-3351"></a><span>    </span><span class="hs-identifier">scd</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sd</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-3352"></a><span>    </span><span class="hs-identifier">sbcd</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">scd</span></a><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3353"></a><span>
</span><a name="line-3354"></a><span class="hs-identifier">takePrefixER</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-3355"></a><span>   </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3356"></a><span class="hs-identifier">takePrefixER</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_i</span><span> </span><span class="hs-glyph">!</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">_</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">sf</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pullL</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679058897"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">sf</span></a><span>
</span><a name="line-3357"></a><span class="hs-identifier">takePrefixER</span><span> </span><span class="hs-identifier">i</span><span> </span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3358"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="takePrefixER"><a href="Data.Sequence.Internal.html#takePrefixER"><span class="hs-identifier">i</span></a></a><span> </span><a name="takePrefixER"><a href="Data.Sequence.Internal.html#takePrefixER"><span class="hs-operator">&lt;</span></a></a><span> </span><span class="hs-number">1</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pullL</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679062003"><a href="#local-6989586621679062003"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3359"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3360"></a><span class="hs-identifier">takePrefixER</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><a href="#local-6989586621679062005"><span class="hs-identifier hs-var">_</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#-"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679062007"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679062008"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-3361"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-operator hs-var">&lt;</span></a><span> </span><span class="hs-number">1</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pullL</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">3</span><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3362"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-number">2</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3363"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#pullL"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3364"></a><span class="hs-identifier">takePrefixER</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><a href="#local-6989586621679062010"><span class="hs-identifier hs-var">_</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#-"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3365"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-operator hs-var">&lt;</span></a><span> </span><span class="hs-number">1</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pullL</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">4</span><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3366"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-number">2</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">3</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><a name="local-6989586621679062021"><a href="#local-6989586621679062021"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3367"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679062015"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><span class="hs-number">3</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#pullL"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3368"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062016"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span> </span><a href="#local-6989586621679062021"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3369"></a><span>
</span><a name="line-3370"></a><span class="hs-identifier">takePrefixNR</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-3371"></a><span>   </span><span class="hs-identifier">StrictPair</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3372"></a><span class="hs-identifier">takePrefixNR</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_i</span><span> </span><span class="hs-glyph">!</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">sf</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">a</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-operator hs-type">:*:</span></a><span> </span><span class="hs-identifier">pullL</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">size</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">sf</span></a><span>
</span><a name="line-3373"></a><span class="hs-identifier">takePrefixNR</span><span> </span><span class="hs-identifier">i</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">sf</span></a><span>
</span><a name="line-3374"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="takePrefixNR"><a href="Data.Sequence.Internal.html#takePrefixNR"><span class="hs-identifier">i</span></a></a><span> </span><a name="takePrefixNR"><a href="Data.Sequence.Internal.html#takePrefixNR"><span class="hs-operator">&lt;</span></a></a><span> </span><a name="takePrefixNR"><a href="Data.Sequence.Internal.html#takePrefixNR"><span class="hs-identifier">sb</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679062023"><a href="#local-6989586621679062023"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">pullL</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679062026"><a href="#local-6989586621679062026"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">sb</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">size</span><span> </span><a href="Data.Sequence.Internal.html#pullL"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679062023"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3375"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679062032"><a href="#local-6989586621679062032"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3376"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3377"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">sb</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3378"></a><span class="hs-identifier">takePrefixNR</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3379"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679062033"><a href="#local-6989586621679062033"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">sc</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">pullL</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">sbc</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3380"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">sbc</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-operator hs-var">:*:</span></a><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3381"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679062038"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-operator hs-var">:*:</span></a><span> </span><a href="Data.Sequence.Internal.html#pullL"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">size</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#-"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">b</span><span> </span><a href="#local-6989586621679062039"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679062040"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3382"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3383"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">sc</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-3384"></a><span>    </span><span class="hs-identifier">sbc</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sc</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3385"></a><span class="hs-identifier">takePrefixNR</span><span> </span><span class="hs-identifier">i</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3386"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679062042"><a href="#local-6989586621679062042"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679062042"><a href="#local-6989586621679062042"><span class="hs-operator">&lt;</span></a></a><span> </span><span class="hs-identifier">sd</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">d</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-operator hs-var">:*:</span></a><span> </span><span class="hs-identifier">pullL</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">sd</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">sabc</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3387"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">scd</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">sabc</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3388"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679062043"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><span class="hs-identifier">sbcd</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679062048"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-operator hs-var">:*:</span></a><span> </span><a href="Data.Sequence.Internal.html#pullL"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">sab</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062053"><span class="hs-identifier hs-var">Two</span></a><span> </span><span class="hs-identifier">c</span><span> </span><a href="#local-6989586621679062049"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679062050"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3389"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679062047"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-operator hs-var">:*:</span></a><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062044"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679062053"><span class="hs-identifier hs-var">sa</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><a href="#local-6989586621679062048"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3390"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3391"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">sa</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-3392"></a><span>    </span><span class="hs-identifier">sab</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sa</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3393"></a><span>    </span><span class="hs-identifier">sabc</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">sab</span></a><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-3394"></a><span>    </span><a name="local-6989586621679062052"><a href="#local-6989586621679062052"><span class="hs-identifier">sd</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-3395"></a><span>    </span><a name="local-6989586621679062053"><a href="#local-6989586621679062053"><span class="hs-identifier">scd</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">c</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-identifier">sd</span><span>
</span><a name="line-3396"></a><span>    </span><span class="hs-identifier">sbcd</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679062048"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">scd</span><span>
</span><a name="line-3397"></a><span>
</span><a name="line-3398"></a><span class="hs-comment">-- | \( O(\log(\min(i,n-i))) \). Split a sequence at a given position.</span><span>
</span><a name="line-3399"></a><span class="hs-comment">-- @'splitAt' i s = ('take' i s, 'drop' i s)@.</span><span>
</span><a name="line-3400"></a><span class="hs-identifier">splitAt</span><span>                  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3401"></a><span class="hs-identifier">splitAt</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">xs</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">t</span><span class="hs-special">)</span><span>
</span><a name="line-3402"></a><span>  </span><span class="hs-comment">-- We use an unsigned comparison to make the common case</span><span>
</span><a name="line-3403"></a><span>  </span><span class="hs-comment">-- faster. This only works because our representation of</span><span>
</span><a name="line-3404"></a><span>  </span><span class="hs-comment">-- sizes as (signed) Ints gives us a free high bit to play</span><span>
</span><a name="line-3405"></a><span>  </span><span class="hs-comment">-- with. Note also that there's no sharing to lose in the</span><span>
</span><a name="line-3406"></a><span>  </span><span class="hs-comment">-- case that the length is 0.</span><span>
</span><a name="line-3407"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Word</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-3408"></a><span>      </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">splitTreeE</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3409"></a><span>        </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Real.html#fromIntegral"><span class="hs-operator hs-var">:*:</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">,</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-3410"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#splitTreeE"><span class="hs-identifier hs-var">empty</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>
</span><a name="line-3411"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">xs</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">empty</span><span class="hs-special">)</span><span>
</span><a name="line-3412"></a><span>
</span><a name="line-3413"></a><span class="hs-comment">-- | \( O(\log(\min(i,n-i))) \) A version of 'splitAt' that does not attempt to</span><span>
</span><a name="line-3414"></a><span class="hs-comment">-- enhance sharing when the split point is less than or equal to 0, and that</span><span>
</span><a name="line-3415"></a><span class="hs-comment">-- gives completely wrong answers when the split point is at least the length</span><span>
</span><a name="line-3416"></a><span class="hs-comment">-- of the sequence, unless the sequence is a singleton. This is used to</span><span>
</span><a name="line-3417"></a><span class="hs-comment">-- implement zipWith and chunksOf, which are extremely sensitive to the cost of</span><span>
</span><a name="line-3418"></a><span class="hs-comment">-- splitting very short sequences. There is just enough of a speed increase to</span><span>
</span><a name="line-3419"></a><span class="hs-comment">-- make this worth the trouble.</span><span>
</span><a name="line-3420"></a><span class="hs-identifier">uncheckedSplitAt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3421"></a><span class="hs-identifier">uncheckedSplitAt</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">splitTreeE</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3422"></a><span>  </span><span class="hs-identifier">l</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">r</span><span class="hs-special">)</span><span>
</span><a name="line-3423"></a><span>
</span><a name="line-3424"></a><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">Split</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Split</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3425"></a><span class="hs-cpp">#ifdef TESTING
</span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier">Show</span><span>
</span><a name="line-3427"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-3429"></a><span class="hs-identifier">splitTreeE</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">StrictPair</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3430"></a><span class="hs-identifier">splitTreeE</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_i</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-3431"></a><span class="hs-identifier">splitTreeE</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">t</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">_</span></a><span class="hs-special">)</span><span>
</span><a name="line-3432"></a><span>   </span><span class="hs-glyph">|</span><span> </span><a name="splitTreeE"><a href="Data.Sequence.Internal.html#splitTreeE"><span class="hs-identifier">i</span></a></a><span> </span><a name="splitTreeE"><a href="Data.Sequence.Internal.html#splitTreeE"><span class="hs-operator">&lt;=</span></a></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-operator">:*:</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-3433"></a><span>   </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-operator hs-var">:*:</span></a><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-3434"></a><span class="hs-identifier">splitTreeE</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-identifier hs-var">pr</span></a><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span>
</span><a name="line-3435"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-operator hs-var">&lt;</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">spr</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splitPrefixE</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3436"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">spm</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">splitTreeN</span><span> </span><span class="hs-identifier">im</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3437"></a><span>            </span><span class="hs-identifier">Split</span><span> </span><a href="Data.Sequence.Internal.html#splitPrefixE"><span class="hs-identifier hs-var">ml</span></a><span> </span><a href="Data.Sequence.Internal.html#splitPrefixE"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="Data.Sequence.Internal.html#splitPrefixE"><span class="hs-identifier hs-var">mr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">splitMiddleE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">im</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">ml</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">spr</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">ml</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-identifier">mr</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3438"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splitSuffixE</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#splitTreeN"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">spm</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3439"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3440"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">spr</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><a href="Data.Sequence.Internal.html#splitSuffixE"><span class="hs-identifier hs-var">pr</span></a><span>
</span><a name="line-3441"></a><span>    </span><span class="hs-identifier">spm</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">spr</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">m</span><span>
</span><a name="line-3442"></a><span>    </span><a name="local-6989586621679062074"><a href="#local-6989586621679062074"><span class="hs-identifier">im</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">spr</span><span>
</span><a name="line-3443"></a><span>
</span><a name="line-3444"></a><span class="hs-identifier">splitTreeN</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Split</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-3445"></a><span class="hs-identifier">splitTreeN</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_i</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;splitTreeN of empty tree&quot;</span><span>
</span><a name="line-3446"></a><span class="hs-identifier">splitTreeN</span><span> </span><span class="hs-identifier">_i</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Split</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-3447"></a><a name="splitTreeN"><a href="Data.Sequence.Internal.html#splitTreeN"><span class="hs-identifier">splitTreeN</span></a></a><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-identifier">pr</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Err.html#error"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Err.html#error"><span class="hs-identifier hs-var">sf</span></a><span class="hs-special">)</span><span>
</span><a name="line-3448"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">spr</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splitPrefixN</span><span> </span><a href="Data.Sequence.Internal.html#Split"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3449"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">spm</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">splitTreeN</span><span> </span><span class="hs-identifier">im</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3450"></a><span>            </span><span class="hs-identifier">Split</span><span> </span><a href="Data.Sequence.Internal.html#splitPrefixN"><span class="hs-identifier hs-var">ml</span></a><span> </span><a href="Data.Sequence.Internal.html#splitPrefixN"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="Data.Sequence.Internal.html#splitPrefixN"><span class="hs-identifier hs-var">mr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">splitMiddleN</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">im</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">ml</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">spr</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">ml</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-identifier">mr</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3451"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splitSuffixN</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#splitTreeN"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">spm</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3452"></a><span>    </span><span class="hs-identifier">spr</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">pr</span><span>
</span><a name="line-3453"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">spm</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">spr</span><span> </span><a href="Data.Sequence.Internal.html#splitSuffixN"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.Sequence.Internal.html#splitSuffixN"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="Data.Sequence.Internal.html#splitSuffixN"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-3454"></a><span>    </span><a name="local-6989586621679062088"><a href="#local-6989586621679062088"><span class="hs-identifier">im</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">spr</span><span>
</span><a name="line-3455"></a><span>
</span><a name="line-3456"></a><span class="hs-identifier">splitMiddleN</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span>
</span><a name="line-3457"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3458"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Split</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-3459"></a><span class="hs-identifier">splitMiddleN</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">s</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">spr</span></a><span> </span><span class="hs-identifier">pr</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">ml</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node2</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">_</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">mr</span></a><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3460"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">sa</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Split</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pullR</span><span> </span><span class="hs-identifier">sprml</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">ml</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">sprmla</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">mr</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span>
</span><a name="line-3461"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Split</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">sprmla</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">ml</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pullL</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">sprmla</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">mr</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span>
</span><a name="line-3462"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3463"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">sa</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><a href="Data.Sequence.Internal.html#Split"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-3464"></a><span>    </span><span class="hs-identifier">sprml</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">spr</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">ml</span><span>
</span><a name="line-3465"></a><span>    </span><span class="hs-identifier">sprmla</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">sa</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-identifier">sprml</span><span>
</span><a name="line-3466"></a><span class="hs-identifier">splitMiddleN</span><span> </span><span class="hs-identifier">i</span><span> </span><a href="#local-6989586621679062096"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-identifier">spr</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">pr</span></a><span> </span><span class="hs-identifier">ml</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">mr</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3467"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679062105"><a href="#local-6989586621679062105"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679062105"><a href="#local-6989586621679062105"><span class="hs-operator">&lt;</span></a></a><span> </span><a name="local-6989586621679062105"><a href="#local-6989586621679062105"><span class="hs-identifier">sa</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Split</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pullR</span><span> </span><span class="hs-identifier">sprml</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">ml</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">sprmla</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">mr</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span>
</span><a name="line-3468"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">sab</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Split</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">sprmla</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">ml</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">sprmlab</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">mr</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span>
</span><a name="line-3469"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Split"><span class="hs-identifier hs-var">Split</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#pullR"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-identifier">sprmlab</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">ml</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#-"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062119"><span class="hs-identifier hs-var">pullL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">sprmlab</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">mr</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span>
</span><a name="line-3470"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3471"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">sa</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><a href="Data.Sequence.Internal.html#Split"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-3472"></a><span>    </span><span class="hs-identifier">sab</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sa</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3473"></a><span>    </span><span class="hs-identifier">sprml</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">spr</span></a><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">ml</span><span>
</span><a name="line-3474"></a><span>    </span><span class="hs-identifier">sprmla</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679062116"><span class="hs-identifier hs-var">sa</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-identifier">sprml</span><span>
</span><a name="line-3475"></a><span>    </span><span class="hs-identifier">sprmlab</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sprmla</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3476"></a><span>
</span><a name="line-3477"></a><span class="hs-identifier">splitMiddleE</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679062119"><span class="hs-identifier hs-var">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span>
</span><a name="line-3478"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3479"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">StrictPair</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3480"></a><span class="hs-identifier">splitMiddleE</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">s</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">spr</span></a><span> </span><span class="hs-identifier">pr</span><span> </span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">ml</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node2</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">_</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">mr</span></a><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3481"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-number">1</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Utils.Containers.Internal.StrictPair.html#StrictPair"><span class="hs-identifier hs-type">pullR</span></a><span> </span><span class="hs-identifier">sprml</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">pr</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">ml</span></a><span> </span><span class="hs-operator">:*:</span><span> </span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">sprml</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">mr</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3482"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">sprmla</span><span> </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">pr</span></a><span> </span><span class="hs-identifier">ml</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><a name="local-6989586621679062128"><a href="#local-6989586621679062128"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">sprmla</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">mr</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3483"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3484"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">sprml</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">spr</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-identifier">size</span><span> </span><a href="#local-6989586621679062131"><span class="hs-identifier hs-var">ml</span></a><span>
</span><a name="line-3485"></a><span>    </span><span class="hs-identifier">sprmla</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">sprml</span><span>
</span><a name="line-3486"></a><span class="hs-identifier">splitMiddleE</span><span> </span><span class="hs-identifier">i</span><span> </span><a href="#local-6989586621679062123"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-identifier">spr</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">pr</span></a><span> </span><span class="hs-identifier">ml</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">mr</span><span> </span><span class="hs-identifier">sf</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3487"></a><span>  </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">pullR</span><span> </span><span class="hs-identifier">sprml</span><span> </span><a href="#local-6989586621679062130"><span class="hs-identifier hs-var">pr</span></a><span> </span><span class="hs-identifier">ml</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">sprml</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">mr</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3488"></a><span>  </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">sprmla</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">ml</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679062140"><a href="#local-6989586621679062140"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">sprmla</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">mr</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3489"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#pullR"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-identifier">sprmlab</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">ml</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-operator">:*:</span><span> </span><a href="#local-6989586621679062142"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">sprmlab</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><a href="#local-6989586621679062141"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">mr</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3490"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3491"></a><span>    </span><span class="hs-identifier">sprml</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679062144"><span class="hs-identifier hs-var">spr</span></a><span> </span><a href="#local-6989586621679062144"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">ml</span><span>
</span><a name="line-3492"></a><span>    </span><span class="hs-identifier">sprmla</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">sprml</span><span>
</span><a name="line-3493"></a><span>    </span><span class="hs-identifier">sprmlab</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sprmla</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">1</span><span>
</span><a name="line-3494"></a><span>
</span><a name="line-3495"></a><span class="hs-identifier">splitPrefixE</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679062143"><span class="hs-identifier hs-var">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-3496"></a><span>                    </span><span class="hs-identifier">StrictPair</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3497"></a><span class="hs-identifier">splitPrefixE</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_i</span><span> </span><span class="hs-glyph">!</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">sf</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">Deep</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">One</span></a><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3498"></a><span class="hs-identifier">splitPrefixE</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><a href="Utils.Containers.Internal.StrictPair.html#StrictPair"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="Utils.Containers.Internal.StrictPair.html#StrictPair"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><a href="Utils.Containers.Internal.StrictPair.html#StrictPair"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier">sf</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3499"></a><span>  </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">Deep</span><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><a name="local-6989586621679062149"><a href="#local-6989586621679062149"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-3500"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3501"></a><span class="hs-identifier">splitPrefixE</span><span> </span><span class="hs-identifier">i</span><span> </span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3502"></a><span>  </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">Deep</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3503"></a><span>  </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679062159"><a href="#local-6989586621679062159"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679062156"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3504"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><a href="#local-6989586621679062159"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3505"></a><span class="hs-identifier">splitPrefixE</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">sf</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3506"></a><span>  </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">Deep</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span> </span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-3507"></a><span>  </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span> </span><a href="#local-6989586621679062163"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3508"></a><span>  </span><span class="hs-number">2</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3509"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-number">3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062170"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">3</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3510"></a><span>
</span><a name="line-3511"></a><span class="hs-identifier">splitPrefixN</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-3512"></a><span>                    </span><span class="hs-identifier">Split</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-3513"></a><span class="hs-identifier">splitPrefixN</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_i</span><span> </span><span class="hs-glyph">!</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">sf</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Split</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">pullL</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">size</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span>
</span><a name="line-3514"></a><span class="hs-identifier">splitPrefixN</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><a href="Data.Sequence.Internal.html#Split"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="Data.Sequence.Internal.html#Split"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3515"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="splitPrefixN"><a href="Data.Sequence.Internal.html#splitPrefixN"><span class="hs-identifier">i</span></a></a><span> </span><a name="splitPrefixN"><a href="Data.Sequence.Internal.html#splitPrefixN"><span class="hs-operator">&lt;</span></a></a><span> </span><a name="splitPrefixN"><a href="Data.Sequence.Internal.html#splitPrefixN"><span class="hs-identifier">sa</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Split</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><a name="local-6989586621679062175"><a href="#local-6989586621679062175"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">sa</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><a href="Data.Sequence.Internal.html#pullL"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span>
</span><a name="line-3516"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Split</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pullL</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">sa</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span>
</span><a name="line-3517"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3518"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">sa</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><a href="Data.Sequence.Internal.html#Split"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-3519"></a><span class="hs-identifier">splitPrefixN</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3520"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679062182"><a href="#local-6989586621679062182"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">sa</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Split</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">sa</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span>
</span><a name="line-3521"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">sab</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Split</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">sab</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span>
</span><a name="line-3522"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Split"><span class="hs-identifier hs-var">Split</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-identifier">sab</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">One</span></a><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679062188"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">pullL</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">sab</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span>
</span><a name="line-3523"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3524"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">sa</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><a href="Data.Sequence.Internal.html#Split"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-3525"></a><span>    </span><span class="hs-identifier">sab</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sa</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3526"></a><span class="hs-identifier">splitPrefixN</span><span> </span><span class="hs-identifier">i</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3527"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679062191"><a href="#local-6989586621679062191"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679062191"><a href="#local-6989586621679062191"><span class="hs-operator">&lt;</span></a></a><span> </span><span class="hs-identifier">sa</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Split</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">sa</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3528"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">sab</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Split</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><a name="local-6989586621679062198"><a href="#local-6989586621679062198"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679062199"><a href="#local-6989586621679062199"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">sab</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3529"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679062192"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><span class="hs-identifier">sabc</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Split"><span class="hs-identifier hs-var">Split</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-identifier">sab</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">One</span></a><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">One</span></a><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679062196"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679062197"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">sabc</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3530"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Split"><span class="hs-identifier hs-var">Split</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-identifier">sabc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679062197"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">pullL</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">sabc</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-3531"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3532"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">sa</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><a href="Data.Sequence.Internal.html#Split"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-3533"></a><span>    </span><span class="hs-identifier">sab</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sa</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3534"></a><span>    </span><span class="hs-identifier">sabc</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">sab</span></a><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-3535"></a><span>
</span><a name="line-3536"></a><span class="hs-identifier">splitSuffixE</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-3537"></a><span>   </span><span class="hs-identifier">StrictPair</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3538"></a><span class="hs-identifier">splitSuffixE</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_i</span><span> </span><span class="hs-glyph">!</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier">pr</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pullR</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679058887"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">pr</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-operator hs-type">:*:</span></a><span> </span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-3539"></a><span class="hs-identifier">splitSuffixE</span><span> </span><span class="hs-identifier">i</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">pr</span></a><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3540"></a><span>  </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a name="splitSuffixE"><a href="Data.Sequence.Internal.html#splitSuffixE"><span class="hs-identifier">pullR</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679062203"><a href="#local-6989586621679062203"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-operator hs-var">:*:</span></a><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><a href="#local-6989586621679062204"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-3541"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679062208"><a href="#local-6989586621679062208"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3542"></a><span class="hs-identifier">splitSuffixE</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3543"></a><span>  </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">pullR</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">3</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-operator hs-var">:*:</span></a><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679062213"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-3544"></a><span>  </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679062214"><a href="#local-6989586621679062214"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-3545"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#pullR"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">(</span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-3546"></a><span class="hs-identifier">splitSuffixE</span><span> </span><a href="#local-6989586621679062215"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#-"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-identifier">pr</span><span> </span><a href="#local-6989586621679062216"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679062218"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier">c</span><span> </span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-3547"></a><span>  </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">pullR</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">4</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-operator hs-var">:*:</span></a><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-number">4</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span>
</span><a name="line-3548"></a><span>  </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679062221"><a href="#local-6989586621679062221"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">3</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><a name="local-6989586621679062226"><a href="#local-6989586621679062226"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span>
</span><a name="line-3549"></a><span>  </span><span class="hs-number">2</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#pullR"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">(</span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">One</span></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span>
</span><a name="line-3550"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062222"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679062223"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679062224"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><a href="Utils.Containers.Internal.StrictPair.html#%3A%2A%3A"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">d</span><span>
</span><a name="line-3551"></a><span>
</span><a name="line-3552"></a><span class="hs-identifier">splitSuffixN</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-3553"></a><span>   </span><span class="hs-identifier">Split</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-3554"></a><span class="hs-identifier">splitSuffixN</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_i</span><span> </span><span class="hs-glyph">!</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier">pr</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Split</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pullR</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">size</span></a><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">pr</span></a><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-3555"></a><span class="hs-identifier">splitSuffixN</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-3556"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="splitSuffixN"><a href="Data.Sequence.Internal.html#splitSuffixN"><span class="hs-identifier">i</span></a></a><span> </span><a name="splitSuffixN"><a href="Data.Sequence.Internal.html#splitSuffixN"><span class="hs-operator">&lt;</span></a></a><span> </span><a name="splitSuffixN"><a href="Data.Sequence.Internal.html#splitSuffixN"><span class="hs-identifier">sa</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Split</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pullR</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><a href="Data.Sequence.Internal.html#Split"><span class="hs-identifier hs-var">sa</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">size</span><span> </span><a href="Data.Sequence.Internal.html#pullR"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-3557"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Split</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-3558"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3559"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">sa</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><a href="Data.Sequence.Internal.html#Split"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-3560"></a><span class="hs-identifier">splitSuffixN</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-3561"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679062240"><a href="#local-6989586621679062240"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">sa</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Split</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pullR</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">sab</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">deep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3562"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">sab</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Split</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679062246"><a href="#local-6989586621679062246"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-3563"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Split"><span class="hs-identifier hs-var">Split</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#pullR"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">size</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#-"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">pr</span></a><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><a href="#local-6989586621679062244"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#deep"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-3564"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3565"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">sa</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><a href="Data.Sequence.Internal.html#Split"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-3566"></a><span>    </span><span class="hs-identifier">sab</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sa</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3567"></a><span class="hs-identifier">splitSuffixN</span><span> </span><span class="hs-identifier">i</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span>
</span><a name="line-3568"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679062249"><a href="#local-6989586621679062249"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679062249"><a href="#local-6989586621679062249"><span class="hs-operator">&lt;</span></a></a><span> </span><span class="hs-identifier">sa</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Split</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pullR</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">sa</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">sbcd</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">sbcd</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3569"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">sab</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Split</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">sbcd</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">scd</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3570"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679062250"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><span class="hs-identifier">sabc</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Split"><span class="hs-identifier hs-var">Split</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#pullR"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">scd</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span> </span><a href="#local-6989586621679062263"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><a href="#local-6989586621679062253"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span>
</span><a name="line-3571"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Split"><span class="hs-identifier hs-var">Split</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679062251"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679062263"><span class="hs-identifier hs-var">sd</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span> </span><a href="#local-6989586621679062252"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><a href="#local-6989586621679062254"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-identifier">b</span><span> </span><a href="#local-6989586621679062255"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-3572"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3573"></a><span>    </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">sa</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><a href="Data.Sequence.Internal.html#Split"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-3574"></a><span>    </span><span class="hs-identifier">sab</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sa</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3575"></a><span>    </span><span class="hs-identifier">sabc</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">sab</span></a><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-3576"></a><span>    </span><a name="local-6989586621679062259"><a href="#local-6989586621679062259"><span class="hs-identifier">sd</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-3577"></a><span>    </span><a name="local-6989586621679062260"><a href="#local-6989586621679062260"><span class="hs-identifier">scd</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">c</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-identifier">sd</span><span>
</span><a name="line-3578"></a><span>    </span><span class="hs-identifier">sbcd</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-6989586621679062257"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">scd</span><span>
</span><a name="line-3579"></a><span>
</span><a name="line-3580"></a><span class="hs-comment">-- | \(O \Bigl(\bigl(\frac{n}{c}\bigr) \log c\Bigr)\). @chunksOf c xs@ splits @xs@ into chunks of size @c&gt;0@.</span><span>
</span><a name="line-3581"></a><span class="hs-comment">-- If @c@ does not divide the length of @xs@ evenly, then the last element</span><span>
</span><a name="line-3582"></a><span class="hs-comment">-- of the result will be short.</span><span>
</span><a name="line-3583"></a><span class="hs-comment">--</span><span>
</span><a name="line-3584"></a><span class="hs-comment">-- Side note: the given performance bound is missing some messy terms that only</span><span>
</span><a name="line-3585"></a><span class="hs-comment">-- really affect edge cases. Performance degrades smoothly from \( O(1) \) (for</span><span>
</span><a name="line-3586"></a><span class="hs-comment">-- \( c = n \)) to \( O(n) \) (for \( c = 1 \)). The true bound is more like</span><span>
</span><a name="line-3587"></a><span class="hs-comment">-- \( O \Bigl( \bigl(\frac{n}{c} - 1\bigr) (\log (c + 1)) + 1 \Bigr) \)</span><span>
</span><a name="line-3588"></a><span class="hs-comment">--</span><span>
</span><a name="line-3589"></a><span class="hs-comment">-- @since 0.5.8</span><span>
</span><a name="line-3590"></a><span class="hs-identifier">chunksOf</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3591"></a><span class="hs-identifier">chunksOf</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-operator">&lt;=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-3592"></a><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">null</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-3593"></a><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">empty</span><span>
</span><a name="line-3594"></a><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;chunksOf: A non-empty sequence can only be broken up into positively-sized chunks.&quot;</span><span>
</span><a name="line-3595"></a><span class="hs-identifier">chunksOf</span><span> </span><span class="hs-number">1</span><span> </span><a href="Data.Sequence.Internal.html#empty"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">singleton</span><span> </span><span class="hs-identifier">s</span><span>
</span><a name="line-3596"></a><span class="hs-identifier">chunksOf</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Err.html#error"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Err.html#error"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splitMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">uncheckedSplitAt</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-operator">*</span><span class="hs-identifier">n</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">const</span><span> </span><span class="hs-identifier">most</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">replicate</span><span> </span><span class="hs-identifier">numReps</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3597"></a><span>                 </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-operator hs-var">&gt;&lt;</span></a><span> </span><span class="hs-keyword">if</span><span> </span><a href="Data.Sequence.Internal.html#singleton"><span class="hs-identifier hs-var">null</span></a><span> </span><span class="hs-identifier">end</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">empty</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">singleton</span><span> </span><span class="hs-identifier">end</span><span>
</span><a name="line-3598"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3599"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">numReps</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">endLength</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">quotRem</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">n</span><span>
</span><a name="line-3600"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">most</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">end</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splitAt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">endLength</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">s</span><span>
</span><a name="line-3601"></a><span>
</span><a name="line-3602"></a><span class="hs-comment">-- | \( O(n) \).  Returns a sequence of all suffixes of this sequence,</span><span>
</span><a name="line-3603"></a><span class="hs-comment">-- longest first.  For example,</span><span>
</span><a name="line-3604"></a><span class="hs-comment">--</span><span>
</span><a name="line-3605"></a><span class="hs-comment">-- &gt; tails (fromList &quot;abc&quot;) = fromList [fromList &quot;abc&quot;, fromList &quot;bc&quot;, fromList &quot;c&quot;, fromList &quot;&quot;]</span><span>
</span><a name="line-3606"></a><span class="hs-comment">--</span><span>
</span><a name="line-3607"></a><span class="hs-comment">-- Evaluating the \( i \)th suffix takes \( O(\log(\min(i, n-i))) \), but evaluating</span><span>
</span><a name="line-3608"></a><span class="hs-comment">-- every suffix in the sequence takes \( O(n) \) due to sharing.</span><span>
</span><a name="line-3609"></a><span class="hs-identifier">tails</span><span>                   </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3610"></a><span class="hs-identifier">tails</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">tailsTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">Seq</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-operator">|&gt;</span><span> </span><span class="hs-identifier">empty</span><span>
</span><a name="line-3611"></a><span>
</span><a name="line-3612"></a><span class="hs-comment">-- | \( O(n) \).  Returns a sequence of all prefixes of this sequence,</span><span>
</span><a name="line-3613"></a><span class="hs-comment">-- shortest first.  For example,</span><span>
</span><a name="line-3614"></a><span class="hs-comment">--</span><span>
</span><a name="line-3615"></a><span class="hs-comment">-- &gt; inits (fromList &quot;abc&quot;) = fromList [fromList &quot;&quot;, fromList &quot;a&quot;, fromList &quot;ab&quot;, fromList &quot;abc&quot;]</span><span>
</span><a name="line-3616"></a><span class="hs-comment">--</span><span>
</span><a name="line-3617"></a><span class="hs-comment">-- Evaluating the \( i \)th prefix takes \( O(\log(\min(i, n-i))) \), but evaluating</span><span>
</span><a name="line-3618"></a><span class="hs-comment">-- every prefix in the sequence takes \( O(n) \) due to sharing.</span><span>
</span><a name="line-3619"></a><span class="hs-identifier">inits</span><span>                   </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3620"></a><span class="hs-identifier">inits</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">empty</span><span> </span><span class="hs-operator">&lt;|</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">initsTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">Seq</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>
</span><a name="line-3621"></a><span>
</span><a name="line-3622"></a><span class="hs-comment">-- This implementation of tails (and, analogously, inits) has the</span><span>
</span><a name="line-3623"></a><span class="hs-comment">-- following algorithmic advantages:</span><span>
</span><a name="line-3624"></a><span class="hs-comment">--      Evaluating each tail in the sequence takes linear total time,</span><span>
</span><a name="line-3625"></a><span class="hs-comment">--      which is better than we could say for</span><span>
</span><a name="line-3626"></a><span class="hs-comment">--              @fromList [drop n xs | n &lt;- [0..length xs]]@.</span><span>
</span><a name="line-3627"></a><span class="hs-comment">--      Evaluating any individual tail takes logarithmic time, which is</span><span>
</span><a name="line-3628"></a><span class="hs-comment">--      better than we can say for either</span><span>
</span><a name="line-3629"></a><span class="hs-comment">--              @scanr (&lt;|) empty xs@ or @iterateN (length xs + 1) (\ xs -&gt; let _ :&lt; xs' = viewl xs in xs') xs@.</span><span>
</span><a name="line-3630"></a><span class="hs-comment">--</span><span>
</span><a name="line-3631"></a><span class="hs-comment">-- Moreover, if we actually look at every tail in the sequence, the</span><span>
</span><a name="line-3632"></a><span class="hs-comment">-- following benchmarks demonstrate that this implementation is modestly</span><span>
</span><a name="line-3633"></a><span class="hs-comment">-- faster than any of the above:</span><span>
</span><a name="line-3634"></a><span class="hs-comment">--</span><span>
</span><a name="line-3635"></a><span class="hs-comment">-- Times (ms)</span><span>
</span><a name="line-3636"></a><span class="hs-comment">--               min      mean    +/-sd    median    max</span><span>
</span><a name="line-3637"></a><span class="hs-comment">-- Seq.tails:   21.986   24.961   10.169   22.417   86.485</span><span>
</span><a name="line-3638"></a><span class="hs-comment">-- scanr:       85.392   87.942    2.488   87.425  100.217</span><span>
</span><a name="line-3639"></a><span class="hs-comment">-- iterateN:       29.952   31.245    1.574   30.412   37.268</span><span>
</span><a name="line-3640"></a><span class="hs-comment">--</span><span>
</span><a name="line-3641"></a><span class="hs-comment">-- The algorithm for tails (and, analogously, inits) is as follows:</span><span>
</span><a name="line-3642"></a><span class="hs-comment">--</span><span>
</span><a name="line-3643"></a><span class="hs-comment">-- A Node in the FingerTree of tails is constructed by evaluating the</span><span>
</span><a name="line-3644"></a><span class="hs-comment">-- corresponding tail of the FingerTree of Nodes, considering the first</span><span>
</span><a name="line-3645"></a><span class="hs-comment">-- Node in this tail, and constructing a Node in which each tail of this</span><span>
</span><a name="line-3646"></a><span class="hs-comment">-- Node is made to be the prefix of the remaining tree.  This ends up</span><span>
</span><a name="line-3647"></a><span class="hs-comment">-- working quite elegantly, as the remainder of the tail of the FingerTree</span><span>
</span><a name="line-3648"></a><span class="hs-comment">-- of Nodes becomes the middle of a new tail, the suffix of the Node is</span><span>
</span><a name="line-3649"></a><span class="hs-comment">-- the prefix, and the suffix of the original tree is retained.</span><span>
</span><a name="line-3650"></a><span class="hs-comment">--</span><span>
</span><a name="line-3651"></a><span class="hs-comment">-- In particular, evaluating the /i/th tail involves making as</span><span>
</span><a name="line-3652"></a><span class="hs-comment">-- many partial evaluations as the Node depth of the /i/th element.</span><span>
</span><a name="line-3653"></a><span class="hs-comment">-- In addition, when we evaluate the /i/th tail, and we also evaluate</span><span>
</span><a name="line-3654"></a><span class="hs-comment">-- the /j/th tail, and /m/ Nodes are on the path to both /i/ and /j/,</span><span>
</span><a name="line-3655"></a><span class="hs-comment">-- each of those /m/ evaluations are shared between the computation of</span><span>
</span><a name="line-3656"></a><span class="hs-comment">-- the /i/th and /j/th tails.</span><span>
</span><a name="line-3657"></a><span class="hs-comment">--</span><span>
</span><a name="line-3658"></a><span class="hs-comment">-- wasserman.louis@gmail.com, 7/16/09</span><span>
</span><a name="line-3659"></a><span>
</span><a name="line-3660"></a><span class="hs-identifier">tailsDigit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Digit</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3661"></a><span class="hs-identifier">tailsDigit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">One</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3662"></a><span class="hs-identifier">tailsDigit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Two</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-3663"></a><a name="tailsDigit"><a href="Data.Sequence.Internal.html#tailsDigit"><span class="hs-identifier">tailsDigit</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Three</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-3664"></a><span class="hs-identifier">tailsDigit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Four</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span>
</span><a name="line-3665"></a><span>
</span><a name="line-3666"></a><span class="hs-identifier">initsDigit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Digit</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3667"></a><span class="hs-identifier">initsDigit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">One</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3668"></a><span class="hs-identifier">initsDigit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Two</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-3669"></a><a name="initsDigit"><a href="Data.Sequence.Internal.html#initsDigit"><span class="hs-identifier">initsDigit</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Three</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-3670"></a><span class="hs-identifier">initsDigit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Four</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span>
</span><a name="line-3671"></a><span>
</span><a name="line-3672"></a><span class="hs-identifier">tailsNode</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Digit</span><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-3673"></a><span class="hs-identifier">tailsNode</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node2</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Node2</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-3674"></a><span class="hs-identifier">tailsNode</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-3675"></a><span>
</span><a name="line-3676"></a><span class="hs-identifier">initsNode</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Digit</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3677"></a><span class="hs-identifier">initsNode</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node2</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Node2</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-3678"></a><span class="hs-identifier">initsNode</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-3679"></a><span>
</span><a name="line-3680"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">tailsTree</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-3681"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">tailsTree</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-3682"></a><span class="hs-comment">-- | Given a function to apply to tails of a tree, applies that function</span><span>
</span><a name="line-3683"></a><span class="hs-comment">-- to every tail of the specified tree.</span><span>
</span><a name="line-3684"></a><span class="hs-identifier">tailsTree</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Sized</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3685"></a><span class="hs-identifier">tailsTree</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-3686"></a><span class="hs-identifier">tailsTree</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">Single</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3687"></a><a name="tailsTree"><a href="Data.Sequence.Internal.html#tailsTree"><span class="hs-identifier">tailsTree</span></a></a><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">pr</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">sf</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-3688"></a><span>    </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">pr'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">deep</span><span> </span><span class="hs-identifier">pr'</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">tailsDigit</span><span> </span><span class="hs-identifier">pr</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3689"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">tailsTree</span><span> </span><span class="hs-identifier">f'</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span>
</span><a name="line-3690"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">digitToTree</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">tailsDigit</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3691"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3692"></a><span>    </span><span class="hs-identifier">f'</span><span> </span><span class="hs-identifier">ms</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">ConsLTree</span><span> </span><a href="Data.Sequence.Internal.html#digitToTree"><span class="hs-identifier hs-var">node</span></a><span> </span><span class="hs-identifier">m'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">viewLTree</span><span> </span><span class="hs-identifier">ms</span><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-3693"></a><span>        </span><span class="hs-identifier">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">pr'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">deep</span><span> </span><span class="hs-identifier">pr'</span><span> </span><span class="hs-identifier">m'</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">tailsNode</span><span> </span><span class="hs-identifier">node</span><span class="hs-special">)</span><span>
</span><a name="line-3694"></a><span>
</span><a name="line-3695"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">initsTree</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Elem</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-3696"></a><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">initsTree</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">a</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">FingerTree</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">Node</span><span> </span><span class="hs-pragma">b</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-3697"></a><span class="hs-comment">-- | Given a function to apply to inits of a tree, applies that function</span><span>
</span><a name="line-3698"></a><span class="hs-comment">-- to every init of the specified tree.</span><span>
</span><a name="line-3699"></a><span class="hs-identifier">initsTree</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Sized</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3700"></a><span class="hs-identifier">initsTree</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-3701"></a><span class="hs-identifier">initsTree</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">Single</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3702"></a><a name="initsTree"><a href="Data.Sequence.Internal.html#initsTree"><span class="hs-identifier">initsTree</span></a></a><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">pr</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">sf</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-3703"></a><span>    </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">f</span></a><span> </span><a name="local-6989586621679062323"><a href="#local-6989586621679062323"><span class="hs-operator">.</span></a></a><span> </span><span class="hs-identifier">digitToTree</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">initsDigit</span><span> </span><span class="hs-identifier">pr</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3704"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">initsTree</span><span> </span><span class="hs-identifier">f'</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span>
</span><a name="line-3705"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-special">(</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">deep</span><span> </span><a href="Data.Sequence.Internal.html#digitToTree"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="Data.Sequence.Internal.html#digitToTree"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">initsDigit</span><span> </span><a href="Data.Sequence.Internal.html#initsDigit"><span class="hs-identifier hs-var">sf</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3706"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3707"></a><span>    </span><span class="hs-identifier">f'</span><span> </span><span class="hs-identifier">ms</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">SnocRTree</span><span> </span><span class="hs-identifier">m'</span><span> </span><span class="hs-identifier">node</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">viewRTree</span><span> </span><span class="hs-identifier">ms</span><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-3708"></a><span>             </span><span class="hs-identifier">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">sf'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">deep</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m'</span><span> </span><span class="hs-identifier">sf'</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">initsNode</span><span> </span><span class="hs-identifier">node</span><span class="hs-special">)</span><span>
</span><a name="line-3709"></a><span>
</span><a name="line-3710"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">foldlWithIndex</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-3711"></a><span class="hs-comment">-- | 'foldlWithIndex' is a version of 'foldl' that also provides access</span><span>
</span><a name="line-3712"></a><span class="hs-comment">-- to the index of each element.</span><span>
</span><a name="line-3713"></a><span class="hs-identifier">foldlWithIndex</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3714"></a><span class="hs-identifier">foldlWithIndex</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldl</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">g</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">const</span><span> </span><span class="hs-identifier">z</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-3715"></a><span>
</span><a name="line-3716"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">foldrWithIndex</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-3717"></a><span class="hs-comment">-- | 'foldrWithIndex' is a version of 'foldr' that also provides access</span><span>
</span><a name="line-3718"></a><span class="hs-comment">-- to the index of each element.</span><span>
</span><a name="line-3719"></a><span class="hs-identifier">foldrWithIndex</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-3720"></a><span class="hs-identifier">foldrWithIndex</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">g</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">i</span><span class="hs-operator">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">const</span><span> </span><span class="hs-identifier">z</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-3721"></a><span>
</span><a name="line-3722"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">listToMaybe'</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-3723"></a><span class="hs-comment">-- 'listToMaybe\'' is a good consumer version of 'listToMaybe'.</span><span>
</span><a name="line-3724"></a><span class="hs-identifier">listToMaybe'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-3725"></a><span class="hs-identifier">listToMaybe'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><a name="line-3726"></a><span>
</span><a name="line-3727"></a><span class="hs-comment">-- | \( O(i) \) where \( i \) is the prefix length. 'takeWhileL', applied</span><span>
</span><a name="line-3728"></a><span class="hs-comment">-- to a predicate @p@ and a sequence @xs@, returns the longest prefix</span><span>
</span><a name="line-3729"></a><span class="hs-comment">-- (possibly empty) of @xs@ of elements that satisfy @p@.</span><span>
</span><a name="line-3730"></a><span class="hs-identifier">takeWhileL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-3731"></a><span class="hs-identifier">takeWhileL</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fst</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">spanl</span><span> </span><span class="hs-identifier">p</span><span>
</span><a name="line-3732"></a><span>
</span><a name="line-3733"></a><span class="hs-comment">-- | \( O(i) \) where \( i \) is the suffix length.  'takeWhileR', applied</span><span>
</span><a name="line-3734"></a><span class="hs-comment">-- to a predicate @p@ and a sequence @xs@, returns the longest suffix</span><span>
</span><a name="line-3735"></a><span class="hs-comment">-- (possibly empty) of @xs@ of elements that satisfy @p@.</span><span>
</span><a name="line-3736"></a><span class="hs-comment">--</span><span>
</span><a name="line-3737"></a><span class="hs-comment">-- @'takeWhileR' p xs@ is equivalent to @'reverse' ('takeWhileL' p ('reverse' xs))@.</span><span>
</span><a name="line-3738"></a><span class="hs-identifier">takeWhileR</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-3739"></a><span class="hs-identifier">takeWhileR</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fst</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">spanr</span><span> </span><span class="hs-identifier">p</span><span>
</span><a name="line-3740"></a><span>
</span><a name="line-3741"></a><span class="hs-comment">-- | \( O(i) \) where \( i \) is the prefix length.  @'dropWhileL' p xs@ returns</span><span>
</span><a name="line-3742"></a><span class="hs-comment">-- the suffix remaining after @'takeWhileL' p xs@.</span><span>
</span><a name="line-3743"></a><span class="hs-identifier">dropWhileL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-3744"></a><span class="hs-identifier">dropWhileL</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">snd</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">spanl</span><span> </span><span class="hs-identifier">p</span><span>
</span><a name="line-3745"></a><span>
</span><a name="line-3746"></a><span class="hs-comment">-- | \( O(i) \) where \( i \) is the suffix length.  @'dropWhileR' p xs@ returns</span><span>
</span><a name="line-3747"></a><span class="hs-comment">-- the prefix remaining after @'takeWhileR' p xs@.</span><span>
</span><a name="line-3748"></a><span class="hs-comment">--</span><span>
</span><a name="line-3749"></a><span class="hs-comment">-- @'dropWhileR' p xs@ is equivalent to @'reverse' ('dropWhileL' p ('reverse' xs))@.</span><span>
</span><a name="line-3750"></a><span class="hs-identifier">dropWhileR</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-3751"></a><span class="hs-identifier">dropWhileR</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">snd</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">spanr</span><span> </span><span class="hs-identifier">p</span><span>
</span><a name="line-3752"></a><span>
</span><a name="line-3753"></a><span class="hs-comment">-- | \( O(i) \) where \( i \) is the prefix length.  'spanl', applied to</span><span>
</span><a name="line-3754"></a><span class="hs-comment">-- a predicate @p@ and a sequence @xs@, returns a pair whose first</span><span>
</span><a name="line-3755"></a><span class="hs-comment">-- element is the longest prefix (possibly empty) of @xs@ of elements that</span><span>
</span><a name="line-3756"></a><span class="hs-comment">-- satisfy @p@ and the second element is the remainder of the sequence.</span><span>
</span><a name="line-3757"></a><span class="hs-identifier">spanl</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3758"></a><span class="hs-identifier">spanl</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">breakl</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">not</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">)</span><span>
</span><a name="line-3759"></a><span>
</span><a name="line-3760"></a><span class="hs-comment">-- | \( O(i) \) where \( i \) is the suffix length.  'spanr', applied to a</span><span>
</span><a name="line-3761"></a><span class="hs-comment">-- predicate @p@ and a sequence @xs@, returns a pair whose /first/ element</span><span>
</span><a name="line-3762"></a><span class="hs-comment">-- is the longest /suffix/ (possibly empty) of @xs@ of elements that</span><span>
</span><a name="line-3763"></a><span class="hs-comment">-- satisfy @p@ and the second element is the remainder of the sequence.</span><span>
</span><a name="line-3764"></a><span class="hs-identifier">spanr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3765"></a><span class="hs-identifier">spanr</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">breakr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">not</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">)</span><span>
</span><a name="line-3766"></a><span>
</span><a name="line-3767"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">breakl</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-3768"></a><span class="hs-comment">-- | \( O(i) \) where \( i \) is the breakpoint index.  'breakl', applied to a</span><span>
</span><a name="line-3769"></a><span class="hs-comment">-- predicate @p@ and a sequence @xs@, returns a pair whose first element</span><span>
</span><a name="line-3770"></a><span class="hs-comment">-- is the longest prefix (possibly empty) of @xs@ of elements that</span><span>
</span><a name="line-3771"></a><span class="hs-comment">-- /do not satisfy/ @p@ and the second element is the remainder of</span><span>
</span><a name="line-3772"></a><span class="hs-comment">-- the sequence.</span><span>
</span><a name="line-3773"></a><span class="hs-comment">--</span><span>
</span><a name="line-3774"></a><span class="hs-comment">-- @'breakl' p@ is equivalent to @'spanl' (not . p)@.</span><span>
</span><a name="line-3775"></a><span class="hs-identifier">breakl</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3776"></a><span class="hs-identifier">breakl</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">splitAt</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">xs</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">empty</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">findIndicesL</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>
</span><a name="line-3777"></a><span>
</span><a name="line-3778"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">breakr</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-3779"></a><span class="hs-comment">-- | @'breakr' p@ is equivalent to @'spanr' (not . p)@.</span><span>
</span><a name="line-3780"></a><span class="hs-identifier">breakr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3781"></a><span class="hs-identifier">breakr</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">flipPair</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">splitAt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">xs</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">empty</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">findIndicesR</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>
</span><a name="line-3782"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">flipPair</span><span> </span><span class="hs-special">(</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Bool"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><a name="line-3783"></a><span>
</span><a name="line-3784"></a><span class="hs-comment">-- | \( O(n) \).  The 'partition' function takes a predicate @p@ and a</span><span>
</span><a name="line-3785"></a><span class="hs-comment">-- sequence @xs@ and returns sequences of those elements which do and</span><span>
</span><a name="line-3786"></a><span class="hs-comment">-- do not satisfy the predicate.</span><span>
</span><a name="line-3787"></a><span class="hs-identifier">partition</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3788"></a><span class="hs-identifier">partition</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">toPair</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">foldl'</span><span> </span><span class="hs-identifier">part</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">empty</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">empty</span><span class="hs-special">)</span><span>
</span><a name="line-3789"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3790"></a><span>    </span><a name="partition"><a href="Data.Sequence.Internal.html#partition"><span class="hs-identifier">part</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">xs</span><span> </span><span class="hs-operator">:*:</span><span> </span><a href="Utils.Containers.Internal.StrictPair.html#toPair"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#."><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-3791"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">x</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">xs</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">snoc'</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">ys</span><span>
</span><a name="line-3792"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ys</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">snoc'</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><a name="line-3793"></a><span>
</span><a name="line-3794"></a><span class="hs-comment">-- | \( O(n) \).  The 'filter' function takes a predicate @p@ and a sequence</span><span>
</span><a name="line-3795"></a><span class="hs-comment">-- @xs@ and returns a sequence of those elements which satisfy the</span><span>
</span><a name="line-3796"></a><span class="hs-comment">-- predicate.</span><span>
</span><a name="line-3797"></a><span class="hs-identifier">filter</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-3798"></a><span class="hs-identifier">filter</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldl'</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">snoc'</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">empty</span><span>
</span><a name="line-3799"></a><span>
</span><a name="line-3800"></a><span class="hs-comment">-- Indexing sequences</span><span>
</span><a name="line-3801"></a><span>
</span><a name="line-3802"></a><span class="hs-comment">-- | 'elemIndexL' finds the leftmost index of the specified element,</span><span>
</span><a name="line-3803"></a><span class="hs-comment">-- if it is present, and otherwise 'Nothing'.</span><span>
</span><a name="line-3804"></a><span class="hs-identifier">elemIndexL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Eq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-identifier">Int</span><span>
</span><a name="line-3805"></a><span class="hs-identifier">elemIndexL</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">findIndexL</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span> </span><span class="hs-operator">==</span><span class="hs-special">)</span><span>
</span><a name="line-3806"></a><span>
</span><a name="line-3807"></a><span class="hs-comment">-- | 'elemIndexR' finds the rightmost index of the specified element,</span><span>
</span><a name="line-3808"></a><span class="hs-comment">-- if it is present, and otherwise 'Nothing'.</span><span>
</span><a name="line-3809"></a><span class="hs-identifier">elemIndexR</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Eq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-identifier">Int</span><span>
</span><a name="line-3810"></a><span class="hs-identifier">elemIndexR</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">findIndexR</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span> </span><span class="hs-operator">==</span><span class="hs-special">)</span><span>
</span><a name="line-3811"></a><span>
</span><a name="line-3812"></a><span class="hs-comment">-- | 'elemIndicesL' finds the indices of the specified element, from</span><span>
</span><a name="line-3813"></a><span class="hs-comment">-- left to right (i.e. in ascending order).</span><span>
</span><a name="line-3814"></a><span class="hs-identifier">elemIndicesL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Eq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Int</span><span class="hs-special">]</span><span>
</span><a name="line-3815"></a><span class="hs-identifier">elemIndicesL</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">findIndicesL</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span> </span><span class="hs-operator">==</span><span class="hs-special">)</span><span>
</span><a name="line-3816"></a><span>
</span><a name="line-3817"></a><span class="hs-comment">-- | 'elemIndicesR' finds the indices of the specified element, from</span><span>
</span><a name="line-3818"></a><span class="hs-comment">-- right to left (i.e. in descending order).</span><span>
</span><a name="line-3819"></a><span class="hs-identifier">elemIndicesR</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Eq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Int</span><span class="hs-special">]</span><span>
</span><a name="line-3820"></a><span class="hs-identifier">elemIndicesR</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">findIndicesR</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span> </span><span class="hs-operator">==</span><span class="hs-special">)</span><span>
</span><a name="line-3821"></a><span>
</span><a name="line-3822"></a><span class="hs-comment">-- | @'findIndexL' p xs@ finds the index of the leftmost element that</span><span>
</span><a name="line-3823"></a><span class="hs-comment">-- satisfies @p@, if any exist.</span><span>
</span><a name="line-3824"></a><span class="hs-identifier">findIndexL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-identifier">Int</span><span>
</span><a name="line-3825"></a><span class="hs-identifier">findIndexL</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">listToMaybe'</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">findIndicesL</span><span> </span><span class="hs-identifier">p</span><span>
</span><a name="line-3826"></a><span>
</span><a name="line-3827"></a><span class="hs-comment">-- | @'findIndexR' p xs@ finds the index of the rightmost element that</span><span>
</span><a name="line-3828"></a><span class="hs-comment">-- satisfies @p@, if any exist.</span><span>
</span><a name="line-3829"></a><span class="hs-identifier">findIndexR</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-identifier">Int</span><span>
</span><a name="line-3830"></a><span class="hs-identifier">findIndexR</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">listToMaybe'</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">findIndicesR</span><span> </span><span class="hs-identifier">p</span><span>
</span><a name="line-3831"></a><span>
</span><a name="line-3832"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">findIndicesL</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-3833"></a><span class="hs-comment">-- | @'findIndicesL' p@ finds all indices of elements that satisfy @p@,</span><span>
</span><a name="line-3834"></a><span class="hs-comment">-- in ascending order.</span><span>
</span><a name="line-3835"></a><span class="hs-identifier">findIndicesL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Int</span><span class="hs-special">]</span><span>
</span><a name="line-3836"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__
</span><span class="hs-identifier">findIndicesL</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">build</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">c</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">g</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-3838"></a><span>                </span><span class="hs-identifier">foldrWithIndex</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>
</span><a name="line-3839"></a><span class="hs-cpp">#else
</span><span class="hs-identifier">findIndicesL</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldrWithIndex</span><span> </span><a href="#local-6989586621679062377"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-3841"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">i</span><span class="hs-glyph">:</span><span class="hs-identifier">is</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">is</span><span>
</span><a name="line-3842"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-3844"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">findIndicesR</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-3845"></a><span class="hs-comment">-- | @'findIndicesR' p@ finds all indices of elements that satisfy @p@,</span><span>
</span><a name="line-3846"></a><span class="hs-comment">-- in descending order.</span><span>
</span><a name="line-3847"></a><span class="hs-identifier">findIndicesR</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Int</span><span class="hs-special">]</span><span>
</span><a name="line-3848"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__
</span><span class="hs-identifier">findIndicesR</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">build</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">c</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-3850"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">foldlWithIndex</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>
</span><a name="line-3851"></a><span class="hs-cpp">#else
</span><span class="hs-identifier">findIndicesR</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldlWithIndex</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-3853"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">i</span><span class="hs-glyph">:</span><span class="hs-identifier">is</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">is</span><span>
</span><a name="line-3854"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-3856"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-3857"></a><span class="hs-comment">-- Lists</span><span>
</span><a name="line-3858"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-3859"></a><span>
</span><a name="line-3860"></a><span class="hs-comment">-- The implementation below is based on an idea by Ross Paterson and</span><span>
</span><a name="line-3861"></a><span class="hs-comment">-- implemented by Lennart Spitzner. It avoids the rebuilding the original</span><span>
</span><a name="line-3862"></a><span class="hs-comment">-- (|&gt;)-based implementation suffered from. It also avoids the excessive pair</span><span>
</span><a name="line-3863"></a><span class="hs-comment">-- allocations Paterson's implementation suffered from.</span><span>
</span><a name="line-3864"></a><span class="hs-comment">--</span><span>
</span><a name="line-3865"></a><span class="hs-comment">-- David Feuer suggested building in nine-element chunks, which reduces</span><span>
</span><a name="line-3866"></a><span class="hs-comment">-- intermediate conses from around (1/2)*n to around (1/8)*n with a concomitant</span><span>
</span><a name="line-3867"></a><span class="hs-comment">-- improvement in benchmark constant factors. In fact, it should be even</span><span>
</span><a name="line-3868"></a><span class="hs-comment">-- better to work in chunks of 27 `Elem`s and chunks of three `Node`s, rather</span><span>
</span><a name="line-3869"></a><span class="hs-comment">-- than nine of each, but it seems hard to avoid a code explosion with</span><span>
</span><a name="line-3870"></a><span class="hs-comment">-- such large chunks.</span><span>
</span><a name="line-3871"></a><span class="hs-comment">--</span><span>
</span><a name="line-3872"></a><span class="hs-comment">-- Paterson's code can be seen, for example, in</span><span>
</span><a name="line-3873"></a><span class="hs-comment">-- https://github.com/haskell/containers/blob/74034b3244fa4817c7bef1202e639b887a975d9e/Data/Sequence.hs#L3532</span><span>
</span><a name="line-3874"></a><span class="hs-comment">--</span><span>
</span><a name="line-3875"></a><span class="hs-comment">-- Given a list</span><span>
</span><a name="line-3876"></a><span class="hs-comment">--</span><span>
</span><a name="line-3877"></a><span class="hs-comment">-- [1..302]</span><span>
</span><a name="line-3878"></a><span class="hs-comment">--</span><span>
</span><a name="line-3879"></a><span class="hs-comment">-- the original code forms Three 1 2 3 | [node3 4 5 6, node3 7 8 9, node3 10 11</span><span>
</span><a name="line-3880"></a><span class="hs-comment">-- 12, ...] | Two 301 302</span><span>
</span><a name="line-3881"></a><span class="hs-comment">--</span><span>
</span><a name="line-3882"></a><span class="hs-comment">-- Then it recurses on the middle list. The middle lists become successively</span><span>
</span><a name="line-3883"></a><span class="hs-comment">-- shorter as their elements become successively deeper nodes.</span><span>
</span><a name="line-3884"></a><span class="hs-comment">--</span><span>
</span><a name="line-3885"></a><span class="hs-comment">-- The original implementation of the list shortener, getNodes, included the</span><span>
</span><a name="line-3886"></a><span class="hs-comment">-- recursive step</span><span>
</span><a name="line-3887"></a><span>
</span><a name="line-3888"></a><span class="hs-comment">--     getNodes s x1 (x2:x3:x4:xs) = (Node3 s x1 x2 x3:ns, d)</span><span>
</span><a name="line-3889"></a><span class="hs-comment">--            where (ns, d) = getNodes s x4 xs</span><span>
</span><a name="line-3890"></a><span>
</span><a name="line-3891"></a><span class="hs-comment">-- This allocates a cons and a lazy pair at each 3-element step. It relies on</span><span>
</span><a name="line-3892"></a><span class="hs-comment">-- the Haskell implementation using Wadler's technique, described in &quot;Fixing</span><span>
</span><a name="line-3893"></a><span class="hs-comment">-- some space leaks with a garbage collector&quot;</span><span>
</span><a name="line-3894"></a><span class="hs-comment">-- http://homepages.inf.ed.ac.uk/wadler/papers/leak/leak.ps.gz, to repeatedly</span><span>
</span><a name="line-3895"></a><span class="hs-comment">-- simplify the `d` thunk. Although GHC uses this GC trick, heap profiling at</span><span>
</span><a name="line-3896"></a><span class="hs-comment">-- least appears to indicate that the pair constructors and conses build up</span><span>
</span><a name="line-3897"></a><span class="hs-comment">-- with this implementation.</span><span>
</span><a name="line-3898"></a><span class="hs-comment">--</span><span>
</span><a name="line-3899"></a><span class="hs-comment">-- Spitzner's implementation uses a similar approach, but replaces the middle</span><span>
</span><a name="line-3900"></a><span class="hs-comment">-- list, in each level, with a customized stream type that finishes off with</span><span>
</span><a name="line-3901"></a><span class="hs-comment">-- the final digit in that level and (since it works in nines) in the one</span><span>
</span><a name="line-3902"></a><span class="hs-comment">-- above. To work around the nested tree structure, the overall computation is</span><span>
</span><a name="line-3903"></a><span class="hs-comment">-- structured using continuation-passing style, with a function that, at the</span><span>
</span><a name="line-3904"></a><span class="hs-comment">-- bottom of the tree, deals with a stream that terminates in a nested-pair</span><span>
</span><a name="line-3905"></a><span class="hs-comment">-- representation of the entire right side of the tree. Perhaps someone will</span><span>
</span><a name="line-3906"></a><span class="hs-comment">-- eventually find a less mind-bending way to accomplish this.</span><span>
</span><a name="line-3907"></a><span>
</span><a name="line-3908"></a><span class="hs-comment">-- | \( O(n) \). Create a sequence from a finite list of elements.</span><span>
</span><a name="line-3909"></a><span class="hs-comment">-- There is a function 'toList' in the opposite direction for all</span><span>
</span><a name="line-3910"></a><span class="hs-comment">-- instances of the 'Foldable' class, including 'Seq'.</span><span>
</span><a name="line-3911"></a><span class="hs-identifier">fromList</span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-3912"></a><span class="hs-comment">-- Note: we can avoid map_elem if we wish by scattering</span><span>
</span><a name="line-3913"></a><span class="hs-comment">-- Elem applications throughout mkTreeE and getNodesE, but</span><span>
</span><a name="line-3914"></a><span class="hs-comment">-- it gets a bit hard to read.</span><span>
</span><a name="line-3915"></a><span class="hs-identifier">fromList</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">mkTree</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">map_elem</span><span>
</span><a name="line-3916"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-3917"></a><span class="hs-cpp">#ifdef __GLASGOW_HASKELL__
</span><span>    </span><span class="hs-identifier">mkTree</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span class="hs-identifier">a'</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a'</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a'</span><span class="hs-special">)</span><span>
</span><a name="line-3919"></a><span class="hs-cpp">#else
</span><span>    </span><span class="hs-identifier">mkTree</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-3921"></a><span class="hs-cpp">#endif
</span><span>    </span><span class="hs-identifier">mkTree</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-3923"></a><span>    </span><span class="hs-identifier">mkTree</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">x1</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">x1</span><span>
</span><a name="line-3924"></a><span>    </span><a name="local-6989586621679062392"><a href="#local-6989586621679062392"><span class="hs-identifier">mkTree</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-identifier">x1</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">x2</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">x1</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">x2</span><span class="hs-special">)</span><span>
</span><a name="line-3925"></a><span>    </span><span class="hs-identifier">mkTree</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679062405"><a href="#local-6989586621679062405"><span class="hs-identifier">x1</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">x2</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">x3</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-identifier">x2</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">x3</span><span class="hs-special">)</span><span>
</span><a name="line-3926"></a><span>    </span><span class="hs-identifier">mkTree</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679062406"><a href="#local-6989586621679062406"><span class="hs-identifier">x1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062407"><a href="#local-6989586621679062407"><span class="hs-identifier">x2</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">x3</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">x4</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-number">4</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-identifier">x2</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">x3</span><span> </span><span class="hs-identifier">x4</span><span class="hs-special">)</span><span>
</span><a name="line-3927"></a><span>    </span><span class="hs-identifier">mkTree</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679062408"><a href="#local-6989586621679062408"><span class="hs-identifier">x1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062409"><a href="#local-6989586621679062409"><span class="hs-identifier">x2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062410"><a href="#local-6989586621679062410"><span class="hs-identifier">x3</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">x4</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">x5</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-number">5</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-identifier">x2</span><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">x3</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">x4</span><span> </span><span class="hs-identifier">x5</span><span class="hs-special">)</span><span>
</span><a name="line-3928"></a><span>    </span><span class="hs-identifier">mkTree</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679062411"><a href="#local-6989586621679062411"><span class="hs-identifier">x1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062412"><a href="#local-6989586621679062412"><span class="hs-identifier">x2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062413"><a href="#local-6989586621679062413"><span class="hs-identifier">x3</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062414"><a href="#local-6989586621679062414"><span class="hs-identifier">x4</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">x5</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">x6</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-3929"></a><span>      </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-number">6</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><a name="local-6989586621679062417"><a href="#local-6989586621679062417"><span class="hs-identifier">x1</span></a></a><span> </span><span class="hs-identifier">x2</span><span> </span><span class="hs-identifier">x3</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">x4</span></a><span> </span><span class="hs-identifier">x5</span><span> </span><span class="hs-identifier">x6</span><span class="hs-special">)</span><span>
</span><a name="line-3930"></a><span>    </span><span class="hs-identifier">mkTree</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679062420"><a href="#local-6989586621679062420"><span class="hs-identifier">x1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062421"><a href="#local-6989586621679062421"><span class="hs-identifier">x2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062422"><a href="#local-6989586621679062422"><span class="hs-identifier">x3</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062423"><a href="#local-6989586621679062423"><span class="hs-identifier">x4</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062424"><a href="#local-6989586621679062424"><span class="hs-identifier">x5</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062425"><a href="#local-6989586621679062425"><span class="hs-identifier">x6</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">x7</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-3931"></a><span>      </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-number">7</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Two</span></a><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-identifier">x2</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-identifier">x3</span><span> </span><span class="hs-identifier">x4</span><span> </span><span class="hs-identifier">x5</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">x6</span><span> </span><span class="hs-identifier">x7</span><span class="hs-special">)</span><span>
</span><a name="line-3932"></a><span>    </span><span class="hs-identifier">mkTree</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679062426"><a href="#local-6989586621679062426"><span class="hs-identifier">x1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062427"><a href="#local-6989586621679062427"><span class="hs-identifier">x2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062428"><a href="#local-6989586621679062428"><span class="hs-identifier">x3</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062429"><a href="#local-6989586621679062429"><span class="hs-identifier">x4</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062430"><a href="#local-6989586621679062430"><span class="hs-identifier">x5</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062431"><a href="#local-6989586621679062431"><span class="hs-identifier">x6</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062432"><a href="#local-6989586621679062432"><span class="hs-identifier">x7</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">x8</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-3933"></a><span>      </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-number">8</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-identifier">x2</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">x3</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-identifier">x4</span><span> </span><span class="hs-identifier">x5</span><span> </span><span class="hs-identifier">x6</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">x7</span><span> </span><span class="hs-identifier">x8</span><span class="hs-special">)</span><span>
</span><a name="line-3934"></a><span>    </span><span class="hs-identifier">mkTree</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679062433"><a href="#local-6989586621679062433"><span class="hs-identifier">x1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062434"><a href="#local-6989586621679062434"><span class="hs-identifier">x2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062435"><a href="#local-6989586621679062435"><span class="hs-identifier">x3</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062436"><a href="#local-6989586621679062436"><span class="hs-identifier">x4</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062437"><a href="#local-6989586621679062437"><span class="hs-identifier">x5</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062438"><a href="#local-6989586621679062438"><span class="hs-identifier">x6</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062439"><a href="#local-6989586621679062439"><span class="hs-identifier">x7</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062440"><a href="#local-6989586621679062440"><span class="hs-identifier">x8</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">x9</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-3935"></a><span>      </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-number">9</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679062433"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="#local-6989586621679062434"><span class="hs-identifier hs-var">x2</span></a><span> </span><a href="#local-6989586621679062435"><span class="hs-identifier hs-var">x3</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-number">3</span><span> </span><a href="#local-6989586621679062436"><span class="hs-identifier hs-var">x4</span></a><span> </span><a href="#local-6989586621679062437"><span class="hs-identifier hs-var">x5</span></a><span> </span><a href="#local-6989586621679062438"><span class="hs-identifier hs-var">x6</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">x7</span><span> </span><span class="hs-identifier">x8</span><span> </span><span class="hs-identifier">x9</span><span class="hs-special">)</span><span>
</span><a name="line-3936"></a><span>    </span><span class="hs-identifier">mkTree</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679062441"><a href="#local-6989586621679062441"><span class="hs-identifier">x1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062442"><a href="#local-6989586621679062442"><span class="hs-identifier">x2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062443"><a href="#local-6989586621679062443"><span class="hs-identifier">x3</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062444"><a href="#local-6989586621679062444"><span class="hs-identifier">x4</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062445"><a href="#local-6989586621679062445"><span class="hs-identifier">x5</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062446"><a href="#local-6989586621679062446"><span class="hs-identifier">x6</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062447"><a href="#local-6989586621679062447"><span class="hs-identifier">x7</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062448"><a href="#local-6989586621679062448"><span class="hs-identifier">x8</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062449"><a href="#local-6989586621679062449"><span class="hs-identifier">y0</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">y1</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-3937"></a><span>      </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-number">10</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Two</span></a><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-identifier">x2</span><span class="hs-special">)</span><span>
</span><a name="line-3938"></a><span>              </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-number">6</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-number">3</span><span> </span><a name="local-6989586621679062456"><a href="#local-6989586621679062456"><span class="hs-identifier">x3</span></a></a><span> </span><span class="hs-identifier">x4</span><span> </span><span class="hs-identifier">x5</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-identifier">x6</span><span> </span><span class="hs-identifier">x7</span><span> </span><span class="hs-identifier">x8</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3939"></a><span>              </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679062450"><span class="hs-identifier hs-var">y0</span></a><span> </span><a href="#local-6989586621679062451"><span class="hs-identifier hs-var">y1</span></a><span class="hs-special">)</span><span>
</span><a name="line-3940"></a><span>    </span><span class="hs-identifier">mkTree</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">x1</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">x2</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">x3</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">x4</span></a><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">x5</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">x6</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679062452"><span class="hs-identifier hs-var">x7</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">x8</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">x9</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">y1</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-3941"></a><span>      </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-number">11</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-identifier">x2</span><span> </span><span class="hs-identifier">x3</span><span class="hs-special">)</span><span>
</span><a name="line-3942"></a><span>              </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-number">6</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-number">3</span><span> </span><a name="local-6989586621679062466"><a href="#local-6989586621679062466"><span class="hs-identifier">x4</span></a></a><span> </span><span class="hs-identifier">x5</span><span> </span><span class="hs-identifier">x6</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-identifier">x7</span><span> </span><span class="hs-identifier">x8</span><span> </span><span class="hs-identifier">x9</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3943"></a><span>              </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Two</span></a><span> </span><span class="hs-identifier">y0</span><span> </span><span class="hs-identifier">y1</span><span class="hs-special">)</span><span>
</span><a name="line-3944"></a><span>    </span><span class="hs-identifier">mkTree</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">x1</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">x2</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">x3</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">x4</span></a><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">x5</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">x6</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679062463"><span class="hs-identifier hs-var">x7</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">x8</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">x9</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">y1</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">y2</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-3945"></a><span>      </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-number">12</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-identifier">x2</span><span> </span><span class="hs-identifier">x3</span><span class="hs-special">)</span><span>
</span><a name="line-3946"></a><span>              </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-number">6</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-number">3</span><span> </span><a name="local-6989586621679062477"><a href="#local-6989586621679062477"><span class="hs-identifier">x4</span></a></a><span> </span><span class="hs-identifier">x5</span><span> </span><span class="hs-identifier">x6</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-identifier">x7</span><span> </span><span class="hs-identifier">x8</span><span> </span><span class="hs-identifier">x9</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3947"></a><span>              </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679062471"><span class="hs-identifier hs-var">y0</span></a><span> </span><a href="#local-6989586621679062472"><span class="hs-identifier hs-var">y1</span></a><span> </span><a href="#local-6989586621679062473"><span class="hs-identifier hs-var">y2</span></a><span class="hs-special">)</span><span>
</span><a name="line-3948"></a><span>    </span><span class="hs-identifier">mkTree</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">x1</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">x2</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">x3</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">x4</span></a><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">x5</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">x6</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679062474"><span class="hs-identifier hs-var">x7</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">x8</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">y0</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">y1</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">y2</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">y3</span></a><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">y4</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-3949"></a><span>      </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-number">13</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Two</span></a><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-identifier">x2</span><span class="hs-special">)</span><span>
</span><a name="line-3950"></a><span>              </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-number">9</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-number">3</span><span> </span><a name="local-6989586621679062489"><a href="#local-6989586621679062489"><span class="hs-identifier">x3</span></a></a><span> </span><span class="hs-identifier">x4</span><span> </span><span class="hs-identifier">x5</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-identifier">x6</span><span> </span><span class="hs-identifier">x7</span><span> </span><span class="hs-identifier">x8</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-identifier">y0</span><span> </span><span class="hs-identifier">y1</span><span> </span><span class="hs-identifier">y2</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3951"></a><span>              </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679062483"><span class="hs-identifier hs-var">y3</span></a><span> </span><a href="#local-6989586621679062484"><span class="hs-identifier hs-var">y4</span></a><span class="hs-special">)</span><span>
</span><a name="line-3952"></a><span>    </span><span class="hs-identifier">mkTree</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">x1</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">x2</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">x3</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">x4</span></a><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">x5</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">x6</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679062485"><span class="hs-identifier hs-var">x7</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">x8</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">x9</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">y1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">y2</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">y3</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">y4</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-3953"></a><span>      </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-number">14</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-identifier">x2</span><span> </span><span class="hs-identifier">x3</span><span class="hs-special">)</span><span>
</span><a name="line-3954"></a><span>              </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-number">9</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-number">3</span><span> </span><a name="local-6989586621679062502"><a href="#local-6989586621679062502"><span class="hs-identifier">x4</span></a></a><span> </span><span class="hs-identifier">x5</span><span> </span><span class="hs-identifier">x6</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-identifier">x7</span><span> </span><span class="hs-identifier">x8</span><span> </span><span class="hs-identifier">x9</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-identifier">y0</span><span> </span><span class="hs-identifier">y1</span><span> </span><span class="hs-identifier">y2</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3955"></a><span>              </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Two</span></a><span> </span><span class="hs-identifier">y3</span><span> </span><span class="hs-identifier">y4</span><span class="hs-special">)</span><span>
</span><a name="line-3956"></a><span>    </span><span class="hs-identifier">mkTree</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">x1</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">x2</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">x3</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">x4</span></a><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">x5</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">x6</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679062499"><span class="hs-identifier hs-var">x7</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">x8</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">x9</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">y0</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">y1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">y2</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">y3</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">y4</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">y5</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-3957"></a><span>      </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-number">15</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-identifier">x2</span><span> </span><span class="hs-identifier">x3</span><span class="hs-special">)</span><span>
</span><a name="line-3958"></a><span>              </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-number">9</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-number">3</span><span> </span><a name="local-6989586621679062516"><a href="#local-6989586621679062516"><span class="hs-identifier">x4</span></a></a><span> </span><span class="hs-identifier">x5</span><span> </span><span class="hs-identifier">x6</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-identifier">x7</span><span> </span><span class="hs-identifier">x8</span><span> </span><span class="hs-identifier">x9</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-identifier">y0</span><span> </span><span class="hs-identifier">y1</span><span> </span><span class="hs-identifier">y2</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-3959"></a><span>              </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679062510"><span class="hs-identifier hs-var">y3</span></a><span> </span><a href="#local-6989586621679062511"><span class="hs-identifier hs-var">y4</span></a><span> </span><a href="#local-6989586621679062512"><span class="hs-identifier hs-var">y5</span></a><span class="hs-special">)</span><span>
</span><a name="line-3960"></a><span>    </span><span class="hs-identifier">mkTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x1</span><span class="hs-glyph">:</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">x2</span></a><span class="hs-glyph">:</span><span class="hs-identifier">x3</span><span class="hs-glyph">:</span><span class="hs-identifier">x4</span><span class="hs-glyph">:</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">x5</span></a><span class="hs-glyph">:</span><span class="hs-identifier">x6</span><span class="hs-glyph">:</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">x7</span></a><span class="hs-glyph">:</span><span class="hs-identifier">x8</span><span class="hs-glyph">:</span><a href="#local-6989586621679062513"><span class="hs-identifier hs-var">x9</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679062514"><span class="hs-identifier hs-var">y0</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679062515"><span class="hs-identifier hs-var">y1</span></a><span class="hs-glyph">:</span><span class="hs-identifier">y2</span><span class="hs-glyph">:</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">y3</span></a><span class="hs-glyph">:</span><span class="hs-identifier">y4</span><span class="hs-glyph">:</span><span class="hs-identifier">y5</span><span class="hs-glyph">:</span><span class="hs-identifier">y6</span><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-3961"></a><span>        </span><span class="hs-identifier">mkTreeC</span><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">cont</span></a><span> </span><span class="hs-number">9</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">getNodes</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-identifier">y3</span><span> </span><span class="hs-identifier">y4</span><span> </span><span class="hs-identifier">y5</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">y6</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>
</span><a name="line-3962"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-3963"></a><span>        </span><a href="#local-6989586621679062394"><span class="hs-identifier hs-var">d2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-identifier">x2</span><span> </span><a href="#local-6989586621679062393"><span class="hs-identifier hs-var">x3</span></a><span>
</span><a name="line-3964"></a><span>        </span><span class="hs-identifier">d1</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Three</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-identifier">x4</span><span> </span><span class="hs-identifier">x5</span><span> </span><span class="hs-identifier">x6</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-identifier">x7</span><span> </span><span class="hs-identifier">x8</span><span> </span><span class="hs-identifier">x9</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-number">3</span><span> </span><span class="hs-identifier">y0</span><span> </span><span class="hs-identifier">y1</span><span> </span><span class="hs-identifier">y2</span><span class="hs-special">)</span><span>
</span><a name="line-3965"></a><span class="hs-cpp">#ifdef __GLASGOW_HASKELL__
</span><span>        </span><span class="hs-identifier">cont</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a'</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><a href="#local-6989586621679062533"><span class="hs-identifier hs-var">a'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a'</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a'</span><span class="hs-special">)</span><span>
</span><a name="line-3967"></a><span class="hs-cpp">#endif
</span><span>        </span><span class="hs-identifier">cont</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-identifier">r1</span><span class="hs-special">,</span><span> </span><span class="hs-glyph">!</span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">r2</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">sub</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-3969"></a><span>          </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">sub1</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-number">9</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">r1</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">sub</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">d1</span><span> </span><span class="hs-identifier">sub</span><span> </span><span class="hs-identifier">r1</span><span>
</span><a name="line-3970"></a><span>          </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><span> </span><a name="local-6989586621679062546"><a href="#local-6989586621679062546"><span class="hs-operator">+</span></a></a><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">r2</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">sub1</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">d2</span><span> </span><span class="hs-identifier">sub1</span><span> </span><span class="hs-identifier">r2</span><span>
</span><a name="line-3971"></a><span>
</span><a name="line-3972"></a><span>    </span><span class="hs-identifier">getNodes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-identifier">Int</span><span>
</span><a name="line-3973"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-3974"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-3975"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-3976"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ListFinal</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-3977"></a><span>    </span><span class="hs-identifier">getNodes</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">n1</span><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">n1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">x1</span><span class="hs-special">)</span><span>
</span><a name="line-3978"></a><span>    </span><span class="hs-identifier">getNodes</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">n1</span><span> </span><a href="Data.Sequence.Internal.html#ListFinal"><span class="hs-identifier hs-type">x1</span></a><span> </span><span class="hs-special">[</span><a href="Data.Sequence.Internal.html#ListFinal"><span class="hs-identifier hs-type">x2</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">n1</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">Two</span></a><span> </span><span class="hs-identifier">x1</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">x2</span></a><span class="hs-special">)</span><span>
</span><a name="line-3979"></a><span>    </span><a name="local-6989586621679062393"><a href="#local-6989586621679062393"><span class="hs-identifier">getNodes</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">n1</span><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-special">[</span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#%5B%5D"><span class="hs-identifier hs-var">x2</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">x3</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">n1</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-identifier">x2</span><span> </span><span class="hs-identifier">x3</span><span class="hs-special">)</span><span>
</span><a name="line-3980"></a><span>    </span><span class="hs-identifier">getNodes</span><span> </span><span class="hs-identifier">s</span><span> </span><a name="local-6989586621679062551"><a href="#local-6989586621679062551"><span class="hs-identifier">n1</span></a></a><span> </span><a name="local-6989586621679062552"><a href="#local-6989586621679062552"><span class="hs-identifier">x1</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621679062553"><a href="#local-6989586621679062553"><span class="hs-identifier">x2</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">x3</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#LFinal"><span class="hs-identifier hs-var">x4</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679062552"><span class="hs-identifier hs-var">n1</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-identifier">x2</span><span> </span><span class="hs-identifier">x3</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">x4</span><span class="hs-special">)</span><span>
</span><a name="line-3981"></a><span>    </span><span class="hs-identifier">getNodes</span><span> </span><span class="hs-identifier">s</span><span> </span><a name="local-6989586621679062554"><a href="#local-6989586621679062554"><span class="hs-identifier">n1</span></a></a><span> </span><a name="local-6989586621679062555"><a href="#local-6989586621679062555"><span class="hs-identifier">x1</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621679062556"><a href="#local-6989586621679062556"><span class="hs-identifier">x2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062557"><a href="#local-6989586621679062557"><span class="hs-identifier">x3</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">x4</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#LFinal"><span class="hs-identifier hs-var">x5</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Two</span></a><span> </span><span class="hs-identifier">n1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-identifier">x2</span><span> </span><span class="hs-identifier">x3</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">x4</span><span> </span><span class="hs-identifier">x5</span><span class="hs-special">)</span><span>
</span><a name="line-3982"></a><span>    </span><span class="hs-identifier">getNodes</span><span> </span><a name="local-6989586621679062558"><a href="#local-6989586621679062558"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679062559"><a href="#local-6989586621679062559"><span class="hs-identifier">n1</span></a></a><span> </span><a name="local-6989586621679062560"><a href="#local-6989586621679062560"><span class="hs-identifier">x1</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621679062561"><a href="#local-6989586621679062561"><span class="hs-identifier">x2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062562"><a href="#local-6989586621679062562"><span class="hs-identifier">x3</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062563"><a href="#local-6989586621679062563"><span class="hs-identifier">x4</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">x5</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#LFinal"><span class="hs-identifier hs-var">x6</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Two</span></a><span> </span><span class="hs-identifier">n1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><a href="#local-6989586621679062562"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-identifier">x1</span><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">x2</span></a><span> </span><span class="hs-identifier">x3</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">x4</span><span> </span><span class="hs-identifier">x5</span><span> </span><span class="hs-identifier">x6</span><span class="hs-special">)</span><span>
</span><a name="line-3983"></a><span>    </span><span class="hs-identifier">getNodes</span><span> </span><a name="local-6989586621679062564"><a href="#local-6989586621679062564"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679062565"><a href="#local-6989586621679062565"><span class="hs-identifier">n1</span></a></a><span> </span><a name="local-6989586621679062566"><a href="#local-6989586621679062566"><span class="hs-identifier">x1</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621679062567"><a href="#local-6989586621679062567"><span class="hs-identifier">x2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062568"><a href="#local-6989586621679062568"><span class="hs-identifier">x3</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062569"><a href="#local-6989586621679062569"><span class="hs-identifier">x4</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062570"><a href="#local-6989586621679062570"><span class="hs-identifier">x5</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">x6</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#LFinal"><span class="hs-identifier hs-var">x7</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Three</span></a><span> </span><span class="hs-identifier">n1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-identifier">x2</span><span> </span><span class="hs-identifier">x3</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">x4</span><span> </span><span class="hs-identifier">x5</span><span> </span><span class="hs-identifier">x6</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">x7</span><span class="hs-special">)</span><span>
</span><a name="line-3984"></a><span>    </span><span class="hs-identifier">getNodes</span><span> </span><a name="local-6989586621679062571"><a href="#local-6989586621679062571"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679062572"><a href="#local-6989586621679062572"><span class="hs-identifier">n1</span></a></a><span> </span><a name="local-6989586621679062573"><a href="#local-6989586621679062573"><span class="hs-identifier">x1</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621679062574"><a href="#local-6989586621679062574"><span class="hs-identifier">x2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062575"><a href="#local-6989586621679062575"><span class="hs-identifier">x3</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062576"><a href="#local-6989586621679062576"><span class="hs-identifier">x4</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062577"><a href="#local-6989586621679062577"><span class="hs-identifier">x5</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062578"><a href="#local-6989586621679062578"><span class="hs-identifier">x6</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">x7</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#LFinal"><span class="hs-identifier hs-var">x8</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Three</span></a><span> </span><span class="hs-identifier">n1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">x1</span><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">x2</span></a><span> </span><span class="hs-identifier">x3</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">x4</span><span> </span><span class="hs-identifier">x5</span><span> </span><span class="hs-identifier">x6</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">x7</span><span> </span><span class="hs-identifier">x8</span><span class="hs-special">)</span><span>
</span><a name="line-3985"></a><span>    </span><span class="hs-identifier">getNodes</span><span> </span><a name="local-6989586621679062579"><a href="#local-6989586621679062579"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679062580"><a href="#local-6989586621679062580"><span class="hs-identifier">n1</span></a></a><span> </span><a name="local-6989586621679062581"><a href="#local-6989586621679062581"><span class="hs-identifier">x1</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621679062582"><a href="#local-6989586621679062582"><span class="hs-identifier">x2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062583"><a href="#local-6989586621679062583"><span class="hs-identifier">x3</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062584"><a href="#local-6989586621679062584"><span class="hs-identifier">x4</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062585"><a href="#local-6989586621679062585"><span class="hs-identifier">x5</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062586"><a href="#local-6989586621679062586"><span class="hs-identifier">x6</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679062587"><a href="#local-6989586621679062587"><span class="hs-identifier">x7</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">x8</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#LFinal"><span class="hs-identifier hs-var">x9</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">n1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><a href="#local-6989586621679062583"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-identifier">x1</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">x2</span></a><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">x3</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><a href="#local-6989586621679062586"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-identifier">x4</span><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">x5</span></a><span> </span><span class="hs-identifier">x6</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">x7</span><span> </span><span class="hs-identifier">x8</span><span> </span><span class="hs-identifier">x9</span><span class="hs-special">)</span><span>
</span><a name="line-3986"></a><span>    </span><span class="hs-identifier">getNodes</span><span> </span><a name="local-6989586621679062588"><a href="#local-6989586621679062588"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679062589"><a href="#local-6989586621679062589"><span class="hs-identifier">n1</span></a></a><span> </span><a name="local-6989586621679062590"><a href="#local-6989586621679062590"><span class="hs-identifier">x1</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679062591"><a href="#local-6989586621679062591"><span class="hs-identifier">x2</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">x3</span><span class="hs-glyph">:</span><span class="hs-identifier">x4</span><span class="hs-glyph">:</span><span class="hs-identifier">x5</span><span class="hs-glyph">:</span><a name="local-6989586621679062594"><a href="#local-6989586621679062594"><span class="hs-identifier">x6</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">x7</span><span class="hs-glyph">:</span><span class="hs-identifier">x8</span><span class="hs-glyph">:</span><span class="hs-identifier">x9</span><span class="hs-glyph">:</span><span class="hs-identifier">x10</span><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">LCons</span><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">n10</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">getNodes</span><span> </span><a href="#local-6989586621679062588"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><a href="#local-6989586621679062592"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-identifier">x7</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">x8</span></a><span> </span><span class="hs-identifier">x9</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">x10</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>
</span><a name="line-3987"></a><span>      </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">n2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">s</span><span> </span><a name="local-6989586621679062602"><a href="#local-6989586621679062602"><span class="hs-identifier">x1</span></a></a><span> </span><span class="hs-identifier">x2</span><span> </span><span class="hs-identifier">x3</span><span>
</span><a name="line-3988"></a><span>            </span><span class="hs-glyph">!</span><span class="hs-identifier">n3</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Node3</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#%3A"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-identifier">x4</span><span> </span><span class="hs-identifier">x5</span><span> </span><span class="hs-identifier">x6</span><span>
</span><a name="line-3989"></a><span>            </span><span class="hs-glyph">!</span><span class="hs-identifier">n10</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Node3</span><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><a href="#local-6989586621679062611"><span class="hs-operator hs-var">*</span></a><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">n1</span><span> </span><span class="hs-identifier">n2</span><span> </span><span class="hs-identifier">n3</span><span>
</span><a name="line-3990"></a><span>
</span><a name="line-3991"></a><span>    </span><span class="hs-identifier">mkTreeC</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-3992"></a><span class="hs-cpp">#ifdef __GLASGOW_HASKELL__
</span><span>               </span><span class="hs-keyword">forall</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">.</span><span>
</span><a name="line-3994"></a><span class="hs-cpp">#endif
</span><span>               </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-3996"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span>
</span><a name="line-3997"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ListFinal</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-3998"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-3999"></a><span>    </span><span class="hs-identifier">mkTreeC</span><span> </span><span class="hs-identifier">cont</span><span> </span><span class="hs-glyph">!</span><a href="Data.Sequence.Internal.html#ListFinal"><span class="hs-identifier hs-type">_</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">LFinal</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-4000"></a><span>      </span><span class="hs-identifier">cont</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-4001"></a><span>    </span><a name="local-6989586621679062394"><a href="#local-6989586621679062394"><span class="hs-identifier">mkTreeC</span></a></a><span> </span><a name="local-6989586621679062625"><a href="#local-6989586621679062625"><span class="hs-identifier">cont</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-4002"></a><span>      </span><a href="#local-6989586621679062625"><span class="hs-identifier hs-var">cont</span></a><span> </span><a href="#local-6989586621679062626"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">x1</span><span class="hs-special">)</span><span>
</span><a name="line-4003"></a><span>    </span><span class="hs-identifier">mkTreeC</span><span> </span><a name="local-6989586621679062627"><a href="#local-6989586621679062627"><span class="hs-identifier">cont</span></a></a><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062628"><a href="#local-6989586621679062628"><span class="hs-identifier">x1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LFinal"><span class="hs-identifier hs-var">LCons</span></a><span> </span><span class="hs-identifier">x2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-4004"></a><span>      </span><a href="#local-6989586621679062627"><span class="hs-identifier hs-var">cont</span></a><span> </span><a href="#local-6989586621679062629"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">2</span><a href="#local-6989586621679062628"><span class="hs-operator hs-var">*</span></a><a href="#local-6989586621679062628"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">x1</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">x2</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4005"></a><span>    </span><span class="hs-identifier">mkTreeC</span><span> </span><a name="local-6989586621679062630"><a href="#local-6989586621679062630"><span class="hs-identifier">cont</span></a></a><span> </span><a name="local-6989586621679062631"><a href="#local-6989586621679062631"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062632"><a href="#local-6989586621679062632"><span class="hs-identifier">x1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062633"><a href="#local-6989586621679062633"><span class="hs-identifier">x2</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LFinal"><span class="hs-identifier hs-var">LCons</span></a><span> </span><span class="hs-identifier">x3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-4006"></a><span>      </span><a href="#local-6989586621679062630"><span class="hs-identifier hs-var">cont</span></a><span> </span><a href="#local-6989586621679062634"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><a href="#local-6989586621679062631"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679062632"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-identifier">x2</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">x3</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4007"></a><span>    </span><span class="hs-identifier">mkTreeC</span><span> </span><a name="local-6989586621679062635"><a href="#local-6989586621679062635"><span class="hs-identifier">cont</span></a></a><span> </span><a name="local-6989586621679062636"><a href="#local-6989586621679062636"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062637"><a href="#local-6989586621679062637"><span class="hs-identifier">x1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062638"><a href="#local-6989586621679062638"><span class="hs-identifier">x2</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062639"><a href="#local-6989586621679062639"><span class="hs-identifier">x3</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LFinal"><span class="hs-identifier hs-var">LCons</span></a><span> </span><span class="hs-identifier">x4</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-4008"></a><span>      </span><a href="#local-6989586621679062635"><span class="hs-identifier hs-var">cont</span></a><span> </span><a href="#local-6989586621679062640"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">4</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><a href="#local-6989586621679062636"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679062637"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="#local-6989586621679062638"><span class="hs-identifier hs-var">x2</span></a><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679062639"><span class="hs-identifier hs-var">x3</span></a><span> </span><span class="hs-identifier">x4</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4009"></a><span>    </span><span class="hs-identifier">mkTreeC</span><span> </span><a name="local-6989586621679062641"><a href="#local-6989586621679062641"><span class="hs-identifier">cont</span></a></a><span> </span><a name="local-6989586621679062642"><a href="#local-6989586621679062642"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062643"><a href="#local-6989586621679062643"><span class="hs-identifier">x1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062644"><a href="#local-6989586621679062644"><span class="hs-identifier">x2</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062645"><a href="#local-6989586621679062645"><span class="hs-identifier">x3</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062646"><a href="#local-6989586621679062646"><span class="hs-identifier">x4</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LFinal"><span class="hs-identifier hs-var">LCons</span></a><span> </span><span class="hs-identifier">x5</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-4010"></a><span>      </span><a href="#local-6989586621679062641"><span class="hs-identifier hs-var">cont</span></a><span> </span><a href="#local-6989586621679062647"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">5</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><a href="#local-6989586621679062642"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-identifier">x2</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">x3</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">x4</span><span> </span><span class="hs-identifier">x5</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4011"></a><span>    </span><span class="hs-identifier">mkTreeC</span><span> </span><a name="local-6989586621679062648"><a href="#local-6989586621679062648"><span class="hs-identifier">cont</span></a></a><span> </span><a name="local-6989586621679062649"><a href="#local-6989586621679062649"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062650"><a href="#local-6989586621679062650"><span class="hs-identifier">x1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062651"><a href="#local-6989586621679062651"><span class="hs-identifier">x2</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062652"><a href="#local-6989586621679062652"><span class="hs-identifier">x3</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062653"><a href="#local-6989586621679062653"><span class="hs-identifier">x4</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062654"><a href="#local-6989586621679062654"><span class="hs-identifier">x5</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LFinal"><span class="hs-identifier hs-var">LCons</span></a><span> </span><span class="hs-identifier">x6</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-4012"></a><span>      </span><a href="#local-6989586621679062648"><span class="hs-identifier hs-var">cont</span></a><span> </span><a href="#local-6989586621679062655"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">6</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><a href="#local-6989586621679062649"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679062650"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="#local-6989586621679062651"><span class="hs-identifier hs-var">x2</span></a><span> </span><a href="#local-6989586621679062652"><span class="hs-identifier hs-var">x3</span></a><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">x4</span><span> </span><span class="hs-identifier">x5</span><span> </span><span class="hs-identifier">x6</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4013"></a><span>    </span><span class="hs-identifier">mkTreeC</span><span> </span><a name="local-6989586621679062656"><a href="#local-6989586621679062656"><span class="hs-identifier">cont</span></a></a><span> </span><a name="local-6989586621679062657"><a href="#local-6989586621679062657"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062658"><a href="#local-6989586621679062658"><span class="hs-identifier">x1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062659"><a href="#local-6989586621679062659"><span class="hs-identifier">x2</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062660"><a href="#local-6989586621679062660"><span class="hs-identifier">x3</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062661"><a href="#local-6989586621679062661"><span class="hs-identifier">x4</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062662"><a href="#local-6989586621679062662"><span class="hs-identifier">x5</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062663"><a href="#local-6989586621679062663"><span class="hs-identifier">x6</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LFinal"><span class="hs-identifier hs-var">LCons</span></a><span> </span><span class="hs-identifier">x7</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-4014"></a><span>      </span><a href="#local-6989586621679062656"><span class="hs-identifier hs-var">cont</span></a><span> </span><a href="#local-6989586621679062664"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">7</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><a href="#local-6989586621679062657"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Two</span></a><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-identifier">x2</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-operator hs-var">*</span></a><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">x3</span><span> </span><span class="hs-identifier">x4</span><span> </span><span class="hs-identifier">x5</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">x6</span><span> </span><span class="hs-identifier">x7</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4015"></a><span>    </span><span class="hs-identifier">mkTreeC</span><span> </span><a name="local-6989586621679062665"><a href="#local-6989586621679062665"><span class="hs-identifier">cont</span></a></a><span> </span><a name="local-6989586621679062666"><a href="#local-6989586621679062666"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062667"><a href="#local-6989586621679062667"><span class="hs-identifier">x1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062668"><a href="#local-6989586621679062668"><span class="hs-identifier">x2</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062669"><a href="#local-6989586621679062669"><span class="hs-identifier">x3</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062670"><a href="#local-6989586621679062670"><span class="hs-identifier">x4</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062671"><a href="#local-6989586621679062671"><span class="hs-identifier">x5</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062672"><a href="#local-6989586621679062672"><span class="hs-identifier">x6</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062673"><a href="#local-6989586621679062673"><span class="hs-identifier">x7</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LFinal"><span class="hs-identifier hs-var">LCons</span></a><span> </span><span class="hs-identifier">x8</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-4016"></a><span>      </span><a href="#local-6989586621679062665"><span class="hs-identifier hs-var">cont</span></a><span> </span><a href="#local-6989586621679062674"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">8</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><a href="#local-6989586621679062666"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-identifier">x2</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">x3</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><a href="#local-6989586621679062669"><span class="hs-operator hs-var">*</span></a><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">x4</span><span> </span><span class="hs-identifier">x5</span><span> </span><span class="hs-identifier">x6</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">x7</span><span> </span><span class="hs-identifier">x8</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4017"></a><span>    </span><span class="hs-identifier">mkTreeC</span><span> </span><a name="local-6989586621679062675"><a href="#local-6989586621679062675"><span class="hs-identifier">cont</span></a></a><span> </span><a name="local-6989586621679062676"><a href="#local-6989586621679062676"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062677"><a href="#local-6989586621679062677"><span class="hs-identifier">x1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062678"><a href="#local-6989586621679062678"><span class="hs-identifier">x2</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062679"><a href="#local-6989586621679062679"><span class="hs-identifier">x3</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062680"><a href="#local-6989586621679062680"><span class="hs-identifier">x4</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062681"><a href="#local-6989586621679062681"><span class="hs-identifier">x5</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062682"><a href="#local-6989586621679062682"><span class="hs-identifier">x6</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062683"><a href="#local-6989586621679062683"><span class="hs-identifier">x7</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062684"><a href="#local-6989586621679062684"><span class="hs-identifier">x8</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LFinal"><span class="hs-identifier hs-var">LCons</span></a><span> </span><span class="hs-identifier">x9</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-4018"></a><span>      </span><a href="#local-6989586621679062675"><span class="hs-identifier hs-var">cont</span></a><span> </span><a href="#local-6989586621679062685"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">9</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><a href="#local-6989586621679062676"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679062677"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="#local-6989586621679062678"><span class="hs-identifier hs-var">x2</span></a><span> </span><a href="#local-6989586621679062679"><span class="hs-identifier hs-var">x3</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">Single</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><a href="#local-6989586621679062676"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679062680"><span class="hs-identifier hs-var">x4</span></a><span> </span><a href="#local-6989586621679062681"><span class="hs-identifier hs-var">x5</span></a><span> </span><a href="#local-6989586621679062682"><span class="hs-identifier hs-var">x6</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">x7</span><span> </span><span class="hs-identifier">x8</span><span> </span><span class="hs-identifier">x9</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4019"></a><span>    </span><span class="hs-identifier">mkTreeC</span><span> </span><a name="local-6989586621679062686"><a href="#local-6989586621679062686"><span class="hs-identifier">cont</span></a></a><span> </span><a name="local-6989586621679062687"><a href="#local-6989586621679062687"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062688"><a href="#local-6989586621679062688"><span class="hs-identifier">x1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062689"><a href="#local-6989586621679062689"><span class="hs-identifier">x2</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062690"><a href="#local-6989586621679062690"><span class="hs-identifier">x3</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062691"><a href="#local-6989586621679062691"><span class="hs-identifier">x4</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062692"><a href="#local-6989586621679062692"><span class="hs-identifier">x5</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062693"><a href="#local-6989586621679062693"><span class="hs-identifier">x6</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062694"><a href="#local-6989586621679062694"><span class="hs-identifier">x7</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062695"><a href="#local-6989586621679062695"><span class="hs-identifier">x8</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062696"><a href="#local-6989586621679062696"><span class="hs-identifier">y0</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LFinal"><span class="hs-identifier hs-var">LCons</span></a><span> </span><span class="hs-identifier">y1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-4020"></a><span>      </span><a href="#local-6989586621679062686"><span class="hs-identifier hs-var">cont</span></a><span> </span><a href="#local-6989586621679062697"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">10</span><a href="#local-6989586621679062687"><span class="hs-operator hs-var">*</span></a><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Two</span></a><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-identifier">x2</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-number">6</span><a href="Data.Sequence.Internal.html#Single"><span class="hs-operator hs-var">*</span></a><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">One</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><a href="#local-6989586621679062691"><span class="hs-operator hs-var">*</span></a><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">x3</span><span> </span><span class="hs-identifier">x4</span><span> </span><span class="hs-identifier">x5</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><span class="hs-operator">*</span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">x6</span><span> </span><span class="hs-identifier">x7</span><span> </span><span class="hs-identifier">x8</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">y0</span><span> </span><span class="hs-identifier">y1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4021"></a><span>    </span><span class="hs-identifier">mkTreeC</span><span> </span><a name="local-6989586621679062698"><a href="#local-6989586621679062698"><span class="hs-identifier">cont</span></a></a><span> </span><a name="local-6989586621679062699"><a href="#local-6989586621679062699"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062700"><a href="#local-6989586621679062700"><span class="hs-identifier">x1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062701"><a href="#local-6989586621679062701"><span class="hs-identifier">x2</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062702"><a href="#local-6989586621679062702"><span class="hs-identifier">x3</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062703"><a href="#local-6989586621679062703"><span class="hs-identifier">x4</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062704"><a href="#local-6989586621679062704"><span class="hs-identifier">x5</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062705"><a href="#local-6989586621679062705"><span class="hs-identifier">x6</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062706"><a href="#local-6989586621679062706"><span class="hs-identifier">x7</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062707"><a href="#local-6989586621679062707"><span class="hs-identifier">x8</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062708"><a href="#local-6989586621679062708"><span class="hs-identifier">x9</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062709"><a href="#local-6989586621679062709"><span class="hs-identifier">y0</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LFinal"><span class="hs-identifier hs-var">LCons</span></a><span> </span><span class="hs-identifier">y1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-4022"></a><span>      </span><a href="#local-6989586621679062698"><span class="hs-identifier hs-var">cont</span></a><span> </span><a href="#local-6989586621679062710"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">11</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><a href="#local-6989586621679062699"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-identifier">x2</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">x3</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-number">6</span><a href="Data.Sequence.Internal.html#One"><span class="hs-operator hs-var">*</span></a><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">One</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><a href="#local-6989586621679062702"><span class="hs-operator hs-var">*</span></a><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">x4</span><span> </span><span class="hs-identifier">x5</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">x6</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">One</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><a href="#local-6989586621679062705"><span class="hs-operator hs-var">*</span></a><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">x7</span><span> </span><span class="hs-identifier">x8</span><span> </span><span class="hs-identifier">x9</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">y0</span><span> </span><span class="hs-identifier">y1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4023"></a><span>    </span><span class="hs-identifier">mkTreeC</span><span> </span><a name="local-6989586621679062711"><a href="#local-6989586621679062711"><span class="hs-identifier">cont</span></a></a><span> </span><a name="local-6989586621679062712"><a href="#local-6989586621679062712"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062713"><a href="#local-6989586621679062713"><span class="hs-identifier">x1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062714"><a href="#local-6989586621679062714"><span class="hs-identifier">x2</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062715"><a href="#local-6989586621679062715"><span class="hs-identifier">x3</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062716"><a href="#local-6989586621679062716"><span class="hs-identifier">x4</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062717"><a href="#local-6989586621679062717"><span class="hs-identifier">x5</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062718"><a href="#local-6989586621679062718"><span class="hs-identifier">x6</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062719"><a href="#local-6989586621679062719"><span class="hs-identifier">x7</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062720"><a href="#local-6989586621679062720"><span class="hs-identifier">x8</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062721"><a href="#local-6989586621679062721"><span class="hs-identifier">x9</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062722"><a href="#local-6989586621679062722"><span class="hs-identifier">y0</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062723"><a href="#local-6989586621679062723"><span class="hs-identifier">y1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LFinal"><span class="hs-identifier hs-var">LCons</span></a><span> </span><span class="hs-identifier">y2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-4024"></a><span>      </span><a href="#local-6989586621679062711"><span class="hs-identifier hs-var">cont</span></a><span> </span><a href="#local-6989586621679062724"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">12</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><a href="#local-6989586621679062712"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679062713"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="#local-6989586621679062714"><span class="hs-identifier hs-var">x2</span></a><span> </span><a href="#local-6989586621679062715"><span class="hs-identifier hs-var">x3</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">6</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><a href="#local-6989586621679062712"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><a href="#local-6989586621679062712"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679062716"><span class="hs-identifier hs-var">x4</span></a><span> </span><a href="#local-6989586621679062717"><span class="hs-identifier hs-var">x5</span></a><span> </span><a href="#local-6989586621679062718"><span class="hs-identifier hs-var">x6</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><a href="#local-6989586621679062712"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679062719"><span class="hs-identifier hs-var">x7</span></a><span> </span><a href="#local-6989586621679062720"><span class="hs-identifier hs-var">x8</span></a><span> </span><a href="#local-6989586621679062721"><span class="hs-identifier hs-var">x9</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">y0</span><span> </span><span class="hs-identifier">y1</span><span> </span><span class="hs-identifier">y2</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4025"></a><span>    </span><span class="hs-identifier">mkTreeC</span><span> </span><a name="local-6989586621679062725"><a href="#local-6989586621679062725"><span class="hs-identifier">cont</span></a></a><span> </span><a name="local-6989586621679062726"><a href="#local-6989586621679062726"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062727"><a href="#local-6989586621679062727"><span class="hs-identifier">x1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062728"><a href="#local-6989586621679062728"><span class="hs-identifier">x2</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062729"><a href="#local-6989586621679062729"><span class="hs-identifier">x3</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062730"><a href="#local-6989586621679062730"><span class="hs-identifier">x4</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062731"><a href="#local-6989586621679062731"><span class="hs-identifier">x5</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062732"><a href="#local-6989586621679062732"><span class="hs-identifier">x6</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062733"><a href="#local-6989586621679062733"><span class="hs-identifier">x7</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062734"><a href="#local-6989586621679062734"><span class="hs-identifier">x8</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062735"><a href="#local-6989586621679062735"><span class="hs-identifier">y0</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062736"><a href="#local-6989586621679062736"><span class="hs-identifier">y1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062737"><a href="#local-6989586621679062737"><span class="hs-identifier">y2</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062738"><a href="#local-6989586621679062738"><span class="hs-identifier">y3</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LFinal"><span class="hs-identifier hs-var">LCons</span></a><span> </span><span class="hs-identifier">y4</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-4026"></a><span>      </span><a href="#local-6989586621679062725"><span class="hs-identifier hs-var">cont</span></a><span> </span><a href="#local-6989586621679062739"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">13</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><a href="#local-6989586621679062726"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Two</span></a><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-identifier">x2</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-number">9</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-operator hs-var">*</span></a><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-operator hs-var">*</span></a><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">x3</span><span> </span><span class="hs-identifier">x4</span><span> </span><span class="hs-identifier">x5</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-operator hs-var">*</span></a><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">x6</span><span> </span><span class="hs-identifier">x7</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">x8</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-operator hs-var">*</span></a><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">y0</span><span> </span><span class="hs-identifier">y1</span><span> </span><span class="hs-identifier">y2</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">y3</span><span> </span><span class="hs-identifier">y4</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4027"></a><span>    </span><span class="hs-identifier">mkTreeC</span><span> </span><a name="local-6989586621679062740"><a href="#local-6989586621679062740"><span class="hs-identifier">cont</span></a></a><span> </span><a name="local-6989586621679062741"><a href="#local-6989586621679062741"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062742"><a href="#local-6989586621679062742"><span class="hs-identifier">x1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062743"><a href="#local-6989586621679062743"><span class="hs-identifier">x2</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062744"><a href="#local-6989586621679062744"><span class="hs-identifier">x3</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062745"><a href="#local-6989586621679062745"><span class="hs-identifier">x4</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062746"><a href="#local-6989586621679062746"><span class="hs-identifier">x5</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062747"><a href="#local-6989586621679062747"><span class="hs-identifier">x6</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062748"><a href="#local-6989586621679062748"><span class="hs-identifier">x7</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062749"><a href="#local-6989586621679062749"><span class="hs-identifier">x8</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062750"><a href="#local-6989586621679062750"><span class="hs-identifier">x9</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062751"><a href="#local-6989586621679062751"><span class="hs-identifier">y0</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062752"><a href="#local-6989586621679062752"><span class="hs-identifier">y1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062753"><a href="#local-6989586621679062753"><span class="hs-identifier">y2</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062754"><a href="#local-6989586621679062754"><span class="hs-identifier">y3</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LFinal"><span class="hs-identifier hs-var">LCons</span></a><span> </span><span class="hs-identifier">y4</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-4028"></a><span>      </span><a href="#local-6989586621679062740"><span class="hs-identifier hs-var">cont</span></a><span> </span><a href="#local-6989586621679062755"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">14</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><a href="#local-6989586621679062741"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-identifier">x2</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">x3</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-number">9</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-operator hs-var">*</span></a><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Two</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><a href="#local-6989586621679062744"><span class="hs-operator hs-var">*</span></a><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">x4</span><span> </span><span class="hs-identifier">x5</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">x6</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><a href="#local-6989586621679062747"><span class="hs-operator hs-var">*</span></a><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">x7</span><span> </span><span class="hs-identifier">x8</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">x9</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">One</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><a href="#local-6989586621679062750"><span class="hs-operator hs-var">*</span></a><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">y0</span><span> </span><span class="hs-identifier">y1</span><span> </span><span class="hs-identifier">y2</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">y3</span><span> </span><span class="hs-identifier">y4</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4029"></a><span>    </span><span class="hs-identifier">mkTreeC</span><span> </span><a name="local-6989586621679062756"><a href="#local-6989586621679062756"><span class="hs-identifier">cont</span></a></a><span> </span><a name="local-6989586621679062757"><a href="#local-6989586621679062757"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062758"><a href="#local-6989586621679062758"><span class="hs-identifier">x1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062759"><a href="#local-6989586621679062759"><span class="hs-identifier">x2</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062760"><a href="#local-6989586621679062760"><span class="hs-identifier">x3</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062761"><a href="#local-6989586621679062761"><span class="hs-identifier">x4</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062762"><a href="#local-6989586621679062762"><span class="hs-identifier">x5</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062763"><a href="#local-6989586621679062763"><span class="hs-identifier">x6</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062764"><a href="#local-6989586621679062764"><span class="hs-identifier">x7</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062765"><a href="#local-6989586621679062765"><span class="hs-identifier">x8</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062766"><a href="#local-6989586621679062766"><span class="hs-identifier">x9</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062767"><a href="#local-6989586621679062767"><span class="hs-identifier">y0</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062768"><a href="#local-6989586621679062768"><span class="hs-identifier">y1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062769"><a href="#local-6989586621679062769"><span class="hs-identifier">y2</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062770"><a href="#local-6989586621679062770"><span class="hs-identifier">y3</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062771"><a href="#local-6989586621679062771"><span class="hs-identifier">y4</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LFinal"><span class="hs-identifier hs-var">LCons</span></a><span> </span><span class="hs-identifier">y5</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-4030"></a><span>      </span><a href="#local-6989586621679062756"><span class="hs-identifier hs-var">cont</span></a><span> </span><a href="#local-6989586621679062772"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">15</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><a href="#local-6989586621679062757"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679062758"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="#local-6989586621679062759"><span class="hs-identifier hs-var">x2</span></a><span> </span><a href="#local-6989586621679062760"><span class="hs-identifier hs-var">x3</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">Deep</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">9</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><a href="#local-6989586621679062757"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><a href="#local-6989586621679062757"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679062761"><span class="hs-identifier hs-var">x4</span></a><span> </span><a href="#local-6989586621679062762"><span class="hs-identifier hs-var">x5</span></a><span> </span><a href="#local-6989586621679062763"><span class="hs-identifier hs-var">x6</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><a href="#local-6989586621679062757"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679062764"><span class="hs-identifier hs-var">x7</span></a><span> </span><a href="#local-6989586621679062765"><span class="hs-identifier hs-var">x8</span></a><span> </span><a href="#local-6989586621679062766"><span class="hs-identifier hs-var">x9</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">EmptyT</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">One</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><a href="#local-6989586621679062757"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679062767"><span class="hs-identifier hs-var">y0</span></a><span> </span><a href="#local-6989586621679062768"><span class="hs-identifier hs-var">y1</span></a><span> </span><a href="#local-6989586621679062769"><span class="hs-identifier hs-var">y2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">y3</span><span> </span><span class="hs-identifier">y4</span><span> </span><span class="hs-identifier">y5</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4031"></a><span>    </span><span class="hs-identifier">mkTreeC</span><span> </span><a name="local-6989586621679062773"><a href="#local-6989586621679062773"><span class="hs-identifier">cont</span></a></a><span> </span><a name="local-6989586621679062774"><a href="#local-6989586621679062774"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062775"><a href="#local-6989586621679062775"><span class="hs-identifier">x1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062776"><a href="#local-6989586621679062776"><span class="hs-identifier">x2</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062777"><a href="#local-6989586621679062777"><span class="hs-identifier">x3</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062778"><a href="#local-6989586621679062778"><span class="hs-identifier">x4</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062779"><a href="#local-6989586621679062779"><span class="hs-identifier">x5</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062780"><a href="#local-6989586621679062780"><span class="hs-identifier">x6</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062781"><a href="#local-6989586621679062781"><span class="hs-identifier">x7</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062782"><a href="#local-6989586621679062782"><span class="hs-identifier">x8</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062783"><a href="#local-6989586621679062783"><span class="hs-identifier">x9</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062784"><a href="#local-6989586621679062784"><span class="hs-identifier">y0</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062785"><a href="#local-6989586621679062785"><span class="hs-identifier">y1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062786"><a href="#local-6989586621679062786"><span class="hs-identifier">y2</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062787"><a href="#local-6989586621679062787"><span class="hs-identifier">y3</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062788"><a href="#local-6989586621679062788"><span class="hs-identifier">y4</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062789"><a href="#local-6989586621679062789"><span class="hs-identifier">y5</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LFinal"><span class="hs-identifier hs-var">LCons</span></a><span> </span><span class="hs-identifier">y6</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-4032"></a><span>      </span><span class="hs-identifier">mkTreeC</span><span> </span><span class="hs-identifier">cont2</span><span> </span><span class="hs-special">(</span><span class="hs-number">9</span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><a href="#local-6989586621679062774"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">getNodesC</span><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><a href="#local-6989586621679062777"><span class="hs-operator hs-var">*</span></a><a href="#local-6989586621679062777"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><a href="#local-6989586621679062774"><span class="hs-operator hs-var">*</span></a><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">y3</span></a><span> </span><span class="hs-identifier">y4</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">y5</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">y6</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>
</span><a name="line-4033"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-4034"></a><span class="hs-cpp">#ifdef __GLASGOW_HASKELL__
</span><span>        </span><span class="hs-identifier">cont2</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-4036"></a><span class="hs-cpp">#endif
</span><span>        </span><span class="hs-identifier">cont2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">r1</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">r2</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">sub</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-4038"></a><span>          </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">d2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-identifier">x2</span><span> </span><span class="hs-identifier">x3</span><span>
</span><a name="line-4039"></a><span>              </span><span class="hs-identifier">d1</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Three</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><span class="hs-operator">*</span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">x4</span><span> </span><span class="hs-identifier">x5</span><span> </span><span class="hs-identifier">x6</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><span class="hs-operator">*</span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">x7</span><span> </span><span class="hs-identifier">x8</span><span> </span><span class="hs-identifier">x9</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><span class="hs-operator">*</span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">y0</span><span> </span><span class="hs-identifier">y1</span><span> </span><span class="hs-identifier">y2</span><span class="hs-special">)</span><span>
</span><a name="line-4040"></a><span>              </span><span class="hs-glyph">!</span><span class="hs-identifier">sub1</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-number">9</span><a href="#local-6989586621679062794"><span class="hs-operator hs-var">*</span></a><span class="hs-identifier">s</span><span> </span><a href="#local-6989586621679062795"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">r1</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">sub</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">d1</span><span> </span><span class="hs-identifier">sub</span><span> </span><span class="hs-identifier">r1</span><span>
</span><a name="line-4041"></a><span>          </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">cont</span><span> </span><span class="hs-identifier">b</span><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-operator hs-var">$!</span></a><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-operator hs-var">*</span></a><span class="hs-identifier">s</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">r2</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">sub1</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">d2</span><span> </span><span class="hs-identifier">sub1</span><span> </span><a href="#local-6989586621679062800"><span class="hs-identifier hs-var">r2</span></a><span>
</span><a name="line-4042"></a><span>
</span><a name="line-4043"></a><span>    </span><span class="hs-identifier">getNodesC</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span>
</span><a name="line-4044"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-4045"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim/src/%{MODULE}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-4046"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ListFinal</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-4047"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ListFinal</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-4048"></a><span>    </span><span class="hs-identifier">getNodesC</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">_</span><span> </span><a href="Data.Sequence.Internal.html#ListFinal"><span class="hs-identifier hs-type">n1</span></a><span> </span><a href="Data.Sequence.Internal.html#ListFinal"><span class="hs-identifier hs-type">x1</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">n1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">x1</span><span class="hs-special">)</span><span>
</span><a name="line-4049"></a><span>    </span><span class="hs-identifier">getNodesC</span><span> </span><span class="hs-identifier">_</span><span>  </span><a href="Data.Sequence.Internal.html#ListFinal"><span class="hs-identifier hs-type">n1</span></a><span>  </span><a href="Data.Sequence.Internal.html#ListFinal"><span class="hs-identifier hs-type">x1</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">LFinal</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-operator hs-type">$</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">One</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">n1</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-identifier">x2</span><span class="hs-special">)</span><span>
</span><a name="line-4050"></a><span>    </span><a name="local-6989586621679062395"><a href="#local-6989586621679062395"><span class="hs-identifier">getNodesC</span></a></a><span> </span><span class="hs-identifier">_</span><span>  </span><a name="local-6989586621679062818"><a href="#local-6989586621679062818"><span class="hs-identifier">n1</span></a></a><span>  </span><span class="hs-identifier">x1</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LFinal"><span class="hs-identifier hs-var">LCons</span></a><span> </span><span class="hs-identifier">x2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">n1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-identifier">x2</span><span> </span><span class="hs-identifier">x3</span><span class="hs-special">)</span><span>
</span><a name="line-4051"></a><span>    </span><span class="hs-identifier">getNodesC</span><span> </span><span class="hs-identifier">s</span><span>  </span><a name="local-6989586621679062821"><a href="#local-6989586621679062821"><span class="hs-identifier">n1</span></a></a><span>  </span><a name="local-6989586621679062822"><a href="#local-6989586621679062822"><span class="hs-identifier">x1</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">LCons</span></a><span> </span><a name="local-6989586621679062823"><a href="#local-6989586621679062823"><span class="hs-identifier">x2</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#LFinal"><span class="hs-identifier hs-var">LCons</span></a><span> </span><span class="hs-identifier">x3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><a href="Data.Sequence.Internal.html#LFinal"><span class="hs-identifier hs-var">x4</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">LFinal</span><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-4052"></a><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">n2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Node3</span><span> </span><a name="local-6989586621679062826"><a href="#local-6989586621679062826"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-identifier">x1</span><span> </span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">x2</span></a><span> </span><span class="hs-identifier">x3</span><span>
</span><a name="line-4053"></a><span>      </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Two</span><span> </span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">n1</span></a><span> </span><span class="hs-identifier">n2</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">One</span><span> </span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">x4</span></a><span class="hs-special">)</span><span>
</span><a name="line-4054"></a><span>    </span><span class="hs-identifier">getNodesC</span><span> </span><span class="hs-identifier">s</span><span>  </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">n1</span></a><span>  </span><span class="hs-identifier">x1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x4</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x5</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-4055"></a><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a href="Data.Sequence.Internal.html#LFinal"><span class="hs-identifier hs-var">n2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Node3</span><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-identifier">x2</span><span> </span><span class="hs-identifier">x3</span><span>
</span><a name="line-4056"></a><span>      </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Two</span><span> </span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">n1</span></a><span> </span><span class="hs-identifier">n2</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Two</span><span> </span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">x4</span></a><span> </span><span class="hs-identifier">x5</span><span class="hs-special">)</span><span>
</span><a name="line-4057"></a><span>    </span><span class="hs-identifier">getNodesC</span><span> </span><span class="hs-identifier">s</span><span>  </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">n1</span></a><span>  </span><span class="hs-identifier">x1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x4</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x5</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x6</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-4058"></a><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a href="Data.Sequence.Internal.html#LFinal"><span class="hs-identifier hs-var">n2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Node3</span><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-identifier">x2</span><span> </span><span class="hs-identifier">x3</span><span>
</span><a name="line-4059"></a><span>      </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Two</span><span> </span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">n1</span></a><span> </span><span class="hs-identifier">n2</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">x4</span><span> </span><span class="hs-identifier">x5</span><span> </span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">x6</span></a><span class="hs-special">)</span><span>
</span><a name="line-4060"></a><span>    </span><span class="hs-identifier">getNodesC</span><span> </span><span class="hs-identifier">s</span><span>  </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">n1</span></a><span>  </span><span class="hs-identifier">x1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x4</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x5</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x6</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x7</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-4061"></a><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a href="Data.Sequence.Internal.html#LFinal"><span class="hs-identifier hs-var">n2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Node3</span><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-identifier">x2</span><span> </span><span class="hs-identifier">x3</span><span>
</span><a name="line-4062"></a><span>          </span><span class="hs-glyph">!</span><span class="hs-identifier">n3</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Node3</span><span> </span><a name="local-6989586621679062859"><a href="#local-6989586621679062859"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-identifier">x4</span><span> </span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">x5</span></a><span> </span><span class="hs-identifier">x6</span><span>
</span><a name="line-4063"></a><span>      </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">LFinal</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">n1</span><span> </span><span class="hs-identifier">n2</span><span> </span><span class="hs-identifier">n3</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">x7</span><span class="hs-special">)</span><span>
</span><a name="line-4064"></a><span>    </span><span class="hs-identifier">getNodesC</span><span> </span><span class="hs-identifier">s</span><span>  </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">n1</span></a><span>  </span><span class="hs-identifier">x1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x4</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x5</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x6</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x7</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x8</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-4065"></a><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a href="Data.Sequence.Internal.html#LFinal"><span class="hs-identifier hs-var">n2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Node3</span><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-identifier">x2</span><span> </span><span class="hs-identifier">x3</span><span>
</span><a name="line-4066"></a><span>          </span><span class="hs-glyph">!</span><span class="hs-identifier">n3</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Node3</span><span> </span><a name="local-6989586621679062871"><a href="#local-6989586621679062871"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-identifier">x4</span><span> </span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">x5</span></a><span> </span><span class="hs-identifier">x6</span><span>
</span><a name="line-4067"></a><span>      </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">LFinal</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">n1</span><span> </span><span class="hs-identifier">n2</span><span> </span><span class="hs-identifier">n3</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">x7</span><span> </span><span class="hs-identifier">x8</span><span class="hs-special">)</span><span>
</span><a name="line-4068"></a><span>    </span><span class="hs-identifier">getNodesC</span><span> </span><span class="hs-identifier">s</span><span>  </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">n1</span></a><span>  </span><span class="hs-identifier">x1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x4</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x5</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x6</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x7</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x8</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x9</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-4069"></a><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a href="Data.Sequence.Internal.html#LFinal"><span class="hs-identifier hs-var">n2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Node3</span><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-identifier">x2</span><span> </span><span class="hs-identifier">x3</span><span>
</span><a name="line-4070"></a><span>          </span><span class="hs-glyph">!</span><span class="hs-identifier">n3</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Node3</span><span> </span><a name="local-6989586621679062884"><a href="#local-6989586621679062884"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-identifier">x4</span><span> </span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">x5</span></a><span> </span><span class="hs-identifier">x6</span><span>
</span><a name="line-4071"></a><span>      </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">LFinal</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">n1</span><span> </span><span class="hs-identifier">n2</span><span> </span><span class="hs-identifier">n3</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">x7</span><span> </span><span class="hs-identifier">x8</span><span> </span><span class="hs-identifier">x9</span><span class="hs-special">)</span><span>
</span><a name="line-4072"></a><span>    </span><span class="hs-identifier">getNodesC</span><span> </span><span class="hs-identifier">s</span><span>  </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">n1</span></a><span>  </span><span class="hs-identifier">x1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x3</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x4</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x5</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x6</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x7</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x8</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x9</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">x10</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-4073"></a><span>        </span><span class="hs-identifier">LCons</span><span> </span><span class="hs-identifier">n10</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">getNodesC</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">x7</span></a><span> </span><a href="#local-6989586621679062890"><span class="hs-identifier hs-var">x8</span></a><span> </span><a href="#local-6989586621679062891"><span class="hs-identifier hs-var">x9</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">x10</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-4074"></a><span>      </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">n2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">s</span><span> </span><a href="Data.Sequence.Internal.html#LCons"><span class="hs-identifier hs-var">x1</span></a><span> </span><span class="hs-identifier">x2</span><span> </span><span class="hs-identifier">x3</span><span>
</span><a name="line-4075"></a><span>            </span><span class="hs-glyph">!</span><span class="hs-identifier">n3</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Node3</span><span> </span><a href="#local-6989586621679062395"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679062395"><span class="hs-identifier hs-var">x4</span></a><span> </span><span class="hs-identifier">x5</span><span> </span><span class="hs-identifier">x6</span><span>
</span><a name="line-4076"></a><span>            </span><span class="hs-glyph">!</span><span class="hs-identifier">n10</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Node3</span><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><a href="#local-6989586621679062898"><span class="hs-operator hs-var">*</span></a><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">n1</span><span> </span><span class="hs-identifier">n2</span><span> </span><span class="hs-identifier">n3</span><span>
</span><a name="line-4077"></a><span>
</span><a name="line-4078"></a><span>    </span><span class="hs-identifier">map_elem</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">]</span><span>
</span><a name="line-4079"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 708
</span><span>    </span><span class="hs-identifier">map_elem</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">coerce</span><span> </span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">xs</span></a><span>
</span><a name="line-4081"></a><span class="hs-cpp">#else
</span><span>    </span><a name="local-6989586621679062396"><a href="#local-6989586621679062396"><span class="hs-identifier">map_elem</span></a></a><span> </span><a name="local-6989586621679062912"><a href="#local-6989586621679062912"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Data.List.map</span><span> </span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-4083"></a><span class="hs-cpp">#endif
</span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">map_elem</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-4085"></a><span>
</span><a name="line-4086"></a><span class="hs-comment">-- essentially: Free ((,) a) b.</span><span>
</span><a name="line-4087"></a><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">ListFinal</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">cont</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">LFinal</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">cont</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">LCons</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">a</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ListFinal</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">cont</span><span class="hs-special">)</span><span>
</span><a name="line-4088"></a><span>
</span><a name="line-4089"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 708
</span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">GHC.Exts.IsList</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-4091"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Item</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-4092"></a><span>    </span><span class="hs-identifier">fromList</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Exts.html#IsList"><span class="hs-identifier hs-type">fromList</span></a><span>
</span><a name="line-4093"></a><span>    </span><span class="hs-identifier">fromListN</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fromList2</span><span>
</span><a name="line-4094"></a><span>    </span><a name="local-3458764513820541127"><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Exts.html#fromList"><span class="hs-identifier">toList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">toList</span><span>
</span><a name="line-4095"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-4097"></a><span class="hs-cpp">#ifdef __GLASGOW_HASKELL__
</span><span class="hs-comment">-- | @since 0.5.7</span><span>
</span><a name="line-4099"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">~</span><span> </span><span class="hs-identifier">Char</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">IsString</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-4100"></a><span>    </span><span class="hs-identifier">fromString</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fromList</span><span>
</span><a name="line-4101"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-4103"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-4104"></a><span class="hs-comment">-- Reverse</span><span>
</span><a name="line-4105"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-4106"></a><span>
</span><a name="line-4107"></a><span class="hs-comment">-- | \( O(n) \). The reverse of a sequence.</span><span>
</span><a name="line-4108"></a><span class="hs-identifier">reverse</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-4109"></a><span class="hs-identifier">reverse</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fmapReverseTree</span><span> </span><span class="hs-identifier">id</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>
</span><a name="line-4110"></a><span>
</span><a name="line-4111"></a><span class="hs-cpp">#ifdef __GLASGOW_HASKELL__
</span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">reverse</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-4113"></a><span>
</span><a name="line-4114"></a><span class="hs-comment">-- | \( O(n) \). Reverse a sequence while mapping over it. This is not</span><span>
</span><a name="line-4115"></a><span class="hs-comment">-- currently exported, but is used in rewrite rules.</span><span>
</span><a name="line-4116"></a><span class="hs-identifier">fmapReverse</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-4117"></a><span class="hs-identifier">fmapReverse</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fmapReverseTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">lift_elem</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>
</span><a name="line-4118"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-4119"></a><span>    </span><span class="hs-identifier">lift_elem</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#fmapReverseTree"><span class="hs-identifier hs-var">Elem</span></a><span> </span><a href="Data.Sequence.Internal.html#fmapReverseTree"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#fmapReverseTree"><span class="hs-identifier hs-var">Elem</span></a><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-4120"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 708
</span><span>    </span><span class="hs-identifier">lift_elem</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">coerce</span><span>
</span><a name="line-4122"></a><span class="hs-cpp">#else
</span><span>    </span><a name="local-6989586621679062916"><a href="#local-6989586621679062916"><span class="hs-identifier">lift_elem</span></a></a><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Elem</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-4124"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-4126"></a><span class="hs-comment">-- If we're mapping over a sequence, we can reverse it at the same time</span><span>
</span><a name="line-4127"></a><span class="hs-comment">-- at no extra charge.</span><span>
</span><a name="line-4128"></a><span class="hs-pragma">{-# RULES</span><span>
</span><a name="line-4129"></a><span class="hs-pragma">&quot;fmapSeq/reverse&quot;</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">fmapSeq</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">reverse</span><span> </span><span class="hs-pragma">xs</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">fmapReverse</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">xs</span><span>
</span><a name="line-4130"></a><span class="hs-pragma">&quot;reverse/fmapSeq&quot;</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">reverse</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">fmapSeq</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">xs</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">fmapReverse</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">xs</span><span>
</span><a name="line-4131"></a><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-4132"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-4134"></a><span class="hs-identifier">fmapReverseTree</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-4135"></a><span class="hs-identifier">fmapReverseTree</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-4136"></a><span class="hs-identifier">fmapReverseTree</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Single</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><a name="line-4137"></a><span class="hs-identifier">fmapReverseTree</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><a href="Data.Sequence.Internal.html#FingerTree"><span class="hs-identifier hs-type">sf</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-4138"></a><span>    </span><a name="fmapReverseTree"><a href="Data.Sequence.Internal.html#fmapReverseTree"><span class="hs-identifier">Deep</span></a></a><span> </span><a name="fmapReverseTree"><a href="Data.Sequence.Internal.html#fmapReverseTree"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">reverseDigit</span><span> </span><span class="hs-identifier">f</span><span> </span><a href="Data.Sequence.Internal.html#EmptyT"><span class="hs-identifier hs-var">sf</span></a><span class="hs-special">)</span><span>
</span><a name="line-4139"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">fmapReverseTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">reverseNode</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679062920"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-4140"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">reverseDigit</span><span> </span><a href="Data.Sequence.Internal.html#Deep"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-identifier">pr</span><span class="hs-special">)</span><span>
</span><a name="line-4141"></a><span>
</span><a name="line-4142"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">reverseDigit</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-4143"></a><span class="hs-identifier">reverseDigit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#reverseDigit"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679062921"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-4144"></a><span class="hs-identifier">reverseDigit</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">One</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-4145"></a><span class="hs-identifier">reverseDigit</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Two</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-4146"></a><span class="hs-identifier">reverseDigit</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><a href="#local-6989586621679058837"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Three</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-4147"></a><a name="reverseDigit"><a href="Data.Sequence.Internal.html#reverseDigit"><span class="hs-identifier">reverseDigit</span></a></a><span> </span><a name="local-6989586621679062926"><a href="#local-6989586621679062926"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Four</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-4148"></a><span>
</span><a name="line-4149"></a><span class="hs-identifier">reverseNode</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-4150"></a><span class="hs-identifier">reverseNode</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node2</span><span> </span><a name="local-6989586621679062936"><a href="#local-6989586621679062936"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679062937"><a href="#local-6989586621679062937"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679062938"><a href="#local-6989586621679062938"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Node2</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-4151"></a><span class="hs-identifier">reverseNode</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-4152"></a><span>
</span><a name="line-4153"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-4154"></a><span class="hs-comment">-- Mapping with a splittable value</span><span>
</span><a name="line-4155"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-4156"></a><span>
</span><a name="line-4157"></a><span class="hs-comment">-- For zipping, it is useful to build a result by</span><span>
</span><a name="line-4158"></a><span class="hs-comment">-- traversing a sequence while splitting up something else.  For zipping, we</span><span>
</span><a name="line-4159"></a><span class="hs-comment">-- traverse the first sequence while splitting up the second.</span><span>
</span><a name="line-4160"></a><span class="hs-comment">--</span><span>
</span><a name="line-4161"></a><span class="hs-comment">-- What makes all this crazy code a good idea:</span><span>
</span><a name="line-4162"></a><span class="hs-comment">--</span><span>
</span><a name="line-4163"></a><span class="hs-comment">-- Suppose we zip together two sequences of the same length:</span><span>
</span><a name="line-4164"></a><span class="hs-comment">--</span><span>
</span><a name="line-4165"></a><span class="hs-comment">-- zs = zip xs ys</span><span>
</span><a name="line-4166"></a><span class="hs-comment">--</span><span>
</span><a name="line-4167"></a><span class="hs-comment">-- We want to get reasonably fast indexing into zs immediately, rather than</span><span>
</span><a name="line-4168"></a><span class="hs-comment">-- needing to construct the entire thing first, as the previous implementation</span><span>
</span><a name="line-4169"></a><span class="hs-comment">-- required. The first aspect is that we build the result &quot;outside-in&quot; or</span><span>
</span><a name="line-4170"></a><span class="hs-comment">-- &quot;top-down&quot;, rather than left to right. That gives us access to both ends</span><span>
</span><a name="line-4171"></a><span class="hs-comment">-- quickly. But that's not enough, by itself, to give immediate access to the</span><span>
</span><a name="line-4172"></a><span class="hs-comment">-- center of zs. For that, we need to be able to skip over larger segments of</span><span>
</span><a name="line-4173"></a><span class="hs-comment">-- zs, delaying their construction until we actually need them. The way we do</span><span>
</span><a name="line-4174"></a><span class="hs-comment">-- this is to traverse xs, while splitting up ys according to the structure of</span><span>
</span><a name="line-4175"></a><span class="hs-comment">-- xs. If we have a Deep _ pr m sf, we split ys into three pieces, and hand off</span><span>
</span><a name="line-4176"></a><span class="hs-comment">-- one piece to the prefix, one to the middle, and one to the suffix of the</span><span>
</span><a name="line-4177"></a><span class="hs-comment">-- result. The key point is that we don't need to actually do anything further</span><span>
</span><a name="line-4178"></a><span class="hs-comment">-- with those pieces until we actually need them; the computations to split</span><span>
</span><a name="line-4179"></a><span class="hs-comment">-- them up further and zip them with their matching pieces can be delayed until</span><span>
</span><a name="line-4180"></a><span class="hs-comment">-- they're actually needed. We do the same thing for Digits (splitting into</span><span>
</span><a name="line-4181"></a><span class="hs-comment">-- between one and four pieces) and Nodes (splitting into two or three). The</span><span>
</span><a name="line-4182"></a><span class="hs-comment">-- ultimate result is that we can index into, or split at, any location in zs</span><span>
</span><a name="line-4183"></a><span class="hs-comment">-- in polylogarithmic time *immediately*, while still being able to force all</span><span>
</span><a name="line-4184"></a><span class="hs-comment">-- the thunks in O(n) time.</span><span>
</span><a name="line-4185"></a><span class="hs-comment">--</span><span>
</span><a name="line-4186"></a><span class="hs-comment">-- Benchmark info, and alternatives:</span><span>
</span><a name="line-4187"></a><span class="hs-comment">--</span><span>
</span><a name="line-4188"></a><span class="hs-comment">-- The old zipping code used mapAccumL to traverse the first sequence while</span><span>
</span><a name="line-4189"></a><span class="hs-comment">-- cutting down the second sequence one piece at a time.</span><span>
</span><a name="line-4190"></a><span class="hs-comment">--</span><span>
</span><a name="line-4191"></a><span class="hs-comment">-- An alternative way to express that basic idea is to convert both sequences</span><span>
</span><a name="line-4192"></a><span class="hs-comment">-- to lists, zip the lists, and then convert the result back to a sequence.</span><span>
</span><a name="line-4193"></a><span class="hs-comment">-- I'll call this the &quot;listy&quot; implementation.</span><span>
</span><a name="line-4194"></a><span class="hs-comment">--</span><span>
</span><a name="line-4195"></a><span class="hs-comment">-- I benchmarked two operations: Each started by zipping two sequences</span><span>
</span><a name="line-4196"></a><span class="hs-comment">-- constructed with replicate and/or fromList. The first would then immediately</span><span>
</span><a name="line-4197"></a><span class="hs-comment">-- index into the result. The second would apply deepseq to force the entire</span><span>
</span><a name="line-4198"></a><span class="hs-comment">-- result.  The new implementation worked much better than either of the others</span><span>
</span><a name="line-4199"></a><span class="hs-comment">-- on the immediate indexing test, as expected. It also worked better than the</span><span>
</span><a name="line-4200"></a><span class="hs-comment">-- old implementation for all the deepseq tests. For short sequences, the listy</span><span>
</span><a name="line-4201"></a><span class="hs-comment">-- implementation outperformed all the others on the deepseq test. However, the</span><span>
</span><a name="line-4202"></a><span class="hs-comment">-- splitting implementation caught up and surpassed it once the sequences grew</span><span>
</span><a name="line-4203"></a><span class="hs-comment">-- long enough. It seems likely that by avoiding rebuilding, it interacts</span><span>
</span><a name="line-4204"></a><span class="hs-comment">-- better with the cache hierarchy.</span><span>
</span><a name="line-4205"></a><span class="hs-comment">--</span><span>
</span><a name="line-4206"></a><span class="hs-comment">-- David Feuer, with some guidance from Carter Schonwald, December 2014</span><span>
</span><a name="line-4207"></a><span>
</span><a name="line-4208"></a><span class="hs-comment">-- | \( O(n) \). Constructs a new sequence with the same structure as an existing</span><span>
</span><a name="line-4209"></a><span class="hs-comment">-- sequence using a user-supplied mapping function along with a splittable</span><span>
</span><a name="line-4210"></a><span class="hs-comment">-- value and a way to split it. The value is split up lazily according to the</span><span>
</span><a name="line-4211"></a><span class="hs-comment">-- structure of the sequence, so one piece of the value is distributed to each</span><span>
</span><a name="line-4212"></a><span class="hs-comment">-- element of the sequence. The caller should provide a splitter function that</span><span>
</span><a name="line-4213"></a><span class="hs-comment">-- takes a number, @n@, and a splittable value, breaks off a chunk of size @n@</span><span>
</span><a name="line-4214"></a><span class="hs-comment">-- from the value, and returns that chunk and the remainder as a pair. The</span><span>
</span><a name="line-4215"></a><span class="hs-comment">-- following examples will hopefully make the usage clear:</span><span>
</span><a name="line-4216"></a><span class="hs-comment">--</span><span>
</span><a name="line-4217"></a><span class="hs-comment">-- &gt; zipWith :: (a -&gt; b -&gt; c) -&gt; Seq a -&gt; Seq b -&gt; Seq c</span><span>
</span><a name="line-4218"></a><span class="hs-comment">-- &gt; zipWith f s1 s2 = splitMap splitAt (\b a -&gt; f a (b `index` 0)) s2' s1'</span><span>
</span><a name="line-4219"></a><span class="hs-comment">-- &gt;   where</span><span>
</span><a name="line-4220"></a><span class="hs-comment">-- &gt;     minLen = min (length s1) (length s2)</span><span>
</span><a name="line-4221"></a><span class="hs-comment">-- &gt;     s1' = take minLen s1</span><span>
</span><a name="line-4222"></a><span class="hs-comment">-- &gt;     s2' = take minLen s2</span><span>
</span><a name="line-4223"></a><span class="hs-comment">--</span><span>
</span><a name="line-4224"></a><span class="hs-comment">-- &gt; mapWithIndex :: (Int -&gt; a -&gt; b) -&gt; Seq a -&gt; Seq b</span><span>
</span><a name="line-4225"></a><span class="hs-comment">-- &gt; mapWithIndex f = splitMap (\n i -&gt; (i, n+i)) f 0</span><span>
</span><a name="line-4226"></a><span class="hs-cpp">#ifdef __GLASGOW_HASKELL__
</span><span class="hs-comment">-- We use ScopedTypeVariables to improve performance and make</span><span>
</span><a name="line-4228"></a><span class="hs-comment">-- performance less sensitive to minor changes.</span><span>
</span><a name="line-4229"></a><span>
</span><a name="line-4230"></a><span class="hs-comment">-- We INLINE this so GHC can see that the function passed in is</span><span>
</span><a name="line-4231"></a><span class="hs-comment">-- strict in its Int argument.</span><span>
</span><a name="line-4232"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">splitMap</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-4233"></a><span class="hs-identifier">splitMap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">a'</span><span> </span><span class="hs-identifier">b'</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span class="hs-special">,</span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b'</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">b'</span><span>
</span><a name="line-4234"></a><span class="hs-identifier">splitMap</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-identifier">f0</span><span> </span><span class="hs-identifier">s0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">xs0</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">splitMapTreeE</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">s'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Elem</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f0</span><span> </span><span class="hs-identifier">s'</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">s0</span><span> </span><span class="hs-identifier">xs0</span><span>
</span><a name="line-4235"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-4236"></a><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">splitMapTreeE</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-4237"></a><span>    </span><span class="hs-identifier">splitMapTreeE</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Elem</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679062953"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-4238"></a><span>    </span><span class="hs-identifier">splitMapTreeE</span><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-4239"></a><span>    </span><span class="hs-identifier">splitMapTreeE</span><span>  </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Single</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-4240"></a><span>    </span><span class="hs-identifier">splitMapTreeE</span><span>  </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">splitMapDigit</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">prs</span><span> </span><span class="hs-identifier">pr</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">splitMapTreeN</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">eta1</span><span> </span><span class="hs-identifier">eta2</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">splitMapNode</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">eta1</span><span> </span><span class="hs-identifier">eta2</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">ms</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">splitMapDigit</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">sfs</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span>
</span><a name="line-4241"></a><span>          </span><span class="hs-keyword">where</span><span>
</span><a name="line-4242"></a><span>            </span><span class="hs-glyph">!</span><span class="hs-identifier">spr</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">pr</span></a><span>
</span><a name="line-4243"></a><span>            </span><span class="hs-glyph">!</span><span class="hs-identifier">sm</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">spr</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-4244"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier">prs</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">r</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-identifier">spr</span><span> </span><span class="hs-identifier">s</span><span>
</span><a name="line-4245"></a><span>            </span><span class="hs-special">(</span><a name="local-6989586621679062974"><a href="#local-6989586621679062974"><span class="hs-identifier">ms</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">sfs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-identifier">sm</span><span> </span><span class="hs-identifier">r</span><span>
</span><a name="line-4246"></a><span>
</span><a name="line-4247"></a><span>    </span><span class="hs-identifier">splitMapTreeN</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><a href="#local-6989586621679062969"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-4248"></a><span>    </span><span class="hs-identifier">splitMapTreeN</span><span> </span><a name="local-6989586621679062979"><a href="#local-6989586621679062979"><span class="hs-identifier">_</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-4249"></a><span>    </span><span class="hs-identifier">splitMapTreeN</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Single</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-4250"></a><span>    </span><span class="hs-identifier">splitMapTreeN</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">splitMapDigit</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-identifier">prs</span><span> </span><span class="hs-identifier">pr</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">splitMapTreeN</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">eta1</span><span> </span><span class="hs-identifier">eta2</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">splitMapNode</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">eta1</span><span> </span><span class="hs-identifier">eta2</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">ms</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">splitMapDigit</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">sfs</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span>
</span><a name="line-4251"></a><span>          </span><span class="hs-keyword">where</span><span>
</span><a name="line-4252"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier">prs</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679062982"><a href="#local-6989586621679062982"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">splt</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">pr</span><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-4253"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier">ms</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sfs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">size</span><span> </span><a name="local-6989586621679062990"><a href="#local-6989586621679062990"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">r</span><span>
</span><a name="line-4254"></a><span>
</span><a name="line-4255"></a><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">splitMapDigit</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-4256"></a><span>    </span><span class="hs-identifier">splitMapDigit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Sized</span><span> </span><a href="#local-6989586621679062949"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679062992"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-4257"></a><span>    </span><span class="hs-identifier">splitMapDigit</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">One</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-4258"></a><span>    </span><span class="hs-identifier">splitMapDigit</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Two</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">first</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">second</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-4259"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-4260"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679062955"><a href="#local-6989586621679062955"><span class="hs-identifier">first</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">second</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">size</span><span> </span><a href="#local-6989586621679062997"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">s</span><span>
</span><a name="line-4261"></a><span>    </span><span class="hs-identifier">splitMapDigit</span><span> </span><a name="local-6989586621679063000"><a href="#local-6989586621679063000"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679063001"><a href="#local-6989586621679063001"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><a name="local-6989586621679063003"><a href="#local-6989586621679063003"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Three</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679063004"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-identifier">first</span><span> </span><a href="#local-6989586621679063005"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679063005"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-identifier">second</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">third</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-4262"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-4263"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679063004"><a href="#local-6989586621679063004"><span class="hs-identifier">first</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679063005"><a href="#local-6989586621679063005"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">size</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-4264"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">second</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">third</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-4265"></a><span>    </span><span class="hs-identifier">splitMapDigit</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Four</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">first</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">second</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">third</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">fourth</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span>
</span><a name="line-4266"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-4267"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679063013"><a href="#local-6989586621679063013"><span class="hs-identifier">first</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">s'</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">size</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">s</span><span>
</span><a name="line-4268"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">middle</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fourth</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-identifier">size</span><span> </span><a href="#local-6989586621679063021"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679063021"><span class="hs-identifier hs-var">s'</span></a><span>
</span><a name="line-4269"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">second</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">third</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">middle</span><span>
</span><a name="line-4270"></a><span>
</span><a name="line-4271"></a><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">splitMapNode</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-4272"></a><span>    </span><span class="hs-identifier">splitMapNode</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Sized</span><span> </span><a href="#local-6989586621679062949"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063018"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679063023"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-4273"></a><span>    </span><span class="hs-identifier">splitMapNode</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node2</span><span> </span><span class="hs-identifier">ns</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Node2</span><span> </span><span class="hs-identifier">ns</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">first</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">second</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-4274"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-4275"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">first</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">second</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">size</span><span> </span><a href="#local-6989586621679062963"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">s</span><span>
</span><a name="line-4276"></a><span>    </span><a name="local-6989586621679062956"><a href="#local-6989586621679062956"><span class="hs-identifier">splitMapNode</span></a></a><span> </span><a name="local-6989586621679063027"><a href="#local-6989586621679063027"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679063028"><a href="#local-6989586621679063028"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a name="local-6989586621679063029"><a href="#local-6989586621679063029"><span class="hs-identifier">ns</span></a></a><span> </span><a name="local-6989586621679063030"><a href="#local-6989586621679063030"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679063031"><a href="#local-6989586621679063031"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">ns</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679063032"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-identifier">first</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679063033"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-identifier">second</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">third</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-4277"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-4278"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679063032"><a href="#local-6989586621679063032"><span class="hs-identifier">first</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679063033"><a href="#local-6989586621679063033"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">size</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#size"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-4279"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">second</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">third</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-4280"></a><span>
</span><a name="line-4281"></a><span class="hs-cpp">#else
</span><span class="hs-comment">-- Implementation without ScopedTypeVariables--somewhat slower,</span><span>
</span><a name="line-4283"></a><span class="hs-comment">-- and much more sensitive to minor changes in various places.</span><span>
</span><a name="line-4284"></a><span>
</span><a name="line-4285"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">splitMap</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-4286"></a><span class="hs-identifier">splitMap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span class="hs-special">,</span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-4287"></a><span class="hs-identifier">splitMap</span><span> </span><span class="hs-identifier">splt'</span><span> </span><span class="hs-identifier">f0</span><span> </span><span class="hs-identifier">s0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">xs0</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">splitMapTreeE</span><span> </span><span class="hs-identifier">splt'</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">s'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Elem</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f0</span><span> </span><span class="hs-identifier">s'</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">s0</span><span> </span><span class="hs-identifier">xs0</span><span>
</span><a name="line-4288"></a><span>
</span><a name="line-4289"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">splitMapTreeE</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-4290"></a><span class="hs-identifier">splitMapTreeE</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span class="hs-special">,</span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">y</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-4291"></a><span class="hs-identifier">splitMapTreeE</span><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-4292"></a><span class="hs-identifier">splitMapTreeE</span><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Single</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-4293"></a><span class="hs-identifier">splitMapTreeE</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">splitMapDigit</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">prs</span><span> </span><span class="hs-identifier">pr</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">splitMapTreeN</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">eta1</span><span> </span><span class="hs-identifier">eta2</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">splitMapNode</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">eta1</span><span> </span><span class="hs-identifier">eta2</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">ms</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">splitMapDigit</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">sfs</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span>
</span><a name="line-4294"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-4295"></a><span>        </span><span class="hs-glyph">!</span><span class="hs-identifier">spr</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">pr</span><span>
</span><a name="line-4296"></a><span>        </span><span class="hs-identifier">sm</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">spr</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">sf</span><span>
</span><a name="line-4297"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">prs</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">r</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-identifier">spr</span><span> </span><span class="hs-identifier">s</span><span>
</span><a name="line-4298"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">ms</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sfs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-identifier">sm</span><span> </span><span class="hs-identifier">r</span><span>
</span><a name="line-4299"></a><span>
</span><a name="line-4300"></a><span class="hs-identifier">splitMapTreeN</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span class="hs-special">,</span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-4301"></a><span class="hs-identifier">splitMapTreeN</span><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EmptyT</span><span>
</span><a name="line-4302"></a><span class="hs-identifier">splitMapTreeN</span><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Single</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">xs</span><span>
</span><a name="line-4303"></a><span class="hs-identifier">splitMapTreeN</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">pr</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">splitMapDigit</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">prs</span><span> </span><span class="hs-identifier">pr</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">splitMapTreeN</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">eta1</span><span> </span><span class="hs-identifier">eta2</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">splitMapNode</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">eta1</span><span> </span><span class="hs-identifier">eta2</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">ms</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">splitMapDigit</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">sfs</span><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span>
</span><a name="line-4304"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-4305"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">prs</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">r</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">pr</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">s</span><span>
</span><a name="line-4306"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">ms</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sfs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">r</span><span>
</span><a name="line-4307"></a><span>
</span><a name="line-4308"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">splitMapDigit</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-4309"></a><span class="hs-identifier">splitMapDigit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Sized</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span class="hs-special">,</span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-4310"></a><span class="hs-identifier">splitMapDigit</span><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">One</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-4311"></a><span class="hs-identifier">splitMapDigit</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Two</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">first</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">second</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-4312"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-4313"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">first</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">second</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">s</span><span>
</span><a name="line-4314"></a><span class="hs-identifier">splitMapDigit</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Three</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">first</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">second</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">third</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-4315"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-4316"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">first</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">r</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">s</span><span>
</span><a name="line-4317"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">second</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">third</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">r</span><span>
</span><a name="line-4318"></a><span class="hs-identifier">splitMapDigit</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Four</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">first</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">second</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">third</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">fourth</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span>
</span><a name="line-4319"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-4320"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">first</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">s'</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">s</span><span>
</span><a name="line-4321"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">middle</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fourth</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">s'</span><span>
</span><a name="line-4322"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">second</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">third</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">middle</span><span>
</span><a name="line-4323"></a><span>
</span><a name="line-4324"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">splitMapNode</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-4325"></a><span class="hs-identifier">splitMapNode</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Sized</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span class="hs-special">,</span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-4326"></a><span class="hs-identifier">splitMapNode</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node2</span><span> </span><span class="hs-identifier">ns</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Node2</span><span> </span><span class="hs-identifier">ns</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">first</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">second</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-4327"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-4328"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">first</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">second</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">s</span><span>
</span><a name="line-4329"></a><span class="hs-identifier">splitMapNode</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">ns</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">ns</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">first</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">second</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">third</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-4330"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-4331"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">first</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">r</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">s</span><span>
</span><a name="line-4332"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">second</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">third</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">size</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">r</span><span>
</span><a name="line-4333"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-4335"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-4336"></a><span class="hs-comment">-- Zipping</span><span>
</span><a name="line-4337"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-4338"></a><span>
</span><a name="line-4339"></a><span class="hs-comment">-- We use a custom definition of munzip to avoid retaining</span><span>
</span><a name="line-4340"></a><span class="hs-comment">-- memory longer than necessary. Using the default definition, if</span><span>
</span><a name="line-4341"></a><span class="hs-comment">-- we write</span><span>
</span><a name="line-4342"></a><span class="hs-comment">--</span><span>
</span><a name="line-4343"></a><span class="hs-comment">-- let (xs,ys) = munzip zs</span><span>
</span><a name="line-4344"></a><span class="hs-comment">-- in xs `deepseq` (... ys ...)</span><span>
</span><a name="line-4345"></a><span class="hs-comment">--</span><span>
</span><a name="line-4346"></a><span class="hs-comment">-- then ys will retain the entire zs sequence until ys itself is fully forced.</span><span>
</span><a name="line-4347"></a><span class="hs-comment">-- This implementation uses the selector thunk optimization to prevent that.</span><span>
</span><a name="line-4348"></a><span class="hs-comment">-- Unfortunately, that optimization is fragile, so we can't actually guarantee</span><span>
</span><a name="line-4349"></a><span class="hs-comment">-- anything.</span><span>
</span><a name="line-4350"></a><span>
</span><a name="line-4351"></a><span class="hs-comment">-- | @ 'mzipWith' = 'zipWith' @</span><span>
</span><a name="line-4352"></a><span class="hs-comment">--</span><span>
</span><a name="line-4353"></a><span class="hs-comment">-- @ 'munzip' = 'unzip' @</span><span>
</span><a name="line-4354"></a><span class="hs-keyword">instance</span><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/Control.Monad.Zip.html#MonadZip"><span class="hs-identifier hs-type">MonadZip</span></a><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-4355"></a><span>  </span><a name="local-8214565720323787054"><a href="../base/src/%{MODULE}.html#%{NAME}/Control.Monad.Zip.html#mzipWith"><span class="hs-identifier">mzipWith</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#zipWith"><span class="hs-identifier hs-var">zipWith</span></a><span>
</span><a name="line-4356"></a><span>  </span><a name="local-8214565720323787053"><a href="../base/src/%{MODULE}.html#%{NAME}/Control.Monad.Zip.html#munzip"><span class="hs-identifier">munzip</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#unzip"><span class="hs-identifier hs-var">unzip</span></a><span>
</span><a name="line-4357"></a><span>
</span><a name="line-4358"></a><span class="hs-comment">-- | Unzip a sequence of pairs.</span><span>
</span><a name="line-4359"></a><span class="hs-comment">--</span><span>
</span><a name="line-4360"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-4361"></a><span class="hs-comment">-- unzip ps = ps ``seq`` ('fmap' 'fst' ps) ('fmap' 'snd' ps)</span><span>
</span><a name="line-4362"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-4363"></a><span class="hs-comment">--</span><span>
</span><a name="line-4364"></a><span class="hs-comment">-- Example:</span><span>
</span><a name="line-4365"></a><span class="hs-comment">--</span><span>
</span><a name="line-4366"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-4367"></a><span class="hs-comment">-- unzip $ fromList [(1,&quot;a&quot;), (2,&quot;b&quot;), (3,&quot;c&quot;)] =</span><span>
</span><a name="line-4368"></a><span class="hs-comment">--   (fromList [1,2,3], fromList [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;])</span><span>
</span><a name="line-4369"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-4370"></a><span class="hs-comment">--</span><span>
</span><a name="line-4371"></a><span class="hs-comment">-- See the note about efficiency at 'unzipWith'.</span><span>
</span><a name="line-4372"></a><span class="hs-comment">--</span><span>
</span><a name="line-4373"></a><span class="hs-comment">-- @since 0.5.11</span><span>
</span><a name="line-4374"></a><span class="hs-identifier">unzip</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679058829"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679058830"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679058829"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679058830"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-4375"></a><a name="unzip"><a href="Data.Sequence.Internal.html#unzip"><span class="hs-identifier">unzip</span></a></a><span> </span><a name="local-6989586621679063046"><a href="#local-6989586621679063046"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#unzipWith"><span class="hs-identifier hs-var">unzipWith</span></a><span> </span><a href="../base/src/%{MODULE}.html#%{NAME}/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621679063046"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-4376"></a><span>
</span><a name="line-4377"></a><span class="hs-comment">-- | \( O(n) \). Unzip a sequence using a function to divide elements.</span><span>
</span><a name="line-4378"></a><span class="hs-comment">--</span><span>
</span><a name="line-4379"></a><span class="hs-comment">-- @ unzipWith f xs == 'unzip' ('fmap' f xs) @</span><span>
</span><a name="line-4380"></a><span class="hs-comment">--</span><span>
</span><a name="line-4381"></a><span class="hs-comment">-- Efficiency note:</span><span>
</span><a name="line-4382"></a><span class="hs-comment">--</span><span>
</span><a name="line-4383"></a><span class="hs-comment">-- @unzipWith@ produces its two results in lockstep. If you calculate</span><span>
</span><a name="line-4384"></a><span class="hs-comment">-- @ unzipWith f xs @ and fully force /either/ of the results, then the</span><span>
</span><a name="line-4385"></a><span class="hs-comment">-- entire structure of the /other/ one will be built as well. This</span><span>
</span><a name="line-4386"></a><span class="hs-comment">-- behavior allows the garbage collector to collect each calculated</span><span>
</span><a name="line-4387"></a><span class="hs-comment">-- pair component as soon as it dies, without having to wait for its mate</span><span>
</span><a name="line-4388"></a><span class="hs-comment">-- to die. If you do not need this behavior, you may be better off simply</span><span>
</span><a name="line-4389"></a><span class="hs-comment">-- calculating the sequence of pairs and using 'fmap' to extract each</span><span>
</span><a name="line-4390"></a><span class="hs-comment">-- component sequence.</span><span>
</span><a name="line-4391"></a><span class="hs-comment">--</span><span>
</span><a name="line-4392"></a><span class="hs-comment">-- @since 0.5.11</span><span>
</span><a name="line-4393"></a><span class="hs-identifier">unzipWith</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679058826"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679058827"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679058828"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679058826"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679058827"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-6989586621679058828"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-4394"></a><a name="unzipWith"><a href="Data.Sequence.Internal.html#unzipWith"><span class="hs-identifier">unzipWith</span></a></a><span> </span><a name="local-6989586621679063047"><a href="#local-6989586621679063047"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#unzipWith%27"><span class="hs-identifier hs-var">unzipWith'</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679063048"><a href="#local-6989586621679063048"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-4395"></a><span>  </span><span class="hs-keyword">let</span><span>
</span><a name="line-4396"></a><span>    </span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">fx</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-4397"></a><span>    </span><a name="local-6989586621679063049"><a href="#local-6989586621679063049"><span class="hs-identifier">fx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679063047"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679063048"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-4398"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679063050"><a href="#local-6989586621679063050"><span class="hs-identifier">y</span></a></a><span class="hs-special">,</span><a name="local-6989586621679063051"><a href="#local-6989586621679063051"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679063049"><span class="hs-identifier hs-var">fx</span></a><span>
</span><a name="line-4399"></a><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679063050"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><a href="#local-6989586621679063051"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4400"></a><span class="hs-comment">-- Why do we lazify `f`? Because we don't want the strictness to depend</span><span>
</span><a name="line-4401"></a><span class="hs-comment">-- on exactly how the sequence is balanced. For example, what do we want</span><span>
</span><a name="line-4402"></a><span class="hs-comment">-- from</span><span>
</span><a name="line-4403"></a><span class="hs-comment">--</span><span>
</span><a name="line-4404"></a><span class="hs-comment">-- unzip [(1,2), undefined, (5,6)]?</span><span>
</span><a name="line-4405"></a><span class="hs-comment">--</span><span>
</span><a name="line-4406"></a><span class="hs-comment">-- The argument could be represented as</span><span>
</span><a name="line-4407"></a><span class="hs-comment">--</span><span>
</span><a name="line-4408"></a><span class="hs-comment">-- Seq $ Deep 3 (One (Elem (1,2))) EmptyT (Two undefined (Elem (5,6)))</span><span>
</span><a name="line-4409"></a><span class="hs-comment">--</span><span>
</span><a name="line-4410"></a><span class="hs-comment">-- or as</span><span>
</span><a name="line-4411"></a><span class="hs-comment">--</span><span>
</span><a name="line-4412"></a><span class="hs-comment">-- Seq $ Deep 3 (Two (Elem (1,2)) undefined) EmptyT (One (Elem (5,6)))</span><span>
</span><a name="line-4413"></a><span class="hs-comment">--</span><span>
</span><a name="line-4414"></a><span class="hs-comment">-- We don't want the tree balance to determine whether we get</span><span>
</span><a name="line-4415"></a><span class="hs-comment">--</span><span>
</span><a name="line-4416"></a><span class="hs-comment">-- ([1, undefined, undefined], [2, undefined, undefined])</span><span>
</span><a name="line-4417"></a><span class="hs-comment">--</span><span>
</span><a name="line-4418"></a><span class="hs-comment">-- or</span><span>
</span><a name="line-4419"></a><span class="hs-comment">--</span><span>
</span><a name="line-4420"></a><span class="hs-comment">-- ([undefined, undefined, 5], [undefined, undefined, 6])</span><span>
</span><a name="line-4421"></a><span class="hs-comment">--</span><span>
</span><a name="line-4422"></a><span class="hs-comment">-- so we pretty much have to be completely lazy in the elements.</span><span>
</span><a name="line-4423"></a><span>
</span><a name="line-4424"></a><span class="hs-cpp">#ifdef __GLASGOW_HASKELL__
</span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">unzipWith</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-4426"></a><span>
</span><a name="line-4427"></a><span class="hs-comment">-- We don't need a special rule for unzip:</span><span>
</span><a name="line-4428"></a><span class="hs-comment">--</span><span>
</span><a name="line-4429"></a><span class="hs-comment">-- unzip (fmap f xs) = unzipWith id f xs,</span><span>
</span><a name="line-4430"></a><span class="hs-comment">--</span><span>
</span><a name="line-4431"></a><span class="hs-comment">-- which rewrites to unzipWith (id . f) xs</span><span>
</span><a name="line-4432"></a><span class="hs-comment">--</span><span>
</span><a name="line-4433"></a><span class="hs-comment">-- It's true that if GHC doesn't know the arity of `f` then</span><span>
</span><a name="line-4434"></a><span class="hs-comment">-- it won't reduce further, but that doesn't seem like too</span><span>
</span><a name="line-4435"></a><span class="hs-comment">-- big a deal here.</span><span>
</span><a name="line-4436"></a><span class="hs-pragma">{-# RULES</span><span>
</span><a name="line-4437"></a><span class="hs-pragma">&quot;unzipWith/fmapSeq&quot;</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">xs</span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">unzipWith</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">fmapSeq</span><span> </span><span class="hs-pragma">g</span><span> </span><span class="hs-pragma">xs</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span>
</span><a name="line-4438"></a><span>                                     </span><span class="hs-pragma">unzipWith</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">g</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">xs</span><span>
</span><a name="line-4439"></a><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-4440"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-4442"></a><span class="hs-keyword">class</span><span> </span><span class="hs-identifier">UnzipWith</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-4443"></a><span>  </span><span class="hs-identifier">unzipWith'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-4444"></a><span>
</span><a name="line-4445"></a><span class="hs-comment">-- This instance is only used at the very top of the tree;</span><span>
</span><a name="line-4446"></a><span class="hs-comment">-- the rest of the elements are handled by unzipWithNodeElem</span><span>
</span><a name="line-4447"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">UnzipWith</span><span> </span><span class="hs-identifier">Elem</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-4448"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 708
</span><span>  </span><span class="hs-identifier">unzipWith'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">coerce</span><span>
</span><a name="line-4450"></a><span class="hs-cpp">#else
</span><span>  </span><span class="hs-identifier">unzipWith'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span>
</span><a name="line-4452"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-4454"></a><span class="hs-comment">-- We're very lazy here for the sake of efficiency. We want to be able to</span><span>
</span><a name="line-4455"></a><span class="hs-comment">-- reach any element of either result in logarithmic time. If we pattern</span><span>
</span><a name="line-4456"></a><span class="hs-comment">-- match strictly, we'll end up building entire 2-3 trees at once, which</span><span>
</span><a name="line-4457"></a><span class="hs-comment">-- would take linear time.</span><span>
</span><a name="line-4458"></a><span class="hs-comment">--</span><span>
</span><a name="line-4459"></a><span class="hs-comment">-- However, we're not *entirely* lazy! We are careful to build pieces</span><span>
</span><a name="line-4460"></a><span class="hs-comment">-- of each sequence as the corresponding pieces of the *other* sequence</span><span>
</span><a name="line-4461"></a><span class="hs-comment">-- are demanded. This allows the garbage collector to get rid of each</span><span>
</span><a name="line-4462"></a><span class="hs-comment">-- *component* of each result pair as soon as it is dead.</span><span>
</span><a name="line-4463"></a><span class="hs-comment">--</span><span>
</span><a name="line-4464"></a><span class="hs-comment">-- Note that this instance is used only for *internal* nodes. Nodes</span><span>
</span><a name="line-4465"></a><span class="hs-comment">-- containing elements are handled by 'unzipWithNodeElem'</span><span>
</span><a name="line-4466"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">UnzipWith</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-4467"></a><span>  </span><span class="hs-identifier">unzipWith'</span><span> </span><a href="Data.Sequence.Internal.html#UnzipWith"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node2</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-4468"></a><span>    </span><span class="hs-special">(</span><span> </span><a name="local-8214565720323832667"><a href="Data.Sequence.Internal.html#unzipWith%27"><span class="hs-identifier">Node2</span></a></a><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">x1</span><span> </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">y1</span></a><span>
</span><a name="line-4469"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a href="#local-6989586621679058129"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679058134"><span class="hs-identifier hs-var">x2</span></a><span> </span><a href="#local-6989586621679058136"><span class="hs-identifier hs-var">y2</span></a><span class="hs-special">)</span><span>
</span><a name="line-4470"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-4471"></a><span>      </span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">fx</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-4472"></a><span>      </span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">fy</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-4473"></a><span>      </span><span class="hs-identifier">fx</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">strictifyPair</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><a name="line-4474"></a><span>      </span><a name="local-6989586621679058132"><a href="#local-6989586621679058132"><span class="hs-identifier">fy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#strictifyPair"><span class="hs-identifier hs-var">strictifyPair</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679058128"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058130"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-4475"></a><span>      </span><span class="hs-special">(</span><span class="hs-identifier">x1</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#strictifyPair"><span class="hs-identifier hs-var">x2</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#strictifyPair"><span class="hs-identifier hs-var">fx</span></a><span>
</span><a name="line-4476"></a><span>      </span><span class="hs-special">(</span><a name="local-6989586621679058134"><a href="#local-6989586621679058134"><span class="hs-identifier">y1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679058135"><a href="#local-6989586621679058135"><span class="hs-identifier">y2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679058132"><span class="hs-identifier hs-var">fy</span></a><span>
</span><a name="line-4477"></a><span>  </span><span class="hs-identifier">unzipWith'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y</span><span> </span><span class="hs-identifier">z</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-4478"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">x1</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">y1</span></a><span> </span><span class="hs-identifier">z1</span><span>
</span><a name="line-4479"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a href="#local-6989586621679058139"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679058146"><span class="hs-identifier hs-var">x2</span></a><span> </span><a href="#local-6989586621679058148"><span class="hs-identifier hs-var">y2</span></a><span> </span><a href="#local-6989586621679058150"><span class="hs-identifier hs-var">z2</span></a><span class="hs-special">)</span><span>
</span><a name="line-4480"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-4481"></a><span>      </span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">fx</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-4482"></a><span>      </span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">fy</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-4483"></a><span>      </span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">fz</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-4484"></a><span>      </span><span class="hs-identifier">fx</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">strictifyPair</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><a name="line-4485"></a><span>      </span><a name="local-6989586621679058143"><a href="#local-6989586621679058143"><span class="hs-identifier">fy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#strictifyPair"><span class="hs-identifier hs-var">strictifyPair</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679058138"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058140"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-4486"></a><span>      </span><a name="local-6989586621679058144"><a href="#local-6989586621679058144"><span class="hs-identifier">fz</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#strictifyPair"><span class="hs-identifier hs-var">strictifyPair</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679058138"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058141"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-4487"></a><span>      </span><span class="hs-special">(</span><span class="hs-identifier">x1</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#strictifyPair"><span class="hs-identifier hs-var">x2</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#strictifyPair"><span class="hs-identifier hs-var">fx</span></a><span>
</span><a name="line-4488"></a><span>      </span><span class="hs-special">(</span><a name="local-6989586621679058146"><a href="#local-6989586621679058146"><span class="hs-identifier">y1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679058147"><a href="#local-6989586621679058147"><span class="hs-identifier">y2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679058143"><span class="hs-identifier hs-var">fy</span></a><span>
</span><a name="line-4489"></a><span>      </span><span class="hs-special">(</span><a name="local-6989586621679058148"><a href="#local-6989586621679058148"><span class="hs-identifier">z1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679058149"><a href="#local-6989586621679058149"><span class="hs-identifier">z2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679058144"><span class="hs-identifier hs-var">fz</span></a><span>
</span><a name="line-4490"></a><span>
</span><a name="line-4491"></a><span class="hs-comment">-- Force both elements of a pair</span><span>
</span><a name="line-4492"></a><span class="hs-identifier">strictifyPair</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-4493"></a><span class="hs-identifier">strictifyPair</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-identifier">x</span><span class="hs-special">,</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span>
</span><a name="line-4494"></a><span>
</span><a name="line-4495"></a><span class="hs-comment">-- We're strict here for the sake of efficiency. The Node instance</span><span>
</span><a name="line-4496"></a><span class="hs-comment">-- is lazy, so we don't particularly need to add an extra thunk on top</span><span>
</span><a name="line-4497"></a><span class="hs-comment">-- of each node.</span><span>
</span><a name="line-4498"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">UnzipWith</span><span> </span><span class="hs-identifier">Digit</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-4499"></a><span>  </span><span class="hs-identifier">unzipWith'</span><span> </span><a href="Data.Sequence.Internal.html#UnzipWith"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><a href="Data.Sequence.Internal.html#Digit"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-4500"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-8214565720323832667"><a href="Data.Sequence.Internal.html#unzipWith%27"><span class="hs-identifier">x1</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">x2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.Sequence.Internal.html#One"><span class="hs-identifier hs-var">f</span></a><span> </span><a name="local-6989586621679058095"><a href="#local-6989586621679058095"><span class="hs-identifier">x</span></a></a><span>
</span><a name="line-4501"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">One</span><span> </span><a name="local-6989586621679058097"><a href="#local-6989586621679058097"><span class="hs-identifier">x1</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">One</span><span> </span><span class="hs-identifier">x2</span><span class="hs-special">)</span><span>
</span><a name="line-4502"></a><span>  </span><span class="hs-identifier">unzipWith'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Two</span><span> </span><a href="#local-6989586621679058097"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span>
</span><a name="line-4503"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">x2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">f</span></a><span> </span><a name="local-6989586621679058099"><a href="#local-6989586621679058099"><span class="hs-identifier">x</span></a></a><span>
</span><a name="line-4504"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679058101"><a href="#local-6989586621679058101"><span class="hs-identifier">y1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679058102"><a href="#local-6989586621679058102"><span class="hs-identifier">y2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679058098"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058099"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-4505"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier">Two</span><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-identifier">y1</span><span>
</span><a name="line-4506"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#Two"><span class="hs-identifier hs-var">Two</span></a><span> </span><a href="#local-6989586621679058101"><span class="hs-identifier hs-var">x2</span></a><span> </span><a href="#local-6989586621679058103"><span class="hs-identifier hs-var">y2</span></a><span class="hs-special">)</span><span>
</span><a name="line-4507"></a><span>  </span><span class="hs-identifier">unzipWith'</span><span> </span><a href="#local-6989586621679058102"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y</span><span> </span><span class="hs-identifier">z</span><span class="hs-special">)</span><span>
</span><a name="line-4508"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">x2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-4509"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679058109"><a href="#local-6989586621679058109"><span class="hs-identifier">y1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679058110"><a href="#local-6989586621679058110"><span class="hs-identifier">y2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679058105"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058106"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-4510"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679058111"><a href="#local-6989586621679058111"><span class="hs-identifier">z1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679058112"><a href="#local-6989586621679058112"><span class="hs-identifier">z2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679058105"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058107"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-4511"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier">Three</span><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-identifier">y1</span><span> </span><span class="hs-identifier">z1</span><span>
</span><a name="line-4512"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#Three"><span class="hs-identifier hs-var">Three</span></a><span> </span><a href="#local-6989586621679058109"><span class="hs-identifier hs-var">x2</span></a><span> </span><a href="#local-6989586621679058111"><span class="hs-identifier hs-var">y2</span></a><span> </span><a href="#local-6989586621679058113"><span class="hs-identifier hs-var">z2</span></a><span class="hs-special">)</span><span>
</span><a name="line-4513"></a><span>  </span><span class="hs-identifier">unzipWith'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Four</span><span> </span><a href="#local-6989586621679058114"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-identifier">y</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">w</span><span class="hs-special">)</span><span>
</span><a name="line-4514"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">x2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-identifier">x</span><span>
</span><a name="line-4515"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679058120"><a href="#local-6989586621679058120"><span class="hs-identifier">y1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679058121"><a href="#local-6989586621679058121"><span class="hs-identifier">y2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679058115"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058116"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-4516"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679058122"><a href="#local-6989586621679058122"><span class="hs-identifier">z1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679058123"><a href="#local-6989586621679058123"><span class="hs-identifier">z2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679058115"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058117"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-4517"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679058124"><a href="#local-6989586621679058124"><span class="hs-identifier">w1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679058125"><a href="#local-6989586621679058125"><span class="hs-identifier">w2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679058115"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058118"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-4518"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier">Four</span><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-identifier">y1</span><span> </span><span class="hs-identifier">z1</span><span> </span><span class="hs-identifier">w1</span><span>
</span><a name="line-4519"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#Four"><span class="hs-identifier hs-var">Four</span></a><span> </span><a href="#local-6989586621679058120"><span class="hs-identifier hs-var">x2</span></a><span> </span><a href="#local-6989586621679058122"><span class="hs-identifier hs-var">y2</span></a><span> </span><a href="#local-6989586621679058124"><span class="hs-identifier hs-var">z2</span></a><span> </span><a href="#local-6989586621679058126"><span class="hs-identifier hs-var">w2</span></a><span class="hs-special">)</span><span>
</span><a name="line-4520"></a><span>
</span><a name="line-4521"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">UnzipWith</span><span> </span><span class="hs-identifier">FingerTree</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-4522"></a><span>  </span><span class="hs-identifier">unzipWith'</span><span> </span><a href="Data.Sequence.Internal.html#UnzipWith"><span class="hs-identifier hs-type">_</span></a><span> </span><span class="hs-identifier">EmptyT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">EmptyT</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">EmptyT</span><span class="hs-special">)</span><span>
</span><a name="line-4523"></a><span>  </span><a name="local-8214565720323832667"><a href="Data.Sequence.Internal.html#unzipWith%27"><span class="hs-identifier">unzipWith'</span></a></a><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><a name="line-4524"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">x2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-4525"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">x1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Single</span><span> </span><span class="hs-identifier">x2</span><span class="hs-special">)</span><span>
</span><a name="line-4526"></a><span>  </span><span class="hs-identifier">unzipWith'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-identifier">pr</span><span> </span><a href="#local-6989586621679058081"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span>
</span><a name="line-4527"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-identifier">pr1</span><span class="hs-special">,</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">pr2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">unzipWith'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">pr</span><span>
</span><a name="line-4528"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><a name="local-6989586621679058090"><a href="#local-6989586621679058090"><span class="hs-identifier">sf1</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679058091"><a href="#local-6989586621679058091"><span class="hs-identifier">sf2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.Sequence.Internal.html#unzipWith%27"><span class="hs-identifier hs-var">unzipWith'</span></a><span> </span><a href="#local-6989586621679058082"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679058084"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-4529"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">s</span><span> </span><a name="local-6989586621679058093"><a href="#local-6989586621679058093"><span class="hs-identifier">pr1</span></a></a><span> </span><span class="hs-identifier">m1</span><span> </span><span class="hs-identifier">sf1</span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#unzipWith%27"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="Data.Sequence.Internal.html#unzipWith%27"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-identifier">pr2</span><span> </span><span class="hs-identifier">m2</span><span> </span><span class="hs-identifier">sf2</span><span class="hs-special">)</span><span>
</span><a name="line-4530"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-4531"></a><span>      </span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">m1m2</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-4532"></a><span>      </span><span class="hs-identifier">m1m2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">strictifyPair</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">unzipWith'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unzipWith'</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span>
</span><a name="line-4533"></a><span>      </span><span class="hs-special">(</span><a name="local-6989586621679058087"><a href="#local-6989586621679058087"><span class="hs-identifier">m1</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">m2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#strictifyPair"><span class="hs-identifier hs-var">m1m2</span></a><span>
</span><a name="line-4534"></a><span>
</span><a name="line-4535"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">UnzipWith</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-4536"></a><span>  </span><span class="hs-identifier">unzipWith'</span><span> </span><a href="Data.Sequence.Internal.html#UnzipWith"><span class="hs-identifier hs-type">_</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">EmptyT</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">empty</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">empty</span><span class="hs-special">)</span><span>
</span><a name="line-4537"></a><span>  </span><a name="local-8214565720323832667"><a href="Data.Sequence.Internal.html#unzipWith%27"><span class="hs-identifier">unzipWith'</span></a></a><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><a href="Data.Sequence.Internal.html#empty"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4538"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">x2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-identifier">x</span><span>
</span><a name="line-4539"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">singleton</span><span> </span><span class="hs-identifier">x1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">singleton</span><span> </span><span class="hs-identifier">x2</span><span class="hs-special">)</span><span>
</span><a name="line-4540"></a><span>  </span><span class="hs-identifier">unzipWith'</span><span> </span><a href="Data.Sequence.Internal.html#singleton"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#singleton"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="Data.Sequence.Internal.html#singleton"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="Data.Sequence.Internal.html#singleton"><span class="hs-identifier hs-var">pr</span></a><span> </span><a href="#local-6989586621679058065"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-identifier">sf</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4541"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-identifier">pr1</span><span class="hs-special">,</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">pr2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">unzipWith'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unzipWith'</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pr</span><span>
</span><a name="line-4542"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><a name="local-6989586621679058074"><a href="#local-6989586621679058074"><span class="hs-identifier">sf1</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679058075"><a href="#local-6989586621679058075"><span class="hs-identifier">sf2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.Sequence.Internal.html#unzipWith%27"><span class="hs-identifier hs-var">unzipWith'</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#unzipWith%27"><span class="hs-identifier hs-var">unzipWith'</span></a><span> </span><a href="#local-6989586621679058066"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679058068"><span class="hs-identifier hs-var">sf</span></a><span>
</span><a name="line-4543"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Deep</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">pr1</span><span> </span><a href="Data.Sequence.Internal.html#unzipWith%27"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="Data.Sequence.Internal.html#unzipWith%27"><span class="hs-identifier hs-var">sf1</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#unzipWith%27"><span class="hs-identifier hs-var">Deep</span></a><span> </span><a href="Data.Sequence.Internal.html#unzipWith%27"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-identifier">pr2</span><span> </span><a href="#local-6989586621679058070"><span class="hs-identifier hs-var">m2</span></a><span> </span><span class="hs-identifier">sf2</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4544"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-4545"></a><span>      </span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">m1m2</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-4546"></a><span>      </span><span class="hs-identifier">m1m2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">strictifyPair</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">unzipWith'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unzipWithNodeElem</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">m</span><span>
</span><a name="line-4547"></a><span>      </span><span class="hs-special">(</span><a name="local-6989586621679058071"><a href="#local-6989586621679058071"><span class="hs-identifier">m1</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">m2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#strictifyPair"><span class="hs-identifier hs-var">m1m2</span></a><span>
</span><a name="line-4548"></a><span>
</span><a name="line-4549"></a><span class="hs-comment">-- Here we need to be lazy in the children (because they're</span><span>
</span><a name="line-4550"></a><span class="hs-comment">-- Elems), but we can afford to be strict in the results</span><span>
</span><a name="line-4551"></a><span class="hs-comment">-- of `f` because it's sure to return a pair immediately</span><span>
</span><a name="line-4552"></a><span class="hs-comment">-- (unzipWith lazifies the function it's passed).</span><span>
</span><a name="line-4553"></a><span class="hs-identifier">unzipWithNodeElem</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4554"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Node</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4555"></a><span class="hs-identifier">unzipWithNodeElem</span><span> </span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node2</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><a href="Data.Sequence.Internal.html#Node"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4556"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="unzipWithNodeElem"><a href="Data.Sequence.Internal.html#unzipWithNodeElem"><span class="hs-identifier">x1</span></a></a><span class="hs-special">,</span><span> </span><a name="unzipWithNodeElem"><a href="Data.Sequence.Internal.html#unzipWithNodeElem"><span class="hs-identifier">x2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a name="unzipWithNodeElem"><a href="Data.Sequence.Internal.html#unzipWithNodeElem"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679063054"><a href="#local-6989586621679063054"><span class="hs-identifier">x</span></a></a><span>
</span><a name="line-4557"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679063058"><a href="#local-6989586621679063058"><span class="hs-identifier">y1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679063059"><a href="#local-6989586621679063059"><span class="hs-identifier">y2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679063054"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679063056"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-4558"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier">Node2</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">x1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">y1</span><span class="hs-special">)</span><span>
</span><a name="line-4559"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#Node2"><span class="hs-identifier hs-var">Node2</span></a><span> </span><a href="#local-6989586621679063055"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-var">Elem</span></a><span> </span><a href="#local-6989586621679063058"><span class="hs-identifier hs-var">x2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-var">Elem</span></a><span> </span><a href="#local-6989586621679063060"><span class="hs-identifier hs-var">y2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4560"></a><span class="hs-identifier">unzipWithNodeElem</span><span> </span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Node3</span><span> </span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">z</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4561"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">x2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679063062"><a href="#local-6989586621679063062"><span class="hs-identifier">x</span></a></a><span>
</span><a name="line-4562"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679063067"><a href="#local-6989586621679063067"><span class="hs-identifier">y1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679063068"><a href="#local-6989586621679063068"><span class="hs-identifier">y2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679063062"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679063064"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-4563"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679063069"><a href="#local-6989586621679063069"><span class="hs-identifier">z1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679063070"><a href="#local-6989586621679063070"><span class="hs-identifier">z2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679063062"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679063065"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-4564"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier">Node3</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">x1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">y1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">z1</span><span class="hs-special">)</span><span>
</span><a name="line-4565"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Data.Sequence.Internal.html#Node3"><span class="hs-identifier hs-var">Node3</span></a><span> </span><a href="#local-6989586621679063063"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-var">Elem</span></a><span> </span><a href="#local-6989586621679063067"><span class="hs-identifier hs-var">x2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-var">Elem</span></a><span> </span><a href="#local-6989586621679063069"><span class="hs-identifier hs-var">y2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.Sequence.Internal.html#Elem"><span class="hs-identifier hs-var">Elem</span></a><span> </span><a href="#local-6989586621679063071"><span class="hs-identifier hs-var">z2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4566"></a><span>
</span><a name="line-4567"></a><span class="hs-comment">-- | \( O(\min(n_1,n_2)) \).  'zip' takes two sequences and returns a sequence</span><span>
</span><a name="line-4568"></a><span class="hs-comment">-- of corresponding pairs.  If one input is short, excess elements are</span><span>
</span><a name="line-4569"></a><span class="hs-comment">-- discarded from the right end of the longer sequence.</span><span>
</span><a name="line-4570"></a><span class="hs-identifier">zip</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-4571"></a><span class="hs-identifier">zip</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">zipWith</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><a name="line-4572"></a><span>
</span><a name="line-4573"></a><span class="hs-comment">-- | \( O(\min(n_1,n_2)) \).  'zipWith' generalizes 'zip' by zipping with the</span><span>
</span><a name="line-4574"></a><span class="hs-comment">-- function given as the first argument, instead of a tupling function.</span><span>
</span><a name="line-4575"></a><span class="hs-comment">-- For example, @zipWith (+)@ is applied to two sequences to take the</span><span>
</span><a name="line-4576"></a><span class="hs-comment">-- sequence of corresponding sums.</span><span>
</span><a name="line-4577"></a><span class="hs-identifier">zipWith</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-4578"></a><span class="hs-identifier">zipWith</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s1</span><span> </span><span class="hs-identifier">s2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">zipWith'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s1'</span><span> </span><span class="hs-identifier">s2'</span><span>
</span><a name="line-4579"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-4580"></a><span>    </span><span class="hs-identifier">minLen</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">min</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">s1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">s2</span><span class="hs-special">)</span><span>
</span><a name="line-4581"></a><span>    </span><a name="local-6989586621679063076"><a href="#local-6989586621679063076"><span class="hs-identifier">s1'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">take</span><span> </span><span class="hs-identifier">minLen</span><span> </span><a href="Data.Sequence.Internal.html#length"><span class="hs-identifier hs-var">s1</span></a><span>
</span><a name="line-4582"></a><span>    </span><a name="local-6989586621679063077"><a href="#local-6989586621679063077"><span class="hs-identifier">s2'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#take"><span class="hs-identifier hs-var">take</span></a><span> </span><a href="#local-6989586621679063076"><span class="hs-identifier hs-var">minLen</span></a><span> </span><a href="#local-6989586621679063074"><span class="hs-identifier hs-var">s2</span></a><span>
</span><a name="line-4583"></a><span>
</span><a name="line-4584"></a><span class="hs-comment">-- | A version of zipWith that assumes the sequences have the same length.</span><span>
</span><a name="line-4585"></a><span class="hs-identifier">zipWith'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-4586"></a><span class="hs-identifier">zipWith'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s1</span><span> </span><span class="hs-identifier">s2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">splitMap</span><span> </span><span class="hs-identifier">uncheckedSplitAt</span><span> </span><span class="hs-identifier">goLeaf</span><span> </span><span class="hs-identifier">s2</span><span> </span><span class="hs-identifier">s1</span><span>
</span><a name="line-4587"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-4588"></a><span>    </span><span class="hs-identifier">goLeaf</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Seq</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Single</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Elem</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-4589"></a><span>    </span><a name="local-6989586621679063082"><a href="#local-6989586621679063082"><span class="hs-identifier">goLeaf</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-var">_</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#Single"><span class="hs-identifier hs-var">error</span></a><span> </span><span class="hs-string">&quot;Data.Sequence.zipWith'.goLeaf internal error: not a singleton&quot;</span><span>
</span><a name="line-4590"></a><span>
</span><a name="line-4591"></a><span class="hs-comment">-- | \( O(\min(n_1,n_2,n_3)) \).  'zip3' takes three sequences and returns a</span><span>
</span><a name="line-4592"></a><span class="hs-comment">-- sequence of triples, analogous to 'zip'.</span><span>
</span><a name="line-4593"></a><span class="hs-identifier">zip3</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>
</span><a name="line-4594"></a><span class="hs-identifier">zip3</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">zipWith3</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><a name="line-4595"></a><span>
</span><a name="line-4596"></a><span class="hs-comment">-- | \( O(\min(n_1,n_2,n_3)) \).  'zipWith3' takes a function which combines</span><span>
</span><a name="line-4597"></a><span class="hs-comment">-- three elements, as well as three sequences and returns a sequence of</span><span>
</span><a name="line-4598"></a><span class="hs-comment">-- their point-wise combinations, analogous to 'zipWith'.</span><span>
</span><a name="line-4599"></a><span class="hs-identifier">zipWith3</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">d</span><span>
</span><a name="line-4600"></a><span class="hs-identifier">zipWith3</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s1</span><span> </span><span class="hs-identifier">s2</span><span> </span><span class="hs-identifier">s3</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">zipWith'</span><span> </span><span class="hs-special">(</span><span class="hs-operator">$</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">zipWith'</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-identifier">s1'</span><span> </span><span class="hs-identifier">s2'</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">s3'</span><span>
</span><a name="line-4601"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-4602"></a><span>    </span><span class="hs-identifier">minLen</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">minimum</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">s1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">s2</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">s3</span><span class="hs-special">]</span><span>
</span><a name="line-4603"></a><span>    </span><a name="local-6989586621679063089"><a href="#local-6989586621679063089"><span class="hs-identifier">s1'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">take</span><span> </span><span class="hs-identifier">minLen</span><span> </span><a href="Data.Sequence.Internal.html#length"><span class="hs-identifier hs-var">s1</span></a><span>
</span><a name="line-4604"></a><span>    </span><a name="local-6989586621679063090"><a href="#local-6989586621679063090"><span class="hs-identifier">s2'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#take"><span class="hs-identifier hs-var">take</span></a><span> </span><a href="#local-6989586621679063089"><span class="hs-identifier hs-var">minLen</span></a><span> </span><a href="#local-6989586621679063086"><span class="hs-identifier hs-var">s2</span></a><span>
</span><a name="line-4605"></a><span>    </span><a name="local-6989586621679063091"><a href="#local-6989586621679063091"><span class="hs-identifier">s3'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#take"><span class="hs-identifier hs-var">take</span></a><span> </span><a href="#local-6989586621679063089"><span class="hs-identifier hs-var">minLen</span></a><span> </span><a href="#local-6989586621679063087"><span class="hs-identifier hs-var">s3</span></a><span>
</span><a name="line-4606"></a><span>
</span><a name="line-4607"></a><span class="hs-identifier">zipWith3'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">d</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">d</span><span>
</span><a name="line-4608"></a><span class="hs-identifier">zipWith3'</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s1</span><span> </span><span class="hs-identifier">s2</span><span> </span><span class="hs-identifier">s3</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">zipWith'</span><span> </span><span class="hs-special">(</span><span class="hs-operator">$</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">zipWith'</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-identifier">s1</span><span> </span><span class="hs-identifier">s2</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">s3</span><span>
</span><a name="line-4609"></a><span>
</span><a name="line-4610"></a><span class="hs-comment">-- | \( O(\min(n_1,n_2,n_3,n_4)) \).  'zip4' takes four sequences and returns a</span><span>
</span><a name="line-4611"></a><span class="hs-comment">-- sequence of quadruples, analogous to 'zip'.</span><span>
</span><a name="line-4612"></a><span class="hs-identifier">zip4</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">d</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span class="hs-identifier">d</span><span class="hs-special">)</span><span>
</span><a name="line-4613"></a><span class="hs-identifier">zip4</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">zipWith4</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><a name="line-4614"></a><span>
</span><a name="line-4615"></a><span class="hs-comment">-- | \( O(\min(n_1,n_2,n_3,n_4)) \).  'zipWith4' takes a function which combines</span><span>
</span><a name="line-4616"></a><span class="hs-comment">-- four elements, as well as four sequences and returns a sequence of</span><span>
</span><a name="line-4617"></a><span class="hs-comment">-- their point-wise combinations, analogous to 'zipWith'.</span><span>
</span><a name="line-4618"></a><span class="hs-identifier">zipWith4</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">d</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">d</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">e</span><span>
</span><a name="line-4619"></a><span class="hs-identifier">zipWith4</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">s1</span><span> </span><span class="hs-identifier">s2</span><span> </span><span class="hs-identifier">s3</span><span> </span><span class="hs-identifier">s4</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">zipWith'</span><span> </span><span class="hs-special">(</span><span class="hs-operator">$</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">zipWith3'</span><span> </span><a href="Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-identifier">s1'</span><span> </span><span class="hs-identifier">s2'</span><span> </span><span class="hs-identifier">s3'</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">s4'</span><span>
</span><a name="line-4620"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-4621"></a><span>    </span><span class="hs-identifier">minLen</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">minimum</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">s1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">s2</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">s3</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">s4</span><span class="hs-special">]</span><span>
</span><a name="line-4622"></a><span>    </span><a name="local-6989586621679063102"><a href="#local-6989586621679063102"><span class="hs-identifier">s1'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">take</span><span> </span><span class="hs-identifier">minLen</span><span> </span><a href="Data.Sequence.Internal.html#length"><span class="hs-identifier hs-var">s1</span></a><span>
</span><a name="line-4623"></a><span>    </span><a name="local-6989586621679063103"><a href="#local-6989586621679063103"><span class="hs-identifier">s2'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#take"><span class="hs-identifier hs-var">take</span></a><span> </span><a href="#local-6989586621679063102"><span class="hs-identifier hs-var">minLen</span></a><span> </span><a href="#local-6989586621679063098"><span class="hs-identifier hs-var">s2</span></a><span>
</span><a name="line-4624"></a><span>    </span><a name="local-6989586621679063104"><a href="#local-6989586621679063104"><span class="hs-identifier">s3'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#take"><span class="hs-identifier hs-var">take</span></a><span> </span><a href="#local-6989586621679063102"><span class="hs-identifier hs-var">minLen</span></a><span> </span><a href="#local-6989586621679063099"><span class="hs-identifier hs-var">s3</span></a><span>
</span><a name="line-4625"></a><span>    </span><a name="local-6989586621679063105"><a href="#local-6989586621679063105"><span class="hs-identifier">s4'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Sequence.Internal.html#take"><span class="hs-identifier hs-var">take</span></a><span> </span><a href="#local-6989586621679063102"><span class="hs-identifier hs-var">minLen</span></a><span> </span><a href="#local-6989586621679063100"><span class="hs-identifier hs-var">s4</span></a><span>
</span><a name="line-4626"></a><span>
</span><a name="line-4627"></a><span class="hs-comment">-- | fromList2, given a list and its length, constructs a completely</span><span>
</span><a name="line-4628"></a><span class="hs-comment">-- balanced Seq whose elements are that list using the replicateA</span><span>
</span><a name="line-4629"></a><span class="hs-comment">-- generalization.</span><span>
</span><a name="line-4630"></a><span class="hs-identifier">fromList2</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Seq</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-4631"></a><span class="hs-identifier">fromList2</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">execState</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">replicateA</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">State</span><span> </span><span class="hs-identifier">ht</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4632"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-4633"></a><span>    </span><span class="hs-identifier">ht</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">xs</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><a name="line-4634"></a><span>    </span><a name="local-6989586621679063108"><a href="#local-6989586621679063108"><span class="hs-identifier">ht</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;fromList2: short list&quot;</span><span>
</span><a name="line-4635"></a></pre></body></html>